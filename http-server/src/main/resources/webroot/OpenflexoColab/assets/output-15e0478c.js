import{vb as W,vc as oe,vd as U,_ as v,a as s,g as _,um as ne,nj as $,ap as ae,da as ue,dl as ce,jy as C,ve as le,vf as ge,mT as he,X as de,Q as pe,aQ as K,a0 as P,Z as fe,e as O,cd as we,Y as R,O as M,N,dd as q,dx as G,cx as L,aW as ve,ag as Ce,ec as Oe,hT as be,vg as H,u as Se,m as me,o2 as Ie,kx as j,B as u,vh as g,dK as Le,vi as z,b as X,f as ye,bB as _e,f4 as Te,U as Q,vj as Y,oK as xe,vk as Ae,vl as Z,vm as Ee,vn as ke,vo as De,vp as Ve,c0 as Fe,bj as I,a3 as S,as as J,k as T,aB as Pe,fO as Re,eV as Me,kw as Be,an as w,iB as Ue,cA as $e,D as We,vq as Ke,aj as p,ak as f,aH as d,aN as Ne,aF as m,t as qe,d as Ge,vr as He,bz as x,al as A,qt as je,f_ as ze,vs as Xe,l as Qe,vt as Ye,am as Ze}from"./index-e8d740ba.js";import{A as ee}from"./textResourceEditor-22f2c951.js";class Je extends W{constructor(e=oe){super(),this.buffer=[],this._logger=void 0,this.setLevel(e),this._register(this.onDidChangeLogLevel(t=>{var i;(i=this._logger)==null||i.setLevel(t)}))}set logger(e){this._logger=e;for(const{level:t,message:i}of this.buffer)U(e,t,i);this.buffer=[]}log(e,t){this._logger?U(this._logger,e,t):this.getLevel()<=e&&this.buffer.push({level:e,message:t})}dispose(){var e;(e=this._logger)==null||e.dispose()}flush(){var e;(e=this._logger)==null||e.flush()}}const et=5*le.MB;let E=class extends W{constructor(e,t,i,r){super(),this.resource=e,this.donotUseFormatters=i,this.fileService=r,this.backupIndex=1,this.buffer="",this.setLevel(t),this.flushDelayer=new ne(100),this.initializePromise=this.initialize()}async flush(){if(!this.buffer)return;await this.initializePromise;let e=await this.loadContent();e.length>et&&(await this.fileService.writeFile(this.getBackupResource(),$.fromString(e)),e=""),this.buffer&&(e+=this.buffer,this.buffer="",await this.fileService.writeFile(this.resource,$.fromString(e)))}async initialize(){try{await this.fileService.createFile(this.resource)}catch(e){if(e.fileOperationResult!==3)throw e}}log(e,t){this.donotUseFormatters?this.buffer+=t:this.buffer+=`${this.getCurrentTimestamp()} [${this.stringifyLogLevel(e)}] ${t}
`,this.flushDelayer.trigger(()=>this.flush())}getCurrentTimestamp(){const e=r=>r<10?`0${r}`:r,t=r=>r<10?`00${r}`:r<100?`0${r}`:r,i=new Date;return`${i.getFullYear()}-${e(i.getMonth()+1)}-${e(i.getDate())} ${e(i.getHours())}:${e(i.getMinutes())}:${e(i.getSeconds())}.${t(i.getMilliseconds())}`}getBackupResource(){return this.backupIndex=this.backupIndex>5?1:this.backupIndex,ae(ue(this.resource),`${ce(this.resource)}_${this.backupIndex++}`)}async loadContent(){try{return(await this.fileService.readFile(this.resource)).value.toString()}catch{return""}}stringifyLogLevel(e){switch(e){case C.Debug:return"debug";case C.Error:return"error";case C.Info:return"info";case C.Trace:return"trace";case C.Warning:return"warning"}return""}};E=v([s(3,_)],E);class tt extends ge{constructor(e,t,i){super(e,t),this.fileService=i}doCreateLogger(e,t,i){const r=new Je(t);return he(e,this.fileService).then(()=>r.logger=new E(e,r.getLevel(),!!(i!=null&&i.donotUseFormatters),this.fileService)),r}}let k=class extends be{get scrollLock(){return!!this.scrollLockContextKey.get()}set scrollLock(e){this.scrollLockContextKey.set(e)}constructor(e,t,i,r,n,o,c,a,l,B){super(e,t,i,r,n,o,c,a,l,B),this.editorPromise=null,this.scrollLockContextKey=H.bindTo(this.contextKeyService);const se=c.createChild(new Se([P,this.scopedContextKeyService]));this.editor=se.createInstance(D),this._register(this.editor.onTitleAreaUpdate(()=>{this.updateTitle(this.editor.getTitle()),this.updateActions()})),this._register(this.onDidChangeBodyVisibility(()=>this.onDidChangeVisibility(this.isBodyVisible())))}showChannel(e,t){this.channelId!==e.id&&this.setInput(e),t||this.focus()}focus(){var e;super.focus(),(e=this.editorPromise)==null||e.then(()=>this.editor.focus())}renderBody(e){super.renderBody(e),this.editor.create(e),e.classList.add("output-view");const t=this.editor.getControl();t.setAriaOptions({role:"document",activeDescendant:void 0}),this._register(t.onDidChangeModelContent(()=>{this.scrollLock||this.editor.revealLastLine()})),this._register(t.onDidChangeCursorPosition(i=>{if(i.reason!==3||!this.configurationService.getValue("output.smartScroll.enabled"))return;const r=t.getModel();if(r){const n=i.position.lineNumber,o=r.getLineCount();this.scrollLock=o!==n}}))}layoutBody(e,t){super.layoutBody(e,t),this.editor.layout(new me(t,e))}onDidChangeVisibility(e){this.editor.setVisible(e),e||this.clearInput()}setInput(e){var i;this.channelId=e.id;const t=this.createInput(e);(!this.editor.input||!t.matches(this.editor.input))&&((i=this.editorPromise)==null||i.cancel(),this.editorPromise=Ie(r=>this.editor.setInput(this.createInput(e),{preserveFocus:!0},Object.create(null),r).then(()=>this.editor)))}clearInput(){this.channelId=void 0,this.editor.clearInput(),this.editorPromise=null}createInput(e){return this.instantiationService.createInstance(j,e.uri,u("output model title","{0} - Output",e.label),u("channel","Output channel for '{0}'",e.label),void 0,void 0)}};k=v([s(1,de),s(2,pe),s(3,K),s(4,P),s(5,fe),s(6,O),s(7,we),s(8,R),s(9,M)],k);let D=class extends ee{constructor(e,t,i,r,n,o,c,a,l,B){super(g,e,t,i,n,o,c,a,l),this.configurationService=r,this.resourceContext=this._register(t.createInstance(Le))}getId(){return g}getTitle(){return u("output","Output")}getConfigurationOverrides(){const e=super.getConfigurationOverrides();e.wordWrap="on",e.lineNumbers="off",e.glyphMargin=!1,e.lineDecorationsWidth=20,e.rulers=[],e.folding=!1,e.scrollBeyondLastLine=!1,e.renderLineHighlight="none",e.minimap={enabled:!1},e.renderValidationDecorations="editable",e.padding=void 0,e.readOnly=!0,e.domReadOnly=!0,e.unicodeHighlight={nonBasicASCII:!1,invisibleCharacters:!1,ambiguousCharacters:!1};const t=this.configurationService.getValue("[Log]");return t&&(t["editor.minimap.enabled"]&&(e.minimap={enabled:!0}),"editor.wordWrap"in t&&(e.wordWrap=t["editor.wordWrap"])),e}getAriaLabel(){return this.input?this.input.getAriaLabel():u("outputViewAriaLabel","Output panel")}async setInput(e,t,i,r){const n=!(t&&t.preserveFocus);this.input&&e.matches(this.input)||(this.input&&this.input.dispose(),await super.setInput(e,t,i,r),this.resourceContext.set(e.resource),n&&this.focus(),this.revealLastLine())}clearInput(){this.input&&this.input.dispose(),super.clearInput(),this.resourceContext.reset()}createEditor(e){e.setAttribute("role","document"),super.createEditor(e);const t=this.scopedContextKeyService;t&&z.bindTo(t).set(!0)}};D=v([s(0,M),s(1,O),s(2,N),s(3,K),s(4,q),s(5,R),s(6,G),s(7,L),s(8,_),s(9,P)],D);ve((h,e)=>{const t=h.getColor(Ce);t&&t!==h.getColor(Oe)&&e.addRule(`
			.monaco-workbench .part.sidebar .output-view .monaco-editor,
			.monaco-workbench .part.sidebar .output-view .monaco-editor .margin,
			.monaco-workbench .part.sidebar .output-view .monaco-editor .monaco-editor-background {
				background-color: ${t};
			}
		`)});let b=class te extends j{get typeId(){return te.ID}constructor(e,t,i,r,n,o,c){super(Q.from({scheme:Y,path:e.id}),xe(e.file.path),Ae(e.file.path),void 0,void 0,t,i,r,n,o,c)}};b.ID="workbench.editorinputs.output";b=v([s(1,X),s(2,ye),s(3,L),s(4,_),s(5,_e),s(6,Te)],b);let y=class ie extends ee{constructor(e,t,i,r,n,o,c,a){super(ie.LOG_VIEWER_EDITOR_ID,e,t,i,r,n,o,c,a)}getConfigurationOverrides(){const e=super.getConfigurationOverrides();return e.wordWrap="off",e.folding=!1,e.scrollBeyondLastLine=!1,e.renderValidationDecorations="editable",e}getAriaLabel(){return u("logViewerAriaLabel","Log viewer")}};y.LOG_VIEWER_EDITOR_ID="workbench.editors.logViewer";y=v([s(0,M),s(1,O),s(2,N),s(3,q),s(4,R),s(5,G),s(6,L),s(7,_)],y);Z.registerLanguage({id:Ee,extensions:[],mimetypes:[ke]});Z.registerLanguage({id:De,extensions:[],mimetypes:[Ve]});const re=Fe("output-view-icon",I.output,u("outputViewIcon","View icon of the output view.")),it=S.as(J.ViewContainersRegistry).registerViewContainer({id:g,title:u("output","Output"),icon:re,order:1,ctorDescriptor:new T(Pe,[g,{mergeViewWithContainerWhenSingleView:!0}]),storageId:g,hideIfEmpty:!0},1,{doNotRegisterOpenCommand:!0});S.as(J.ViewsRegistry).registerViews([{id:g,name:u("output","Output"),containerIcon:re,canMoveView:!0,canToggleVisibility:!1,ctorDescriptor:new T(k),openCommandActionDescriptor:{id:"workbench.action.output.toggleOutput",mnemonicTitle:u({key:"miToggleOutput",comment:["&& denotes a mnemonic"]},"&&Output"),keybindings:{primary:3123,linux:{primary:Re(2089,2086)}},order:1}}],it);S.as(Me.EditorPane).registerEditorPane(Be.create(y,y.LOG_VIEWER_EDITOR_ID,u("logViewer","Log Viewer")),[new T(b)]);let V=class extends We{constructor(e,t,i){super(),this.outputService=i,t.registerTextModelContentProvider(Y,e.createInstance(Ke)),this.registerActions()}registerActions(){this.registerSwitchOutputAction(),this.registerShowOutputChannelsAction(),this.registerClearOutputAction(),this.registerToggleAutoScrollAction(),this.registerOpenActiveLogOutputFileAction(),this.registerShowLogsAction(),this.registerOpenLogFileAction()}registerSwitchOutputAction(){this._register(p(class extends f{constructor(){super({id:"workbench.output.action.switchBetweenOutputs",title:u("switchBetweenOutputs.label","Switch Output")})}async run(n,o){o&&n.get(w).showChannel(o,!0)}}));const e=new d("workbench.output.menu.switchOutput");this._register(Ne.appendMenuItem(d.ViewTitle,{submenu:e,title:u("switchToOutput.label","Switch Output"),group:"navigation",when:m.equals("view",g),order:1,isSelection:!0}));const t=new Map;this._register(qe(()=>Ge(t.values())));const i=n=>{for(const o of n){const c=o.label,a=o.extensionId?"0_ext_outputchannels":"1_core_outputchannels";t.set(o.id,p(class extends f{constructor(){super({id:`workbench.action.output.show.${o.id}`,title:c,toggled:Ye.isEqualTo(o.id),menu:{id:e,group:a}})}async run(l){return l.get(w).showChannel(o.id,!0)}}))}};i(this.outputService.getChannelDescriptors());const r=S.as(He.OutputChannels);this._register(r.onDidRegisterChannel(n=>{const o=this.outputService.getChannelDescriptor(n);o&&i([o])})),this._register(r.onDidRemoveChannel(n=>{var o;(o=t.get(n))==null||o.dispose(),t.delete(n)}))}registerShowOutputChannelsAction(){this._register(p(class extends f{constructor(){super({id:"workbench.action.showOutputChannels",title:{value:u("showOutputChannels","Show Output Channels..."),original:"Show Output Channels..."},category:{value:u("output","Output"),original:"Output"},f1:!0})}async run(e){const t=e.get(w),i=e.get(x),r=[],n=[];for(const a of t.getChannelDescriptors())a.extensionId?r.push(a):n.push(a);const o=[];for(const{id:a,label:l}of r)o.push({id:a,label:l});r.length&&n.length&&o.push({type:"separator"});for(const{id:a,label:l}of n)o.push({id:a,label:l});const c=await i.pick(o,{placeHolder:u("selectOutput","Select Output Channel")});if(c)return t.showChannel(c.id)}}))}registerClearOutputAction(){this._register(p(class extends f{constructor(){super({id:"workbench.output.action.clearOutput",title:{value:u("clearOutput.label","Clear Output"),original:"Clear Output"},category:A.View,menu:[{id:d.ViewTitle,when:m.equals("view",g),group:"navigation",order:2},{id:d.CommandPalette},{id:d.EditorContext,when:z}],icon:I.clearAll})}async run(e){const i=e.get(w).getActiveChannel();i&&(i.clear(),je(u("outputCleared","Output was cleared")))}}))}registerToggleAutoScrollAction(){this._register(p(class extends f{constructor(){super({id:"workbench.output.action.toggleAutoScroll",title:{value:u("toggleAutoScroll","Toggle Auto Scrolling"),original:"Toggle Auto Scrolling"},tooltip:u("outputScrollOff","Turn Auto Scrolling Off"),menu:{id:d.ViewTitle,when:m.and(m.equals("view",g)),group:"navigation",order:3},icon:I.lock,toggled:{condition:H,icon:I.unlock,tooltip:u("outputScrollOn","Turn Auto Scrolling On")}})}async run(e){const t=e.get(ze).getActiveViewWithId(g);t.scrollLock=!t.scrollLock}}))}registerOpenActiveLogOutputFileAction(){this._register(p(class extends f{constructor(){super({id:"workbench.action.openActiveLogOutputFile",title:{value:u("openActiveLogOutputFile","Open Log Output File"),original:"Open Log Output File"},menu:[{id:d.ViewTitle,when:m.equals("view",g),group:"navigation",order:4}],icon:I.goToFile,precondition:Xe})}async run(e){const t=e.get(w),i=e.get(L),r=e.get(O),n=this.getLogFileOutputChannelDescriptor(t);n&&await i.openEditor(r.createInstance(b,n),{pinned:!0})}getLogFileOutputChannelDescriptor(e){const t=e.getActiveChannel();if(t){const i=e.getChannelDescriptors().filter(r=>r.id===t.id)[0];if(i&&i.file&&i.log)return i}return null}}))}registerShowLogsAction(){this._register(p(class extends f{constructor(){super({id:"workbench.action.showLogs",title:{value:u("showLogs","Show Logs..."),original:"Show Logs..."},category:A.Developer,menu:{id:d.CommandPalette}})}async run(e){const t=e.get(w),i=e.get(x),r=[],n=[];for(const a of t.getChannelDescriptors())a.log&&(a.extensionId?r.push(a):n.push(a));const o=[];for(const{id:a,label:l}of n)o.push({id:a,label:l});r.length&&n.length&&o.push({type:"separator",label:u("extensionLogs","Extension Logs")});for(const{id:a,label:l}of r)o.push({id:a,label:l});const c=await i.pick(o,{placeHolder:u("selectlog","Select Log")});if(c)return t.showChannel(c.id)}}))}registerOpenLogFileAction(){this._register(p(class extends f{constructor(){super({id:"workbench.action.openLogFile",title:{value:u("openLogFile","Open Log File..."),original:"Open Log File..."},category:A.Developer,menu:{id:d.CommandPalette}})}async run(e){const t=e.get(w),i=e.get(x),r=e.get(O),n=e.get(L),o=t.getChannelDescriptors().filter(a=>a.file&&a.log).map(a=>({id:a.id,label:a.label,channel:a})),c=await i.pick(o,{placeHolder:u("selectlogFile","Select Log file")});c&&(Qe(c.channel.file),await n.openEditor(r.createInstance(b,c.channel),{pinned:!0}))}}))}};V=v([s(0,O),s(1,X),s(2,w)],V);S.as(Ue.Workbench).registerWorkbenchContribution(V,3);S.as($e.Configuration).registerConfiguration({id:"output",order:30,title:u("output","Output"),type:"object",properties:{"output.smartScroll.enabled":{type:"boolean",description:u("output.smartScroll.enabled","Enable/disable the ability of smart scrolling in the output view. Smart scrolling allows you to lock scrolling automatically when you click in the output view and unlocks when you click in the last line."),default:!0,scope:3,tags:["output"]}}});let F=class extends tt{constructor(e){super(C.Info,Q.file("logs.log"),e)}};F=v([s(0,_)],F);function lt(){return{[Ze.toString()]:new T(F)}}export{lt as default};
