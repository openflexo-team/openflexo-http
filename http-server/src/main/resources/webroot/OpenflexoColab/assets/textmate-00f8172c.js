import{D as ae,E as Xe,o_ as Ie,o$ as Ye,p0 as De,p1 as Ze,p2 as et,p3 as tt,p4 as nt,p5 as rt,p6 as st,p7 as it,p8 as Ae,p9 as ot,pa as at,ct,pb as je,_ as Re,a as q,oS as Fe,I as ut,pc as lt,aQ as Be,bC as $e,pd as ht,L as ze,O as dt,bS as We,pe as ee,pf as pt,pg as gt,w as pe,U as xe,t as mt,ph as Te,pi as Ee,au as ft,iA as fe,B as N,aU as _t,hR as kt,ao as yt,e as Ue,d3 as St,pj as Se,ap as qe,pk as Ne,dc as bt,d0 as Tt,pl as Ct,pm as vt,cW as wt,ic as Me,oO as Rt,pn as Lt,a3 as Pt,iB as It,nM as At,po as Ve,k as xt,nN as Et,cy as Nt,jA as Mt}from"./index-e8d740ba.js";import{l as Ot}from"./languageService-96e25f8d.js";import{I as Gt}from"./workbenchThemeService-428461e4.js";import{a as oe,g as Dt}from"./tokenClassificationRegistry-e01f7921.js";import{r as jt}from"./assets-28e9249d.js";function Ft(M,h){for(var k=0;k<h.length;k++){const v=h[k];if(typeof v!="string"&&!Array.isArray(v)){for(const T in v)if(T!=="default"&&!(T in M)){const t=Object.getOwnPropertyDescriptor(v,T);t&&Object.defineProperty(M,T,t.get?t:{enumerable:!0,get:()=>v[T]})}}}return Object.freeze(Object.defineProperty(M,Symbol.toStringTag,{value:"Module"}))}class Bt extends ae{constructor(h,k,v,T,t=()=>!1){super(),this._grammar=h,this._initialState=k,this._containsEmbeddedLanguages=v,this._createBackgroundTokenizer=T,this._backgroundTokenizerShouldOnlyVerifyTokens=t,this._seenLanguages=[],this._onDidEncounterLanguage=this._register(new Xe),this.onDidEncounterLanguage=this._onDidEncounterLanguage.event}get backgroundTokenizerShouldOnlyVerifyTokens(){return this._backgroundTokenizerShouldOnlyVerifyTokens()}getInitialState(){return this._initialState}tokenize(h,k,v){throw new Error("Not supported!")}createBackgroundTokenizer(h,k){if(this._createBackgroundTokenizer)return this._createBackgroundTokenizer(h,k)}tokenizeEncoded(h,k,v){const T=this._grammar.tokenizeLine2(h,v,500);if(T.stoppedEarly)return console.warn(`Time limit reached when tokenizing line: ${h.substring(0,100)}`),new Ie(T.tokens,v);if(this._containsEmbeddedLanguages){const u=this._seenLanguages,o=T.tokens;for(let g=0,p=o.length>>>1;g<p;g++){const m=o[(g<<1)+1],c=Ye.getLanguageId(m);u[c]||(u[c]=!0,this._onDidEncounterLanguage.fire(c))}}let t;return v.equals(T.ruleStack)?t=v:t=T.ruleStack,new Ie(T.tokens,t)}}class $t extends ae{get backgroundTokenizerShouldOnlyVerifyTokens(){return this._actual.backgroundTokenizerShouldOnlyVerifyTokens}constructor(h,k,v){super(),this._encodedLanguageId=h,this._actual=k,this._maxTokenizationLineLength=v,this._register(De(this._maxTokenizationLineLength))}getInitialState(){return this._actual.getInitialState()}tokenize(h,k,v){throw new Error("Not supported!")}tokenizeEncoded(h,k,v){return h.length>=this._maxTokenizationLineLength.get()?Ze(this._encodedLanguageId,v):this._actual.tokenizeEncoded(h,k,v)}createBackgroundTokenizer(h,k){if(this._actual.createBackgroundTokenizer)return this._actual.createBackgroundTokenizer(h,k)}}class zt{constructor(h){this.edits=h.slice().sort(et(k=>k.offset,tt))}applyToArray(h){for(let k=this.edits.length-1;k>=0;k--){const v=this.edits[k];h.splice(v.offset,v.length,...new Array(v.newLength))}}}class Wt{constructor(h,k,v){this.offset=h,this.length=k,this.newLength=v}toString(){return`[${this.offset}, +${this.length}) -> +${this.newLength}}`}}class ge{static fromMany(h){const k=h.map(v=>new ge(v));return new Ut(k)}constructor(h){this.transformation=h,this.idx=0,this.offset=0}transform(h){let k=this.transformation.edits[this.idx];for(;k&&k.offset+k.length<=h;)this.offset+=k.newLength-k.length,this.idx++,k=this.transformation.edits[this.idx];if(!(k&&k.offset<=h))return h+this.offset}}class Ut{constructor(h){this.transformers=h}transform(h){for(const k of this.transformers){const v=k.transform(h);if(v===void 0)return;h=v}return h}}var He={exports:{}};(function(M,h){(function(k,v){M.exports=v()})(nt,function(){return(()=>{var k={350:(T,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UseOnigurumaFindOptions=t.DebugFlags=void 0,t.DebugFlags={InDebugMode:typeof process<"u"&&!!{}.VSCODE_TEXTMATE_DEBUG},t.UseOnigurumaFindOptions=!1},442:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyStateStackDiff=t.diffStateStacksRefEq=void 0;const o=u(391);t.diffStateStacksRefEq=function(g,p){let m=0;const c=[];let f=g,I=p;for(;f!==I;)f&&(!I||f.depth>=I.depth)?(m++,f=f.parent):(c.push(I.toStateStackFrame()),I=I.parent);return{pops:m,newFrames:c.reverse()}},t.applyStateStackDiff=function(g,p){let m=g;for(let c=0;c<p.pops;c++)m=m.parent;for(const c of p.newFrames)m=o.StateStackImpl.pushFrame(m,c);return m}},36:(T,t)=>{var u;Object.defineProperty(t,"__esModule",{value:!0}),t.toOptionalTokenType=t.EncodedTokenAttributes=void 0,(u=t.EncodedTokenAttributes||(t.EncodedTokenAttributes={})).toBinaryStr=function(o){let g=o.toString(2);for(;g.length<32;)g="0"+g;return g},u.print=function(o){const g=u.getLanguageId(o),p=u.getTokenType(o),m=u.getFontStyle(o),c=u.getForeground(o),f=u.getBackground(o);console.log({languageId:g,tokenType:p,fontStyle:m,foreground:c,background:f})},u.getLanguageId=function(o){return(255&o)>>>0},u.getTokenType=function(o){return(768&o)>>>8},u.containsBalancedBrackets=function(o){return(1024&o)!=0},u.getFontStyle=function(o){return(30720&o)>>>11},u.getForeground=function(o){return(16744448&o)>>>15},u.getBackground=function(o){return(4278190080&o)>>>24},u.set=function(o,g,p,m,c,f,I){let _=u.getLanguageId(o),w=u.getTokenType(o),L=u.containsBalancedBrackets(o)?1:0,C=u.getFontStyle(o),d=u.getForeground(o),S=u.getBackground(o);return g!==0&&(_=g),p!==8&&(w=p),m!==null&&(L=m?1:0),c!==-1&&(C=c),f!==0&&(d=f),I!==0&&(S=I),(_<<0|w<<8|L<<10|C<<11|d<<15|S<<24)>>>0},t.toOptionalTokenType=function(o){return o}},996:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BasicScopeAttributesProvider=t.BasicScopeAttributes=void 0;const o=u(878);class g{constructor(f,I){this.languageId=f,this.tokenType=I}}t.BasicScopeAttributes=g;class p{constructor(f,I){this._getBasicScopeAttributes=new o.CachedFn(_=>{const w=this._scopeToLanguage(_),L=this._toStandardTokenType(_);return new g(w,L)}),this._defaultAttributes=new g(f,8),this._embeddedLanguagesMatcher=new m(Object.entries(I||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(f){return f===null?p._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(f)}_scopeToLanguage(f){return this._embeddedLanguagesMatcher.match(f)||0}_toStandardTokenType(f){const I=f.match(p.STANDARD_TOKEN_TYPE_REGEXP);if(!I)return 8;switch(I[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}}t.BasicScopeAttributesProvider=p,p._NULL_SCOPE_METADATA=new g(0,0),p.STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/;class m{constructor(f){if(f.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(f);const I=f.map(([_,w])=>o.escapeRegExpCharacters(_));I.sort(),I.reverse(),this.scopesRegExp=new RegExp(`^((${I.join(")|(")}))($|\\.)`,"")}}match(f){if(!this.scopesRegExp)return;const I=f.match(this.scopesRegExp);return I?this.values.get(I[1]):void 0}}},947:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LineTokens=t.BalancedBracketSelectors=t.StateStackImpl=t.AttributedScopeStack=t.Grammar=t.createGrammar=void 0;const o=u(350),g=u(36),p=u(736),m=u(44),c=u(792),f=u(583),I=u(878),_=u(996),w=u(47);function L(s,n,i,a,y){const R=p.createMatchers(n,C),A=c.RuleFactory.getCompiledRuleId(i,a,y.repository);for(const x of R)s.push({debugSelector:n,matcher:x.matcher,ruleId:A,grammar:y,priority:x.priority})}function C(s,n){if(n.length<s.length)return!1;let i=0;return s.every(a=>{for(let y=i;y<n.length;y++)if(d(n[y],a))return i=y+1,!0;return!1})}function d(s,n){if(!s)return!1;if(s===n)return!0;const i=n.length;return s.length>i&&s.substr(0,i)===n&&s[i]==="."}t.createGrammar=function(s,n,i,a,y,R,A,x){return new S(s,n,i,a,y,R,A,x)};class S{constructor(n,i,a,y,R,A,x,E){if(this._rootScopeName=n,this.balancedBracketSelectors=A,this._onigLib=E,this._basicScopeAttributesProvider=new _.BasicScopeAttributesProvider(a,y),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=x,this._grammar=b(i,null),this._injections=null,this._tokenTypeMatchers=[],R)for(const $ of Object.keys(R)){const j=p.createMatchers($,C);for(const O of j)this._tokenTypeMatchers.push({matcher:O.matcher,type:R[$]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const n of this._ruleId2desc)n&&n.dispose()}createOnigScanner(n){return this._onigLib.createOnigScanner(n)}createOnigString(n){return this._onigLib.createOnigString(n)}getMetadataForScope(n){return this._basicScopeAttributesProvider.getBasicScopeAttributes(n)}_collectInjections(){const n=[],i=this._rootScopeName,a=(y=>y===this._rootScopeName?this._grammar:this.getExternalGrammar(y))(i);if(a){const y=a.injections;if(y)for(let A in y)L(n,A,y[A],this,a);const R=this._grammarRepository.injections(i);R&&R.forEach(A=>{const x=this.getExternalGrammar(A);if(x){const E=x.injectionSelector;E&&L(n,E,x,this,x)}})}return n.sort((y,R)=>y.priority-R.priority),n}getInjections(){if(this._injections===null&&(this._injections=this._collectInjections(),o.DebugFlags.InDebugMode&&this._injections.length>0)){console.log(`Grammar ${this._rootScopeName} contains the following injections:`);for(const n of this._injections)console.log(`  - ${n.debugSelector}`)}return this._injections}registerRule(n){const i=++this._lastRuleId,a=n(c.ruleIdFromNumber(i));return this._ruleId2desc[i]=a,a}getRule(n){return this._ruleId2desc[c.ruleIdToNumber(n)]}getExternalGrammar(n,i){if(this._includedGrammars[n])return this._includedGrammars[n];if(this._grammarRepository){const a=this._grammarRepository.lookup(n);if(a)return this._includedGrammars[n]=b(a,i&&i.$base),this._includedGrammars[n]}}tokenizeLine(n,i,a=0){const y=this._tokenize(n,i,!1,a);return{tokens:y.lineTokens.getResult(y.ruleStack,y.lineLength),ruleStack:y.ruleStack,stoppedEarly:y.stoppedEarly}}tokenizeLine2(n,i,a=0){const y=this._tokenize(n,i,!0,a);return{tokens:y.lineTokens.getBinaryResult(y.ruleStack,y.lineLength),ruleStack:y.ruleStack,stoppedEarly:y.stoppedEarly}}_tokenize(n,i,a,y){let R;if(this._rootId===-1&&(this._rootId=c.RuleFactory.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections()),i&&i!==e.NULL)R=!1,i.reset();else{R=!0;const j=this._basicScopeAttributesProvider.getDefaultAttributes(),O=this.themeProvider.getDefaults(),z=g.EncodedTokenAttributes.set(0,j.languageId,j.tokenType,null,O.fontStyle,O.foregroundId,O.backgroundId),V=this.getRule(this._rootId).getName(null,null);let W;W=V?l.createRootAndLookUpScopeName(V,z,this):l.createRoot("unknown",z),i=new e(null,this._rootId,-1,-1,!1,null,W,W)}n+=`
`;const A=this.createOnigString(n),x=A.content.length,E=new r(a,n,this._tokenTypeMatchers,this.balancedBracketSelectors),$=w._tokenizeString(this,A,R,0,i,E,!0,y);return m.disposeOnigString(A),{lineLength:x,lineTokens:E,ruleStack:$.stack,stoppedEarly:$.stoppedEarly}}}function b(s,n){return(s=I.clone(s)).repository=s.repository||{},s.repository.$self={$vscodeTextmateLocation:s.$vscodeTextmateLocation,patterns:s.patterns,name:s.scopeName},s.repository.$base=n||s.repository.$self,s}t.Grammar=S;class l{constructor(n,i,a){this.parent=n,this.scopePath=i,this.tokenAttributes=a}static fromExtension(n,i){let a=n,y=(n==null?void 0:n.scopePath)??null;for(const R of i)y=f.ScopeStack.push(y,R.scopeNames),a=new l(a,y,R.encodedTokenAttributes);return a}static createRoot(n,i){return new l(null,new f.ScopeStack(null,n),i)}static createRootAndLookUpScopeName(n,i,a){const y=a.getMetadataForScope(n),R=new f.ScopeStack(null,n),A=a.themeProvider.themeMatch(R),x=l.mergeAttributes(i,y,A);return new l(null,R,x)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(n){return l.equals(this,n)}static equals(n,i){for(;;){if(n===i||!n&&!i)return!0;if(!n||!i||n.scopeName!==i.scopeName||n.tokenAttributes!==i.tokenAttributes)return!1;n=n.parent,i=i.parent}}static mergeAttributes(n,i,a){let y=-1,R=0,A=0;return a!==null&&(y=a.fontStyle,R=a.foregroundId,A=a.backgroundId),g.EncodedTokenAttributes.set(n,i.languageId,i.tokenType,null,y,R,A)}pushAttributed(n,i){if(n===null)return this;if(n.indexOf(" ")===-1)return l._pushAttributed(this,n,i);const a=n.split(/ /g);let y=this;for(const R of a)y=l._pushAttributed(y,R,i);return y}static _pushAttributed(n,i,a){const y=a.getMetadataForScope(i),R=n.scopePath.push(i),A=a.themeProvider.themeMatch(R),x=l.mergeAttributes(n.tokenAttributes,y,A);return new l(n,R,x)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(n){var y;const i=[];let a=this;for(;a&&a!==n;)i.push({encodedTokenAttributes:a.tokenAttributes,scopeNames:a.scopePath.getExtensionIfDefined(((y=a.parent)==null?void 0:y.scopePath)??null)}),a=a.parent;return a===n?i.reverse():void 0}}t.AttributedScopeStack=l;class e{constructor(n,i,a,y,R,A,x,E){this.parent=n,this.ruleId=i,this.beginRuleCapturedEOL=R,this.endRule=A,this.nameScopesList=x,this.contentNameScopesList=E,this._stackElementBrand=void 0,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=a,this._anchorPos=y}equals(n){return n!==null&&e._equals(this,n)}static _equals(n,i){return n===i||!!this._structuralEquals(n,i)&&l.equals(n.contentNameScopesList,i.contentNameScopesList)}static _structuralEquals(n,i){for(;;){if(n===i||!n&&!i)return!0;if(!n||!i||n.depth!==i.depth||n.ruleId!==i.ruleId||n.endRule!==i.endRule)return!1;n=n.parent,i=i.parent}}clone(){return this}static _reset(n){for(;n;)n._enterPos=-1,n._anchorPos=-1,n=n.parent}reset(){e._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(n,i,a,y,R,A,x){return new e(this,n,i,a,y,R,A,x)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(n){return n.getRule(this.ruleId)}toString(){const n=[];return this._writeString(n,0),"["+n.join(",")+"]"}_writeString(n,i){var a,y;return this.parent&&(i=this.parent._writeString(n,i)),n[i++]=`(${this.ruleId}, ${(a=this.nameScopesList)==null?void 0:a.toString()}, ${(y=this.contentNameScopesList)==null?void 0:y.toString()})`,i}withContentNameScopesList(n){return this.contentNameScopesList===n?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,n)}withEndRule(n){return this.endRule===n?this:new e(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,n,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(n){let i=this;for(;i&&i._enterPos===n._enterPos;){if(i.ruleId===n.ruleId)return!0;i=i.parent}return!1}toStateStackFrame(){var n,i,a;return{ruleId:c.ruleIdToNumber(this.ruleId),beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:((i=this.nameScopesList)==null?void 0:i.getExtensionIfDefined(((n=this.parent)==null?void 0:n.nameScopesList)??null))??[],contentNameScopesList:((a=this.contentNameScopesList)==null?void 0:a.getExtensionIfDefined(this.nameScopesList))??[]}}static pushFrame(n,i){const a=l.fromExtension((n==null?void 0:n.nameScopesList)??null,i.nameScopesList);return new e(n,c.ruleIdFromNumber(i.ruleId),i.enterPos??-1,i.anchorPos??-1,i.beginRuleCapturedEOL,i.endRule,a,l.fromExtension(a,i.contentNameScopesList))}}t.StateStackImpl=e,e.NULL=new e(null,0,0,0,!1,null,null,null),t.BalancedBracketSelectors=class{constructor(s,n){this.allowAny=!1,this.balancedBracketScopes=s.flatMap(i=>i==="*"?(this.allowAny=!0,[]):p.createMatchers(i,C).map(a=>a.matcher)),this.unbalancedBracketScopes=n.flatMap(i=>p.createMatchers(i,C).map(a=>a.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(s){for(const n of this.unbalancedBracketScopes)if(n(s))return!1;for(const n of this.balancedBracketScopes)if(n(s))return!0;return this.allowAny}};class r{constructor(n,i,a,y){this.balancedBracketSelectors=y,this._emitBinaryTokens=n,this._tokenTypeOverrides=a,o.DebugFlags.InDebugMode?this._lineText=i:this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(n,i){this.produceFromScopes(n.contentNameScopesList,i)}produceFromScopes(n,i){var y;if(this._lastTokenEndIndex>=i)return;if(this._emitBinaryTokens){let R=(n==null?void 0:n.tokenAttributes)??0,A=!1;if((y=this.balancedBracketSelectors)!=null&&y.matchesAlways&&(A=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const x=(n==null?void 0:n.getScopeNames())??[];for(const E of this._tokenTypeOverrides)E.matcher(x)&&(R=g.EncodedTokenAttributes.set(R,0,g.toOptionalTokenType(E.type),null,-1,0,0));this.balancedBracketSelectors&&(A=this.balancedBracketSelectors.match(x))}if(A&&(R=g.EncodedTokenAttributes.set(R,0,8,A,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===R)return void(this._lastTokenEndIndex=i);if(o.DebugFlags.InDebugMode){const x=(n==null?void 0:n.getScopeNames())??[];console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,i).replace(/\n$/,"\\n")+"|");for(let E=0;E<x.length;E++)console.log("      * "+x[E])}return this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(R),void(this._lastTokenEndIndex=i)}const a=(n==null?void 0:n.getScopeNames())??[];if(o.DebugFlags.InDebugMode){console.log("  token: |"+this._lineText.substring(this._lastTokenEndIndex,i).replace(/\n$/,"\\n")+"|");for(let R=0;R<a.length;R++)console.log("      * "+a[R])}this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:i,scopes:a}),this._lastTokenEndIndex=i}getResult(n,i){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===i-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(n,i),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(n,i){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===i-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(n,i),this._binaryTokens[this._binaryTokens.length-2]=0);const a=new Uint32Array(this._binaryTokens.length);for(let y=0,R=this._binaryTokens.length;y<R;y++)a[y]=this._binaryTokens[y];return a}}t.LineTokens=r},965:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseInclude=t.TopLevelRepositoryReference=t.TopLevelReference=t.RelativeReference=t.SelfReference=t.BaseReference=t.ScopeDependencyProcessor=t.ExternalReferenceCollector=t.TopLevelRepositoryRuleReference=t.TopLevelRuleReference=void 0;const o=u(878);class g{constructor(e){this.scopeName=e}toKey(){return this.scopeName}}t.TopLevelRuleReference=g;class p{constructor(e,r){this.scopeName=e,this.ruleName=r}toKey(){return`${this.scopeName}#${this.ruleName}`}}t.TopLevelRepositoryRuleReference=p;class m{constructor(){this._references=[],this._seenReferenceKeys=new Set,this.visitedRule=new Set}get references(){return this._references}add(e){const r=e.toKey();this._seenReferenceKeys.has(r)||(this._seenReferenceKeys.add(r),this._references.push(e))}}function c(l,e,r,s){const n=r.lookup(l.scopeName);if(!n){if(l.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const i=r.lookup(e);l instanceof g?I({baseGrammar:i,selfGrammar:n},s):f(l.ruleName,{baseGrammar:i,selfGrammar:n,repository:n.repository},s);const a=r.injections(l.scopeName);if(a)for(const y of a)s.add(new g(y))}function f(l,e,r){e.repository&&e.repository[l]&&_([e.repository[l]],e,r)}function I(l,e){l.selfGrammar.patterns&&Array.isArray(l.selfGrammar.patterns)&&_(l.selfGrammar.patterns,{...l,repository:l.selfGrammar.repository},e),l.selfGrammar.injections&&_(Object.values(l.selfGrammar.injections),{...l,repository:l.selfGrammar.repository},e)}function _(l,e,r){for(const s of l){if(r.visitedRule.has(s))continue;r.visitedRule.add(s);const n=s.repository?o.mergeObjects({},e.repository,s.repository):e.repository;Array.isArray(s.patterns)&&_(s.patterns,{...e,repository:n},r);const i=s.include;if(!i)continue;const a=b(i);switch(a.kind){case 0:I({...e,selfGrammar:e.baseGrammar},r);break;case 1:I(e,r);break;case 2:f(a.ruleName,{...e,repository:n},r);break;case 3:case 4:const y=a.scopeName===e.selfGrammar.scopeName?e.selfGrammar:a.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(y){const R={baseGrammar:e.baseGrammar,selfGrammar:y,repository:n};a.kind===4?f(a.ruleName,R,r):I(R,r)}else a.kind===4?r.add(new p(a.scopeName,a.ruleName)):r.add(new g(a.scopeName))}}}t.ExternalReferenceCollector=m,t.ScopeDependencyProcessor=class{constructor(l,e){this.repo=l,this.initialScopeName=e,this.seenFullScopeRequests=new Set,this.seenPartialScopeRequests=new Set,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new g(this.initialScopeName)]}processQueue(){const l=this.Q;this.Q=[];const e=new m;for(const r of l)c(r,this.initialScopeName,this.repo,e);for(const r of e.references)if(r instanceof g){if(this.seenFullScopeRequests.has(r.scopeName))continue;this.seenFullScopeRequests.add(r.scopeName),this.Q.push(r)}else{if(this.seenFullScopeRequests.has(r.scopeName)||this.seenPartialScopeRequests.has(r.toKey()))continue;this.seenPartialScopeRequests.add(r.toKey()),this.Q.push(r)}}};class w{constructor(){this.kind=0}}t.BaseReference=w;class L{constructor(){this.kind=1}}t.SelfReference=L;class C{constructor(e){this.ruleName=e,this.kind=2}}t.RelativeReference=C;class d{constructor(e){this.scopeName=e,this.kind=3}}t.TopLevelReference=d;class S{constructor(e,r){this.scopeName=e,this.ruleName=r,this.kind=4}}function b(l){if(l==="$base")return new w;if(l==="$self")return new L;const e=l.indexOf("#");if(e===-1)return new d(l);if(e===0)return new C(l.substring(1));{const r=l.substring(0,e),s=l.substring(e+1);return new S(r,s)}}t.TopLevelRepositoryReference=S,t.parseInclude=b},391:function(T,t,u){var o=this&&this.__createBinding||(Object.create?function(p,m,c,f){f===void 0&&(f=c),Object.defineProperty(p,f,{enumerable:!0,get:function(){return m[c]}})}:function(p,m,c,f){f===void 0&&(f=c),p[f]=m[c]}),g=this&&this.__exportStar||function(p,m){for(var c in p)c==="default"||Object.prototype.hasOwnProperty.call(m,c)||o(m,p,c)};Object.defineProperty(t,"__esModule",{value:!0}),g(u(947),t)},47:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStackElement=t._tokenizeString=void 0;const o=u(350),g=u(44),p=u(792),m=u(878);class c{constructor(S,b){this.stack=S,this.stoppedEarly=b}}function f(d,S,b,l,e,r,s,n){const i=S.content.length;let a=!1,y=-1;if(s){const x=function(E,$,j,O,z,V){let W=z.beginRuleCapturedEOL?0:-1;const D=[];for(let G=z;G;G=G.pop()){const B=G.getRule(E);B instanceof p.BeginWhileRule&&D.push({rule:B,stack:G})}for(let G=D.pop();G;G=D.pop()){const{ruleScanner:B,findOptions:X}=_(G.rule,E,G.stack.endRule,j,O===W),P=B.findNextMatchSync($,O,X);if(o.DebugFlags.InDebugMode&&(console.log("  scanning for while rule"),console.log(B.toString())),!P){o.DebugFlags.InDebugMode&&console.log("  popping "+G.rule.debugName+" - "+G.rule.debugWhileRegExp),z=G.stack.pop();break}if(P.ruleId!==p.whileRuleId){z=G.stack.pop();break}P.captureIndices&&P.captureIndices.length&&(V.produce(G.stack,P.captureIndices[0].start),L(E,$,j,G.stack,V,G.rule.whileCaptures,P.captureIndices),V.produce(G.stack,P.captureIndices[0].end),W=P.captureIndices[0].end,P.captureIndices[0].end>O&&(O=P.captureIndices[0].end,j=!1))}return{stack:z,linePos:O,anchorPosition:W,isFirstLine:j}}(d,S,b,l,e,r);e=x.stack,l=x.linePos,b=x.isFirstLine,y=x.anchorPosition}const R=Date.now();for(;!a;){if(n!==0&&Date.now()-R>n)return new c(e,!0);A()}return new c(e,!1);function A(){o.DebugFlags.InDebugMode&&(console.log(""),console.log(`@@scanNext ${l}: |${S.content.substr(l).replace(/\n$/,"\\n")}|`));const x=function(O,z,V,W,D,G){const B=function(K,te,ke,ne,Y,ce){const re=Y.getRule(K),{ruleScanner:se,findOptions:ie}=I(re,K,Y.endRule,ke,ne===ce);let Z=0;o.DebugFlags.InDebugMode&&(Z=m.performanceNow());const H=se.findNextMatchSync(te,ne,ie);if(o.DebugFlags.InDebugMode){const ue=m.performanceNow()-Z;ue>5&&console.warn(`Rule ${re.debugName} (${re.id}) matching took ${ue} against '${te}'`),console.log(`  scanning for (linePos: ${ne}, anchorPosition: ${ce})`),console.log(se.toString()),H&&console.log(`matched rule id: ${H.ruleId} from ${H.captureIndices[0].start} to ${H.captureIndices[0].end}`)}return H?{captureIndices:H.captureIndices,matchedRuleId:H.ruleId}:null}(O,z,V,W,D,G),X=O.getInjections();if(X.length===0)return B;const P=function(K,te,ke,ne,Y,ce,re){let se,ie=Number.MAX_VALUE,Z=null,H=0;const ue=ce.contentNameScopesList.getScopeNames();for(let ye=0,Ke=K.length;ye<Ke;ye++){const le=K[ye];if(!le.matcher(ue))continue;const Qe=te.getRule(le.ruleId),{ruleScanner:Le,findOptions:Je}=I(Qe,te,null,ne,Y===re),he=Le.findNextMatchSync(ke,Y,Je);if(!he)continue;o.DebugFlags.InDebugMode&&(console.log(`  matched injection: ${le.debugSelector}`),console.log(Le.toString()));const Pe=he.captureIndices[0].start;if(!(Pe>=ie)&&(ie=Pe,Z=he.captureIndices,se=he.ruleId,H=le.priority,ie===Y))break}return Z?{priorityMatch:H===-1,captureIndices:Z,matchedRuleId:se}:null}(X,O,z,V,W,D,G);if(!P)return B;if(!B)return P;const U=B.captureIndices[0].start,F=P.captureIndices[0].start;return F<U||P.priorityMatch&&F===U?P:B}(d,S,b,l,e,y);if(!x)return o.DebugFlags.InDebugMode&&console.log("  no more matches."),r.produce(e,i),void(a=!0);const E=x.captureIndices,$=x.matchedRuleId,j=!!(E&&E.length>0)&&E[0].end>l;if($===p.endRuleId){const O=e.getRule(d);o.DebugFlags.InDebugMode&&console.log("  popping "+O.debugName+" - "+O.debugEndRegExp),r.produce(e,E[0].start),e=e.withContentNameScopesList(e.nameScopesList),L(d,S,b,e,r,O.endCaptures,E),r.produce(e,E[0].end);const z=e;if(e=e.parent,y=z.getAnchorPos(),!j&&z.getEnterPos()===l)return o.DebugFlags.InDebugMode&&console.error("[1] - Grammar is in an endless loop - Grammar pushed & popped a rule without advancing"),e=z,r.produce(e,i),void(a=!0)}else{const O=d.getRule($);r.produce(e,E[0].start);const z=e,V=O.getName(S.content,E),W=e.contentNameScopesList.pushAttributed(V,d);if(e=e.push($,l,y,E[0].end===i,null,W,W),O instanceof p.BeginEndRule){const D=O;o.DebugFlags.InDebugMode&&console.log("  pushing "+D.debugName+" - "+D.debugBeginRegExp),L(d,S,b,e,r,D.beginCaptures,E),r.produce(e,E[0].end),y=E[0].end;const G=D.getContentName(S.content,E),B=W.pushAttributed(G,d);if(e=e.withContentNameScopesList(B),D.endHasBackReferences&&(e=e.withEndRule(D.getEndWithResolvedBackReferences(S.content,E))),!j&&z.hasSameRuleAs(e))return o.DebugFlags.InDebugMode&&console.error("[2] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),e=e.pop(),r.produce(e,i),void(a=!0)}else if(O instanceof p.BeginWhileRule){const D=O;o.DebugFlags.InDebugMode&&console.log("  pushing "+D.debugName),L(d,S,b,e,r,D.beginCaptures,E),r.produce(e,E[0].end),y=E[0].end;const G=D.getContentName(S.content,E),B=W.pushAttributed(G,d);if(e=e.withContentNameScopesList(B),D.whileHasBackReferences&&(e=e.withEndRule(D.getWhileWithResolvedBackReferences(S.content,E))),!j&&z.hasSameRuleAs(e))return o.DebugFlags.InDebugMode&&console.error("[3] - Grammar is in an endless loop - Grammar pushed the same rule without advancing"),e=e.pop(),r.produce(e,i),void(a=!0)}else{const D=O;if(o.DebugFlags.InDebugMode&&console.log("  matched "+D.debugName+" - "+D.debugMatchRegExp),L(d,S,b,e,r,D.captures,E),r.produce(e,E[0].end),e=e.pop(),!j)return o.DebugFlags.InDebugMode&&console.error("[4] - Grammar is in an endless loop - Grammar is not advancing, nor is it pushing/popping"),e=e.safePop(),r.produce(e,i),void(a=!0)}}E[0].end>l&&(l=E[0].end,b=!1)}}function I(d,S,b,l,e){return o.UseOnigurumaFindOptions?{ruleScanner:d.compile(S,b),findOptions:w(l,e)}:{ruleScanner:d.compileAG(S,b,l,e),findOptions:0}}function _(d,S,b,l,e){return o.UseOnigurumaFindOptions?{ruleScanner:d.compileWhile(S,b),findOptions:w(l,e)}:{ruleScanner:d.compileWhileAG(S,b,l,e),findOptions:0}}function w(d,S){let b=0;return d||(b|=1),S||(b|=4),b}function L(d,S,b,l,e,r,s){if(r.length===0)return;const n=S.content,i=Math.min(r.length,s.length),a=[],y=s[0].end;for(let R=0;R<i;R++){const A=r[R];if(A===null)continue;const x=s[R];if(x.length===0)continue;if(x.start>y)break;for(;a.length>0&&a[a.length-1].endPos<=x.start;)e.produceFromScopes(a[a.length-1].scopes,a[a.length-1].endPos),a.pop();if(a.length>0?e.produceFromScopes(a[a.length-1].scopes,x.start):e.produce(l,x.start),A.retokenizeCapturedWithRuleId){const $=A.getName(n,s),j=l.contentNameScopesList.pushAttributed($,d),O=A.getContentName(n,s),z=j.pushAttributed(O,d),V=l.push(A.retokenizeCapturedWithRuleId,x.start,-1,!1,null,j,z),W=d.createOnigString(n.substring(0,x.end));f(d,W,b&&x.start===0,x.start,V,e,!1,0),g.disposeOnigString(W);continue}const E=A.getName(n,s);if(E!==null){const $=(a.length>0?a[a.length-1].scopes:l.contentNameScopesList).pushAttributed(E,d);a.push(new C($,x.end))}}for(;a.length>0;)e.produceFromScopes(a[a.length-1].scopes,a[a.length-1].endPos),a.pop()}t._tokenizeString=f;class C{constructor(S,b){this.scopes=S,this.endPos=b}}t.LocalStackElement=C},974:(T,t)=>{function u(m,c){throw new Error("Near offset "+m.pos+": "+c+" ~~~"+m.source.substr(m.pos,50)+"~~~")}Object.defineProperty(t,"__esModule",{value:!0}),t.parseJSON=void 0,t.parseJSON=function(m,c,f){let I=new o(m),_=new g,w=0,L=null,C=[],d=[];function S(){C.push(w),d.push(L)}function b(){w=C.pop(),L=d.pop()}function l(e){u(I,e)}for(;p(I,_);){if(w===0){if(L!==null&&l("too many constructs in root"),_.type===3){L={},f&&(L.$vscodeTextmateLocation=_.toLocation(c)),S(),w=1;continue}if(_.type===2){L=[],S(),w=4;continue}l("unexpected token in root")}if(w===2){if(_.type===5){b();continue}if(_.type===7){w=3;continue}l("expected , or }")}if(w===1||w===3){if(w===1&&_.type===5){b();continue}if(_.type===1){let e=_.value;if(p(I,_)&&_.type===6||l("expected colon"),p(I,_)||l("expected value"),w=2,_.type===1){L[e]=_.value;continue}if(_.type===8){L[e]=null;continue}if(_.type===9){L[e]=!0;continue}if(_.type===10){L[e]=!1;continue}if(_.type===11){L[e]=parseFloat(_.value);continue}if(_.type===2){let r=[];L[e]=r,S(),w=4,L=r;continue}if(_.type===3){let r={};f&&(r.$vscodeTextmateLocation=_.toLocation(c)),L[e]=r,S(),w=1,L=r;continue}}l("unexpected token in dict")}if(w===5){if(_.type===4){b();continue}if(_.type===7){w=6;continue}l("expected , or ]")}if(w===4||w===6){if(w===4&&_.type===4){b();continue}if(w=5,_.type===1){L.push(_.value);continue}if(_.type===8){L.push(null);continue}if(_.type===9){L.push(!0);continue}if(_.type===10){L.push(!1);continue}if(_.type===11){L.push(parseFloat(_.value));continue}if(_.type===2){let e=[];L.push(e),S(),w=4,L=e;continue}if(_.type===3){let e={};f&&(e.$vscodeTextmateLocation=_.toLocation(c)),L.push(e),S(),w=1,L=e;continue}l("unexpected token in array")}l("unknown state")}return d.length!==0&&l("unclosed constructs"),L};class o{constructor(c){this.source=c,this.pos=0,this.len=c.length,this.line=1,this.char=0}}class g{constructor(){this.value=null,this.type=0,this.offset=-1,this.len=-1,this.line=-1,this.char=-1}toLocation(c){return{filename:c,line:this.line,char:this.char}}}function p(m,c){c.value=null,c.type=0,c.offset=-1,c.len=-1,c.line=-1,c.char=-1;let f,I=m.source,_=m.pos,w=m.len,L=m.line,C=m.char;for(;;){if(_>=w)return!1;if(f=I.charCodeAt(_),f!==32&&f!==9&&f!==13){if(f!==10)break;_++,L++,C=0}else _++,C++}if(c.offset=_,c.line=L,c.char=C,f===34){for(c.type=1,_++,C++;;){if(_>=w)return!1;if(f=I.charCodeAt(_),_++,C++,f!==92){if(f===34)break}else _++,C++}c.value=I.substring(c.offset+1,_-1).replace(/\\u([0-9A-Fa-f]{4})/g,(d,S)=>String.fromCodePoint(parseInt(S,16))).replace(/\\(.)/g,(d,S)=>{switch(S){case'"':return'"';case"\\":return"\\";case"/":return"/";case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";default:u(m,"invalid escape sequence")}throw new Error("unreachable")})}else if(f===91)c.type=2,_++,C++;else if(f===123)c.type=3,_++,C++;else if(f===93)c.type=4,_++,C++;else if(f===125)c.type=5,_++,C++;else if(f===58)c.type=6,_++,C++;else if(f===44)c.type=7,_++,C++;else if(f===110){if(c.type=8,_++,C++,f=I.charCodeAt(_),f!==117||(_++,C++,f=I.charCodeAt(_),f!==108)||(_++,C++,f=I.charCodeAt(_),f!==108))return!1;_++,C++}else if(f===116){if(c.type=9,_++,C++,f=I.charCodeAt(_),f!==114||(_++,C++,f=I.charCodeAt(_),f!==117)||(_++,C++,f=I.charCodeAt(_),f!==101))return!1;_++,C++}else if(f===102){if(c.type=10,_++,C++,f=I.charCodeAt(_),f!==97||(_++,C++,f=I.charCodeAt(_),f!==108)||(_++,C++,f=I.charCodeAt(_),f!==115)||(_++,C++,f=I.charCodeAt(_),f!==101))return!1;_++,C++}else for(c.type=11;;){if(_>=w)return!1;if(f=I.charCodeAt(_),!(f===46||f>=48&&f<=57||f===101||f===69||f===45||f===43))break;_++,C++}return c.len=_-c.offset,c.value===null&&(c.value=I.substr(c.offset,c.len)),m.pos=_,m.line=L,m.char=C,!0}},787:function(T,t,u){var o=this&&this.__createBinding||(Object.create?function(w,L,C,d){d===void 0&&(d=C),Object.defineProperty(w,d,{enumerable:!0,get:function(){return L[C]}})}:function(w,L,C,d){d===void 0&&(d=C),w[d]=L[C]}),g=this&&this.__exportStar||function(w,L){for(var C in w)C==="default"||Object.prototype.hasOwnProperty.call(L,C)||o(L,w,C)};Object.defineProperty(t,"__esModule",{value:!0}),t.applyStateStackDiff=t.diffStateStacksRefEq=t.parseRawGrammar=t.INITIAL=t.Registry=void 0;const p=u(391),m=u(50),c=u(652),f=u(583),I=u(965),_=u(442);Object.defineProperty(t,"applyStateStackDiff",{enumerable:!0,get:function(){return _.applyStateStackDiff}}),Object.defineProperty(t,"diffStateStacksRefEq",{enumerable:!0,get:function(){return _.diffStateStacksRefEq}}),g(u(44),t),t.Registry=class{constructor(w){this._options=w,this._syncRegistry=new c.SyncRegistry(f.Theme.createFromRawTheme(w.theme,w.colorMap),w.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(w,L){this._syncRegistry.setTheme(f.Theme.createFromRawTheme(w,L))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(w,L,C){return this.loadGrammarWithConfiguration(w,L,{embeddedLanguages:C})}loadGrammarWithConfiguration(w,L,C){return this._loadGrammar(w,L,C.embeddedLanguages,C.tokenTypes,new p.BalancedBracketSelectors(C.balancedBracketSelectors||[],C.unbalancedBracketSelectors||[]))}loadGrammar(w){return this._loadGrammar(w,0,null,null,null)}async _loadGrammar(w,L,C,d,S){const b=new I.ScopeDependencyProcessor(this._syncRegistry,w);for(;b.Q.length>0;)await Promise.all(b.Q.map(l=>this._loadSingleGrammar(l.scopeName))),b.processQueue();return this._grammarForScopeName(w,L,C,d,S)}async _loadSingleGrammar(w){return this._ensureGrammarCache.has(w)||this._ensureGrammarCache.set(w,this._doLoadSingleGrammar(w)),this._ensureGrammarCache.get(w)}async _doLoadSingleGrammar(w){const L=await this._options.loadGrammar(w);if(L){const C=typeof this._options.getInjections=="function"?this._options.getInjections(w):void 0;this._syncRegistry.addGrammar(L,C)}}async addGrammar(w,L=[],C=0,d=null){return this._syncRegistry.addGrammar(w,L),await this._grammarForScopeName(w.scopeName,C,d)}_grammarForScopeName(w,L=0,C=null,d=null,S=null){return this._syncRegistry.grammarForScopeName(w,L,C,d,S)}},t.INITIAL=p.StateStackImpl.NULL,t.parseRawGrammar=m.parseRawGrammar},736:(T,t)=>{function u(o){return!!o&&!!o.match(/[\w\.:]+/)}Object.defineProperty(t,"__esModule",{value:!0}),t.createMatchers=void 0,t.createMatchers=function(o,g){const p=[],m=function(_){let w=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,L=w.exec(_);return{next:()=>{if(!L)return null;const C=L[0];return L=w.exec(_),C}}}(o);let c=m.next();for(;c!==null;){let _=0;if(c.length===2&&c.charAt(1)===":"){switch(c.charAt(0)){case"R":_=1;break;case"L":_=-1;break;default:console.log(`Unknown priority ${c} in scope selector`)}c=m.next()}let w=I();if(p.push({matcher:w,priority:_}),c!==",")break;c=m.next()}return p;function f(){if(c==="-"){c=m.next();const _=f();return w=>!!_&&!_(w)}if(c==="("){c=m.next();const _=function(){const w=[];let L=I();for(;L&&(w.push(L),c==="|"||c===",");){do c=m.next();while(c==="|"||c===",");L=I()}return C=>w.some(d=>d(C))}();return c===")"&&(c=m.next()),_}if(u(c)){const _=[];do _.push(c),c=m.next();while(u(c));return w=>g(_,w)}return null}function I(){const _=[];let w=f();for(;w;)_.push(w),w=f();return L=>_.every(C=>C(L))}}},44:(T,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disposeOnigString=void 0,t.disposeOnigString=function(u){typeof u.dispose=="function"&&u.dispose()}},50:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseRawGrammar=void 0;const o=u(69),g=u(350),p=u(974);t.parseRawGrammar=function(m,c=null){return c!==null&&/\.json$/.test(c)?(f=m,I=c,g.DebugFlags.InDebugMode?p.parseJSON(f,I,!0):JSON.parse(f)):function(_,w){return g.DebugFlags.InDebugMode?o.parseWithLocation(_,w,"$vscodeTextmateLocation"):o.parsePLIST(_)}(m,c);var f,I}},69:(T,t)=>{function u(o,g,p){const m=o.length;let c=0,f=1,I=0;function _(P){if(p===null)c+=P;else for(;P>0;)o.charCodeAt(c)===10?(c++,f++,I=0):(c++,I++),P--}function w(P){p===null?c=P:_(P-c)}function L(){for(;c<m;){let P=o.charCodeAt(c);if(P!==32&&P!==9&&P!==13&&P!==10)break;_(1)}}function C(P){return o.substr(c,P.length)===P&&(_(P.length),!0)}function d(P){let U=o.indexOf(P,c);w(U!==-1?U+P.length:m)}function S(P){let U=o.indexOf(P,c);if(U!==-1){let F=o.substring(c,U);return w(U+P.length),F}{let F=o.substr(c);return w(m),F}}m>0&&o.charCodeAt(0)===65279&&(c=1);let b=0,l=null,e=[],r=[],s=null;function n(P,U){e.push(b),r.push(l),b=P,l=U}function i(){if(e.length===0)return a("illegal state stack");b=e.pop(),l=r.pop()}function a(P){throw new Error("Near offset "+c+": "+P+" ~~~"+o.substr(c,50)+"~~~")}const y=function(){if(s===null)return a("missing <key>");let P={};p!==null&&(P[p]={filename:g,line:f,char:I}),l[s]=P,s=null,n(1,P)},R=function(){if(s===null)return a("missing <key>");let P=[];l[s]=P,s=null,n(2,P)},A=function(){let P={};p!==null&&(P[p]={filename:g,line:f,char:I}),l.push(P),n(1,P)},x=function(){let P=[];l.push(P),n(2,P)};function E(){if(b!==1)return a("unexpected </dict>");i()}function $(){return b===1||b!==2?a("unexpected </array>"):void i()}function j(P){if(b===1){if(s===null)return a("missing <key>");l[s]=P,s=null}else b===2?l.push(P):l=P}function O(P){if(isNaN(P))return a("cannot parse float");if(b===1){if(s===null)return a("missing <key>");l[s]=P,s=null}else b===2?l.push(P):l=P}function z(P){if(isNaN(P))return a("cannot parse integer");if(b===1){if(s===null)return a("missing <key>");l[s]=P,s=null}else b===2?l.push(P):l=P}function V(P){if(b===1){if(s===null)return a("missing <key>");l[s]=P,s=null}else b===2?l.push(P):l=P}function W(P){if(b===1){if(s===null)return a("missing <key>");l[s]=P,s=null}else b===2?l.push(P):l=P}function D(P){if(b===1){if(s===null)return a("missing <key>");l[s]=P,s=null}else b===2?l.push(P):l=P}function G(){let P=S(">"),U=!1;return P.charCodeAt(P.length-1)===47&&(U=!0,P=P.substring(0,P.length-1)),{name:P.trim(),isClosed:U}}function B(P){if(P.isClosed)return"";let U=S("</");return d(">"),U.replace(/&#([0-9]+);/g,function(F,K){return String.fromCodePoint(parseInt(K,10))}).replace(/&#x([0-9a-f]+);/g,function(F,K){return String.fromCodePoint(parseInt(K,16))}).replace(/&amp;|&lt;|&gt;|&quot;|&apos;/g,function(F){switch(F){case"&amp;":return"&";case"&lt;":return"<";case"&gt;":return">";case"&quot;":return'"';case"&apos;":return"'"}return F})}for(;c<m&&(L(),!(c>=m));){const P=o.charCodeAt(c);if(_(1),P!==60)return a("expected <");if(c>=m)return a("unexpected end of input");const U=o.charCodeAt(c);if(U===63){_(1),d("?>");continue}if(U===33){if(_(1),C("--")){d("-->");continue}d(">");continue}if(U===47){if(_(1),L(),C("plist")){d(">");continue}if(C("dict")){d(">"),E();continue}if(C("array")){d(">"),$();continue}return a("unexpected closed tag")}let F=G();switch(F.name){case"dict":b===1?y():b===2?A():(l={},p!==null&&(l[p]={filename:g,line:f,char:I}),n(1,l)),F.isClosed&&E();continue;case"array":b===1?R():b===2?x():(l=[],n(2,l)),F.isClosed&&$();continue;case"key":X=B(F),b!==1?a("unexpected <key>"):s!==null?a("too many <key>"):s=X;continue;case"string":j(B(F));continue;case"real":O(parseFloat(B(F)));continue;case"integer":z(parseInt(B(F),10));continue;case"date":V(new Date(B(F)));continue;case"data":W(B(F));continue;case"true":B(F),D(!0);continue;case"false":B(F),D(!1);continue}if(!/^plist/.test(F.name))return a("unexpected opened tag "+F.name)}var X;return l}Object.defineProperty(t,"__esModule",{value:!0}),t.parsePLIST=t.parseWithLocation=void 0,t.parseWithLocation=function(o,g,p){return u(o,g,p)},t.parsePLIST=function(o){return u(o,null,null)}},652:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SyncRegistry=void 0;const o=u(391);t.SyncRegistry=class{constructor(g,p){this._onigLibPromise=p,this._grammars=new Map,this._rawGrammars=new Map,this._injectionGrammars=new Map,this._theme=g}dispose(){for(const g of this._grammars.values())g.dispose()}setTheme(g){this._theme=g}getColorMap(){return this._theme.getColorMap()}addGrammar(g,p){this._rawGrammars.set(g.scopeName,g),p&&this._injectionGrammars.set(g.scopeName,p)}lookup(g){return this._rawGrammars.get(g)}injections(g){return this._injectionGrammars.get(g)}getDefaults(){return this._theme.getDefaults()}themeMatch(g){return this._theme.match(g)}async grammarForScopeName(g,p,m,c,f){if(!this._grammars.has(g)){let I=this._rawGrammars.get(g);if(!I)return null;this._grammars.set(g,o.createGrammar(g,I,p,m,c,f,this,await this._onigLibPromise))}return this._grammars.get(g)}}},792:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CompiledRule=t.RegExpSourceList=t.RegExpSource=t.RuleFactory=t.BeginWhileRule=t.BeginEndRule=t.IncludeOnlyRule=t.MatchRule=t.CaptureRule=t.Rule=t.ruleIdToNumber=t.ruleIdFromNumber=t.whileRuleId=t.endRuleId=void 0;const o=u(878),g=u(965),p=/\\(\d+)/,m=/\\(\d+)/g;t.endRuleId=-1,t.whileRuleId=-2,t.ruleIdFromNumber=function(l){return l},t.ruleIdToNumber=function(l){return l};class c{constructor(e,r,s,n){this.$location=e,this.id=r,this._name=s||null,this._nameIsCapturing=o.RegexSource.hasCaptures(this._name),this._contentName=n||null,this._contentNameIsCapturing=o.RegexSource.hasCaptures(this._contentName)}get debugName(){const e=this.$location?`${o.basename(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${e}`}getName(e,r){return this._nameIsCapturing&&this._name!==null&&e!==null&&r!==null?o.RegexSource.replaceCaptures(this._name,e,r):this._name}getContentName(e,r){return this._contentNameIsCapturing&&this._contentName!==null?o.RegexSource.replaceCaptures(this._contentName,e,r):this._contentName}}t.Rule=c;class f extends c{constructor(e,r,s,n,i){super(e,r,s,n),this.retokenizeCapturedWithRuleId=i}dispose(){}collectPatterns(e,r){throw new Error("Not supported!")}compile(e,r){throw new Error("Not supported!")}compileAG(e,r,s,n){throw new Error("Not supported!")}}t.CaptureRule=f;class I extends c{constructor(e,r,s,n,i){super(e,r,s,null),this._match=new d(n,this.id),this.captures=i,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(e,r){r.push(this._match)}compile(e,r){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,r,s,n){return this._getCachedCompiledPatterns(e).compileAG(e,s,n)}_getCachedCompiledPatterns(e){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new S,this.collectPatterns(e,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}t.MatchRule=I;class _ extends c{constructor(e,r,s,n,i){super(e,r,s,n),this.patterns=i.patterns,this.hasMissingPatterns=i.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(e,r){for(const s of this.patterns)e.getRule(s).collectPatterns(e,r)}compile(e,r){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,r,s,n){return this._getCachedCompiledPatterns(e).compileAG(e,s,n)}_getCachedCompiledPatterns(e){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new S,this.collectPatterns(e,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}}t.IncludeOnlyRule=_;class w extends c{constructor(e,r,s,n,i,a,y,R,A,x){super(e,r,s,n),this._begin=new d(i,this.id),this.beginCaptures=a,this._end=new d(y||"￿",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=R,this.applyEndPatternLast=A||!1,this.patterns=x.patterns,this.hasMissingPatterns=x.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(e,r){return this._end.resolveBackReferences(e,r)}collectPatterns(e,r){r.push(this._begin)}compile(e,r){return this._getCachedCompiledPatterns(e,r).compile(e)}compileAG(e,r,s,n){return this._getCachedCompiledPatterns(e,r).compileAG(e,s,n)}_getCachedCompiledPatterns(e,r){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new S;for(const s of this.patterns)e.getRule(s).collectPatterns(e,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,r):this._cachedCompiledPatterns.setSource(0,r)),this._cachedCompiledPatterns}}t.BeginEndRule=w;class L extends c{constructor(e,r,s,n,i,a,y,R,A){super(e,r,s,n),this._begin=new d(i,this.id),this.beginCaptures=a,this.whileCaptures=R,this._while=new d(y,t.whileRuleId),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=A.patterns,this.hasMissingPatterns=A.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(e,r){return this._while.resolveBackReferences(e,r)}collectPatterns(e,r){r.push(this._begin)}compile(e,r){return this._getCachedCompiledPatterns(e).compile(e)}compileAG(e,r,s,n){return this._getCachedCompiledPatterns(e).compileAG(e,s,n)}_getCachedCompiledPatterns(e){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new S;for(const r of this.patterns)e.getRule(r).collectPatterns(e,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(e,r){return this._getCachedCompiledWhilePatterns(e,r).compile(e)}compileWhileAG(e,r,s,n){return this._getCachedCompiledWhilePatterns(e,r).compileAG(e,s,n)}_getCachedCompiledWhilePatterns(e,r){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new S,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,r||"￿"),this._cachedCompiledWhilePatterns}}t.BeginWhileRule=L;class C{static createCaptureRule(e,r,s,n,i){return e.registerRule(a=>new f(r,a,s,n,i))}static getCompiledRuleId(e,r,s){return e.id||r.registerRule(n=>{if(e.id=n,e.match)return new I(e.$vscodeTextmateLocation,e.id,e.name,e.match,C._compileCaptures(e.captures,r,s));if(e.begin===void 0){e.repository&&(s=o.mergeObjects({},s,e.repository));let i=e.patterns;return i===void 0&&e.include&&(i=[{include:e.include}]),new _(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,C._compilePatterns(i,r,s))}return e.while?new L(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,C._compileCaptures(e.beginCaptures||e.captures,r,s),e.while,C._compileCaptures(e.whileCaptures||e.captures,r,s),C._compilePatterns(e.patterns,r,s)):new w(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,C._compileCaptures(e.beginCaptures||e.captures,r,s),e.end,C._compileCaptures(e.endCaptures||e.captures,r,s),e.applyEndPatternLast,C._compilePatterns(e.patterns,r,s))}),e.id}static _compileCaptures(e,r,s){let n=[];if(e){let i=0;for(const a in e){if(a==="$vscodeTextmateLocation")continue;const y=parseInt(a,10);y>i&&(i=y)}for(let a=0;a<=i;a++)n[a]=null;for(const a in e){if(a==="$vscodeTextmateLocation")continue;const y=parseInt(a,10);let R=0;e[a].patterns&&(R=C.getCompiledRuleId(e[a],r,s)),n[y]=C.createCaptureRule(r,e[a].$vscodeTextmateLocation,e[a].name,e[a].contentName,R)}}return n}static _compilePatterns(e,r,s){let n=[];if(e)for(let i=0,a=e.length;i<a;i++){const y=e[i];let R=-1;if(y.include){const A=g.parseInclude(y.include);switch(A.kind){case 0:case 1:R=C.getCompiledRuleId(s[y.include],r,s);break;case 2:let x=s[A.ruleName];x&&(R=C.getCompiledRuleId(x,r,s));break;case 3:case 4:const E=A.scopeName,$=A.kind===4?A.ruleName:null,j=r.getExternalGrammar(E,s);if(j)if($){let O=j.repository[$];O&&(R=C.getCompiledRuleId(O,r,j.repository))}else R=C.getCompiledRuleId(j.repository.$self,r,j.repository)}}else R=C.getCompiledRuleId(y,r,s);if(R!==-1){const A=r.getRule(R);let x=!1;if((A instanceof _||A instanceof w||A instanceof L)&&A.hasMissingPatterns&&A.patterns.length===0&&(x=!0),x)continue;n.push(R)}}return{patterns:n,hasMissingPatterns:(e?e.length:0)!==n.length}}}t.RuleFactory=C;class d{constructor(e,r){if(e){const s=e.length;let n=0,i=[],a=!1;for(let y=0;y<s;y++)if(e.charAt(y)==="\\"&&y+1<s){const R=e.charAt(y+1);R==="z"?(i.push(e.substring(n,y)),i.push("$(?!\\n)(?<!\\n)"),n=y+2):R!=="A"&&R!=="G"||(a=!0),y++}this.hasAnchor=a,n===0?this.source=e:(i.push(e.substring(n,s)),this.source=i.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=r,this.hasBackReferences=p.test(this.source)}clone(){return new d(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,r){let s=r.map(n=>e.substring(n.start,n.end));return m.lastIndex=0,this.source.replace(m,(n,i)=>o.escapeRegExpCharacters(s[parseInt(i,10)]||""))}_buildAnchorCache(){let e,r,s,n,i=[],a=[],y=[],R=[];for(e=0,r=this.source.length;e<r;e++)s=this.source.charAt(e),i[e]=s,a[e]=s,y[e]=s,R[e]=s,s==="\\"&&e+1<r&&(n=this.source.charAt(e+1),n==="A"?(i[e+1]="￿",a[e+1]="￿",y[e+1]="A",R[e+1]="A"):n==="G"?(i[e+1]="￿",a[e+1]="G",y[e+1]="￿",R[e+1]="G"):(i[e+1]=n,a[e+1]=n,y[e+1]=n,R[e+1]=n),e++);return{A0_G0:i.join(""),A0_G1:a.join(""),A1_G0:y.join(""),A1_G1:R.join("")}}resolveAnchors(e,r){return this.hasAnchor&&this._anchorCache?e?r?this._anchorCache.A1_G1:this._anchorCache.A1_G0:r?this._anchorCache.A0_G1:this._anchorCache.A0_G0:this.source}}t.RegExpSource=d;class S{constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(e){this._items.push(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}unshift(e){this._items.unshift(e),this._hasAnchors=this._hasAnchors||e.hasAnchor}length(){return this._items.length}setSource(e,r){this._items[e].source!==r&&(this._disposeCaches(),this._items[e].setSource(r))}compile(e){if(!this._cached){let r=this._items.map(s=>s.source);this._cached=new b(e,r,this._items.map(s=>s.ruleId))}return this._cached}compileAG(e,r,s){return this._hasAnchors?r?s?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(e,r,s)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(e,r,s)),this._anchorCache.A1_G0):s?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(e,r,s)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(e,r,s)),this._anchorCache.A0_G0):this.compile(e)}_resolveAnchors(e,r,s){let n=this._items.map(i=>i.resolveAnchors(r,s));return new b(e,n,this._items.map(i=>i.ruleId))}}t.RegExpSourceList=S;class b{constructor(e,r,s){this.regExps=r,this.rules=s,this.scanner=e.createOnigScanner(r)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const e=[];for(let r=0,s=this.rules.length;r<s;r++)e.push("   - "+this.rules[r]+": "+this.regExps[r]);return e.join(`
`)}findNextMatchSync(e,r,s){const n=this.scanner.findNextMatchSync(e,r,s);return n?{ruleId:this.rules[n.index],captureIndices:n.captureIndices}:null}}t.CompiledRule=b},583:(T,t,u)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeTrieElement=t.ThemeTrieElementRule=t.ColorMap=t.fontStyleToString=t.ParsedThemeRule=t.parseTheme=t.StyleAttributes=t.ScopeStack=t.Theme=void 0;const o=u(878);class g{constructor(d,S,b){this._colorMap=d,this._defaults=S,this._root=b,this._cachedMatchRoot=new o.CachedFn(l=>this._root.match(l))}static createFromRawTheme(d,S){return this.createFromParsedTheme(f(d),S)}static createFromParsedTheme(d,S){return function(b,l){b.sort((y,R)=>{let A=o.strcmp(y.scope,R.scope);return A!==0?A:(A=o.strArrCmp(y.parentScopes,R.parentScopes),A!==0?A:y.index-R.index)});let e=0,r="#000000",s="#ffffff";for(;b.length>=1&&b[0].scope==="";){let y=b.shift();y.fontStyle!==-1&&(e=y.fontStyle),y.foreground!==null&&(r=y.foreground),y.background!==null&&(s=y.background)}let n=new _(l),i=new c(e,n.getId(r),n.getId(s)),a=new L(new w(0,null,-1,0,0),[]);for(let y=0,R=b.length;y<R;y++){let A=b[y];a.insert(0,A.scope,A.parentScopes,A.fontStyle,n.getId(A.foreground),n.getId(A.background))}return new g(n,i,a)}(d,S)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(d){if(d===null)return this._defaults;const S=d.scopeName,b=this._cachedMatchRoot.get(S).find(l=>function(e,r){if(r===null)return!0;let s=0,n=r[s];for(;e;){if(m(e.scopeName,n)){if(s++,s===r.length)return!0;n=r[s]}e=e.parent}return!1}(d.parent,l.parentScopes));return b?new c(b.fontStyle,b.foreground,b.background):null}}t.Theme=g;class p{constructor(d,S){this.parent=d,this.scopeName=S}static push(d,S){for(const b of S)d=new p(d,b);return d}static from(...d){let S=null;for(let b=0;b<d.length;b++)S=new p(S,d[b]);return S}push(d){return new p(this,d)}getSegments(){let d=this;const S=[];for(;d;)S.push(d.scopeName),d=d.parent;return S.reverse(),S}toString(){return this.getSegments().join(" ")}extends(d){return this===d||this.parent!==null&&this.parent.extends(d)}getExtensionIfDefined(d){const S=[];let b=this;for(;b&&b!==d;)S.push(b.scopeName),b=b.parent;return b===d?S.reverse():void 0}}function m(C,d){return d===C||C.startsWith(d)&&C[d.length]==="."}t.ScopeStack=p;class c{constructor(d,S,b){this.fontStyle=d,this.foregroundId=S,this.backgroundId=b}}function f(C){if(!C)return[];if(!C.settings||!Array.isArray(C.settings))return[];let d=C.settings,S=[],b=0;for(let l=0,e=d.length;l<e;l++){let r,s=d[l];if(!s.settings)continue;if(typeof s.scope=="string"){let y=s.scope;y=y.replace(/^[,]+/,""),y=y.replace(/[,]+$/,""),r=y.split(",")}else r=Array.isArray(s.scope)?s.scope:[""];let n=-1;if(typeof s.settings.fontStyle=="string"){n=0;let y=s.settings.fontStyle.split(" ");for(let R=0,A=y.length;R<A;R++)switch(y[R]){case"italic":n|=1;break;case"bold":n|=2;break;case"underline":n|=4;break;case"strikethrough":n|=8}}let i=null;typeof s.settings.foreground=="string"&&o.isValidHexColor(s.settings.foreground)&&(i=s.settings.foreground);let a=null;typeof s.settings.background=="string"&&o.isValidHexColor(s.settings.background)&&(a=s.settings.background);for(let y=0,R=r.length;y<R;y++){let A=r[y].trim().split(" "),x=A[A.length-1],E=null;A.length>1&&(E=A.slice(0,A.length-1),E.reverse()),S[b++]=new I(x,E,l,n,i,a)}}return S}t.StyleAttributes=c,t.parseTheme=f;class I{constructor(d,S,b,l,e,r){this.scope=d,this.parentScopes=S,this.index=b,this.fontStyle=l,this.foreground=e,this.background=r}}t.ParsedThemeRule=I,t.fontStyleToString=function(C){if(C===-1)return"not set";let d="";return 1&C&&(d+="italic "),2&C&&(d+="bold "),4&C&&(d+="underline "),8&C&&(d+="strikethrough "),d===""&&(d="none"),d.trim()};class _{constructor(d){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(d)){this._isFrozen=!0;for(let S=0,b=d.length;S<b;S++)this._color2id[d[S]]=S,this._id2color[S]=d[S]}else this._isFrozen=!1}getId(d){if(d===null)return 0;d=d.toUpperCase();let S=this._color2id[d];if(S)return S;if(this._isFrozen)throw new Error(`Missing color in color map - ${d}`);return S=++this._lastColorId,this._color2id[d]=S,this._id2color[S]=d,S}getColorMap(){return this._id2color.slice(0)}}t.ColorMap=_;class w{constructor(d,S,b,l,e){this.scopeDepth=d,this.parentScopes=S,this.fontStyle=b,this.foreground=l,this.background=e}clone(){return new w(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(d){let S=[];for(let b=0,l=d.length;b<l;b++)S[b]=d[b].clone();return S}acceptOverwrite(d,S,b,l){this.scopeDepth>d?console.log("how did this happen?"):this.scopeDepth=d,S!==-1&&(this.fontStyle=S),b!==0&&(this.foreground=b),l!==0&&(this.background=l)}}t.ThemeTrieElementRule=w;class L{constructor(d,S=[],b={}){this._mainRule=d,this._children=b,this._rulesWithParentScopes=S}static _sortBySpecificity(d){return d.length===1||d.sort(this._cmpBySpecificity),d}static _cmpBySpecificity(d,S){if(d.scopeDepth===S.scopeDepth){const b=d.parentScopes,l=S.parentScopes;let e=b===null?0:b.length,r=l===null?0:l.length;if(e===r)for(let s=0;s<e;s++){const n=b[s].length,i=l[s].length;if(n!==i)return i-n}return r-e}return S.scopeDepth-d.scopeDepth}match(d){if(d==="")return L._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes));let S,b,l=d.indexOf(".");return l===-1?(S=d,b=""):(S=d.substring(0,l),b=d.substring(l+1)),this._children.hasOwnProperty(S)?this._children[S].match(b):L._sortBySpecificity([].concat(this._mainRule).concat(this._rulesWithParentScopes))}insert(d,S,b,l,e,r){if(S==="")return void this._doInsertHere(d,b,l,e,r);let s,n,i,a=S.indexOf(".");a===-1?(s=S,n=""):(s=S.substring(0,a),n=S.substring(a+1)),this._children.hasOwnProperty(s)?i=this._children[s]:(i=new L(this._mainRule.clone(),w.cloneArr(this._rulesWithParentScopes)),this._children[s]=i),i.insert(d+1,n,b,l,e,r)}_doInsertHere(d,S,b,l,e){if(S!==null){for(let r=0,s=this._rulesWithParentScopes.length;r<s;r++){let n=this._rulesWithParentScopes[r];if(o.strArrCmp(n.parentScopes,S)===0)return void n.acceptOverwrite(d,b,l,e)}b===-1&&(b=this._mainRule.fontStyle),l===0&&(l=this._mainRule.foreground),e===0&&(e=this._mainRule.background),this._rulesWithParentScopes.push(new w(d,S,b,l,e))}else this._mainRule.acceptOverwrite(d,b,l,e)}}t.ThemeTrieElement=L},878:(T,t)=>{function u(p){return Array.isArray(p)?function(m){let c=[];for(let f=0,I=m.length;f<I;f++)c[f]=u(m[f]);return c}(p):typeof p=="object"?function(m){let c={};for(let f in m)c[f]=u(m[f]);return c}(p):p}Object.defineProperty(t,"__esModule",{value:!0}),t.performanceNow=t.CachedFn=t.escapeRegExpCharacters=t.isValidHexColor=t.strArrCmp=t.strcmp=t.RegexSource=t.basename=t.mergeObjects=t.clone=void 0,t.clone=function(p){return u(p)},t.mergeObjects=function(p,...m){return m.forEach(c=>{for(let f in c)p[f]=c[f]}),p},t.basename=function p(m){const c=~m.lastIndexOf("/")||~m.lastIndexOf("\\");return c===0?m:~c==m.length-1?p(m.substring(0,m.length-1)):m.substr(1+~c)};let o=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g;function g(p,m){return p<m?-1:p>m?1:0}t.RegexSource=class{static hasCaptures(p){return p!==null&&(o.lastIndex=0,o.test(p))}static replaceCaptures(p,m,c){return p.replace(o,(f,I,_,w)=>{let L=c[parseInt(I||_,10)];if(!L)return f;{let C=m.substring(L.start,L.end);for(;C[0]===".";)C=C.substring(1);switch(w){case"downcase":return C.toLowerCase();case"upcase":return C.toUpperCase();default:return C}}})}},t.strcmp=g,t.strArrCmp=function(p,m){if(p===null&&m===null)return 0;if(!p)return-1;if(!m)return 1;let c=p.length,f=m.length;if(c===f){for(let I=0;I<c;I++){let _=g(p[I],m[I]);if(_!==0)return _}return 0}return c-f},t.isValidHexColor=function(p){return!!(/^#[0-9a-f]{6}$/i.test(p)||/^#[0-9a-f]{8}$/i.test(p)||/^#[0-9a-f]{3}$/i.test(p)||/^#[0-9a-f]{4}$/i.test(p))},t.escapeRegExpCharacters=function(p){return p.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")},t.CachedFn=class{constructor(p){this.fn=p,this.cache=new Map}get(p){if(this.cache.has(p))return this.cache.get(p);const m=this.fn(p);return this.cache.set(p,m),m}},t.performanceNow=typeof performance>"u"?function(){return Date.now()}:function(){return performance.now()}}},v={};return function T(t){var u=v[t];if(u!==void 0)return u.exports;var o=v[t]={exports:{}};return k[t].call(o.exports,o,o.exports,T),o.exports}(787)})()})})(He);var _e=He.exports;const qt=rt(_e),Vt=Ft({__proto__:null,default:qt},[_e]);class Ht extends ae{constructor(h,k,v,T,t,u,o){super(),this._model=h,this._worker=k,this._languageIdCodec=v,this._backgroundTokenizationStore=T,this._initialState=t,this._configurationService=u,this._maxTokenizationLineLength=o,this._pendingChanges=[],this._states=new st,this._loggingEnabled=Kt("editor.experimental.asyncTokenizationLogging",!1,this._configurationService),this._register(De(this._loggingEnabled)),this._register(this._model.onDidChangeContent(m=>{this.shouldLog&&console.log("model change",{fileName:this._model.uri.fsPath.split("\\").pop(),changes:be(m.changes)}),this._worker.acceptModelChanged(this._model.uri.toString(),m),this._pendingChanges.push(m)})),this._register(this._model.onDidChangeLanguage(m=>{const c=this._model.getLanguageId(),f=this._languageIdCodec.encodeLanguageId(c);this._worker.acceptModelLanguageChanged(this._model.uri.toString(),c,f)}));const g=this._model.getLanguageId(),p=this._languageIdCodec.encodeLanguageId(g);this._worker.acceptNewModel({uri:this._model.uri,versionId:this._model.getVersionId(),lines:this._model.getLinesContent(),EOL:this._model.getEOL(),languageId:g,encodedLanguageId:p,maxTokenizationLineLength:this._maxTokenizationLineLength.get()}),this._register(it("update maxTokenizationLineLength",m=>{const c=this._maxTokenizationLineLength.read(m);this._worker.acceptMaxTokenizationLineLength(this._model.uri.toString(),c)}))}get shouldLog(){return this._loggingEnabled.get()}dispose(){super.dispose(),this._worker.acceptRemovedModel(this._model.uri.toString())}setTokensAndStates(h,k,v){let T=Ae.deserialize(new Uint8Array(k));if(this.shouldLog&&console.log("received background tokenization result",{fileName:this._model.uri.fsPath.split("\\").pop(),updatedTokenLines:T.map(u=>u.getLineRange()).join(" & "),updatedStateLines:v.map(u=>new ot(u.startLineNumber,u.startLineNumber+u.stateDeltas.length).toString()).join(" & ")}),this.shouldLog){const u=this._pendingChanges.filter(o=>o.versionId<=h).map(o=>o.changes).map(o=>be(o)).join(" then ");console.log("Applying changes to local states",u)}for(;this._pendingChanges.length>0&&this._pendingChanges[0].versionId<=h;){const u=this._pendingChanges.shift();this._states.acceptChanges(u.changes)}if(this._pendingChanges.length>0){if(this.shouldLog){const g=this._pendingChanges.map(p=>p.changes).map(p=>be(p)).join(" then ");console.log("Considering non-processed changes",g)}const u=ge.fromMany(this._pendingChanges.map(g=>Oe(g.changes))),o=new Ae;for(const g of T)for(let p=g.startLineNumber;p<=g.endLineNumber;p++)u.transform(p-1)!==void 0&&o.add(p,g.getLineTokens(p));T=o.finalize();for(const g of this._pendingChanges)for(const p of g.changes)for(let m=0;m<T.length;m++)T[m].applyEdit(p.range,p.text)}const t=ge.fromMany(this._pendingChanges.map(u=>Oe(u.changes)));for(const u of v){let o=u.startLineNumber<=1?this._initialState:this._states.getEndState(u.startLineNumber-1);for(let g=0;g<u.stateDeltas.length;g++){const p=u.stateDeltas[g];let m;p?(m=_e.applyStateStackDiff(o,p),this._states.setEndState(u.startLineNumber+g,m)):m=this._states.getEndState(u.startLineNumber+g);const c=t.transform(u.startLineNumber+g-1);c!==void 0&&this._backgroundTokenizationStore.setEndState(c+1,m),u.startLineNumber+g>=this._model.getLineCount()-1&&this._backgroundTokenizationStore.backgroundTokenizationFinished(),o=m}}this._backgroundTokenizationStore.setTokens(T)}}function Oe(M){return new zt(M.map(h=>new Wt(h.range.startLineNumber-1,h.range.endLineNumber-h.range.startLineNumber+1,at(h.text)[0]+1)))}function be(M){return M.map(h=>ct.lift(h.range).toString()+" => "+h.text).join(" & ")}function Kt(M,h,k){return je(v=>k.onDidChangeConfiguration(T=>{T.affectsConfiguration(M)&&v(T)}),()=>k.getValue(M)??h)}let me=class Ce{constructor(h,k,v,T,t,u,o,g){this._extensionResourceLoaderService=h,this._modelService=k,this._languageConfigurationService=v,this._configurationService=T,this._languageService=t,this._environmentService=u,this._notificationService=o,this._telemetryService=g,this._workerProxyPromise=null,this._worker=null,this._workerProxy=null,this._workerTokenizerControllers=new Map,this._currentTheme=null,this._currentTokenColorMap=null,this._grammarDefinitions=[]}setGrammarDefinitions(h){this._grammarDefinitions=h,this._killWorker()}dispose(){this._killWorker()}acceptTheme(h,k){this._currentTheme=h,this._currentTokenColorMap=k,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy&&this._workerProxy.acceptTheme(this._currentTheme,this._currentTokenColorMap)}getWorkerProxy(){return this._workerProxyPromise||(this._workerProxyPromise=this.createWorkerProxy()),this._workerProxyPromise}async createWorkerProxy(){const h=`${Te}/vscode-textmate`,k=`${Ee}/vscode-textmate`,v=`${Te}/vscode-oniguruma`,T=`${Ee}/vscode-oniguruma`,t=this._environmentService.isBuilt&&!We,u=t?k:h,o=t?T:v,g=`${u}/release/main.js`,p=`${o}/release/main.js`,m=`${o}/release/onig.wasm`,c=ee.asBrowserUri(g).toString(!0),f={grammarDefinitions:this._grammarDefinitions,textmateMainUri:c,onigurumaMainUri:ee.asBrowserUri(p).toString(!0),onigurumaWASMUri:ee.asBrowserUri(m).toString(!0)},I=pt(this._modelService,this._languageConfigurationService,{createData:f,label:"textMateWorker",moduleId:"vs/workbench/services/textMate/browser/worker/textMate.worker",host:this});this._worker=I;const _=await I.getProxy();return this._worker!==I?null:(this._workerProxy=_,this._currentTheme&&this._currentTokenColorMap&&this._workerProxy.acceptTheme(this._currentTheme,this._currentTokenColorMap),_)}_killWorker(){for(const h of this._workerTokenizerControllers.values())h.dispose();this._workerTokenizerControllers.clear(),this._worker&&(this._worker.dispose(),this._worker=null),this._workerProxy=null,this._workerProxyPromise=null}createBackgroundTokenizer(h,k,v){if(this._workerTokenizerControllers.has(h.uri.toString()))throw new gt;if(this._configurationService.getValue("editor.experimental.asyncTokenization")!==!0||h.isTooLargeForSyncing())return;const t=new pe;return this.getWorkerProxy().then(u=>{t.isDisposed||!u||t.add(Qt(h,()=>{const o=new Ht(h,u,this._languageService.languageIdCodec,k,_e.INITIAL,this._configurationService,v);return this._workerTokenizerControllers.set(h.uri.toString(),o),mt(()=>{this._workerTokenizerControllers.delete(h.uri.toString()),o.dispose()})}))}),{dispose(){t.dispose()},requestTokens:(u,o)=>{this.getWorkerProxy().then(g=>{g==null||g.retokenize(h.uri.toString(),u,o)})},reportMismatchingTokens:u=>{Ce._reportedMismatchingTokens||(Ce._reportedMismatchingTokens=!0,this._notificationService.error({message:"Async Tokenization Token Mismatch in line "+u,name:"Async Tokenization Token Mismatch"}),this._telemetryService.publicLog2("asyncTokenizationMismatchingTokens",{}))}}}async readFile(h){const k=xe.revive(h);return this._extensionResourceLoaderService.readExtensionResource(k)}async setTokensAndStates(h,k,v,T){const t=xe.revive(h),u=this._workerTokenizerControllers.get(t.toString());u&&u.setTokensAndStates(k,v,T)}};me._reportedMismatchingTokens=!1;me=Re([q(0,Fe),q(1,ut),q(2,lt),q(3,Be),q(4,$e),q(5,ht),q(6,ze),q(7,dt)],me);function Qt(M,h){const k=new pe,v=k.add(new pe);function T(){M.isAttachedToEditor()?v.add(h()):v.clear()}return T(),k.add(M.onDidChangeAttached(()=>{T()})),k}class Jt{constructor(){this._scopeNameToLanguageRegistration=Object.create(null)}reset(){this._scopeNameToLanguageRegistration=Object.create(null)}register(h){if(this._scopeNameToLanguageRegistration[h.scopeName]){const k=this._scopeNameToLanguageRegistration[h.scopeName];ft(k.location,h.location)||console.warn(`Overwriting grammar scope name to file mapping for scope ${h.scopeName}.
Old grammar file: ${k.location.toString()}.
New grammar file: ${h.location.toString()}`)}this._scopeNameToLanguageRegistration[h.scopeName]=h}getGrammarDefinition(h){return this._scopeNameToLanguageRegistration[h]||null}}const de="No TM Grammar registered for this language.";class Xt extends ae{constructor(h,k,v,T){super(),this._host=h,this._initialState=v.INITIAL,this._scopeRegistry=new Jt,this._injections={},this._injectedEmbeddedLanguages={},this._languageToScope=new Map,this._grammarRegistry=this._register(new v.Registry({onigLib:T,loadGrammar:async t=>{const u=this._scopeRegistry.getGrammarDefinition(t);if(!u)return this._host.logTrace(`No grammar found for scope ${t}`),null;const o=u.location;try{const g=await this._host.readFile(o);return v.parseRawGrammar(g,o.path)}catch(g){return this._host.logError(`Unable to load and parse grammar for scope ${t} from ${o}`,g),null}},getInjections:t=>{const u=t.split(".");let o=[];for(let g=1;g<=u.length;g++){const p=u.slice(0,g).join(".");o=[...o,...this._injections[p]||[]]}return o}}));for(const t of k){if(this._scopeRegistry.register(t),t.injectTo){for(const u of t.injectTo){let o=this._injections[u];o||(this._injections[u]=o=[]),o.push(t.scopeName)}if(t.embeddedLanguages)for(const u of t.injectTo){let o=this._injectedEmbeddedLanguages[u];o||(this._injectedEmbeddedLanguages[u]=o=[]),o.push(t.embeddedLanguages)}}t.language&&this._languageToScope.set(t.language,t.scopeName)}}has(h){return this._languageToScope.has(h)}setTheme(h,k){this._grammarRegistry.setTheme(h,k)}getColorMap(){return this._grammarRegistry.getColorMap()}async createGrammar(h,k){const v=this._languageToScope.get(h);if(typeof v!="string")throw new Error(de);const T=this._scopeRegistry.getGrammarDefinition(v);if(!T)throw new Error(de);const t=T.embeddedLanguages;if(this._injectedEmbeddedLanguages[v]){const g=this._injectedEmbeddedLanguages[v];for(const p of g)for(const m of Object.keys(p))t[m]=p[m]}const u=Object.keys(t).length>0;let o;try{o=await this._grammarRegistry.loadGrammarWithConfiguration(v,k,{embeddedLanguages:t,tokenTypes:T.tokenTypes,balancedBracketSelectors:T.balancedBracketSelectors,unbalancedBracketSelectors:T.unbalancedBracketSelectors})}catch(g){throw g.message&&g.message.startsWith("No grammar provided for")?new Error(de):g}return{languageId:h,grammar:o,initialState:this._initialState,containsEmbeddedLanguages:u}}}const J=fe.registerExtensionPoint({extensionPoint:"grammars",deps:[Ot],jsonSchema:{description:N("vscode.extension.contributes.grammars","Contributes textmate tokenizers."),type:"array",defaultSnippets:[{body:[{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}]}],items:{type:"object",defaultSnippets:[{body:{language:"${1:id}",scopeName:"source.${2:id}",path:"./syntaxes/${3:id}.tmLanguage."}}],properties:{language:{description:N("vscode.extension.contributes.grammars.language","Language identifier for which this syntax is contributed to."),type:"string"},scopeName:{description:N("vscode.extension.contributes.grammars.scopeName","Textmate scope name used by the tmLanguage file."),type:"string"},path:{description:N("vscode.extension.contributes.grammars.path","Path of the tmLanguage file. The path is relative to the extension folder and typically starts with './syntaxes/'."),type:"string"},embeddedLanguages:{description:N("vscode.extension.contributes.grammars.embeddedLanguages","A map of scope name to language id if this grammar contains embedded languages."),type:"object"},tokenTypes:{description:N("vscode.extension.contributes.grammars.tokenTypes","A map of scope name to token types."),type:"object",additionalProperties:{enum:["string","comment","other"]}},injectTo:{description:N("vscode.extension.contributes.grammars.injectTo","List of language scope names to which this grammar is injected to."),type:"array",items:{type:"string"}},balancedBracketScopes:{description:N("vscode.extension.contributes.grammars.balancedBracketScopes","Defines which scope names contain balanced brackets."),type:"array",items:{type:"string"},default:["*"]},unbalancedBracketScopes:{description:N("vscode.extension.contributes.grammars.unbalancedBracketScopes","Defines which scope names do not contain balanced brackets."),type:"array",items:{type:"string"},default:[]}},required:["scopeName","path"]}}});let ve=class extends ae{constructor(h,k,v,T,t,u,o,g,p){super(),this._languageService=h,this._themeService=k,this._extensionResourceLoaderService=v,this._notificationService=T,this._logService=t,this._configurationService=u,this._progressService=o,this._environmentService=g,this._instantiationService=p,this._createdModes=[],this._encounteredLanguages=[],this._debugMode=!1,this._debugModePrintFunc=()=>{},this._grammarDefinitions=null,this._grammarFactory=null,this._tokenizersRegistrations=new pe,this._currentTheme=null,this._currentTokenColorMap=null,this._workerHost=this._instantiationService.createInstance(me),this._vscodeOniguruma=null,this._styleElement=St(),this._styleElement.className="vscode-tokens-styles",J.setHandler(m=>this.handleGrammarsExtPoint(m)),this._updateTheme(this._themeService.getColorTheme(),!0),this._register(this._themeService.onDidColorThemeChange(()=>{this._updateTheme(this._themeService.getColorTheme(),!1)})),this._languageService.onDidRequestRichLanguageFeatures(m=>{this._createdModes.push(m)})}handleGrammarsExtPoint(h){this._grammarDefinitions=null,this._grammarFactory&&(this._grammarFactory.dispose(),this._grammarFactory=null),this._tokenizersRegistrations.clear(),this._grammarDefinitions=[];for(const k of h){const v=k.value;for(const T of v){const t=this.createValidGrammarDefinition(k,T);if(t&&(this._grammarDefinitions.push(t),t.language)){const u=new Lt(()=>this.createTokenizationSupport(t.language));this._tokenizersRegistrations.add(u),this._tokenizersRegistrations.add(Se.registerFactory(t.language,u))}}}this._workerHost.setGrammarDefinitions(this._grammarDefinitions);for(const k of this._createdModes)Se.getOrCreate(k)}createValidGrammarDefinition(h,k){if(!en(h.description.extensionLocation,k,h.collector,this._languageService))return null;const v=qe(h.description.extensionLocation,k.path),T=Object.create(null);if(k.embeddedLanguages){const g=Object.keys(k.embeddedLanguages);for(let p=0,m=g.length;p<m;p++){const c=g[p],f=k.embeddedLanguages[c];typeof f=="string"&&this._languageService.isRegisteredLanguageId(f)&&(T[c]=this._languageService.languageIdCodec.encodeLanguageId(f))}}const t=Object.create(null);if(k.tokenTypes){const g=Object.keys(k.tokenTypes);for(const p of g)switch(k.tokenTypes[p]){case"string":t[p]=2;break;case"other":t[p]=0;break;case"comment":t[p]=1;break}}let u=null;k.language&&this._languageService.isRegisteredLanguageId(k.language)&&(u=k.language);function o(g,p){return!Array.isArray(g)||!g.every(m=>typeof m=="string")?p:g}return{location:v,language:u||void 0,scopeName:k.scopeName,embeddedLanguages:T,tokenTypes:t,injectTo:k.injectTo,balancedBracketSelectors:o(k.balancedBracketScopes,["*"]),unbalancedBracketSelectors:o(k.unbalancedBracketScopes,[])}}startDebugMode(h,k){if(this._debugMode){this._notificationService.error(N("alreadyDebugging","Already Logging."));return}this._debugModePrintFunc=h,this._debugMode=!0,this._debugMode&&this._progressService.withProgress({location:15,buttons:[N("stop","Stop")]},v=>(v.report({message:N("progress1","Preparing to log TM Grammar parsing. Press Stop when finished.")}),this._getVSCodeOniguruma().then(T=>(T.setDefaultDebugCall(!0),v.report({message:N("progress2","Now logging TM Grammar parsing. Press Stop when finished.")}),new Promise((t,u)=>{})))),v=>{this._getVSCodeOniguruma().then(T=>{this._debugModePrintFunc=()=>{},this._debugMode=!1,T.setDefaultDebugCall(!1),k()})})}_canCreateGrammarFactory(){return!!this._grammarDefinitions}async _getOrCreateGrammarFactory(){if(this._grammarFactory)return this._grammarFactory;const[h,k]=await Promise.all([Ne(()=>Promise.resolve().then(()=>Vt),void 0).then(T=>T.default??T),this._getVSCodeOniguruma()]),v=Promise.resolve({createOnigScanner:T=>k.createOnigScanner(T),createOnigString:T=>k.createOnigString(T)});return this._grammarFactory?this._grammarFactory:(this._grammarFactory=new Xt({logTrace:T=>this._logService.trace(T),logError:(T,t)=>this._logService.error(T,t),readFile:T=>this._extensionResourceLoaderService.readExtensionResource(T)},this._grammarDefinitions||[],h,v),this._updateTheme(this._themeService.getColorTheme(),!0),this._grammarFactory)}async createTokenizationSupport(h){if(!this._languageService.isRegisteredLanguageId(h)||!this._canCreateGrammarFactory())return null;try{const k=await this._getOrCreateGrammarFactory();if(!k.has(h))return null;const v=this._languageService.languageIdCodec.encodeLanguageId(h),T=await k.createGrammar(h,v);if(!T.grammar)return null;const t=tn("editor.maxTokenizationLineLength",h,-1,this._configurationService),u=new Bt(T.grammar,T.initialState,T.containsEmbeddedLanguages,(o,g)=>this._workerHost.createBackgroundTokenizer(o,g,t),()=>this._configurationService.getValue("editor.experimental.asyncTokenizationVerification"));return u.onDidEncounterLanguage(o=>{if(!this._encounteredLanguages[o]){const g=this._languageService.languageIdCodec.decodeLanguageId(o);this._encounteredLanguages[o]=!0,this._languageService.requestBasicLanguageFeatures(g)}}),new $t(v,u,t)}catch(k){return k.message&&k.message===de||bt(k),null}}_updateTheme(h,k){var t;if(!k&&this._currentTheme&&this._currentTokenColorMap&&Zt(this._currentTheme.settings,h.tokenColors)&&Tt(this._currentTokenColorMap,h.tokenColorMap))return;this._currentTheme={name:h.label,settings:h.tokenColors},this._currentTokenColorMap=h.tokenColorMap,(t=this._grammarFactory)==null||t.setTheme(this._currentTheme,this._currentTokenColorMap);const v=Yt(this._currentTokenColorMap),T=Ct(v);this._styleElement.textContent=T,Se.setColorMap(v),this._currentTheme&&this._currentTokenColorMap&&this._workerHost.acceptTheme(this._currentTheme,this._currentTokenColorMap)}async createGrammar(h){if(!this._languageService.isRegisteredLanguageId(h))return null;const k=await this._getOrCreateGrammarFactory();if(!k.has(h))return null;const v=this._languageService.languageIdCodec.encodeLanguageId(h),{grammar:T}=await k.createGrammar(h,v);return T}_getVSCodeOniguruma(){return this._vscodeOniguruma||(this._vscodeOniguruma=(async()=>{const[h,k]=await Promise.all([Ne(()=>import("./main-d9721a23.js").then(v=>v.m),["assets/main-d9721a23.js","assets/index-e8d740ba.js","assets/index-4826039e.css"]).then(v=>v.default??v),this._loadVSCodeOnigurumaWASM()]);return await h.loadWASM({data:k,print:v=>{this._debugModePrintFunc(v)}}),h})()),this._vscodeOniguruma}async _loadVSCodeOnigurumaWASM(){return We?await(await fetch(ee.asBrowserUri("vscode-oniguruma/../onig.wasm").toString(!0))).arrayBuffer():await fetch(this._environmentService.isBuilt?ee.asBrowserUri(`${vt}/vscode-oniguruma/release/onig.wasm`).toString(!0):ee.asBrowserUri(`${Te}/vscode-oniguruma/release/onig.wasm`).toString(!0))}};ve=Re([q(0,$e),q(1,Gt),q(2,Fe),q(3,ze),q(4,_t),q(5,Be),q(6,kt),q(7,yt),q(8,Ue)],ve);function Yt(M){const h=[null];for(let k=1,v=M.length;k<v;k++)h[k]=wt.fromHex(M[k]);return h}function Zt(M,h){if(!h||!M||h.length!==M.length)return!1;for(let k=h.length-1;k>=0;k--){const v=h[k],T=M[k];if(v.scope!==T.scope)return!1;const t=v.settings,u=T.settings;if(t&&u){if(t.fontStyle!==u.fontStyle||t.foreground!==u.foreground||t.background!==u.background)return!1}else if(!t||!u)return!1}return!0}function en(M,h,k,v){if(h.language&&(typeof h.language!="string"||!v.isRegisteredLanguageId(h.language)))return k.error(N("invalid.language","Unknown language in `contributes.{0}.language`. Provided value: {1}",J.name,String(h.language))),!1;if(!h.scopeName||typeof h.scopeName!="string")return k.error(N("invalid.scopeName","Expected string in `contributes.{0}.scopeName`. Provided value: {1}",J.name,String(h.scopeName))),!1;if(!h.path||typeof h.path!="string")return k.error(N("invalid.path.0","Expected string in `contributes.{0}.path`. Provided value: {1}",J.name,String(h.path))),!1;if(h.injectTo&&(!Array.isArray(h.injectTo)||h.injectTo.some(t=>typeof t!="string")))return k.error(N("invalid.injectTo","Invalid value in `contributes.{0}.injectTo`. Must be an array of language scope names. Provided value: {1}",J.name,JSON.stringify(h.injectTo))),!1;if(h.embeddedLanguages&&!Me(h.embeddedLanguages))return k.error(N("invalid.embeddedLanguages","Invalid value in `contributes.{0}.embeddedLanguages`. Must be an object map from scope name to language. Provided value: {1}",J.name,JSON.stringify(h.embeddedLanguages))),!1;if(h.tokenTypes&&!Me(h.tokenTypes))return k.error(N("invalid.tokenTypes","Invalid value in `contributes.{0}.tokenTypes`. Must be an object map from scope name to token type. Provided value: {1}",J.name,JSON.stringify(h.tokenTypes))),!1;const T=qe(M,h.path);return Rt(T,M)||k.warn(N("invalid.path.1","Expected `contributes.{0}.path` ({1}) to be included inside extension's folder ({2}). This might make the extension non-portable.",J.name,T.path,M.path)),!0}function tn(M,h,k,v){return je(T=>v.onDidChangeConfiguration(t=>{t.affectsConfiguration(M,{overrideIdentifier:h})&&T(t)}),()=>v.getValue(M,{overrideIdentifier:h})??k)}const Q=Dt(),nn=fe.registerExtensionPoint({extensionPoint:"semanticTokenTypes",jsonSchema:{description:N("contributes.semanticTokenTypes","Contributes semantic token types."),type:"array",items:{type:"object",properties:{id:{type:"string",description:N("contributes.semanticTokenTypes.id","The identifier of the semantic token type"),pattern:oe,patternErrorMessage:N("contributes.semanticTokenTypes.id.format","Identifiers should be in the form letterOrDigit[_-letterOrDigit]*")},superType:{type:"string",description:N("contributes.semanticTokenTypes.superType","The super type of the semantic token type"),pattern:oe,patternErrorMessage:N("contributes.semanticTokenTypes.superType.format","Super types should be in the form letterOrDigit[_-letterOrDigit]*")},description:{type:"string",description:N("contributes.color.description","The description of the semantic token type")}}}}}),rn=fe.registerExtensionPoint({extensionPoint:"semanticTokenModifiers",jsonSchema:{description:N("contributes.semanticTokenModifiers","Contributes semantic token modifiers."),type:"array",items:{type:"object",properties:{id:{type:"string",description:N("contributes.semanticTokenModifiers.id","The identifier of the semantic token modifier"),pattern:oe,patternErrorMessage:N("contributes.semanticTokenModifiers.id.format","Identifiers should be in the form letterOrDigit[_-letterOrDigit]*")},description:{description:N("contributes.semanticTokenModifiers.description","The description of the semantic token modifier")}}}}}),sn=fe.registerExtensionPoint({extensionPoint:"semanticTokenScopes",jsonSchema:{description:N("contributes.semanticTokenScopes","Contributes semantic token scope maps."),type:"array",items:{type:"object",properties:{language:{description:N("contributes.semanticTokenScopes.languages","Lists the languge for which the defaults are."),type:"string"},scopes:{description:N("contributes.semanticTokenScopes.scopes","Maps a semantic token (described by semantic token selector) to one or more textMate scopes used to represent that token."),type:"object",additionalProperties:{type:"array",items:{type:"string"}}}}}}});class on{constructor(){function h(k,v,T){if(typeof k.id!="string"||k.id.length===0)return T.error(N("invalid.id","'configuration.{0}.id' must be defined and can not be empty",v)),!1;if(!k.id.match(oe))return T.error(N("invalid.id.format","'configuration.{0}.id' must follow the pattern letterOrDigit[-_letterOrDigit]*",v)),!1;const t=k.superType;return t&&!t.match(oe)?(T.error(N("invalid.superType.format","'configuration.{0}.superType' must follow the pattern letterOrDigit[-_letterOrDigit]*",v)),!1):typeof k.description!="string"||k.id.length===0?(T.error(N("invalid.description","'configuration.{0}.description' must be defined and can not be empty",v)),!1):!0}nn.setHandler((k,v)=>{for(const T of v.added){const t=T.value,u=T.collector;if(!t||!Array.isArray(t)){u.error(N("invalid.semanticTokenTypeConfiguration","'configuration.semanticTokenType' must be an array"));return}for(const o of t)h(o,"semanticTokenType",u)&&Q.registerTokenType(o.id,o.description,o.superType)}for(const T of v.removed){const t=T.value;for(const u of t)Q.deregisterTokenType(u.id)}}),rn.setHandler((k,v)=>{for(const T of v.added){const t=T.value,u=T.collector;if(!t||!Array.isArray(t)){u.error(N("invalid.semanticTokenModifierConfiguration","'configuration.semanticTokenModifier' must be an array"));return}for(const o of t)h(o,"semanticTokenModifier",u)&&Q.registerTokenModifier(o.id,o.description)}for(const T of v.removed){const t=T.value;for(const u of t)Q.deregisterTokenModifier(u.id)}}),sn.setHandler((k,v)=>{for(const T of v.added){const t=T.value,u=T.collector;if(!t||!Array.isArray(t)){u.error(N("invalid.semanticTokenScopes.configuration","'configuration.semanticTokenScopes' must be an array"));return}for(const o of t){if(o.language&&typeof o.language!="string"){u.error(N("invalid.semanticTokenScopes.language","'configuration.semanticTokenScopes.language' must be a string"));continue}if(!o.scopes||typeof o.scopes!="object"){u.error(N("invalid.semanticTokenScopes.scopes","'configuration.semanticTokenScopes.scopes' must be defined as an object"));continue}for(const g in o.scopes){const p=o.scopes[g];if(!Array.isArray(p)||p.some(m=>typeof m!="string")){u.error(N("invalid.semanticTokenScopes.scopes.value","'configuration.semanticTokenScopes.scopes' values must be an array of strings"));continue}try{const m=Q.parseTokenSelector(g,o.language);Q.registerTokenStyleDefault(m,{scopesToProbe:p.map(c=>c.split(" "))})}catch{u.error(N("invalid.semanticTokenScopes.scopes.selector","configuration.semanticTokenScopes.scopes': Problems parsing selector {0}.",g))}}}}for(const T of v.removed){const t=T.value;for(const u of t)for(const o in u.scopes){const g=u.scopes[o];try{const p=Q.parseTokenSelector(o,u.language);Q.registerTokenStyleDefault(p,{scopesToProbe:g.map(m=>m.split(" "))})}catch{}}}})}}const Ge="/OpenflexoColab/assets/onig-fd885c2d.wasm";jt({"vscode-oniguruma/../onig.wasm":Ge,"vs/../../node_modules/vscode-oniguruma/release/onig.wasm":Ge});Et(async M=>{M.get(Nt).when(2).then(()=>{Mt.get(Ve)})});let we=class{constructor(h){this.instantiationService=h,this.instantiationService.createInstance(on)}};we=Re([q(0,Ue)],we);Pt.as(It.Workbench).registerWorkbenchContribution(we,1);function gn(){return{...At(),[Ve.toString()]:new xt(ve)}}export{Ve as ITextMateTokenizationService,gn as default};
