import{mM as p,uI as I,fD as b,mN as h,uJ as k,uK as P,uL as L,s8 as V}from"./index-e8d740ba.js";function v(s,n,e,i){const d=p(s,n,e,i)[0];return d&&(s=s.substring(0,d.offset)+d.content+s.substring(d.offset+d.length)),s}function M(s,n,e){let i=[];e?i=w(e):i=E(n);const d=[],u=[...I()];if(Array.isArray(i))for(const t of i)t.startsWith("-")?u.push(t.substring(1)):d.push(t);return b([...s,...d].filter(t=>!u.includes(t)))}function E(s){let n=s.inspect("settingsSync.ignoredSettings").userValue;return n!==void 0||(n=s.inspect("sync.ignoredSettings").userValue,n!==void 0)?n:s.getValue("settingsSync.ignoredSettings")||[]}function w(s){const n=h(s);return n?n["settingsSync.ignoredSettings"]||n["sync.ignoredSettings"]||[]:[]}function $(s,n,e,i){if(e.length){const d=y(n),u=h(n)||{},t=h(s);if(!t)return s;const f=[];for(const r of e){const c=u[r],o=t[r];c===void 0?s=v(s,[r],void 0,i):o!==void 0?s=v(s,[r],c,i):f.push(a(r,d))}f.sort((r,c)=>r.startOffset-c.startOffset),f.forEach(r=>s=j(r.setting.key,n,s,i))}return s}function j(s,n,e,i){const d=h(n),u=y(n),t=y(e),f=B(s,u,t);return F(e,s,d[s],f,t,i)}function B(s,n,e){const i=n.findIndex(u=>{var t;return((t=u.setting)==null?void 0:t.key)===s}),d=n[i-1];if(d){if(d.setting){const t=a(d.setting.key,e);if(t)return{index:e.indexOf(t),insertAfter:!0}}else{const t=S(i,n);if(t){const f=a(t.setting.key,e);if(f){const r=N(e.indexOf(f),e),c=l(n,t,n[i]);if(r){const o=l(e,f,r),g=m(c,o);return g?{index:e.indexOf(g),insertAfter:!0}:{index:e.indexOf(r),insertAfter:!1}}else{const o=l(e,f,e[e.length-1]),g=m(c,o);return g?{index:e.indexOf(g),insertAfter:!0}:{index:e.length-1,insertAfter:!0}}}}}const u=n[i+1];if(u)if(u.setting){const t=a(u.setting.key,e);if(t)return{index:e.indexOf(t),insertAfter:!1}}else{const t=N(i,n);if(t){const f=a(t.setting.key,e);if(f){const r=S(e.indexOf(f),e),c=l(n,n[i],t);if(r){const o=l(e,r,f),g=m(c.reverse(),o.reverse());return g?{index:e.indexOf(g),insertAfter:!1}:{index:e.indexOf(r),insertAfter:!0}}else{const o=l(e,e[0],f),g=m(c.reverse(),o.reverse());return g?{index:e.indexOf(g),insertAfter:!1}:{index:0,insertAfter:!1}}}}}}return{index:e.length-1,insertAfter:!0}}function F(s,n,e,i,d,u){let t;return i.index===-1?t=p(s,[n],e,u):t=J(s,n,e,i,d,u).map(f=>k(s,f,u)[0]),P(s,t)}function J(s,n,e,i,d,u){var c;const t=`${JSON.stringify(n)}: ${JSON.stringify(e)}`,f=L(u,s),r=d[i.index];if(i.insertAfter){const o=[];if(r.setting)o.push({offset:r.endOffset,length:0,content:","+t});else{const g=N(i.index,d),x=S(i.index,d),O=(c=x==null?void 0:x.setting)==null?void 0:c.commaOffset;x&&O===void 0&&o.push({offset:x.endOffset,length:0,content:","});const A=O!==void 0&&O>r.endOffset;o.push({offset:A?O+1:r.endOffset,length:0,content:g?f+t+",":f+t})}return o}else{if(r.setting)return[{offset:r.startOffset,length:0,content:t+","}];const o=(d[i.index-1]&&!d[i.index-1].setting?f:"")+t+(N(i.index,d)?",":"")+f;return[{offset:r.startOffset,length:0,content:o}]}}function a(s,n){return n.filter(e=>{var i;return((i=e.setting)==null?void 0:i.key)===s})[0]}function S(s,n){for(let e=s-1;e>=0;e--)if(n[e].setting)return n[e]}function N(s,n){for(let e=s+1;e<n.length;e++)if(n[e].setting)return n[e]}function l(s,n,e){const i=s.indexOf(n),d=s.indexOf(e);return s.filter((u,t)=>i<t&&t<d)}function m(s,n){if(s.length&&n.length){let e=0;for(;e<n.length&&e<s.length;e++)if(s[e].value!==n[e].value)return n[e-1];return n[e-1]}}function y(s){const n=[];let e=-1,i,d;return V(s,{onObjectBegin:t=>{e++},onObjectProperty:(t,f,r)=>{e===0&&(i=f,d=t)},onObjectEnd:(t,f)=>{e--,e===0&&n.push({startOffset:i,endOffset:t+f,value:s.substring(i,t+f),setting:{key:d,commaOffset:void 0}})},onArrayBegin:(t,f)=>{e++},onArrayEnd:(t,f)=>{e--,e===0&&n.push({startOffset:i,endOffset:t+f,value:s.substring(i,t+f),setting:{key:d,commaOffset:void 0}})},onLiteralValue:(t,f,r)=>{e===0&&n.push({startOffset:i,endOffset:f+r,value:s.substring(i,f+r),setting:{key:d,commaOffset:void 0}})},onSeparator:(t,f,r)=>{if(e===0&&t===","){let c=n.length-1;for(;c>=0&&!n[c].setting;c--);const o=n[c];o&&n.splice(c,1,{startOffset:o.startOffset,endOffset:o.endOffset,value:o.value,setting:{key:o.setting.key,commaOffset:f}})}},onComment:(t,f)=>{e===0&&n.push({startOffset:t,endOffset:t+f,value:s.substring(t,t+f)})}}),n}export{M as g,$ as u};
