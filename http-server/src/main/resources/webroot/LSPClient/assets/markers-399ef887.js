import{bE as Ge,dl as z,ij as bt,oh as $e,kn as _,dH as re,ct as Ie,kl as wt,E as H,dT as ze,z0 as Re,km as Et,z1 as _t,n as Qe,B as o,av as Ae,bj as O,_ as x,a as h,Q as je,b3 as ve,hZ as xe,b0 as Mt,dF as St,D,bo as It,bn as Pe,sl as Rt,z2 as At,rH as vt,ds as Ve,z3 as xt,nZ as Ft,z4 as Ne,bB as J,g as Lt,e as K,cd as Fe,c0 as Le,I as Ct,cx as Ye,q_ as yt,a0 as Ce,vk as Tt,w as se,H as u,$ as p,so as Pt,sp as Vt,S as Nt,da as Ot,b9 as de,b7 as Xe,eZ as Ze,ya as Je,aa as ue,ac as ie,ay as et,t as B,rg as F,yc as tt,o2 as Oe,z5 as Dt,cH as Kt,z6 as Wt,tS as Bt,z7 as Ut,z8 as Ht,dG as rt,au as qt,mV as Gt,d as De,oK as $t,iu as zt,a2 as T,oi as Ke,eM as st,Z as Qt,aQ as it,O as jt,k5 as ye,bA as Yt,h as Xt,X as Zt,N as Jt,Y as nt,dz as er,ss as tr,iz as rr,b1 as sr,dq as ir,ie as nr,yv as We,yw as he,cX as or,dm as ar,z9 as lr,dB as cr,dC as hr,d2 as Be,aH as P,b5 as dr,u6 as ur,uc as te,bv as oe,aF as A,f_ as $,a3 as ae,cA as mr,as as ot,k as at,aB as gr,iB as pr,aj as I,rv as v,za as ee,ak as lt,al as fr,xt as ct,fY as Te,xu as ht,j3 as kr,aJ as br,o as wr,c1 as Er}from"./index-1e6bb64c.js";import{a as b,M as l}from"./markers-2afb8888.js";import{R as _r}from"./codeeditor-60d8146c.js";function dt(i,e){return re.compare(i.resource,e.resource)}function Mr(i,e){const[t]=i.markers,[r]=e.markers;let s=0;return t&&r&&(s=_.compare(t.marker.severity,r.marker.severity)),s===0&&(s=i.path.localeCompare(e.path)||i.name.localeCompare(e.name)),s}class y{constructor(e,t){this.id=e,this.resource=t,this._markersMap=new Ge,this._total=0,this.path=this.resource.fsPath,this.name=z(this.resource)}get markers(){return this._cachedMarkers||(this._cachedMarkers=bt([...this._markersMap.values()]).sort(y._compareMarkers)),this._cachedMarkers}has(e){return this._markersMap.has(e)}set(e,t){this.delete(e),$e(t)&&(this._markersMap.set(e,t),this._total+=t.length,this._cachedMarkers=void 0)}delete(e){const t=this._markersMap.get(e);t&&(this._total-=t.length,this._cachedMarkers=void 0,this._markersMap.delete(e))}get total(){return this._total}static _compareMarkers(e,t){return _.compare(e.marker.severity,t.marker.severity)||re.compare(e.resource,t.resource)||Ie.compareRangesUsingStarts(e.marker,t.marker)}}class w{get resource(){return this.marker.resource}get range(){return this.marker}get lines(){return this._lines||(this._lines=wt(this.marker.message)),this._lines}constructor(e,t,r=[]){this.id=e,this.marker=t,this.relatedInformation=r}toString(){return JSON.stringify({...this.marker,resource:this.marker.resource.path,relatedInformation:this.relatedInformation.length?this.relatedInformation.map(e=>({...e.raw,resource:e.raw.resource.path})):void 0},null,"	")}}class N extends w{constructor(e,t,r,s,n,a){super(e.id,e.marker,e.relatedInformation),this.sourceMatches=t,this.codeMatches=r,this.messageMatches=s,this.fileMatches=n,this.ownerMatches=a}}class U{constructor(e,t,r){this.id=e,this.marker=t,this.raw=r}}class Sr{get resourceMarkers(){return this.cachedSortedResources||(this.cachedSortedResources=[...this.resourcesByUri.values()].sort(Mr)),this.cachedSortedResources}constructor(){this.cachedSortedResources=void 0,this._onDidChange=new H,this.onDidChange=this._onDidChange.event,this._total=0,this.resourcesByUri=new Map}reset(){const e=new Set;for(const t of this.resourcesByUri.values())e.add(t);this.resourcesByUri.clear(),this._total=0,this._onDidChange.fire({removed:e,added:new Set,updated:new Set})}get total(){return this._total}getResourceMarkers(e){return ze(this.resourcesByUri.get(re.getComparisonKey(e,!0)))}setResourceMarkers(e){const t={added:new Set,removed:new Set,updated:new Set};for(const[r,s]of e){if(Re.has(r.scheme))continue;const n=re.getComparisonKey(r,!0);let a=this.resourcesByUri.get(n);if($e(s)){if(a)t.updated.add(a);else{const g=this.id(r.toString());a=new y(g,r.with({fragment:null})),this.resourcesByUri.set(n,a),t.added.add(a)}const c=new Map,m=s.map(g=>{const E=Et.makeKey(g),S=c.get(E)||0;c.set(E,S+1);const M=this.id(a.id,E,S,g.resource.toString());let f;return g.relatedInformation&&(f=g.relatedInformation.map((C,le)=>new U(this.id(M,C.resource.toString(),C.startLineNumber,C.startColumn,C.endLineNumber,C.endColumn,le),g,C))),new w(M,g,f)});this._total-=a.total,a.set(r,m),this._total+=a.total}else a&&(this._total-=a.total,a.delete(r),this._total+=a.total,a.total===0?(this.resourcesByUri.delete(n),t.removed.add(a)):t.updated.add(a))}this.cachedSortedResources=void 0,(t.added.size||t.removed.size||t.updated.size)&&this._onDidChange.fire(t)}id(...e){const t=new _t;for(const r of e)t.hash(r);return`${t.value}`}dispose(){this._onDidChange.dispose(),this.resourcesByUri.clear()}}var Ir='.markers-panel .markers-panel-container{height:100%}.markers-panel .hide{display:none}.markers-panel .markers-panel-container .message-box-container{line-height:22px;padding-left:20px}.markers-panel .markers-panel-container .message-box-container .messageAction{cursor:pointer;margin-left:4px;text-decoration:underline}.markers-panel .markers-panel-container .hidden{display:none}.markers-panel .markers-panel-container .codicon.codicon-light-bulb{color:var(--vscode-editorLightBulb-foreground)}.markers-panel .markers-panel-container .codicon.codicon-lightbulb-autofix{color:var(--vscode-editorLightBulbAutoFix-foreground)}.markers-panel .markers-panel-container .tree-container.hidden{display:none;visibility:hidden}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents{display:flex;line-height:22px;padding-right:10px}.monaco-workbench.hc-black .markers-panel .markers-panel-container .tree-container .monaco-tl-contents,.monaco-workbench.hc-light .markers-panel .markers-panel-container .tree-container .monaco-tl-contents{line-height:20px}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-stats{display:inline-block;margin-left:10px}.markers-panel:not(.wide) .markers-panel-container .tree-container .monaco-tl-contents .resource-label-container{flex:1}.markers-panel.wide .markers-panel-container .tree-container .monaco-tl-contents .count-badge-wrapper{margin-left:10px}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-message-details-container{flex:1;overflow:hidden}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-message-details-container>.marker-message-line{overflow:hidden}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-message-details-container>.marker-message-line>.marker-message{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-message-details-container>.marker-message-line.details-container{display:flex}.markers-panel .markers-panel-container .tree-container .monaco-list:focus .monaco-list-row.focused .monaco-tl-contents .details-container a.monaco-link{color:inherit}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .details-container a.monaco-link .monaco-highlighted-label{text-decoration:underline;text-underline-position:under}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-code:before{content:"("}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-code:after{content:")"}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .details-container .marker-line,.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .details-container .marker-source,.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .details-container .multiline-actions{margin-left:6px}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-code,.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-line,.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .marker-source,.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .related-info-resource,.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .related-info-resource-separator{opacity:.7}.markers-panel .markers-panel-container .tree-container .monaco-tl-contents .highlight{font-weight:700}.markers-panel .monaco-tl-contents .marker-icon{align-items:center;display:flex;height:22px;justify-content:center;margin:0 6px}.markers-panel .monaco-list-row.focused .monaco-tl-contents>.marker-icon.quickFix,.markers-panel .monaco-list-row.selected .monaco-tl-contents>.marker-icon.quickFix,.markers-panel .monaco-list-row:hover .monaco-tl-contents>.marker-icon.quickFix,.markers-panel .monaco-tl-contents .actions .monaco-action-bar{display:none}.markers-panel .monaco-list-row.focused .monaco-tl-contents .actions .monaco-action-bar,.markers-panel .monaco-list-row.selected .monaco-tl-contents .actions .monaco-action-bar,.markers-panel .monaco-list-row:hover .monaco-tl-contents .actions .monaco-action-bar{display:block}.markers-panel .monaco-tl-contents .actions,.markers-panel .monaco-tl-contents .multiline-actions .monaco-action-bar{height:22px}.markers-panel .monaco-tl-contents .actions .action-label,.markers-panel .monaco-tl-contents .multiline-actions .monaco-action-bar .action-label{padding:2px}.markers-panel .monaco-tl-contents .actions .action-item{margin:0 4px}.markers-panel .monaco-tl-contents .actions .action-item.disabled,.markers-panel .monaco-tl-contents .multiline-actions .action-item.disabled{display:none}.markers-panel .markers-table-container .monaco-table .monaco-table-th{align-items:center;display:flex;font-weight:600;padding-left:10px}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td{align-items:center;display:flex;padding-left:10px}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td .highlight{font-weight:700}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code,.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.file,.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.message,.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.owner{overflow:hidden;text-overflow:ellipsis}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.severity{display:flex}.markers-panel .markers-table-container .monaco-table .monaco-list-row.focused .monaco-table-tr>.monaco-table-td.quickFix>.severity,.markers-panel .markers-table-container .monaco-table .monaco-list-row.selected .monaco-table-tr>.monaco-table-td.quickFix>.severity,.markers-panel .markers-table-container .monaco-table .monaco-list-row:hover .monaco-table-tr>.monaco-table-td.quickFix>.severity{display:none}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.actions{margin-left:-3px}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.actions>.monaco-action-bar .action-item{display:none}.markers-panel .markers-table-container .monaco-table .monaco-list-row.focused .monaco-table-tr>.monaco-table-td.quickFix>.actions>.monaco-action-bar .action-item,.markers-panel .markers-table-container .monaco-table .monaco-list-row.selected .monaco-table-tr>.monaco-table-td.quickFix>.actions>.monaco-action-bar .action-item,.markers-panel .markers-table-container .monaco-table .monaco-list-row:hover .monaco-table-tr>.monaco-table-td.quickFix>.actions>.monaco-action-bar .action-item{display:flex}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code>.code-label:before,.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code>.monaco-link:before{content:"("}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code>.code-label:after,.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code>.monaco-link:after{content:")"}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code>.code-label,.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code>.monaco-link{display:none}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code.code-label>.code-label{display:inline}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.code.code-link>.monaco-link{display:inline;text-decoration:underline}.markers-panel .markers-table-container .monaco-table .monaco-list-row .monaco-table-tr>.monaco-table-td>.file>.file-position{margin-left:6px;opacity:.7}';Qe(Ir,{});class d{}d.MARKERS_PANEL_TOGGLE_LABEL=o("problems.view.toggle.label","Toggle Problems (Errors, Warnings, Infos)");d.MARKERS_PANEL_SHOW_LABEL=o("problems.view.focus.label","Focus Problems (Errors, Warnings, Infos)");d.PROBLEMS_PANEL_CONFIGURATION_TITLE=o("problems.panel.configuration.title","Problems View");d.PROBLEMS_PANEL_CONFIGURATION_AUTO_REVEAL=o("problems.panel.configuration.autoreveal","Controls whether Problems view should automatically reveal files when opening them.");d.PROBLEMS_PANEL_CONFIGURATION_VIEW_MODE=o("problems.panel.configuration.viewMode","Controls the default view mode of the Problems view.");d.PROBLEMS_PANEL_CONFIGURATION_SHOW_CURRENT_STATUS=o("problems.panel.configuration.showCurrentInStatus","When enabled shows the current problem in the status bar.");d.PROBLEMS_PANEL_CONFIGURATION_COMPARE_ORDER=o("problems.panel.configuration.compareOrder","Controls the order in which problems are navigated.");d.PROBLEMS_PANEL_CONFIGURATION_COMPARE_ORDER_SEVERITY=o("problems.panel.configuration.compareOrder.severity","Navigate problems ordered by severity");d.PROBLEMS_PANEL_CONFIGURATION_COMPARE_ORDER_POSITION=o("problems.panel.configuration.compareOrder.position","Navigate problems ordered by position");d.MARKERS_PANEL_TITLE_PROBLEMS=o("markers.panel.title.problems","Problems");d.MARKERS_PANEL_NO_PROBLEMS_BUILT=o("markers.panel.no.problems.build","No problems have been detected in the workspace.");d.MARKERS_PANEL_NO_PROBLEMS_ACTIVE_FILE_BUILT=o("markers.panel.no.problems.activeFile.build","No problems have been detected in the current file.");d.MARKERS_PANEL_NO_PROBLEMS_FILTERS=o("markers.panel.no.problems.filters","No results found with provided filter criteria.");d.MARKERS_PANEL_ACTION_TOOLTIP_MORE_FILTERS=o("markers.panel.action.moreFilters","More Filters...");d.MARKERS_PANEL_FILTER_LABEL_SHOW_ERRORS=o("markers.panel.filter.showErrors","Show Errors");d.MARKERS_PANEL_FILTER_LABEL_SHOW_WARNINGS=o("markers.panel.filter.showWarnings","Show Warnings");d.MARKERS_PANEL_FILTER_LABEL_SHOW_INFOS=o("markers.panel.filter.showInfos","Show Infos");d.MARKERS_PANEL_FILTER_LABEL_EXCLUDED_FILES=o("markers.panel.filter.useFilesExclude","Hide Excluded Files");d.MARKERS_PANEL_FILTER_LABEL_ACTIVE_FILE=o("markers.panel.filter.activeFile","Show Active File Only");d.MARKERS_PANEL_ACTION_TOOLTIP_FILTER=o("markers.panel.action.filter","Filter Problems");d.MARKERS_PANEL_ACTION_TOOLTIP_QUICKFIX=o("markers.panel.action.quickfix","Show fixes");d.MARKERS_PANEL_FILTER_ARIA_LABEL=o("markers.panel.filter.ariaLabel","Filter Problems");d.MARKERS_PANEL_FILTER_PLACEHOLDER=o("markers.panel.filter.placeholder","Filter (e.g. text, **/*.ts, !**/node_modules/**)");d.MARKERS_PANEL_FILTER_ERRORS=o("markers.panel.filter.errors","errors");d.MARKERS_PANEL_FILTER_WARNINGS=o("markers.panel.filter.warnings","warnings");d.MARKERS_PANEL_FILTER_INFOS=o("markers.panel.filter.infos","infos");d.MARKERS_PANEL_SINGLE_ERROR_LABEL=o("markers.panel.single.error.label","1 Error");d.MARKERS_PANEL_MULTIPLE_ERRORS_LABEL=i=>o("markers.panel.multiple.errors.label","{0} Errors",""+i);d.MARKERS_PANEL_SINGLE_WARNING_LABEL=o("markers.panel.single.warning.label","1 Warning");d.MARKERS_PANEL_MULTIPLE_WARNINGS_LABEL=i=>o("markers.panel.multiple.warnings.label","{0} Warnings",""+i);d.MARKERS_PANEL_SINGLE_INFO_LABEL=o("markers.panel.single.info.label","1 Info");d.MARKERS_PANEL_MULTIPLE_INFOS_LABEL=i=>o("markers.panel.multiple.infos.label","{0} Infos",""+i);d.MARKERS_PANEL_SINGLE_UNKNOWN_LABEL=o("markers.panel.single.unknown.label","1 Unknown");d.MARKERS_PANEL_MULTIPLE_UNKNOWNS_LABEL=i=>o("markers.panel.multiple.unknowns.label","{0} Unknowns",""+i);d.MARKERS_PANEL_AT_LINE_COL_NUMBER=(i,e)=>o("markers.panel.at.ln.col.number","[Ln {0}, Col {1}]",""+i,""+e);d.MARKERS_TREE_ARIA_LABEL_RESOURCE=(i,e,t)=>o("problems.tree.aria.label.resource","{0} problems in file {1} of folder {2}",i,e,t);d.MARKERS_TREE_ARIA_LABEL_MARKER=i=>{const e=i.relatedInformation.length?o("problems.tree.aria.label.marker.relatedInformation"," This problem has references to {0} locations.",i.relatedInformation.length):"";switch(i.marker.severity){case _.Error:return i.marker.source?o("problems.tree.aria.label.error.marker","Error: {0} at line {1} and character {2}.{3} generated by {4}",i.marker.message,i.marker.startLineNumber,i.marker.startColumn,e,i.marker.source):o("problems.tree.aria.label.error.marker.nosource","Error: {0} at line {1} and character {2}.{3}",i.marker.message,i.marker.startLineNumber,i.marker.startColumn,e);case _.Warning:return i.marker.source?o("problems.tree.aria.label.warning.marker","Warning: {0} at line {1} and character {2}.{3} generated by {4}",i.marker.message,i.marker.startLineNumber,i.marker.startColumn,e,i.marker.source):o("problems.tree.aria.label.warning.marker.nosource","Warning: {0} at line {1} and character {2}.{3}",i.marker.message,i.marker.startLineNumber,i.marker.startColumn,e,e);case _.Info:return i.marker.source?o("problems.tree.aria.label.info.marker","Info: {0} at line {1} and character {2}.{3} generated by {4}",i.marker.message,i.marker.startLineNumber,i.marker.startColumn,e,i.marker.source):o("problems.tree.aria.label.info.marker.nosource","Info: {0} at line {1} and character {2}.{3}",i.marker.message,i.marker.startLineNumber,i.marker.startColumn,e);default:return i.marker.source?o("problems.tree.aria.label.marker","Problem: {0} at line {1} and character {2}.{3} generated by {4}",i.marker.source,i.marker.message,i.marker.startLineNumber,i.marker.startColumn,e,i.marker.source):o("problems.tree.aria.label.marker.nosource","Problem: {0} at line {1} and character {2}.{3}",i.marker.message,i.marker.startLineNumber,i.marker.startColumn,e)}};d.MARKERS_TREE_ARIA_LABEL_RELATED_INFORMATION=i=>o("problems.tree.aria.label.relatedinfo.message","{0} at line {1} and character {2} in {3}",i.message,i.startLineNumber,i.startColumn,z(i.resource));d.SHOW_ERRORS_WARNINGS_ACTION_LABEL=o("errors.warnings.show.label","Show Errors and Warnings");var k=d,Rr=".markers-panel-action-filter>.markers-panel-filter-controls>.monaco-action-bar .action-label.markers-filters.checked{background-color:var(--vscode-inputOption-activeBackground);border-color:var(--vscode-inputOption-activeBorder);color:var(--vscode-inputOption-activeForeground)}";Qe(Rr,{});class Ar extends D{constructor(e,t){super(),this.contextKeyService=t,this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,this._excludedFiles=b.ShowExcludedFilesFilterContextKey.bindTo(this.contextKeyService),this._activeFile=b.ShowActiveFileFilterContextKey.bindTo(this.contextKeyService),this._showWarnings=b.ShowWarningsFilterContextKey.bindTo(this.contextKeyService),this._showErrors=b.ShowErrorsFilterContextKey.bindTo(this.contextKeyService),this._showInfos=b.ShowInfoFilterContextKey.bindTo(this.contextKeyService),this._showErrors.set(e.showErrors),this._showWarnings.set(e.showWarnings),this._showInfos.set(e.showInfos),this._excludedFiles.set(e.excludedFiles),this._activeFile.set(e.activeFile),this.filterHistory=e.filterHistory}get excludedFiles(){return!!this._excludedFiles.get()}set excludedFiles(e){this._excludedFiles.get()!==e&&(this._excludedFiles.set(e),this._onDidChange.fire({excludedFiles:!0}))}get activeFile(){return!!this._activeFile.get()}set activeFile(e){this._activeFile.get()!==e&&(this._activeFile.set(e),this._onDidChange.fire({activeFile:!0}))}get showWarnings(){return!!this._showWarnings.get()}set showWarnings(e){this._showWarnings.get()!==e&&(this._showWarnings.set(e),this._onDidChange.fire({showWarnings:!0}))}get showErrors(){return!!this._showErrors.get()}set showErrors(e){this._showErrors.get()!==e&&(this._showErrors.set(e),this._onDidChange.fire({showErrors:!0}))}get showInfos(){return!!this._showInfos.get()}set showInfos(e){this._showInfos.get()!==e&&(this._showInfos.set(e),this._onDidChange.fire({showInfos:!0}))}}class L extends ve{get quickFixes(){return this._quickFixes}set quickFixes(e){this._quickFixes=e,this.enabled=this._quickFixes.length>0}autoFixable(e){this.class=e?L.AUTO_FIX_CLASS:L.CLASS}constructor(e){super(L.ID,k.MARKERS_PANEL_ACTION_TOOLTIP_QUICKFIX,L.CLASS,!1),this.marker=e,this._onShowQuickFixes=this._register(new H),this.onShowQuickFixes=this._onShowQuickFixes.event,this._quickFixes=[]}run(){return this._onShowQuickFixes.fire(),Promise.resolve()}}L.ID="workbench.actions.problems.quickfix";L.CLASS="markers-panel-action-quickfix "+Ae.asClassName(O.lightBulb);L.AUTO_FIX_CLASS=L.CLASS+" autofixable";let ne=class extends xe{constructor(e,t){super(null,e,{icon:!0,label:!1}),this.contextMenuService=t}onClick(e){Mt.stop(e,!0),this.showQuickFixes()}showQuickFixes(){if(!this.element||!this.isEnabled())return;const e=St(this.element),t=this.action.quickFixes;t.length&&this.contextMenuService.showContextMenu({getAnchor:()=>({x:e.left+10,y:e.top+e.height+4}),getActions:()=>t})}};ne=x([h(1,je)],ne);class Ue{constructor(e,t,r){this.globalExpression=Ve(e),this.expressionsByRoot=xt.forUris(s=>r.extUri.ignorePathCasing(s));for(const s of t)this.expressionsByRoot.set(s.root,{root:s.root,expression:Ve(s.expression)})}matches(e){const t=this.expressionsByRoot.findSubstr(e);if(t){const r=Ft(t.root,e);if(r&&t.expression(r))return!0}return!!this.globalExpression(e.path)}}class R{static EMPTY(e){return new R("",[],!1,!1,!1,e)}constructor(e,t,r,s,n,a){this.filter=e,this.showWarnings=!1,this.showErrors=!1,this.showInfos=!1,e=e.trim(),this.showWarnings=r,this.showErrors=s,this.showInfos=n;const c=Array.isArray(t)?t:[],m=Array.isArray(t)?Ne():t;for(const{expression:S}of c)for(const M of Object.keys(S))M.endsWith("/**")||(S[`${It(M,"/")}/**`]=S[M]);const g=e.startsWith("!");this.textFilter={text:(g?Pe(e,"!"):e).trim(),negate:g};const E=Ne();if(e){const S=Rt(e,",").map(M=>M.trim()).filter(M=>!!M.length);for(const M of S)if(M.startsWith("!")){const f=Pe(M,"!");f&&this.setPattern(m,f)}else this.setPattern(E,M)}this.excludesMatcher=new Ue(m,c,a),this.includesMatcher=new Ue(E,[],a)}setPattern(e,t){t[0]==="."&&(t="*"+t),e[`**/${t}/**`]=!0,e[`**/${t}`]=!0}}R._filter=At;R._messageFilter=vt;let me=class{constructor(e){this.labelService=e}getWidgetAriaLabel(){return o("problemsView","Problems View")}getAriaLabel(e){if(e instanceof y){const t=this.labelService.getUriLabel(e.resource,{relative:!0})||e.resource.fsPath;return k.MARKERS_TREE_ARIA_LABEL_RESOURCE(e.markers.length,e.name,Tt(t))}return e instanceof w||e instanceof N?k.MARKERS_TREE_ARIA_LABEL_MARKER(e):e instanceof U?k.MARKERS_TREE_ARIA_LABEL_RELATED_INFORMATION(e.raw):null}};me=x([h(0,J)],me);class q{constructor(e){this.markersViewState=e}getHeight(e){if(e instanceof w){const t=this.markersViewState.getViewModel(e);return(!t||t.multiline?e.lines.length:1)*q.LINE_HEIGHT}return q.LINE_HEIGHT}getTemplateId(e){return e instanceof y?"rm":e instanceof w?"m":"ri"}}q.LINE_HEIGHT=22;let ge=class{constructor(e,t,r,s){this.labels=e,this.labelService=r,this.fileService=s,this.renderedNodes=new Map,this.disposables=new se,this.templateId="rm",t(this.onDidChangeRenderNodeCount,this,this.disposables)}renderTemplate(e){const t=u(e,p(".resource-label-container")),r=this.labels.create(t,{supportHighlights:!0}),s=u(e,p(".count-badge-wrapper"));return{count:new Pt(s,{},Vt),resourceLabel:r}}renderElement(e,t,r){const s=e.element,n=e.filterData&&e.filterData.uriMatches||[];this.fileService.hasProvider(s.resource)||s.resource.scheme===Nt.untitled?r.resourceLabel.setFile(s.resource,{matches:n}):r.resourceLabel.setResource({name:s.name,description:this.labelService.getUriLabel(Ot(s.resource),{relative:!0}),resource:s.resource},{matches:n}),this.updateCount(e,r),this.renderedNodes.set(e,r)}disposeElement(e){this.renderedNodes.delete(e)}disposeTemplate(e){e.resourceLabel.dispose()}onDidChangeRenderNodeCount(e){const t=this.renderedNodes.get(e);t&&this.updateCount(e,t)}updateCount(e,t){t.count.setCount(e.children.reduce((r,s)=>r+(s.visible?1:0),0))}dispose(){this.disposables.dispose()}};ge=x([h(2,J),h(3,Lt)],ge);let pe=class{constructor(e,t,r){this.markersViewState=e,this.instantiationService=t,this.openerService=r,this.templateId="m"}renderTemplate(e){const t=Object.create(null);return t.markerWidget=new Fr(e,this.markersViewState,this.openerService,this.instantiationService),t}renderElement(e,t,r){r.markerWidget.render(e.element,e.filterData)}disposeTemplate(e){e.markerWidget.dispose()}};pe=x([h(1,K),h(2,Fe)],pe);const ut=Le("markers-view-multi-line-expanded",O.chevronUp,o("expandedIcon","Icon indicating that multiple lines are shown in the markers view.")),vr=Le("markers-view-multi-line-collapsed",O.chevronDown,o("collapsedIcon","Icon indicating that multiple lines are collapsed in the markers view.")),He="problems.action.toggleMultiline";class xr extends xe{render(e){super.render(e),this.updateExpandedAttribute()}updateClass(){super.updateClass(),this.updateExpandedAttribute()}updateExpandedAttribute(){var e;(e=this.element)==null||e.setAttribute("aria-expanded",`${this._action.class===Ae.asClassName(ut)}`)}}class Fr extends D{constructor(e,t,r,s){super(),this.parent=e,this.markersViewModel=t,this._openerService=r,this.disposables=this._register(new se),this.actionBar=this._register(new de(u(e,p(".actions")),{actionViewItemProvider:n=>n.id===L.ID?s.createInstance(ne,n):void 0})),this.iconContainer=u(e,p("")),this.icon=u(this.iconContainer,p("")),this.messageAndDetailsContainer=u(e,p(".marker-message-details-container"))}render(e,t){this.actionBar.clear(),this.disposables.clear(),Xe(this.messageAndDetailsContainer),this.iconContainer.className=`marker-icon ${Ze.toString(_.toSeverity(e.marker.severity))}`,this.icon.className=`codicon ${Je.className(_.toSeverity(e.marker.severity))}`,this.renderQuickfixActionbar(e),this.renderMessageAndDetails(e,t),this.disposables.add(ue(this.parent,ie.MOUSE_OVER,()=>this.markersViewModel.onMarkerMouseHover(e))),this.disposables.add(ue(this.parent,ie.MOUSE_LEAVE,()=>this.markersViewModel.onMarkerMouseLeave(e)))}renderQuickfixActionbar(e){const t=this.markersViewModel.getViewModel(e);if(t){const r=t.quickFixAction;this.actionBar.push([r],{icon:!0,label:!1}),this.iconContainer.classList.toggle("quickFix",r.enabled),r.onDidChange(({enabled:s})=>{et(s)||this.iconContainer.classList.toggle("quickFix",s)},this,this.disposables),r.onShowQuickFixes(()=>{const s=this.actionBar.viewItems[0];s&&s.showQuickFixes()},this,this.disposables)}}renderMultilineActionbar(e,t){const r=this.disposables.add(new de(u(t,p(".multiline-actions")),{actionViewItemProvider:c=>{if(c.id===He)return new xr(void 0,c,{icon:!0})}}));this.disposables.add(B(()=>r.dispose()));const s=this.markersViewModel.getViewModel(e),n=s&&s.multiline,a=new ve(He);a.enabled=!!s&&e.lines.length>1,a.tooltip=n?o("single line","Show message in single line"):o("multi line","Show message in multiple lines"),a.class=Ae.asClassName(n?ut:vr),a.run=()=>(s&&(s.multiline=!s.multiline),Promise.resolve()),r.push([a],{icon:!0,label:!1})}renderMessageAndDetails(e,t){const{marker:r,lines:s}=e,n=this.markersViewModel.getViewModel(e),a=!n||n.multiline,c=t&&t.lineMatches||[];this.messageAndDetailsContainer.title=e.marker.message;const m=[];for(let g=0;g<(a?s.length:1);g++){const E=u(this.messageAndDetailsContainer,p(".marker-message-line")),S=u(E,p(".marker-message"));new F(S).set(s[g].length>1e3?`${s[g].substring(0,1e3)}...`:s[g],c[g]),s[g]===""&&(E.style.height=`${q.LINE_HEIGHT}px`),m.push(E)}this.renderDetails(r,t,m[0]),this.renderMultilineActionbar(e,m[0])}renderDetails(e,t,r){if(r.classList.add("details-container"),e.source||e.code){const n=new F(u(r,p(".marker-source"))),a=t&&t.sourceMatches||[];if(n.set(e.source,a),e.code)if(typeof e.code=="string"){const c=new F(u(r,p(".marker-code"))),m=t&&t.codeMatches||[];c.set(e.code,m)}else{const c=p(".marker-code"),m=new F(c),g=e.code.target.toString(!0);this.disposables.add(new tt(r,{href:g,label:c,title:g},void 0,this._openerService));const E=t&&t.codeMatches||[];m.set(e.code.value,E)}}const s=u(r,p("span.marker-line"));s.textContent=k.MARKERS_PANEL_AT_LINE_COL_NUMBER(e.startLineNumber,e.startColumn)}}let fe=class{constructor(e){this.labelService=e,this.templateId="ri"}renderTemplate(e){const t=Object.create(null);u(e,p(".actions")),u(e,p(".icon")),t.resourceLabel=new F(u(e,p(".related-info-resource"))),t.lnCol=u(e,p("span.marker-line"));const r=u(e,p("span.related-info-resource-separator"));return r.textContent=":",r.style.paddingRight="4px",t.description=new F(u(e,p(".marker-description"))),t}renderElement(e,t,r){const s=e.element.raw,n=e.filterData&&e.filterData.uriMatches||[],a=e.filterData&&e.filterData.messageMatches||[];r.resourceLabel.set(z(s.resource),n),r.resourceLabel.element.title=this.labelService.getUriLabel(s.resource,{relative:!0}),r.lnCol.textContent=k.MARKERS_PANEL_AT_LINE_COL_NUMBER(s.startLineNumber,s.startColumn),r.description.set(s.message,a),r.description.element.title=s.message}disposeTemplate(e){}};fe=x([h(0,J)],fe);class Lr{constructor(e){this.options=e}filter(e,t){return e instanceof y?this.filterResourceMarkers(e):e instanceof w?this.filterMarker(e,t):this.filterRelatedInformation(e,t)}filterResourceMarkers(e){if(Re.has(e.resource.scheme)||this.options.excludesMatcher.matches(e.resource))return!1;if(this.options.includesMatcher.matches(e.resource))return!0;if(this.options.textFilter.text&&!this.options.textFilter.negate){const t=R._filter(this.options.textFilter.text,z(e.resource));if(t)return{visibility:!0,data:{type:0,uriMatches:t||[]}}}return 2}filterMarker(e,t){if(!(this.options.showErrors&&_.Error===e.marker.severity||this.options.showWarnings&&_.Warning===e.marker.severity||this.options.showInfos&&_.Info===e.marker.severity))return!1;if(!this.options.textFilter.text)return!0;const s=[];for(const m of e.lines){const g=R._messageFilter(this.options.textFilter.text,m);s.push(g||[])}const n=e.marker.source?R._filter(this.options.textFilter.text,e.marker.source):void 0,a=e.marker.code?R._filter(this.options.textFilter.text,typeof e.marker.code=="string"?e.marker.code:e.marker.code.value):void 0,c=n||a||s.some(m=>m.length>0);return c&&!this.options.textFilter.negate?{visibility:!0,data:{type:1,lineMatches:s,sourceMatches:n||[],codeMatches:a||[]}}:c&&this.options.textFilter.negate&&t===2?!1:!c&&this.options.textFilter.negate&&t===2?!0:t}filterRelatedInformation(e,t){if(!this.options.textFilter.text)return!0;const r=R._filter(this.options.textFilter.text,z(e.raw.resource)),s=R._messageFilter(this.options.textFilter.text,$t(e.raw.message)),n=r||s;return n&&!this.options.textFilter.negate?{visibility:!0,data:{type:2,uriMatches:r||[],messageMatches:s||[]}}:n&&this.options.textFilter.negate&&t===2?!1:!n&&this.options.textFilter.negate&&t===2?!0:t}}let ke=class extends D{constructor(e,t,r,s,n){super(),this.marker=e,this.modelService=t,this.instantiationService=r,this.editorService=s,this.languageFeaturesService=n,this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,this.modelPromise=null,this.codeActionsPromise=null,this._multiline=!0,this._quickFixAction=null,this._register(B(()=>{this.modelPromise&&this.modelPromise.cancel(),this.codeActionsPromise&&this.codeActionsPromise.cancel()}))}get multiline(){return this._multiline}set multiline(e){this._multiline!==e&&(this._multiline=e,this._onDidChange.fire())}get quickFixAction(){return this._quickFixAction||(this._quickFixAction=this._register(this.instantiationService.createInstance(L,this.marker))),this._quickFixAction}showLightBulb(){this.setQuickFixes(!0)}async setQuickFixes(e){const t=await this.getCodeActions(e);this.quickFixAction.quickFixes=t?this.toActions(t):[],this.quickFixAction.autoFixable(!!t&&t.hasAutoFix)}getCodeActions(e){return this.codeActionsPromise!==null?this.codeActionsPromise:this.getModel(e).then(t=>t?(this.codeActionsPromise||(this.codeActionsPromise=Oe(r=>Dt(this.languageFeaturesService.codeActionProvider,t,new Ie(this.marker.range.startLineNumber,this.marker.range.startColumn,this.marker.range.endLineNumber,this.marker.range.endColumn),{type:1,triggerAction:Wt.ProblemsView,filter:{include:Bt.QuickFix}},Kt.None,r).then(s=>this._register(s)))),this.codeActionsPromise):null)}toActions(e){return e.validActions.map(t=>new ve(t.action.command?t.action.command.id:t.action.title,t.action.title,void 0,!0,()=>this.openFileAtMarker(this.marker).then(()=>this.instantiationService.invokeFunction(Ut,t,Ht.FromProblemsView))))}openFileAtMarker(e){const{resource:t,selection:r}={resource:e.resource,selection:e.range};return this.editorService.openEditor({resource:t,options:{selection:r,preserveFocus:!0,pinned:!1,revealIfVisible:!0}},rt).then(()=>{})}getModel(e){const t=this.modelService.getModel(this.marker.resource);return t?Promise.resolve(t):e?(this.modelPromise||(this.modelPromise=Oe(r=>new Promise(s=>{this._register(this.modelService.onModelAdded(n=>{qt(n.uri,this.marker.resource)&&s(n)}))}))),this.modelPromise):Promise.resolve(null)}};ke=x([h(1,Ct),h(2,K),h(3,Ye),h(4,yt)],ke);let be=class extends D{constructor(e=!0,t="tree",r,s){super(),this.contextKeyService=r,this.instantiationService=s,this._onDidChange=this._register(new H),this.onDidChange=this._onDidChange.event,this._onDidChangeViewMode=this._register(new H),this.onDidChangeViewMode=this._onDidChangeViewMode.event,this.markersViewStates=new Map,this.markersPerResource=new Map,this.bulkUpdate=!1,this.hoveredMarker=null,this.hoverDelayer=new Gt(300),this._multiline=!0,this._viewMode="tree",this._multiline=e,this._viewMode=t,this.viewModeContextKey=b.MarkersViewModeContextKey.bindTo(this.contextKeyService),this.viewModeContextKey.set(t)}add(e){if(!this.markersViewStates.has(e.id)){const t=this.instantiationService.createInstance(ke,e),r=[t];t.multiline=this.multiline,t.onDidChange(()=>{this.bulkUpdate||this._onDidChange.fire(e)},this,r),this.markersViewStates.set(e.id,{viewModel:t,disposables:r});const s=this.markersPerResource.get(e.resource.toString())||[];s.push(e),this.markersPerResource.set(e.resource.toString(),s)}}remove(e){const t=this.markersPerResource.get(e.toString())||[];for(const r of t){const s=this.markersViewStates.get(r.id);s&&De(s.disposables),this.markersViewStates.delete(r.id),this.hoveredMarker===r&&(this.hoveredMarker=null)}this.markersPerResource.delete(e.toString())}getViewModel(e){const t=this.markersViewStates.get(e.id);return t?t.viewModel:null}onMarkerMouseHover(e){this.hoveredMarker=e,this.hoverDelayer.trigger(()=>{if(this.hoveredMarker){const t=this.getViewModel(this.hoveredMarker);t&&t.showLightBulb()}})}onMarkerMouseLeave(e){this.hoveredMarker===e&&(this.hoveredMarker=null)}get multiline(){return this._multiline}set multiline(e){let t=!1;this._multiline!==e&&(this._multiline=e,t=!0),this.bulkUpdate=!0,this.markersViewStates.forEach(({viewModel:r})=>{r.multiline!==e&&(r.multiline=e,t=!0)}),this.bulkUpdate=!1,t&&this._onDidChange.fire(void 0)}get viewMode(){return this._viewMode}set viewMode(e){this._viewMode!==e&&(this._viewMode=e,this._onDidChangeViewMode.fire(e),this.viewModeContextKey.set(e))}dispose(){this.markersViewStates.forEach(({disposables:e})=>De(e)),this.markersViewStates.clear(),this.markersPerResource.clear(),super.dispose()}};be=x([h(2,Ce),h(3,K)],be);const V=p;let Q=class mt{constructor(e,t){this.markersViewModel=e,this.instantiationService=t,this.templateId=mt.TEMPLATE_ID}renderTemplate(e){const t=u(e,V(".severity")),r=u(t,V("")),s=u(e,V(".actions"));return{actionBar:new de(s,{actionViewItemProvider:a=>a.id===L.ID?this.instantiationService.createInstance(ne,a):void 0,animated:!1}),icon:r}}renderElement(e,t,r,s){const n=c=>{et(c)||st(r.icon,"monaco-table-td").classList.toggle("quickFix",c)};r.icon.title=_.toString(e.marker.severity),r.icon.className=`marker-icon ${Ze.toString(_.toSeverity(e.marker.severity))} codicon ${Je.className(_.toSeverity(e.marker.severity))}`,r.actionBar.clear();const a=this.markersViewModel.getViewModel(e);if(a){const c=a.quickFixAction;r.actionBar.push([c],{icon:!0,label:!1}),n(a.quickFixAction.enabled),c.onDidChange(({enabled:m})=>n(m)),c.onShowQuickFixes(()=>{const m=r.actionBar.viewItems[0];m&&m.showQuickFixes()})}}disposeTemplate(e){}};Q.TEMPLATE_ID="severity";Q=x([h(1,K)],Q);let j=class gt{constructor(e){this.openerService=e,this.templateId=gt.TEMPLATE_ID}renderTemplate(e){const t=u(e,V(".code")),r=new F(t);r.element.classList.add("source-label");const s=new F(t);s.element.classList.add("code-label");const n=new tt(t,{href:"",label:""},{},this.openerService);return{codeColumn:t,sourceLabel:r,codeLabel:s,codeLink:n}}renderElement(e,t,r,s){if(r.codeColumn.classList.remove("code-label"),r.codeColumn.classList.remove("code-link"),e.marker.source&&e.marker.code)if(typeof e.marker.code=="string")r.codeColumn.classList.add("code-label"),r.codeColumn.title=`${e.marker.source} (${e.marker.code})`,r.sourceLabel.set(e.marker.source,e.sourceMatches),r.codeLabel.set(e.marker.code,e.codeMatches);else{r.codeColumn.classList.add("code-link"),r.codeColumn.title=`${e.marker.source} (${e.marker.code.value})`,r.sourceLabel.set(e.marker.source,e.sourceMatches);const n=new F(V(".code-link-label"));n.set(e.marker.code.value,e.codeMatches),r.codeLink.link={href:e.marker.code.target.toString(),title:e.marker.code.target.toString(),label:n.element}}else r.codeColumn.title="",r.sourceLabel.set("-")}disposeTemplate(e){}};j.TEMPLATE_ID="code";j=x([h(0,Fe)],j);class Y{constructor(){this.templateId=Y.TEMPLATE_ID}renderTemplate(e){const t=u(e,V(".message")),r=new F(t);return{columnElement:t,highlightedLabel:r}}renderElement(e,t,r,s){r.columnElement.title=e.marker.message,r.highlightedLabel.set(e.marker.message,e.messageMatches)}disposeTemplate(e){}}Y.TEMPLATE_ID="message";let X=class pt{constructor(e){this.labelService=e,this.templateId=pt.TEMPLATE_ID}renderTemplate(e){const t=u(e,V(".file")),r=new F(t);r.element.classList.add("file-label");const s=new F(t);return s.element.classList.add("file-position"),{columnElement:t,fileLabel:r,positionLabel:s}}renderElement(e,t,r,s){const n=k.MARKERS_PANEL_AT_LINE_COL_NUMBER(e.marker.startLineNumber,e.marker.startColumn);r.columnElement.title=`${this.labelService.getUriLabel(e.marker.resource,{relative:!1})} ${n}`,r.fileLabel.set(this.labelService.getUriLabel(e.marker.resource,{relative:!0}),e.fileMatches),r.positionLabel.set(n,void 0)}disposeTemplate(e){}};X.TEMPLATE_ID="file";X=x([h(0,J)],X);class Z{constructor(){this.templateId=Z.TEMPLATE_ID}renderTemplate(e){const t=u(e,V(".owner")),r=new F(t);return{columnElement:t,highlightedLabel:r}}renderElement(e,t,r,s){r.columnElement.title=e.marker.owner,r.highlightedLabel.set(e.marker.owner,e.ownerMatches)}disposeTemplate(e){}}Z.TEMPLATE_ID="owner";class G{constructor(){this.headerRowHeight=G.HEADER_ROW_HEIGHT}getHeight(e){return G.ROW_HEIGHT}}G.HEADER_ROW_HEIGHT=24;G.ROW_HEIGHT=24;let we=class extends D{constructor(e,t,r,s,n,a,c){super(),this.container=e,this.markersViewModel=t,this.resourceMarkers=r,this.filterOptions=s,this.instantiationService=a,this.labelService=c,this._itemCount=0,this.table=this.instantiationService.createInstance(zt,"Markers",this.container,new G,[{label:"",tooltip:"",weight:0,minimumWidth:36,maximumWidth:36,templateId:Q.TEMPLATE_ID,project(f){return f}},{label:o("codeColumnLabel","Code"),tooltip:"",weight:1,minimumWidth:100,maximumWidth:300,templateId:j.TEMPLATE_ID,project(f){return f}},{label:o("messageColumnLabel","Message"),tooltip:"",weight:4,templateId:Y.TEMPLATE_ID,project(f){return f}},{label:o("fileColumnLabel","File"),tooltip:"",weight:2,templateId:X.TEMPLATE_ID,project(f){return f}},{label:o("sourceColumnLabel","Source"),tooltip:"",weight:1,minimumWidth:100,maximumWidth:300,templateId:Z.TEMPLATE_ID,project(f){return f}}],[this.instantiationService.createInstance(Q,this.markersViewModel),this.instantiationService.createInstance(j),this.instantiationService.createInstance(Y),this.instantiationService.createInstance(X),this.instantiationService.createInstance(Z)],n);const m=this.table.domNode.querySelector(".monaco-list-rows"),g=T.chain(this._register(new Ke(m,"mouseover")).event).map(f=>st(f.target,"monaco-list-row","monaco-list-rows")).filter(f=>!!f).map(f=>parseInt(f.getAttribute("data-index"))).event,E=T.map(this._register(new Ke(m,"mouseleave")).event,()=>-1),S=T.latch(T.any(g,E)),M=T.debounce(S,(f,C)=>C,500);this._register(M(f=>{f!==-1&&this.table.row(f)&&this.markersViewModel.onMarkerMouseHover(this.table.row(f))}))}get contextKeyService(){return this.table.contextKeyService}get onContextMenu(){return this.table.onContextMenu}get onDidOpen(){return this.table.onDidOpen}get onDidChangeFocus(){return this.table.onDidChangeFocus}get onDidChangeSelection(){return this.table.onDidChangeSelection}collapseMarkers(){}domFocus(){this.table.domFocus()}filterMarkers(e,t){this.filterOptions=t,this.reset(e)}getFocus(){const e=this.table.getFocus();return e.length>0?[...e.map(t=>this.table.row(t))]:[]}getHTMLElement(){return this.table.getHTMLElement()}getRelativeTop(e){return e?this.table.getRelativeTop(this.table.indexOf(e)):null}getSelection(){const e=this.table.getSelection();return e.length>0?[...e.map(t=>this.table.row(t))]:[]}getVisibleItemCount(){return this._itemCount}isVisible(){return!this.container.classList.contains("hidden")}layout(e,t){this.container.style.height=`${e}px`,this.table.layout(e,t)}reset(e){this.resourceMarkers=e;const t=[];for(const r of this.resourceMarkers)for(const s of r.markers){if(Re.has(s.resource.scheme)||this.filterOptions.excludesMatcher.matches(s.resource))continue;if(this.filterOptions.includesMatcher.matches(s.resource)){t.push(new N(s));continue}if(this.filterOptions.showErrors&&_.Error===s.marker.severity||this.filterOptions.showWarnings&&_.Warning===s.marker.severity||this.filterOptions.showInfos&&_.Info===s.marker.severity){if(this.filterOptions.textFilter.text){const a=s.marker.source?R._filter(this.filterOptions.textFilter.text,s.marker.source)??void 0:void 0,c=s.marker.code?R._filter(this.filterOptions.textFilter.text,typeof s.marker.code=="string"?s.marker.code:s.marker.code.value)??void 0:void 0,m=R._messageFilter(this.filterOptions.textFilter.text,s.marker.message)??void 0,g=R._messageFilter(this.filterOptions.textFilter.text,this.labelService.getUriLabel(s.resource,{relative:!0}))??void 0,E=R._messageFilter(this.filterOptions.textFilter.text,s.marker.owner)??void 0,S=a||c||m||g||E;(S&&!this.filterOptions.textFilter.negate||!S&&this.filterOptions.textFilter.negate)&&t.push(new N(s,a,c,m,g,E));continue}t.push(new N(s))}}this._itemCount=t.length,this.table.splice(0,Number.POSITIVE_INFINITY,t.sort((r,s)=>{let n=_.compare(r.marker.severity,s.marker.severity);return n===0&&(n=dt(r.marker,s.marker)),n===0&&(n=Ie.compareRangesUsingStarts(r.marker,s.marker)),n}))}revealMarkers(e,t,r){if(e){const s=this.resourceMarkers.indexOf(e);if(s!==-1)if(this.hasSelectedMarkerFor(e)){const n=this.table.getSelection();this.table.reveal(n[0],r),t&&this.table.setFocus(n)}else this.table.reveal(s,0),t&&(this.table.setFocus([s]),this.table.setSelection([s]))}else t&&(this.table.setSelection([]),this.table.focusFirst())}setAriaLabel(e){this.table.domNode.ariaLabel=e}setMarkerSelection(e,t){this.isVisible()&&(e&&e.length>0?(this.table.setSelection(e.map(r=>this.findMarkerIndex(r))),t&&t.length>0?this.table.setFocus(t.map(r=>this.findMarkerIndex(r))):this.table.setFocus([this.findMarkerIndex(e[0])]),this.table.reveal(this.findMarkerIndex(e[0]))):this.getSelection().length===0&&this.getVisibleItemCount()>0&&(this.table.setSelection([0]),this.table.setFocus([0]),this.table.reveal(0)))}toggleVisibility(e){this.container.classList.toggle("hidden",e)}update(e){for(const t of e){const r=this.resourceMarkers.indexOf(t);this.resourceMarkers.splice(r,1,t)}this.reset(this.resourceMarkers)}updateMarker(e){this.table.rerender()}findMarkerIndex(e){for(let t=0;t<this.table.length;t++)if(this.table.row(t).marker===e.marker)return t;return-1}hasSelectedMarkerFor(e){const t=this.getSelection();return!!(t&&t.length>0&&t[0]instanceof w&&e.has(t[0].marker.resource))}};we=x([h(5,K),h(6,J)],we);function qe(i){return te.map(i.markers,e=>{const t=te.from(e.relatedInformation),r=te.map(t,s=>({element:s}));return{element:e,children:r}})}let Ee=class extends tr{constructor(e,t,r,s,n,a,c,m,g,E,S,M,f,C,le){const ce=new rr(l.MARKERS_VIEW_STORAGE_ID,f).getMemento(1,1);super({...e,filterOptions:{ariaLabel:k.MARKERS_PANEL_FILTER_ARIA_LABEL,placeholder:k.MARKERS_PANEL_FILTER_PLACEHOLDER,focusContextKey:b.MarkerViewFilterFocusContextKey.key,text:ce.filter||"",history:ce.filterHistory||[]}},M,E,n,m,r,t,C,le,a),this.editorService=s,this.markerService=c,this.workspaceContextService=g,this.uriIdentityService=S,this.lastSelectedRelativeTop=0,this.currentActiveResource=null,this.onVisibleDisposables=this._register(new se),this.widgetDisposables=this._register(new se),this.currentHeight=0,this.currentWidth=0,this.cachedFilterStats=void 0,this.currentResourceGotAddedToMarkersData=!1,this.onDidChangeVisibility=this.onDidChangeBodyVisibility,this.panelState=ce,this.markersModel=this._register(t.createInstance(Sr)),this.markersViewModel=this._register(t.createInstance(be,this.panelState.multiline,this.panelState.viewMode??this.getDefaultViewMode())),this._register(this.onDidChangeVisibility(W=>this.onDidChangeMarkersViewVisibility(W))),this._register(this.markersViewModel.onDidChangeViewMode(W=>this.onDidChangeViewMode())),this.widgetAccessibilityProvider=t.createInstance(me),this.widgetIdentityProvider={getId(W){return W.id}},this.setCurrentActiveEditor(),this.filter=new Lr(R.EMPTY(S)),this.rangeHighlightDecorations=this._register(this.instantiationService.createInstance(_r)),this.filters=this._register(new Ar({filterHistory:this.panelState.filterHistory||[],showErrors:this.panelState.showErrors!==!1,showWarnings:this.panelState.showWarnings!==!1,showInfos:this.panelState.showInfos!==!1,excludedFiles:!!this.panelState.useFilesExclude,activeFile:!!this.panelState.activeFile},this.contextKeyService)),this._register(this.configurationService.onDidChangeConfiguration(W=>{this.filters.excludedFiles&&W.affectsConfiguration("files.exclude")&&this.updateFilter()}))}renderBody(e){super.renderBody(e),e.classList.add("markers-panel"),this._register(ue(e,"keydown",r=>{this.keybindingService.mightProducePrintableCharacter(new sr(r))&&this.focusFilter()}));const t=u(e,p(".markers-panel-container"));this.createArialLabelElement(t),this.createMessageBox(t),this.widgetContainer=u(t,p(".widget-container")),this.createWidget(this.widgetContainer),this.updateFilter(),this.renderContent()}getTitle(){return k.MARKERS_PANEL_TITLE_PROBLEMS}layoutBodyContent(e=this.currentHeight,t=this.currentWidth){this.messageBoxContainer&&(this.messageBoxContainer.style.height=`${e}px`),this.widget.layout(e,t),this.currentHeight=e,this.currentWidth=t}focus(){this.widget.getHTMLElement()!==document.activeElement&&(this.hasNoProblems()?this.messageBoxContainer.focus():(this.widget.domFocus(),this.widget.setMarkerSelection()))}focusFilter(){this.filterWidget.focus()}updateBadge(e,t){this.filterWidget.updateBadge(e===t||e===0?void 0:o("showing filtered problems","Showing {0} of {1}",t,e))}checkMoreFilters(){this.filterWidget.checkMoreFilters(!this.filters.showErrors||!this.filters.showWarnings||!this.filters.showInfos||this.filters.excludedFiles||this.filters.activeFile)}clearFilterText(){this.filterWidget.setFilterText("")}showQuickFixes(e){const t=this.markersViewModel.getViewModel(e);t&&t.quickFixAction.run()}openFileAtElement(e,t,r,s){const{resource:n,selection:a}=e instanceof w?{resource:e.resource,selection:e.range}:e instanceof U?{resource:e.raw.resource,selection:e.raw}:"marker"in e?{resource:e.marker.resource,selection:e.marker.range}:{resource:null,selection:null};return n&&a?(this.editorService.openEditor({resource:n,options:{selection:a,preserveFocus:t,pinned:s,revealIfVisible:!0}},r?ir:rt).then(c=>{c&&t?this.rangeHighlightDecorations.highlightRange({resource:n,range:a},c.getControl()):this.rangeHighlightDecorations.removeHighlightRange()}),!0):(this.rangeHighlightDecorations.removeHighlightRange(),!1)}refreshPanel(e){if(this.isVisible()){const t=this.widget.getSelection().length>0;e?e instanceof w?this.widget.updateMarker(e):e.added.size||e.removed.size?this.resetWidget():this.widget.update([...e.updated]):this.resetWidget(),t&&this.widget.setMarkerSelection(),this.cachedFilterStats=void 0;const{total:r,filtered:s}=this.getFilterStats();this.toggleVisibility(r===0||s===0),this.renderMessage(),this.updateBadge(r,s),this.checkMoreFilters()}}onDidChangeViewState(e){this.refreshPanel(e)}resetWidget(){this.widget.reset(this.getResourceMarkers())}updateFilter(){this.filter.options=new R(this.filterWidget.getFilterText(),this.getFilesExcludeExpressions(),this.filters.showWarnings,this.filters.showErrors,this.filters.showInfos,this.uriIdentityService),this.widget.filterMarkers(this.getResourceMarkers(),this.filter.options),this.cachedFilterStats=void 0;const{total:e,filtered:t}=this.getFilterStats();this.toggleVisibility(e===0||t===0),this.renderMessage(),this.updateBadge(e,t),this.checkMoreFilters()}getDefaultViewMode(){switch(this.configurationService.getValue("problems.defaultViewMode")){case"table":return"table";case"tree":return"tree";default:return"tree"}}getFilesExcludeExpressions(){if(!this.filters.excludedFiles)return[];const e=this.workspaceContextService.getWorkspace().folders;return e.length?e.map(t=>({root:t.uri,expression:this.getFilesExclude(t.uri)})):this.getFilesExclude()}getFilesExclude(e){return nr(this.configurationService.getValue("files.exclude",{resource:e}))||{}}getResourceMarkers(){if(!this.filters.activeFile)return this.markersModel.resourceMarkers;let e=[];if(this.currentActiveResource){const t=this.markersModel.getResourceMarkers(this.currentActiveResource);t&&(e=[t])}return e}createMessageBox(e){this.messageBoxContainer=u(e,p(".message-box-container")),this.messageBoxContainer.setAttribute("aria-labelledby","markers-panel-arialabel")}createArialLabelElement(e){this.ariaLabelElement=u(e,p("")),this.ariaLabelElement.setAttribute("id","markers-panel-arialabel")}createWidget(e){this.widget=this.markersViewModel.viewMode==="table"?this.createTable(e):this.createTree(e),this.widgetDisposables.add(this.widget);const t=b.MarkerFocusContextKey.bindTo(this.widget.contextKeyService),r=b.RelatedInformationFocusContextKey.bindTo(this.widget.contextKeyService);this.widgetDisposables.add(this.widget.onDidChangeFocus(s=>{t.set(s.elements.some(n=>n instanceof w)),r.set(s.elements.some(n=>n instanceof U))})),this.widgetDisposables.add(T.debounce(this.widget.onDidOpen,(s,n)=>n,75,!0)(s=>{this.openFileAtElement(s.element,!!s.editorOptions.preserveFocus,s.sideBySide,!!s.editorOptions.pinned)})),this.widgetDisposables.add(T.any(this.widget.onDidChangeSelection,this.widget.onDidChangeFocus)(()=>{const s=[...this.widget.getSelection(),...this.widget.getFocus()];for(const n of s)if(n instanceof w){const a=this.markersViewModel.getViewModel(n);a==null||a.showLightBulb()}})),this.widgetDisposables.add(this.widget.onContextMenu(this.onContextMenu,this)),this.widgetDisposables.add(this.widget.onDidChangeSelection(this.onSelected,this))}createTable(e){return this.instantiationService.createInstance(we,u(e,p(".markers-table-container")),this.markersViewModel,this.getResourceMarkers(),this.filter.options,{accessibilityProvider:this.widgetAccessibilityProvider,dnd:this.instantiationService.createInstance(We,r=>r instanceof N?he(r.resource,r.range):null),horizontalScrolling:!1,identityProvider:this.widgetIdentityProvider,multipleSelectionSupport:!0,selectionNavigation:!0})}createTree(e){const t=new or,r=this.instantiationService.createInstance(ar,this),s=new q(this.markersViewModel),n=[this.instantiationService.createInstance(ge,r,t.event),this.instantiationService.createInstance(pe,this.markersViewModel),this.instantiationService.createInstance(fe)],a=this.instantiationService.createInstance(_e,"MarkersView",u(e,p(".tree-container.show-file-icons")),s,n,{filter:this.filter,accessibilityProvider:this.widgetAccessibilityProvider,identityProvider:this.widgetIdentityProvider,dnd:this.instantiationService.createInstance(We,c=>c instanceof y?c.resource:c instanceof w?he(c.resource,c.range):c instanceof U?he(c.raw.resource,c.raw):null),expandOnlyOnTwistieClick:c=>c instanceof w&&c.relatedInformation.length>0,overrideStyles:{listBackground:this.getBackgroundColor()},selectionNavigation:!0,multipleSelectionSupport:!0});return t.input=a.onDidChangeRenderNodeCount,a}collapseAll(){this.widget.collapseMarkers()}setMultiline(e){this.markersViewModel.multiline=e}setViewMode(e){this.markersViewModel.viewMode=e}onDidChangeMarkersViewVisibility(e){if(this.onVisibleDisposables.clear(),e){for(const t of this.reInitialize())this.onVisibleDisposables.add(t);this.refreshPanel()}}reInitialize(){const e=[],t=r=>this.markerService.read({resource:r,severities:_.Error|_.Warning|_.Info});return this.markersModel.setResourceMarkers(lr(t(),dt).map(r=>[r[0].resource,r])),e.push(T.debounce(this.markerService.onMarkerChanged,(r,s)=>(r=r||new Ge,s.forEach(n=>r.set(n,n)),r),64)(r=>{this.markersModel.setResourceMarkers([...r.values()].map(s=>[s,t(s)]))})),e.push(T.any(this.markersModel.onDidChange,this.editorService.onDidActiveEditorChange)(r=>{r?this.onDidChangeModel(r):this.onActiveEditorChanged()})),e.push(B(()=>this.markersModel.reset())),this.markersModel.resourceMarkers.forEach(r=>r.markers.forEach(s=>this.markersViewModel.add(s))),e.push(this.markersViewModel.onDidChange(r=>this.onDidChangeViewState(r))),e.push(B(()=>this.markersModel.resourceMarkers.forEach(r=>this.markersViewModel.remove(r.resource)))),e.push(this.filters.onDidChange(r=>{r.activeFile?this.refreshPanel():(r.excludedFiles||r.showWarnings||r.showErrors||r.showInfos)&&this.updateFilter()})),e.push(this.filterWidget.onDidChangeFilterText(r=>this.updateFilter())),e.push(B(()=>{this.cachedFilterStats=void 0})),e.push(B(()=>this.rangeHighlightDecorations.removeHighlightRange())),e}onDidChangeModel(e){const t=[...e.added,...e.removed,...e.updated],r=[];for(const{resource:s}of t){this.markersViewModel.remove(s);const n=this.markersModel.getResourceMarkers(s);if(n)for(const a of n.markers)this.markersViewModel.add(a);r.push(s)}this.currentResourceGotAddedToMarkersData=this.currentResourceGotAddedToMarkersData||this.isCurrentResourceGotAddedToMarkersData(r),this.refreshPanel(e),this.updateRangeHighlights(),this.currentResourceGotAddedToMarkersData&&(this.autoReveal(),this.currentResourceGotAddedToMarkersData=!1)}onDidChangeViewMode(){this.widgetContainer&&this.widget&&(this.widgetContainer.textContent="",this.widgetDisposables.clear());const e=new Set;for(const r of this.widget.getSelection())r instanceof y?r.markers.forEach(s=>e.add(s)):(r instanceof w||r instanceof N)&&e.add(r);const t=new Set;for(const r of this.widget.getFocus())(r instanceof w||r instanceof N)&&t.add(r);this.createWidget(this.widgetContainer),this.refreshPanel(),e.size>0&&(this.widget.setMarkerSelection(Array.from(e),Array.from(t)),this.widget.domFocus())}isCurrentResourceGotAddedToMarkersData(e){const t=this.currentActiveResource;return!t||this.getResourceForCurrentActiveResource()?!1:e.some(s=>s.toString()===t.toString())}onActiveEditorChanged(){this.setCurrentActiveEditor(),this.filters.activeFile&&this.refreshPanel(),this.autoReveal()}setCurrentActiveEditor(){const e=this.editorService.activeEditor;this.currentActiveResource=e?ze(cr.getOriginalUri(e,{supportSideBySide:hr.PRIMARY})):null}onSelected(){const e=this.widget.getSelection();e&&e.length>0&&(this.lastSelectedRelativeTop=this.widget.getRelativeTop(e[0])||0)}hasNoProblems(){const{total:e,filtered:t}=this.getFilterStats();return e===0||t===0}renderContent(){this.cachedFilterStats=void 0,this.resetWidget(),this.toggleVisibility(this.hasNoProblems()),this.renderMessage()}renderMessage(){if(!this.messageBoxContainer||!this.ariaLabelElement)return;Xe(this.messageBoxContainer);const{total:e,filtered:t}=this.getFilterStats();t===0?(this.messageBoxContainer.style.display="block",this.messageBoxContainer.setAttribute("tabIndex","0"),this.filters.activeFile?this.renderFilterMessageForActiveFile(this.messageBoxContainer):e>0?this.renderFilteredByFilterMessage(this.messageBoxContainer):this.renderNoProblemsMessage(this.messageBoxContainer)):(this.messageBoxContainer.style.display="none",t===e?this.setAriaLabel(o("No problems filtered","Showing {0} problems",e)):this.setAriaLabel(o("problems filtered","Showing {0} of {1} problems",t,e)),this.messageBoxContainer.removeAttribute("tabIndex"))}renderFilterMessageForActiveFile(e){this.currentActiveResource&&this.markersModel.getResourceMarkers(this.currentActiveResource)?this.renderFilteredByFilterMessage(e):this.renderNoProblemsMessageForActiveFile(e)}renderFilteredByFilterMessage(e){const t=u(e,p("span"));t.textContent=k.MARKERS_PANEL_NO_PROBLEMS_FILTERS;const r=u(e,p("a.messageAction"));r.textContent=o("clearFilter","Clear Filters"),r.setAttribute("tabIndex","0");const s=u(e,p("span"));s.textContent=".",Be(r,ie.CLICK,()=>this.clearFilters()),Be(r,ie.KEY_DOWN,n=>{(n.equals(3)||n.equals(10))&&(this.clearFilters(),n.stopPropagation())}),this.setAriaLabel(k.MARKERS_PANEL_NO_PROBLEMS_FILTERS)}renderNoProblemsMessageForActiveFile(e){const t=u(e,p("span"));t.textContent=k.MARKERS_PANEL_NO_PROBLEMS_ACTIVE_FILE_BUILT,this.setAriaLabel(k.MARKERS_PANEL_NO_PROBLEMS_ACTIVE_FILE_BUILT)}renderNoProblemsMessage(e){const t=u(e,p("span"));t.textContent=k.MARKERS_PANEL_NO_PROBLEMS_BUILT,this.setAriaLabel(k.MARKERS_PANEL_NO_PROBLEMS_BUILT)}setAriaLabel(e){this.widget.setAriaLabel(e),this.ariaLabelElement.setAttribute("aria-label",e)}clearFilters(){this.filterWidget.setFilterText(""),this.filters.excludedFiles=!1,this.filters.showErrors=!0,this.filters.showWarnings=!0,this.filters.showInfos=!0}autoReveal(e=!1){if(this.filters.activeFile)return;const t=this.configurationService.getValue("problems.autoReveal");if(typeof t=="boolean"&&t){const r=this.getResourceForCurrentActiveResource();this.widget.revealMarkers(r,e,this.lastSelectedRelativeTop)}}getResourceForCurrentActiveResource(){return this.currentActiveResource?this.markersModel.getResourceMarkers(this.currentActiveResource):null}updateRangeHighlights(){this.rangeHighlightDecorations.removeHighlightRange(),this.widget.getHTMLElement()===document.activeElement&&this.highlightCurrentSelectedMarkerRange()}highlightCurrentSelectedMarkerRange(){const e=this.widget.getSelection()??[];if(e.length!==1)return;const t=e[0];t instanceof w&&this.rangeHighlightDecorations.highlightRange(t)}onContextMenu(e){const t=e.element;t&&(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this.contextMenuService.showContextMenu({getAnchor:()=>e.anchor,menuId:P.ProblemsPanelContext,contextKeyService:this.widget.contextKeyService,getActions:()=>this.getMenuActions(t),getActionViewItem:r=>{const s=this.keybindingService.lookupKeybinding(r.id);if(s)return new xe(r,r,{label:!0,keybinding:s.getLabel()})},onHide:r=>{r&&this.widget.domFocus()}}))}getMenuActions(e){const t=[];if(e instanceof w){const r=this.markersViewModel.getViewModel(e);if(r){const s=r.quickFixAction.quickFixes;s.length&&(t.push(...s),t.push(new dr))}}return t}getFocusElement(){return this.widget.getFocus()[0]??void 0}getFocusedSelectedElements(){const e=this.getFocusElement();if(!e)return null;const t=this.widget.getSelection();if(t.includes(e)){const r=[];for(const s of t)s&&r.push(s);return r}else return[e]}getAllResourceMarkers(){return this.markersModel.resourceMarkers}getFilterStats(){var e;return this.cachedFilterStats||(this.cachedFilterStats={total:this.markersModel.total,filtered:((e=this.widget)==null?void 0:e.getVisibleItemCount())??0}),this.cachedFilterStats}toggleVisibility(e){this.widget.toggleVisibility(e),this.layoutBodyContent()}saveState(){this.panelState.filter=this.filterWidget.getFilterText(),this.panelState.filterHistory=this.filters.filterHistory,this.panelState.showErrors=this.filters.showErrors,this.panelState.showWarnings=this.filters.showWarnings,this.panelState.showInfos=this.filters.showInfos,this.panelState.useFilesExclude=this.filters.excludedFiles,this.panelState.activeFile=this.filters.activeFile,this.panelState.multiline=this.markersViewModel.multiline,this.panelState.viewMode=this.markersViewModel.viewMode,super.saveState()}dispose(){super.dispose()}};Ee=x([h(1,K),h(2,Qt),h(3,Ye),h(4,it),h(5,jt),h(6,ye),h(7,Ce),h(8,Yt),h(9,je),h(10,Xt),h(11,Zt),h(12,Jt),h(13,Fe),h(14,nt)],Ee);let _e=class extends ur{constructor(e,t,r,s,n,a,c,m,g,E){super(e,t,r,s,n,a,c,m,E),this.container=t,this.visibilityContextKey=b.MarkersTreeVisibilityContextKey.bindTo(c)}collapseMarkers(){this.collapseAll(),this.setSelection([]),this.setFocus([]),this.getHTMLElement().focus(),this.focusFirst()}filterMarkers(){this.refilter()}getVisibleItemCount(){let e=0;const t=this.getNode();for(const r of t.children)for(const s of r.children)r.visible&&s.visible&&e++;return e}isVisible(){return!this.container.classList.contains("hidden")}toggleVisibility(e){this.visibilityContextKey.set(!e),this.container.classList.toggle("hidden",e)}reset(e){this.setChildren(null,te.map(e,t=>({element:t,children:qe(t)})))}revealMarkers(e,t,r){e?this.hasElement(e)&&(!this.isCollapsed(e)&&this.hasSelectedMarkerFor(e)?(this.reveal(this.getSelection()[0],r),t&&this.setFocus(this.getSelection())):(this.expand(e),this.reveal(e,0),t&&(this.setFocus([e]),this.setSelection([e])))):t&&(this.setSelection([]),this.focusFirst())}setAriaLabel(e){this.ariaLabel=e}setMarkerSelection(e,t){if(this.isVisible()){if(e&&e.length>0)this.setSelection(e.map(r=>this.findMarkerNode(r))),t&&t.length>0?this.setFocus(t.map(r=>this.findMarkerNode(r))):this.setFocus([this.findMarkerNode(e[0])]),this.reveal(this.findMarkerNode(e[0]));else if(this.getSelection().length===0){const r=this.firstVisibleElement,s=r?r instanceof y?r.markers[0]:r instanceof w?r:void 0:void 0;s&&(this.setSelection([s]),this.setFocus([s]),this.reveal(s))}}}update(e){for(const t of e)this.setChildren(t,qe(t)),this.rerender(t)}updateMarker(e){this.rerender(e)}findMarkerNode(e){for(const t of this.getNode().children)for(const r of t.children)if(r.element instanceof w&&r.element.marker===e.marker)return r.element;return null}hasSelectedMarkerFor(e){const t=this.getSelection();return!!(t&&t.length>0&&t[0]instanceof w&&e.has(t[0].marker.resource))}dispose(){super.dispose()}layout(e,t){this.container.style.height=`${e}px`,super.layout(e,t)}};_e=x([h(5,K),h(6,Ce),h(7,er),h(8,nt),h(9,it)],_e);oe.registerCommandAndKeybindingRule({id:l.MARKER_OPEN_ACTION_ID,weight:200,when:A.and(b.MarkerFocusContextKey),primary:3,mac:{primary:3,secondary:[2066]},handler:(i,e)=>{const t=i.get($).getActiveViewWithId(l.MARKERS_VIEW_ID);t.openFileAtElement(t.getFocusElement(),!1,!1,!0)}});oe.registerCommandAndKeybindingRule({id:l.MARKER_OPEN_SIDE_ACTION_ID,weight:200,when:A.and(b.MarkerFocusContextKey),primary:2051,mac:{primary:259},handler:(i,e)=>{const t=i.get($).getActiveViewWithId(l.MARKERS_VIEW_ID);t.openFileAtElement(t.getFocusElement(),!1,!0,!0)}});oe.registerCommandAndKeybindingRule({id:l.MARKER_SHOW_PANEL_ID,weight:200,when:void 0,primary:void 0,handler:async(i,e)=>{await i.get($).openView(l.MARKERS_VIEW_ID)}});oe.registerCommandAndKeybindingRule({id:l.MARKER_SHOW_QUICK_FIX,weight:200,when:b.MarkerFocusContextKey,primary:2137,handler:(i,e)=>{const t=i.get($).getActiveViewWithId(l.MARKERS_VIEW_ID),r=t.getFocusElement();r instanceof w&&t.showQuickFixes(r)}});ae.as(mr.Configuration).registerConfiguration({id:"problems",order:101,title:k.PROBLEMS_PANEL_CONFIGURATION_TITLE,type:"object",properties:{"problems.autoReveal":{description:k.PROBLEMS_PANEL_CONFIGURATION_AUTO_REVEAL,type:"boolean",default:!0},"problems.defaultViewMode":{description:k.PROBLEMS_PANEL_CONFIGURATION_VIEW_MODE,type:"string",default:"tree",enum:["table","tree"]},"problems.showCurrentInStatus":{description:k.PROBLEMS_PANEL_CONFIGURATION_SHOW_CURRENT_STATUS,type:"boolean",default:!1},"problems.sortOrder":{description:k.PROBLEMS_PANEL_CONFIGURATION_COMPARE_ORDER,type:"string",default:"severity",enum:["severity","position"],enumDescriptions:[k.PROBLEMS_PANEL_CONFIGURATION_COMPARE_ORDER_SEVERITY,k.PROBLEMS_PANEL_CONFIGURATION_COMPARE_ORDER_POSITION]}}});const ft=Le("markers-view-icon",O.warning,o("markersViewIcon","View icon of the markers view.")),Cr=ae.as(ot.ViewContainersRegistry).registerViewContainer({id:l.MARKERS_CONTAINER_ID,title:k.MARKERS_PANEL_TITLE_PROBLEMS,icon:ft,hideIfEmpty:!0,order:0,ctorDescriptor:new at(gr,[l.MARKERS_CONTAINER_ID,{mergeViewWithContainerWhenSingleView:!0}]),storageId:l.MARKERS_VIEW_STORAGE_ID},1,{doNotRegisterOpenCommand:!0});ae.as(ot.ViewsRegistry).registerViews([{id:l.MARKERS_VIEW_ID,containerIcon:ft,name:k.MARKERS_PANEL_TITLE_PROBLEMS,canToggleVisibility:!1,canMoveView:!0,ctorDescriptor:new at(Ee),openCommandActionDescriptor:{id:"workbench.actions.view.problems",mnemonicTitle:o({key:"miMarker",comment:["&& denotes a mnemonic"]},"&&Problems"),keybindings:{primary:3115},order:0}}],Cr);const kt=ae.as(pr.Workbench);I(class extends v{constructor(){super({id:`workbench.actions.table.${l.MARKERS_VIEW_ID}.viewAsTree`,title:o("viewAsTree","View as Tree"),menu:{id:P.ViewTitle,when:A.and(A.equals("view",l.MARKERS_VIEW_ID),b.MarkersViewModeContextKey.isEqualTo("table")),group:"navigation",order:3},icon:O.listTree,viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.setViewMode("tree")}});I(class extends v{constructor(){super({id:`workbench.actions.table.${l.MARKERS_VIEW_ID}.viewAsTable`,title:o("viewAsTable","View as Table"),menu:{id:P.ViewTitle,when:A.and(A.equals("view",l.MARKERS_VIEW_ID),b.MarkersViewModeContextKey.isEqualTo("tree")),group:"navigation",order:3},icon:O.listFlat,viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.setViewMode("table")}});I(class extends v{constructor(){super({id:`workbench.actions.${l.MARKERS_VIEW_ID}.toggleErrors`,title:o("toggle errors","Toggle Errors"),category:o("problems","Problems"),toggled:{condition:b.ShowErrorsFilterContextKey,title:o("errors","Show Errors")},menu:{id:ee,group:"1_filter",when:A.equals("view",l.MARKERS_VIEW_ID),order:1},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.filters.showErrors=!e.filters.showErrors}});I(class extends v{constructor(){super({id:`workbench.actions.${l.MARKERS_VIEW_ID}.toggleWarnings`,title:o("toggle warnings","Toggle Warnings"),category:o("problems","Problems"),toggled:{condition:b.ShowWarningsFilterContextKey,title:o("warnings","Show Warnings")},menu:{id:ee,group:"1_filter",when:A.equals("view",l.MARKERS_VIEW_ID),order:2},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.filters.showWarnings=!e.filters.showWarnings}});I(class extends v{constructor(){super({id:`workbench.actions.${l.MARKERS_VIEW_ID}.toggleInfos`,title:o("toggle infos","Toggle Infos"),category:o("problems","Problems"),toggled:{condition:b.ShowInfoFilterContextKey,title:o("Infos","Show Infos")},menu:{id:ee,group:"1_filter",when:A.equals("view",l.MARKERS_VIEW_ID),order:3},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.filters.showInfos=!e.filters.showInfos}});I(class extends v{constructor(){super({id:`workbench.actions.${l.MARKERS_VIEW_ID}.toggleActiveFile`,title:o("toggle active file","Toggle Active File"),category:o("problems","Problems"),toggled:{condition:b.ShowActiveFileFilterContextKey,title:o("Active File","Show Active File Only")},menu:{id:ee,group:"2_filter",when:A.equals("view",l.MARKERS_VIEW_ID),order:1},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.filters.activeFile=!e.filters.activeFile}});I(class extends v{constructor(){super({id:`workbench.actions.${l.MARKERS_VIEW_ID}.toggleExcludedFiles`,title:o("toggle Excluded Files","Toggle Excluded Files"),category:o("problems","Problems"),toggled:{condition:b.ShowExcludedFilesFilterContextKey,title:o("Excluded Files","Hide Excluded Files")},menu:{id:ee,group:"2_filter",when:A.equals("view",l.MARKERS_VIEW_ID),order:2},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.filters.excludedFiles=!e.filters.excludedFiles}});I(class extends lt{constructor(){super({id:"workbench.action.problems.focus",title:{value:k.MARKERS_PANEL_SHOW_LABEL,original:"Focus Problems (Errors, Warnings, Infos)"},category:fr.View,f1:!0})}async run(i){i.get($).openView(l.MARKERS_VIEW_ID,!0)}});I(class extends v{constructor(){const i=A.and(ct.isEqualTo(l.MARKERS_VIEW_ID),b.MarkersTreeVisibilityContextKey,b.RelatedInformationFocusContextKey.toNegated());super({id:l.MARKER_COPY_ACTION_ID,title:{value:o("copyMarker","Copy"),original:"Copy"},menu:{id:P.ProblemsPanelContext,when:i,group:"navigation"},keybinding:{weight:200,primary:2081,when:i},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){const t=i.get(Te),r=e.getFocusedSelectedElements()||e.getAllResourceMarkers(),s=[],n=a=>{s.includes(a)||s.push(a)};for(const a of r)a instanceof y?a.markers.forEach(n):a instanceof w&&n(a);s.length&&await t.writeText(`[${s}]`)}});I(class extends v{constructor(){super({id:l.MARKER_COPY_MESSAGE_ACTION_ID,title:{value:o("copyMessage","Copy Message"),original:"Copy Message"},menu:{id:P.ProblemsPanelContext,when:b.MarkerFocusContextKey,group:"navigation"},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){const t=i.get(Te),r=e.getFocusElement();r instanceof w&&await t.writeText(r.marker.message)}});I(class extends v{constructor(){super({id:l.RELATED_INFORMATION_COPY_MESSAGE_ACTION_ID,title:{value:o("copyMessage","Copy Message"),original:"Copy Message"},menu:{id:P.ProblemsPanelContext,when:b.RelatedInformationFocusContextKey,group:"navigation"},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){const t=i.get(Te),r=e.getFocusElement();r instanceof U&&await t.writeText(r.raw.message)}});I(class extends v{constructor(){super({id:l.FOCUS_PROBLEMS_FROM_FILTER,title:o("focusProblemsList","Focus problems view"),keybinding:{when:b.MarkerViewFilterFocusContextKey,weight:200,primary:2066},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.focus()}});I(class extends v{constructor(){super({id:l.MARKERS_VIEW_FOCUS_FILTER,title:o("focusProblemsFilter","Focus problems filter"),keybinding:{when:ct.isEqualTo(l.MARKERS_VIEW_ID),weight:200,primary:2084},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.focusFilter()}});I(class extends v{constructor(){super({id:l.MARKERS_VIEW_SHOW_MULTILINE_MESSAGE,title:{value:o("show multiline","Show message in multiple lines"),original:"Problems: Show message in multiple lines"},category:o("problems","Problems"),menu:{id:P.CommandPalette,when:A.has(ht(l.MARKERS_VIEW_ID))},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.setMultiline(!0)}});I(class extends v{constructor(){super({id:l.MARKERS_VIEW_SHOW_SINGLELINE_MESSAGE,title:{value:o("show singleline","Show message in single line"),original:"Problems: Show message in single line"},category:o("problems","Problems"),menu:{id:P.CommandPalette,when:A.has(ht(l.MARKERS_VIEW_ID))},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.setMultiline(!1)}});I(class extends v{constructor(){super({id:l.MARKERS_VIEW_CLEAR_FILTER_TEXT,title:o("clearFiltersText","Clear filters text"),category:o("problems","Problems"),keybinding:{when:b.MarkerViewFilterFocusContextKey,weight:200,primary:9},viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){e.clearFilterText()}});I(class extends v{constructor(){super({id:`workbench.actions.treeView.${l.MARKERS_VIEW_ID}.collapseAll`,title:o("collapseAll","Collapse All"),menu:{id:P.ViewTitle,when:A.and(A.equals("view",l.MARKERS_VIEW_ID),b.MarkersViewModeContextKey.isEqualTo("tree")),group:"navigation",order:2},icon:O.collapseAll,viewId:l.MARKERS_VIEW_ID})}async runInView(i,e){return e.collapseAll()}});I(class extends lt{constructor(){super({id:l.TOGGLE_MARKERS_VIEW_ACTION_ID,title:k.MARKERS_PANEL_TOGGLE_LABEL})}async run(i){const e=i.get($);e.isViewVisible(l.MARKERS_VIEW_ID)?e.closeView(l.MARKERS_VIEW_ID):e.openView(l.MARKERS_VIEW_ID,!0)}});let Me=class extends D{constructor(e,t){super(),this.markerService=e,this.statusbarService=t,this.markersStatusItem=this._register(this.statusbarService.addEntry(this.getMarkersItem(),"status.problems",0,50)),this.markerService.onMarkerChanged(()=>this.markersStatusItem.update(this.getMarkersItem()))}getMarkersItem(){const e=this.markerService.getStatistics(),t=this.getMarkersTooltip(e);return{name:o("status.problems","Problems"),text:this.getMarkersText(e),ariaLabel:t,tooltip:t,command:"workbench.actions.view.toggleProblems"}}getMarkersTooltip(e){const t=a=>o("totalErrors","Errors: {0}",a),r=a=>o("totalWarnings","Warnings: {0}",a),s=a=>o("totalInfos","Infos: {0}",a),n=[];return e.errors>0&&n.push(t(e.errors)),e.warnings>0&&n.push(r(e.warnings)),e.infos>0&&n.push(s(e.infos)),n.length===0?o("noProblems","No Problems"):n.join(", ")}getMarkersText(e){const t=[];return t.push("$(error) "+this.packNumber(e.errors)),t.push("$(warning) "+this.packNumber(e.warnings)),e.infos>0&&t.push("$(info) "+this.packNumber(e.infos)),t.join(" ")}packNumber(e){const t=o("manyProblems","10K+");return e>9999?t:e>999?e.toString().charAt(0)+"K":e.toString()}};Me=x([h(0,ye),h(1,kr)],Me);kt.registerWorkbenchContribution(Me,3);let Se=class extends D{constructor(e,t){super(),this.activityService=e,this.markerService=t,this.activity=this._register(new wr),this._register(this.markerService.onMarkerChanged(()=>this.updateBadge())),this.updateBadge()}updateBadge(){const{errors:e,warnings:t,infos:r}=this.markerService.getStatistics(),s=e+t+r,n=o("totalProblems","Total {0} Problems",s);this.activity.value=this.activityService.showViewActivity(l.MARKERS_VIEW_ID,{badge:new Er(s,()=>n)})}};Se=x([h(0,br),h(1,ye)],Se);kt.registerWorkbenchContribution(Se,3);function zr(){return{}}export{zr as default};
