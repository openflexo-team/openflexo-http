import{n as be,C as Cu,E as y,l as j,m as G,s as Su,o as je,p as Eu,q as _u,r as ku,u as vd,v as ga,w as A,$ as z,x as go,y as Gi,z as Bt,B as p,F as no,G as mo,H as se,W as wd,J as un,P as yd,K as Cd,d as ue,_ as x,a as h,L as Be,N as Se,O as Ye,Q as xe,V as pt,X as we,e as D,Y as X,Z as nt,a0 as H,a1 as yi,a2 as I,a3 as de,a4 as xu,a5 as bc,a6 as ot,a7 as Du,a8 as Iu,a9 as fo,aa as w,ab as _t,ac as S,ad as ii,ae as Te,af as Mo,ag as sr,ah as Au,ai as Tu,aj as te,ak as qe,al as ve,am as ma,an as Vu,ao as Ut,ap as No,D as R,aq as Vi,ar as Ru,as as lt,at as Sd,U as P,au as Qt,av as me,aw as et,ax as Pu,ay as Ze,az as vc,aA as So,k as J,aB as fa,aC as wc,aD as Ed,t as ie,aE as yc,aF as v,aG as Lu,aH as b,aI as N,aJ as ts,aK as zi,aL as q,aM as Ou,aN as _,aO as Nt,aP as bo,aQ as L,aR as gt,aS as Xe,aT as Mu,aU as rt,aV as Nu,aW as ba,aX as _d,aY as Fu,aZ as kd,a_ as ro,a$ as Bu,b0 as K,b1 as Ct,b2 as Ui,b3 as ke,b4 as ao,b5 as Fe,b6 as Ne,b7 as oi,b8 as va,b9 as vo,ba as Ht,bb as xd,bc as Hu,bd as pn,be as is,bf as Wu,bg as le,bh as Cc,bi as Sc,bj as M,bk as Ai,bl as Gu,bm as Mn,bn as zu,bo as Uu,bp as nr,bq as Dd,br as Ku,bs as Id,bt as $u,bu as ju,bv as k,bw as qu,bx as os,by as wa,bz as Kt,bA as at,bB as Ci,I as Ad,bC as Yu,bD as gn,bE as Zt,bF as Vs,bG as rr,bH as Nn,bI as Ve,bJ as Xu,bK as Ju,bL as Zu,bM as Qu,bN as ep,bO as It,bP as ar,bQ as ya,bR as tp,bS as Qe,bT as wt,bU as Do,bV as hi,bW as Gs,bX as ip,bY as Ec,bZ as op,b_ as sp,b$ as np,c0 as pe,c1 as Io,c2 as Ca,c3 as Td,c4 as Vd,c5 as Rd,c6 as rp,c7 as ap,c8 as cp,c9 as dp,ca as lp,cb as hp,cc as up,cd as Ki,ce as pp,cf as Ao,cg as gp,ch as mp,ci as fp,cj as bp,ck as Pd,cl as ss,cm as vp,cn as mn,g as Ue,f as Ld,c as Od,co as Md,cp as Fi,cq as wp,b as ns,cr as Fo,cs as _c,M as yp,ct as tt,cu as Cp,cv as Nd,cw as Sp,cx as U,cy as Sa,cz as Ep,cA as _p,cB as zs,cC as cr,cD as kp,cE as xp,cF as Rs,cG as Dp,cH as Ip,cI as dr,cJ as Ap,cK as Tp,cL as Vp,cM as Rp,cN as Pp,cO as Lp,cP as Op,cQ as fn,cR as Mp,cS as lr,cT as Np,cU as Fp,cV as kc,cW as bi,cX as ei,cY as ge,cZ as yt,c_ as Bo,c$ as Bp,d0 as co,d1 as Hp,d2 as Fd,d3 as Bd,d4 as Wp,d5 as xc,d6 as Gp,d7 as zp,d8 as Ft,d9 as Up,S as Re,da as Ea,db as st,dc as Ho,dd as Kp,de as Hd,df as $p,dg as jp,dh as hr,di as si,dj as Wo,dk as qp,dl as rs,dm as bn,dn as _a,dp as as,dq as vi,dr as Wd,ds as Yp,dt as Xp,du as Gd,dv as $t,dw as ka,dx as oe,dy as Y,dz as O,dA as zd,dB as ee,dC as $,dD as Jp,dE as ur,dF as Zp,dG as Qp,dH as eg,dI as vn,dJ as ti,dK as fe,dL as Ud,dM as Kd,dN as $d,dO as jd,dP as tg,dQ as ig,dR as qd,dS as Dc,dT as Ic,dU as Pt,dV as Ge,dW as og,dX as to,dY as sg,dZ as ng,d_ as rg,d$ as Yd,e0 as Xd,e1 as xa,e2 as pr,e3 as ag,e4 as cg,e5 as dg,e6 as lg,e7 as hg,e8 as ug,e9 as Da,ea as pg,eb as gg,ec as Ia,ed as Jd,ee as gr,ef as Zd,eg as mr,eh as Qd,ei as Fn,ej as Bn,ek as wn,el as mg,em as fg,en as Zi,eo as Rt,ep as fr,eq as Ce,er as Aa,es as el,et as bg,eu as Hn,ev as vg,ew as wg,ex as yg,ey as Cg,ez as Sg,eA as Eg,eB as _g,eC as tl,eD as il,eE as kg,eF as xg,eG as Dg,eH as Ig,eI as Ag,eJ as Tg,eK as Vg,eL as ol,eM as Us,eN as Lt,eO as sl,eP as nl,eQ as Ri,eR as Rg,eS as Ac,eT as Tc,eU as Pg,eV as rl,eW as al,eX as Vc,eY as Lg,eZ as Ks,e_ as Go,e$ as Og,f0 as Mg,f1 as cl,f2 as Wn,f3 as dl,f4 as Ng,h as cs,f5 as Fg,f6 as br,f7 as ll,f8 as Rc,f9 as Bg,fa as Hg,fb as Wg,fc as vr,fd as Gg,fe as zg,ff as xi,fg as hl,fh as Ug,fi as zo,fj as Ta,fk as To,fl as Ti,fm as Kg,fn as $g,fo as jg,fp as qg,fq as Yg,fr as Xg,fs as Jg,ft as Zg,fu as Qg,fv as em,fw as tm,fx as wr,fy as Vo,fz as Pc,fA as ae,fB as Lc,fC as im,fD as Ro,fE as om,fF as sm,fG as nm,fH as rm,fI as ul,fJ as ci,fK as ds,fL as Je,fM as ct,fN as Va,fO as kt,fP as Oc,fQ as ls,fR as pl,fS as Ra,fT as gl,fU as ml,fV as hs,fW as us,fX as ps,fY as Uo,fZ as fl,f_ as yn,f$ as am,g0 as cm,g1 as bl,g2 as Ps,g3 as Pa,g4 as vl,g5 as wl,g6 as dm,g7 as La,g8 as lm,g9 as yl,ga as Oa,gb as Cl,gc as Sl,gd as hm,ge as um,gf as Cn,gg as El,gh as pm,gi as Mi,gj as _l,gk as gm,gl as mm,gm as fm,gn as Ma,go as kl,gp as bm,gq as gs,gr as Na,gs as At,gt as ze,gu as vm,gv as Sn,gw as wm,gx as xl,gy as ym,gz as Cm,gA as Sm,gB as Em,gC as _m,gD as Dl,gE as km,gF as xm,gG as Fa,gH as Il,gI as Al,gJ as Tl,gK as Vl,gL as Dm,gM as Im,gN as Ba,gO as ms,gP as Rl,gQ as Ha,gR as Am,gS as $i,gT as Tm,gU as Vm,gV as Rm,gW as Pm,gX as Lm,gY as Om,gZ as Mm,g_ as Nm,g$ as Fm,h0 as Bm,h1 as Hm,h2 as Wm,h3 as Gm,h4 as zm,h5 as Pl,h6 as Ll,h7 as Um,h8 as Km,h9 as $m,ha as Ol,hb as Wa,hc as Ml,hd as Nl,he as Fl,hf as Bl,hg as Hl,hh as Wl,hi as Gl,hj as zl,hk as Ul,hl as Kl,hm as $l,hn as jl,ho as ql,hp as Yl,hq as jt,hr as $s,hs as Gn,ht as Xl,hu as zn,hv as Ga,hw as jm,hx as qm,hy as Si,hz as Ei,hA as mt,hB as fs,hC as bs,hD as vs,hE as Jl,hF as Ym,hG as Xm,hH as Jm,hI as Zm,hJ as Zl,hK as za,hL as Un,hM as Ql,hN as Qm,hO as ef,hP as tf,hQ as of,hR as Ua,hS as eh,hT as En,hU as sf,hV as Ot,hW as nf,hX as rf,hY as Ka,hZ as th,h_ as yr,h$ as af,i0 as cf,i1 as df,i2 as ih,i3 as Cr,i4 as Mc,i5 as Kn,i6 as Nc,i7 as lf,i8 as hf,i9 as Wt,ia as uf,ib as $n,ic as Fc,id as Xi,ie as pf,ig as _e,ih as Ko,ii as oh,ij as sh,ik as _n,il as kn,im as gf,io as mf,ip as As,iq as ff,ir as bf,is as vf,it as wf,iu as yf,iv as Cf,iw as Sf,ix as Ef,iy as _f,iz as kf,iA as nh,iB as xf,iC as Bc,iD as Df,iE as If,iF as Hc,iG as Af,iH as $a,iI as rh,iJ as ja,iK as Tf,iL as io,iM as jn,iN as Vf,iO as Rf,iP as Po,iQ as Pf,iR as ah,iS as Ls,iT as js,iU as Wc,iV as Lf,iW as Of,iX as Gc,iY as qn,iZ as zc,i_ as Tt,i$ as ui,j0 as Mf,j1 as Nf,j2 as wo,j3 as ji,j4 as Os,j5 as Ff,j6 as Uc,j7 as Bf,j8 as Hf,j9 as Wf,ja as Kc,jb as $c,jc as Gf,jd as zf,je as Uf,jf as Kf,jg as $f,jh as jf,ji as qf,jj as Yf,jk as Xf,jl as Jf,jm as Zf,jn as Qf,jo as eb,jp as tb,jq as ib,jr as ob,js as sb,jt as nb,ju as rb,jv as Sr,jw as ab,jx as cb,jy as jc,jz as qc,jA as yo,jB as db,jC as lb,jD as hb,jE as ub,jF as pb,jG as gb,jH as mb,jI as fb,jJ as bb,jK as vb,jL as wb,jM as yb}from"./index-1e6bb64c.js";import{jN as vC}from"./index-1e6bb64c.js";import{E as qs,V as Cb}from"./viewsService-5f902b53.js";import{A as Ms,a as Sb,T as qa,b as Ya,C as Yc,c as Eb,d as _b,e as Yn,f as Xc,P as Jc,g as Zc,h as kb,i as Qc,j as ed,k as xb,w as Db}from"./editor-fda0ae13.js";import{g as Lo,a as Ib}from"./window-ded988fc.js";import{i as Ab,g as ch}from"./quickaccess-364b5136.js";import"./workbench.contribution-90d7208d.js";import"./textResourceEditor-19643567.js";import"./codeeditor-60d8146c.js";var Tb=".monaco-workbench.nosidebar>.part.sidebar{display:none!important;visibility:hidden!important}.monaco-workbench .part.sidebar .title-actions .actions-container{justify-content:flex-end}.monaco-workbench .part.sidebar .title-actions .action-item{margin-right:4px}.monaco-workbench .part.sidebar>.title>.title-label h2{text-transform:uppercase}.monaco-workbench .viewlet .collapsible.header .title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .viewlet .collapsible.header .actions{width:0}.monaco-workbench .viewlet .collapsible.header.focused .actions,.monaco-workbench .viewlet .split-view-view:hover>.header .actions{flex:1;width:auto}.monaco-workbench .viewlet .collapsible.header .actions .action-label{background-position:50%;background-repeat:no-repeat;background-size:16px;height:22px;margin-right:0;width:28px}.monaco-workbench .viewlet .collapsible.header .actions .action-label .label,.monaco-workbench .viewlet .collapsible.header.collapsed .actions{display:none}.monaco-workbench .viewlet .collapsible.header .action-label{background-repeat:no-repeat;height:16px;margin-right:.2em;width:16px}";be(Tb,{});var Vb=".monaco-workbench .part>.content>.composite{height:100%}.monaco-workbench .part>.composite.title{display:flex}.monaco-workbench .part>.composite.title>.title-actions{flex:1;padding-left:5px}";be(Vb,{});var Rb=`.monaco-workbench .part{box-sizing:border-box;overflow:hidden}.monaco-workbench .part>.drop-block-overlay.visible{visibility:visible}.monaco-workbench .part>.drop-block-overlay{height:100%;opacity:0;position:absolute;top:0;visibility:hidden;width:100%;z-index:12}.monaco-workbench .part>.title{box-sizing:border-box;display:none;display:flex;height:35px;overflow:hidden;padding-left:8px;padding-right:8px}.monaco-workbench .part>.title>.title-label{line-height:35px;overflow:hidden;padding-left:12px;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .part>.title>.title-label h2{cursor:default;font-size:11px;font-weight:400;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.monaco-workbench .part>.title>.title-label a{cursor:default;font-size:13px;text-decoration:none}.monaco-workbench .part>.title>.title-actions{flex:1;height:35px;padding-left:5px}.monaco-workbench .part>.title>.title-actions .action-label{background-position:50%;background-repeat:no-repeat;background-size:16px;display:block}.monaco-workbench .part>.title>.title-actions .action-label .label{display:none}.monaco-workbench .part>.title>.title-actions .action-label.codicon{color:inherit}.monaco-workbench .part>.content{font-size:13px}.monaco-workbench .part.editor>.content .monaco-progress-container,.monaco-workbench .part>.content>.monaco-progress-container{height:2px;left:0;position:absolute;top:33px;z-index:5}.monaco-workbench
	.part.editor>.content
	.monaco-progress-container
	.progress-bit,.monaco-workbench .part>.content>.monaco-progress-container .progress-bit{height:2px}`;be(Rb,{});class xn extends Cu{get dimension(){return this._dimension}constructor(e,t,i,o,s){super(e,i,o),this.options=t,this.layoutService=s,this._onDidVisibilityChange=this._register(new y),this.onDidVisibilityChange=this._onDidVisibilityChange.event,this._onDidChange=this._register(new y),s.registerPart(this)}onThemeChange(e){this.parent&&super.onThemeChange(e)}updateStyles(){super.updateStyles()}create(e,t){this.parent=e,this.titleArea=this.createTitleArea(e,t),this.contentArea=this.createContentArea(e,t),this.partLayout=new Dn(this.options,this.contentArea),this.updateStyles()}getContainer(){return this.parent}createTitleArea(e,t){}getTitleArea(){return this.titleArea}createContentArea(e,t){}getContentArea(){return this.contentArea}layoutContents(e,t){return j(this.partLayout).layout(e,t)}get onDidChange(){return this._onDidChange.event}layout(e,t,i,o){this._dimension=new G(e,t)}setVisible(e){this._onDidVisibilityChange.fire(e)}}class Dn{constructor(e,t){this.options=e,this.contentArea=t}layout(e,t){let i;this.options.hasTitle?i=new G(e,Math.min(t,Dn.TITLE_HEIGHT)):i=G.None;let o=e;this.options&&typeof this.options.borderWidth=="function"&&(o-=this.options.borderWidth());const s=new G(o,t-i.height);return this.contentArea&&Su(this.contentArea,s.width,s.height),{titleSize:i,contentSize:s}}}Dn.TITLE_HEIGHT=35;class dh extends xn{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E){super(C,E,a,t,s),this.notificationService=e,this.storageService=t,this.telemetryService=i,this.contextMenuService=o,this.keybindingService=n,this.instantiationService=r,this.registry=d,this.activeCompositeSettingsKey=l,this.defaultCompositeId=u,this.nameForTelemetry=g,this.compositeCSSClass=m,this.titleForegroundColor=f,this.onDidCompositeOpen=this._register(new y),this.onDidCompositeClose=this._register(new y),this.mapCompositeToCompositeContainer=new Map,this.mapActionsBindingToComposite=new Map,this.instantiatedCompositeItems=new Map,this.telemetryActionsListener=this._register(new je),this.lastActiveCompositeId=t.get(l,1,this.defaultCompositeId)}openComposite(e,t){var i;if(((i=this.activeComposite)==null?void 0:i.getId())===e)return t&&this.activeComposite.focus(),this.activeComposite;if(this.element)return this.doOpenComposite(e,t)}doOpenComposite(e,t=!1){var s;const i=Eu.nextId();this.currentCompositeOpenToken=i,this.activeComposite&&this.hideActiveComposite(),this.updateTitle(e);const o=this.createComposite(e,!0);if(!(this.currentCompositeOpenToken!==i||this.activeComposite&&this.activeComposite.getId()!==o.getId()))return((s=this.activeComposite)==null?void 0:s.getId())===o.getId()?(t&&o.focus(),this.onDidCompositeOpen.fire({composite:o,focus:t}),o):(this.showComposite(o),t&&o.focus(),o&&this.onDidCompositeOpen.fire({composite:o,focus:t}),o)}createComposite(e,t){const i=this.instantiatedCompositeItems.get(e);if(i)return i.composite;const o=this.registry.getComposite(e);if(o){const s=this,n=new _u(j(this.progressBar),new class extends ku{constructor(){super(o.id,!!t),this._register(s.onDidCompositeOpen.event(l=>this.onScopeOpened(l.composite.getId()))),this._register(s.onDidCompositeClose.event(l=>this.onScopeClosed(l.getId())))}}),r=this.instantiationService.createChild(new vd([ga,n])),a=o.instantiate(r),d=new A;return this.instantiatedCompositeItems.set(e,{composite:a,disposable:d,progress:n}),d.add(a.onTitleAreaUpdate(()=>this.onTitleAreaUpdate(a.getId()),this)),a}throw new Error(`Unable to find composite with id ${e}`)}showComposite(e){this.activeComposite=e;const t=this.activeComposite.getId();t!==this.defaultCompositeId?this.storageService.store(this.activeCompositeSettingsKey,t,1,1):this.storageService.remove(this.activeCompositeSettingsKey,1),this.lastActiveCompositeId=this.activeComposite.getId();let i=this.mapCompositeToCompositeContainer.get(e.getId());if(i||(i=z(".composite"),i.classList.add(...this.compositeCSSClass.split(" ")),i.id=e.getId(),e.create(i),e.updateStyles(),this.mapCompositeToCompositeContainer.set(e.getId(),i)),!this.activeComposite||e.getId()!==this.activeComposite.getId())return;const o=this.getContentArea();o==null||o.appendChild(i),go(i);const s=j(this.toolBar);s.actionRunner=e.getActionRunner();const n=this.registry.getComposite(e.getId());n&&n.name!==e.getTitle()&&this.updateTitle(e.getId(),e.getTitle());let r=this.mapActionsBindingToComposite.get(e.getId());r||(r=this.collectCompositeActions(e),this.mapActionsBindingToComposite.set(e.getId(),r)),r(),this.telemetryActionsListener.value=s.actionRunner.onDidRun(a=>{a.error&&!Gi(a.error)&&this.notificationService.error(a.error),this.telemetryService.publicLog2("workbenchActionExecuted",{id:a.action.id,from:this.nameForTelemetry})}),e.setVisible(!0),!(!this.activeComposite||e.getId()!==this.activeComposite.getId())&&(this.contentAreaSize&&e.layout(this.contentAreaSize),this.boundarySashes&&e.setBoundarySashes(this.boundarySashes))}onTitleAreaUpdate(e){var i;const t=this.instantiatedCompositeItems.get(e);if(t&&this.updateTitle(e,t.composite.getTitle()),((i=this.activeComposite)==null?void 0:i.getId())===e){const o=this.collectCompositeActions(this.activeComposite);this.mapActionsBindingToComposite.set(this.activeComposite.getId(),o),o()}else this.mapActionsBindingToComposite.delete(e)}updateTitle(e,t){const i=this.registry.getComposite(e);if(!i||!this.titleLabel)return;t||(t=i.name);const o=this.keybindingService.lookupKeybinding(e);this.titleLabel.updateTitle(e,t,Bt(o==null?void 0:o.getLabel())),j(this.toolBar).setAriaLabel(p("ariaCompositeToolbarLabel","{0} actions",t))}collectCompositeActions(e){const t=e==null?void 0:e.getMenuIds(),i=(e==null?void 0:e.getActions().slice(0))||[],o=(e==null?void 0:e.getSecondaryActions().slice(0))||[],s=j(this.toolBar);return s.context=this.actionsContextProvider(),()=>s.setActions(no(i),no(o),t)}getActiveComposite(){return this.activeComposite}getLastActiveCompositeId(){return this.lastActiveCompositeId}hideActiveComposite(){var i;if(!this.activeComposite)return;const e=this.activeComposite;this.activeComposite=void 0;const t=this.mapCompositeToCompositeContainer.get(e.getId());return e.setVisible(!1),t&&(t.remove(),mo(t)),(i=this.progressBar)==null||i.stop().hide(),this.toolBar&&this.collectCompositeActions()(),this.onDidCompositeClose.fire(e),e}createTitleArea(e){const t=se(e,z(".composite"));t.classList.add("title"),this.titleLabel=this.createTitleLabel(t);const i=se(t,z(".title-actions"));return this.toolBar=this._register(this.instantiationService.createInstance(wd,i,{actionViewItemProvider:o=>this.actionViewItemProvider(o),orientation:0,getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:p("viewsAndMoreActions","Views and More Actions...")})),this.collectCompositeActions()(),t}createTitleLabel(e){const t=se(e,z(".title-label")),i=se(t,z("h2"));this.titleLabelElement=i;const o=this;return{updateTitle:(s,n,r)=>{(!this.activeComposite||this.activeComposite.getId()===s)&&(i.innerText=n,i.title=r?p("titleTooltip","{0} ({1})",n,r):n)},updateStyles:()=>{i.style.color=o.titleForegroundColor&&o.getColor(o.titleForegroundColor)||""}}}updateStyles(){super.updateStyles(),j(this.titleLabel).updateStyles()}actionViewItemProvider(e){return this.activeComposite?this.activeComposite.getActionViewItem(e):un(this.instantiationService,e)}actionsContextProvider(){return this.activeComposite?this.activeComposite.getActionsContext():null}createContentArea(e){const t=se(e,z(".content"));return this.progressBar=this._register(new yd(t,Cd)),this.progressBar.hide(),t}getProgressIndicator(e){const t=this.instantiatedCompositeItems.get(e);return t?t.progress:void 0}getTitleAreaDropDownAnchorAlignment(){return 1}layout(e,t,i,o){var s;super.layout(e,t,i,o),this.contentAreaSize=G.lift(super.layoutContents(e,t).contentSize),(s=this.activeComposite)==null||s.layout(this.contentAreaSize)}setBoundarySashes(e){var t;this.boundarySashes=e,(t=this.activeComposite)==null||t.setBoundarySashes(e)}removeComposite(e){var i;if(((i=this.activeComposite)==null?void 0:i.getId())===e)return!1;this.mapCompositeToCompositeContainer.delete(e),this.mapActionsBindingToComposite.delete(e);const t=this.instantiatedCompositeItems.get(e);return t&&(t.composite.dispose(),ue(t.disposable),this.instantiatedCompositeItems.delete(e)),!0}dispose(){this.mapCompositeToCompositeContainer.clear(),this.mapActionsBindingToComposite.clear(),this.instantiatedCompositeItems.forEach(e=>{e.composite.dispose(),ue(e.disposable)}),this.instantiatedCompositeItems.clear(),super.dispose()}}let Ys=class lh extends dh{get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}get onDidPaneCompositeRegister(){return this.viewletRegistry.onDidRegister}get onDidPaneCompositeOpen(){return I.map(this.onDidCompositeOpen.event,e=>e.composite)}get onDidPaneCompositeClose(){return this.onDidCompositeClose.event}constructor(e,t,i,o,s,n,r,a,d,l,u){super(e,t,i,o,s,n,r,a,de.as(qs.Viewlets),lh.activeViewletSettingsKey,d.getDefaultViewContainer(0).id,"sideBar","viewlet",xu,"workbench.parts.sidebar",{hasTitle:!0,borderWidth:()=>this.getColor(bc)||this.getColor(ot)?1:0}),this.viewDescriptorService=d,this.contextKeyService=l,this.extensionService=u,this.minimumWidth=170,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=0,this.maximumHeight=Number.POSITIVE_INFINITY,this.priority=1,this.snap=!0,this._onDidViewletDeregister=this._register(new y),this.onDidPaneCompositeDeregister=this._onDidViewletDeregister.event,this.viewletRegistry=de.as(qs.Viewlets),this.sideBarFocusContextKey=Du.bindTo(this.contextKeyService),this.activeViewletContextKey=Iu.bindTo(this.contextKeyService),this.blockOpeningViewlet=!1,this.registerListeners()}registerListeners(){this._register(this.onDidPaneCompositeOpen(e=>{this.activeViewletContextKey.set(e.getId())})),this._register(this.onDidPaneCompositeClose(e=>{this.activeViewletContextKey.get()===e.getId()&&this.activeViewletContextKey.reset()})),this._register(this.registry.onDidDeregister(async e=>{var i,o;const t=this.viewDescriptorService.getViewContainersByLocation(0).filter(s=>this.viewDescriptorService.getViewContainerModel(s).activeViewDescriptors.length>0);if(t.length){if(((i=this.getActiveComposite())==null?void 0:i.getId())===e.id){const s=(o=this.viewDescriptorService.getDefaultViewContainer(0))==null?void 0:o.id,n=t.filter(r=>r.id===s)[0]||t[0];await this.openPaneComposite(n.id)}}else this.layoutService.setPartHidden(!0,"workbench.parts.sidebar");this.removeComposite(e.id),this._onDidViewletDeregister.fire(e)}))}create(e){this.element=e,super.create(e);const t=this._register(fo(e));this._register(t.onDidFocus(()=>this.sideBarFocusContextKey.set(!0))),this._register(t.onDidBlur(()=>this.sideBarFocusContextKey.set(!1)))}createTitleArea(e){const t=super.createTitleArea(e);this._register(w(t,S.CONTEXT_MENU,o=>{this.onTitleAreaContextMenu(new _t(o))})),this._register(ii.addTarget(t)),this._register(w(t,Te.Contextmenu,o=>{this.onTitleAreaContextMenu(new _t(o))})),this.titleLabelElement.draggable=!0;const i=()=>({type:"composite",id:this.getActivePaneComposite().getId()});return this._register(Mo.INSTANCE.registerDraggable(this.titleLabelElement,i,{})),t}updateStyles(){super.updateStyles();const e=j(this.getContainer());e.style.backgroundColor=this.getColor(sr)||"",e.style.color=this.getColor(Au)||"";const t=this.getColor(bc)||this.getColor(ot),i=this.layoutService.getSideBarPosition()===0;e.style.borderRightWidth=t&&i?"1px":"",e.style.borderRightStyle=t&&i?"solid":"",e.style.borderRightColor=i&&t||"",e.style.borderLeftWidth=t&&!i?"1px":"",e.style.borderLeftStyle=t&&!i?"solid":"",e.style.borderLeftColor=i?"":t||"",e.style.outlineColor=this.getColor(Tu)??""}layout(e,t,i,o){this.layoutService.isVisible("workbench.parts.sidebar")&&super.layout(e,t,i,o)}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.hideActiveComposite()}async openPaneComposite(e,t){if(typeof e=="string"&&this.getPaneComposite(e))return this.doOpenViewlet(e,t);if(await this.extensionService.whenInstalledExtensionsRegistered(),typeof e=="string"&&this.getPaneComposite(e))return this.doOpenViewlet(e,t)}getPaneComposites(){return this.viewletRegistry.getPaneComposites().sort((e,t)=>typeof e.order!="number"?-1:typeof t.order!="number"?1:e.order-t.order)}getPaneComposite(e){return this.getPaneComposites().filter(t=>t.id===e)[0]}doOpenViewlet(e,t){if(!this.blockOpeningViewlet){if(!this.layoutService.isVisible("workbench.parts.sidebar"))try{this.blockOpeningViewlet=!0,this.layoutService.setPartHidden(!1,"workbench.parts.sidebar")}finally{this.blockOpeningViewlet=!1}return this.openComposite(e,t)}}getTitleAreaDropDownAnchorAlignment(){return this.layoutService.getSideBarPosition()===0?0:1}onTitleAreaContextMenu(e){const t=this.getActivePaneComposite();if(t){const i=t?t.getContextMenuActions():[];if(i.length){const o={x:e.posx,y:e.posy};this.contextMenuService.showContextMenu({getAnchor:()=>o,getActions:()=>i.slice(),getActionViewItem:s=>this.actionViewItemProvider(s),actionRunner:t.getActionRunner()})}}}toJSON(){return{type:"workbench.parts.sidebar"}}};Ys.activeViewletSettingsKey="workbench.sidebar.activeviewletid";Ys=x([h(0,Be),h(1,Se),h(2,Ye),h(3,xe),h(4,pt),h(5,we),h(6,D),h(7,X),h(8,nt),h(9,H),h(10,yi)],Ys);const Xa="viewsLog",hh=p("views log","Views");function Ja(c){return No(c.windowLogsPath,"views.log")}te(class extends qe{constructor(){super({id:"_workbench.output.showViewsLog",title:{value:"Show Views Log",original:"Show Views Log"},category:ve.Developer,f1:!0})}async run(c){const e=c.get(ma),t=c.get(Vu),i=c.get(Ut);e.setVisibility(Ja(i),!0),t.showChannel(Xa)}});function uh(c){return`${c}.hidden`}let Er=class extends R{constructor(e,t,i,o,s){super(),this.viewContainerName=t,this.storageService=i,this._onDidChangeStoredState=this._register(new y),this.onDidChangeStoredState=this._onDidChangeStoredState.event,this.logger=o.createLogger(Ja(s),{id:Xa,name:hh,hidden:!0}),this.globalViewsStateStorageId=uh(e),this.workspaceViewsStateStorageId=e,this._register(this.storageService.onDidChangeValue(n=>this.onDidStorageChange(n))),this.state=this.initialize()}set(e,t){this.state.set(e,t)}get(e){return this.state.get(e)}updateState(e){this.updateWorkspaceState(e),this.updateGlobalState(e)}updateWorkspaceState(e){const t=this.getStoredWorkspaceState();for(const i of e){const o=this.get(i.id);o&&(t[i.id]={collapsed:!!o.collapsed,isHidden:!o.visibleWorkspace,size:o.size,order:i.workspace&&o?o.order:void 0})}Object.keys(t).length>0?this.storageService.store(this.workspaceViewsStateStorageId,JSON.stringify(t),1,1):this.storageService.remove(this.workspaceViewsStateStorageId,1)}updateGlobalState(e){const t=this.getStoredGlobalState();for(const i of e){const o=this.get(i.id);t.set(i.id,{id:i.id,isHidden:o&&i.canToggleVisibility?!o.visibleGlobal:!1,order:!i.workspace&&o?o.order:void 0})}this.setStoredGlobalState(t)}onDidStorageChange(e){if(e.key===this.globalViewsStateStorageId&&e.scope===0&&this.globalViewsStatesValue!==this.getStoredGlobalViewsStatesValue()){this._globalViewsStatesValue=void 0;const t=this.getStoredGlobalState(),i=this.getStoredWorkspaceState(),o=[];for(const[s,n]of t){const r=this.get(s);if(r)r.visibleGlobal!==!n.isHidden&&(n.isHidden||this.logger.info(`View visibility state changed: ${s} is now visible`,this.viewContainerName),o.push({id:s,visible:!n.isHidden}));else{const a=i[s];this.set(s,{active:!1,visibleGlobal:!n.isHidden,visibleWorkspace:Vi(a==null?void 0:a.isHidden)?void 0:!(a!=null&&a.isHidden),collapsed:a==null?void 0:a.collapsed,order:a==null?void 0:a.order,size:a==null?void 0:a.size})}}if(o.length){this._onDidChangeStoredState.fire(o);for(const s of o){const n=this.get(s.id);n&&(n.visibleGlobal=s.visible)}}}}initialize(){const e=new Map,t=this.getStoredWorkspaceState();for(const r of Object.keys(t)){const a=t[r];e.set(r,{active:!1,visibleGlobal:void 0,visibleWorkspace:Vi(a.isHidden)?void 0:!a.isHidden,collapsed:a.collapsed,order:a.order,size:a.size})}const i=this.storageService.get(this.globalViewsStateStorageId,1,"[]"),{state:o}=this.parseStoredGlobalState(i);if(o.size>0){for(const{id:r,isHidden:a}of o.values()){const d=e.get(r);d?Vi(d.visibleWorkspace)&&(d.visibleWorkspace=!a):e.set(r,{active:!1,collapsed:void 0,visibleGlobal:void 0,visibleWorkspace:!a})}this.storageService.remove(this.globalViewsStateStorageId,1)}const{state:s,hasDuplicates:n}=this.parseStoredGlobalState(this.globalViewsStatesValue);n&&this.setStoredGlobalState(s);for(const{id:r,isHidden:a,order:d}of s.values()){const l=e.get(r);l?(l.visibleGlobal=!a,Vi(d)||(l.order=d)):e.set(r,{active:!1,visibleGlobal:!a,order:d,collapsed:void 0,visibleWorkspace:void 0})}return e}getStoredWorkspaceState(){return JSON.parse(this.storageService.get(this.workspaceViewsStateStorageId,1,"{}"))}getStoredGlobalState(){return this.parseStoredGlobalState(this.globalViewsStatesValue).state}setStoredGlobalState(e){this.globalViewsStatesValue=JSON.stringify([...e.values()])}parseStoredGlobalState(e){const t=JSON.parse(e);let i=!1;return{state:t.reduce((s,n)=>(typeof n=="string"?(i=i||s.has(n),s.set(n,{id:n,isHidden:!0})):(i=i||s.has(n.id),s.set(n.id,n)),s),new Map),hasDuplicates:i}}get globalViewsStatesValue(){return this._globalViewsStatesValue||(this._globalViewsStatesValue=this.getStoredGlobalViewsStatesValue()),this._globalViewsStatesValue}set globalViewsStatesValue(e){this.globalViewsStatesValue!==e&&(this._globalViewsStatesValue=e,this.setStoredGlobalViewsStatesValue(e))}getStoredGlobalViewsStatesValue(){return this.storageService.get(this.globalViewsStateStorageId,0,"[]")}setStoredGlobalViewsStatesValue(e){this.storageService.store(this.globalViewsStateStorageId,e,0,0)}};Er=x([h(2,Se),h(3,ma),h(4,Ut)],Er);let _r=class extends R{get title(){return this._title}get icon(){return this._icon}get keybindingId(){return this._keybindingId}get allViewDescriptors(){return this.viewDescriptorItems.map(e=>e.viewDescriptor)}get activeViewDescriptors(){return this.viewDescriptorItems.filter(e=>e.state.active).map(e=>e.viewDescriptor)}get visibleViewDescriptors(){return this.viewDescriptorItems.filter(e=>this.isViewDescriptorVisible(e)).map(e=>e.viewDescriptor)}constructor(e,t,i,o,s){super(),this.viewContainer=e,this.contextKeyService=i,this.contextKeys=new Ru,this.viewDescriptorItems=[],this._onDidChangeContainerInfo=this._register(new y),this.onDidChangeContainerInfo=this._onDidChangeContainerInfo.event,this._onDidChangeAllViewDescriptors=this._register(new y),this.onDidChangeAllViewDescriptors=this._onDidChangeAllViewDescriptors.event,this._onDidChangeActiveViewDescriptors=this._register(new y),this.onDidChangeActiveViewDescriptors=this._onDidChangeActiveViewDescriptors.event,this._onDidAddVisibleViewDescriptors=this._register(new y),this.onDidAddVisibleViewDescriptors=this._onDidAddVisibleViewDescriptors.event,this._onDidRemoveVisibleViewDescriptors=this._register(new y),this.onDidRemoveVisibleViewDescriptors=this._onDidRemoveVisibleViewDescriptors.event,this._onDidMoveVisibleViewDescriptors=this._register(new y),this.onDidMoveVisibleViewDescriptors=this._onDidMoveVisibleViewDescriptors.event,this.logger=o.createLogger(Ja(s),{id:Xa,name:hh,hidden:!0}),this._register(I.filter(i.onDidChangeContext,n=>n.affectsSome(this.contextKeys))(()=>this.onDidChangeContext())),this.viewDescriptorsState=this._register(t.createInstance(Er,e.storageId||`${e.id}.state`,typeof e.title=="string"?e.title:e.title.original)),this._register(this.viewDescriptorsState.onDidChangeStoredState(n=>this.updateVisibility(n))),this.updateContainerInfo()}updateContainerInfo(){var a,d,l,u,g,m;const e=this.viewContainer.alwaysUseContainerInfo||this.visibleViewDescriptors.length===0||this.visibleViewDescriptors.some(f=>de.as(lt.ViewsRegistry).getViewContainer(f.id)===this.viewContainer),t=e?typeof this.viewContainer.title=="string"?this.viewContainer.title:this.viewContainer.title.value:((a=this.visibleViewDescriptors[0])==null?void 0:a.containerTitle)||((d=this.visibleViewDescriptors[0])==null?void 0:d.name)||"";let i=!1;this._title!==t&&(this._title=t,i=!0);const o=e?this.viewContainer.icon:((l=this.visibleViewDescriptors[0])==null?void 0:l.containerIcon)||Sd;let s=!1;this.isEqualIcon(o)||(this._icon=o,s=!0);const n=((u=this.viewContainer.openCommandActionDescriptor)==null?void 0:u.id)??((m=(g=this.activeViewDescriptors.find(f=>f.openCommandActionDescriptor))==null?void 0:g.openCommandActionDescriptor)==null?void 0:m.id);let r=!1;this._keybindingId!==n&&(this._keybindingId=n,r=!0),(i||s||r)&&this._onDidChangeContainerInfo.fire({title:i,icon:s,keybindingId:r})}isEqualIcon(e){return P.isUri(e)?P.isUri(this._icon)&&Qt(e,this._icon):me.isThemeIcon(e)?me.isThemeIcon(this._icon)&&me.isEqual(e,this._icon):e===this._icon}isVisible(e){const t=this.viewDescriptorItems.find(i=>i.viewDescriptor.id===e);if(!t)throw new Error(`Unknown view ${e}`);return this.isViewDescriptorVisible(t)}setVisible(e,t){this.updateVisibility([{id:e,visible:t}])}updateVisibility(e){const t=et(e.filter(({visible:s})=>!s).map(({id:s})=>this.findAndIgnoreIfNotFound(s))),i=[];for(const{viewDescriptorItem:s,visibleIndex:n}of t)this.updateViewDescriptorItemVisibility(s,!1)&&i.push({viewDescriptor:s.viewDescriptor,index:n});i.length&&this.broadCastRemovedVisibleViewDescriptors(i);const o=[];for(const{id:s,visible:n}of e){if(!n)continue;const r=this.findAndIgnoreIfNotFound(s);if(!r)continue;const{viewDescriptorItem:a,visibleIndex:d}=r;this.updateViewDescriptorItemVisibility(a,!0)&&o.push({index:d,viewDescriptor:a.viewDescriptor,size:a.state.size,collapsed:!!a.state.collapsed})}o.length&&this.broadCastAddedVisibleViewDescriptors(o)}updateViewDescriptorItemVisibility(e,t){return!e.viewDescriptor.canToggleVisibility||this.isViewDescriptorVisibleWhenActive(e)===t?!1:(e.viewDescriptor.workspace?e.state.visibleWorkspace=t:(e.state.visibleGlobal=t,t&&this.logger.info(`Showing view ${e.viewDescriptor.id} in the container ${this.viewContainer.id}`)),this.isViewDescriptorVisible(e)===t)}isCollapsed(e){return!!this.find(e).viewDescriptorItem.state.collapsed}setCollapsed(e,t){const{viewDescriptorItem:i}=this.find(e);i.state.collapsed!==t&&(i.state.collapsed=t),this.viewDescriptorsState.updateState(this.allViewDescriptors)}getSize(e){return this.find(e).viewDescriptorItem.state.size}setSizes(e){for(const{id:t,size:i}of e){const{viewDescriptorItem:o}=this.find(t);o.state.size!==i&&(o.state.size=i)}this.viewDescriptorsState.updateState(this.allViewDescriptors)}move(e,t){const i=this.viewDescriptorItems.findIndex(r=>r.viewDescriptor.id===e),o=this.viewDescriptorItems.findIndex(r=>r.viewDescriptor.id===t),s=this.viewDescriptorItems[i],n=this.viewDescriptorItems[o];Pu(this.viewDescriptorItems,i,o);for(let r=0;r<this.viewDescriptorItems.length;r++)this.viewDescriptorItems[r].state.order=r;this.broadCastMovedViewDescriptors({index:i,viewDescriptor:s.viewDescriptor},{index:o,viewDescriptor:n.viewDescriptor})}add(e){const t=[];for(const s of e){const n=s.viewDescriptor;if(n.when)for(const a of n.when.keys())this.contextKeys.add(a);let r=this.viewDescriptorsState.get(n.id);if(r){if(n.workspace)r.visibleWorkspace=Ze(s.visible)?Ze(r.visibleWorkspace)?!n.hideByDefault:r.visibleWorkspace:s.visible;else{const a=r.visibleGlobal;r.visibleGlobal=Ze(s.visible)?Ze(r.visibleGlobal)?!n.hideByDefault:r.visibleGlobal:s.visible,r.visibleGlobal&&!a&&this.logger.info(`Added view ${n.id} in the container ${this.viewContainer.id} and showing it.`,`${a}`,`${n.hideByDefault}`,`${s.visible}`)}r.collapsed=Ze(s.collapsed)?Ze(r.collapsed)?!!n.collapsed:r.collapsed:s.collapsed}else r={active:!1,visibleGlobal:Ze(s.visible)?!n.hideByDefault:s.visible,visibleWorkspace:Ze(s.visible)?!n.hideByDefault:s.visible,collapsed:Ze(s.collapsed)?!!n.collapsed:s.collapsed};this.viewDescriptorsState.set(n.id,r),r.active=this.contextKeyService.contextMatchesRules(n.when),t.push({viewDescriptor:n,state:r})}this.viewDescriptorItems.push(...t),this.viewDescriptorItems.sort(this.compareViewDescriptors.bind(this)),this._onDidChangeAllViewDescriptors.fire({added:t.map(({viewDescriptor:s})=>s),removed:[]});const i=[];for(const s of t)s.state.active&&i.push({viewDescriptorItem:s,visible:this.isViewDescriptorVisible(s)});i.length&&this._onDidChangeActiveViewDescriptors.fire({added:i.map(({viewDescriptorItem:s})=>s.viewDescriptor),removed:[]});const o=[];for(const{viewDescriptorItem:s,visible:n}of i)if(n&&this.isViewDescriptorVisible(s)){const{visibleIndex:r}=this.find(s.viewDescriptor.id);o.push({index:r,viewDescriptor:s.viewDescriptor,size:s.state.size,collapsed:!!s.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}remove(e){const t=[],i=[],o=[],s=[];for(const n of e){if(n.when)for(const a of n.when.keys())this.contextKeys.delete(a);const r=this.viewDescriptorItems.findIndex(a=>a.viewDescriptor.id===n.id);if(r!==-1){t.push(n);const a=this.viewDescriptorItems[r];if(a.state.active&&o.push(a.viewDescriptor),this.isViewDescriptorVisible(a)){const{visibleIndex:d}=this.find(a.viewDescriptor.id);s.push({index:d,viewDescriptor:a.viewDescriptor})}i.push(a)}}i.forEach(n=>this.viewDescriptorItems.splice(this.viewDescriptorItems.indexOf(n),1)),this.broadCastRemovedVisibleViewDescriptors(s),o.length&&this._onDidChangeActiveViewDescriptors.fire({added:[],removed:o}),t.length&&this._onDidChangeAllViewDescriptors.fire({added:[],removed:t})}onDidChangeContext(){const e=[],t=[];for(const s of this.viewDescriptorItems){const n=s.state.active,r=this.contextKeyService.contextMatchesRules(s.viewDescriptor.when);n!==r&&(r?e.push({item:s,visibleWhenActive:this.isViewDescriptorVisibleWhenActive(s)}):t.push(s))}const i=[];for(const s of t)if(this.isViewDescriptorVisible(s)){const{visibleIndex:n}=this.find(s.viewDescriptor.id);i.push({index:n,viewDescriptor:s.viewDescriptor})}t.forEach(s=>s.state.active=!1),e.forEach(({item:s})=>s.state.active=!0),this.broadCastRemovedVisibleViewDescriptors(i),(e.length||t.length)&&this._onDidChangeActiveViewDescriptors.fire({added:e.map(({item:s})=>s.viewDescriptor),removed:t.map(s=>s.viewDescriptor)});const o=[];for(const{item:s,visibleWhenActive:n}of e)if(n&&this.isViewDescriptorVisible(s)){const{visibleIndex:r}=this.find(s.viewDescriptor.id);o.push({index:r,viewDescriptor:s.viewDescriptor,size:s.state.size,collapsed:!!s.state.collapsed})}this.broadCastAddedVisibleViewDescriptors(o)}broadCastAddedVisibleViewDescriptors(e){e.length&&(this._onDidAddVisibleViewDescriptors.fire(e.sort((t,i)=>t.index-i.index)),this.updateState(`Added views:${e.map(t=>t.viewDescriptor.id).join(",")} in ${this.viewContainer.id}`))}broadCastRemovedVisibleViewDescriptors(e){e.length&&(this._onDidRemoveVisibleViewDescriptors.fire(e.sort((t,i)=>i.index-t.index)),this.updateState(`Removed views:${e.map(t=>t.viewDescriptor.id).join(",")} from ${this.viewContainer.id}`))}broadCastMovedViewDescriptors(e,t){this._onDidMoveVisibleViewDescriptors.fire({from:e,to:t}),this.updateState(`Moved view ${e.viewDescriptor.id} to ${t.viewDescriptor.id} in ${this.viewContainer.id}`)}updateState(e){this.logger.info(e),this.viewDescriptorsState.updateState(this.allViewDescriptors),this.updateContainerInfo()}isViewDescriptorVisible(e){return e.state.active?this.isViewDescriptorVisibleWhenActive(e):!1}isViewDescriptorVisibleWhenActive(e){return e.viewDescriptor.workspace?!!e.state.visibleWorkspace:!!e.state.visibleGlobal}find(e){const t=this.findAndIgnoreIfNotFound(e);if(t)return t;throw new Error(`view descriptor ${e} not found`)}findAndIgnoreIfNotFound(e){for(let t=0,i=0;t<this.viewDescriptorItems.length;t++){const o=this.viewDescriptorItems[t];if(o.viewDescriptor.id===e)return{index:t,visibleIndex:i,viewDescriptorItem:o};this.isViewDescriptorVisible(o)&&i++}}compareViewDescriptors(e,t){return e.viewDescriptor.id===t.viewDescriptor.id?0:this.getViewOrder(e)-this.getViewOrder(t)||this.getGroupOrderResult(e.viewDescriptor,t.viewDescriptor)}getViewOrder(e){const t=typeof e.state.order=="number"?e.state.order:e.viewDescriptor.order;return typeof t=="number"?t:Number.MAX_VALUE}getGroupOrderResult(e,t){return!e.group||!t.group||e.group===t.group?0:e.group<t.group?-1:1}};_r=x([h(1,D),h(2,H),h(3,ma),h(4,Ut)],_r);function td(c){return`${c}.state`}let $o=class qt extends R{get viewContainers(){return this.viewContainersRegistry.all}constructor(e,t,i,o,s){super(),this.instantiationService=e,this.contextKeyService=t,this.storageService=i,this.extensionService=o,this.telemetryService=s,this._onDidChangeContainer=this._register(new y),this.onDidChangeContainer=this._onDidChangeContainer.event,this._onDidChangeLocation=this._register(new y),this.onDidChangeLocation=this._onDidChangeLocation.event,this._onDidChangeContainerLocation=this._register(new y),this.onDidChangeContainerLocation=this._onDidChangeContainerLocation.event,this.viewContainerModels=this._register(new vc),this.viewsVisibilityActionDisposables=this._register(new vc),this._onDidChangeViewContainers=this._register(new y),this.onDidChangeViewContainers=this._onDidChangeViewContainers.event,this.activeViewContextKeys=new Map,this.movableViewContextKeys=new Map,this.defaultViewLocationContextKeys=new Map,this.defaultViewContainerLocationContextKeys=new Map,this.viewContainersRegistry=de.as(lt.ViewContainersRegistry),this.viewsRegistry=de.as(lt.ViewsRegistry),this.migrateToViewsCustomizationsStorage(),this.viewContainersCustomLocations=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),this.viewDescriptorsCustomLocations=new Map(Object.entries(this.viewCustomizations.viewLocations)),this.viewContainerBadgeEnablementStates=new Map(Object.entries(this.viewCustomizations.viewContainerBadgeEnablementStates)),this.viewContainers.forEach(n=>this.onDidRegisterViewContainer(n)),this._register(this.viewsRegistry.onViewsRegistered(n=>this.onDidRegisterViews(n))),this._register(this.viewsRegistry.onViewsDeregistered(({views:n,viewContainer:r})=>this.onDidDeregisterViews(n,r))),this._register(this.viewsRegistry.onDidChangeContainer(({views:n,from:r,to:a})=>this.onDidChangeDefaultContainer(n,r,a))),this._register(this.viewContainersRegistry.onDidRegister(({viewContainer:n})=>{this.onDidRegisterViewContainer(n),this._onDidChangeViewContainers.fire({added:[{container:n,location:this.getViewContainerLocation(n)}],removed:[]})})),this._register(this.viewContainersRegistry.onDidDeregister(({viewContainer:n})=>{this.onDidDeregisterViewContainer(n),this._onDidChangeViewContainers.fire({removed:[{container:n,location:this.getViewContainerLocation(n)}],added:[]})})),this._register(this.storageService.onDidChangeValue(n=>{this.onDidStorageChange(n)})),this.extensionService.whenInstalledExtensionsRegistered().then(()=>this.whenExtensionsRegistered())}migrateToViewsCustomizationsStorage(){if(this.storageService.get(qt.VIEWS_CUSTOMIZATIONS,0))return;const e=this.storageService.get("views.cachedViewContainerLocations",0),t=this.storageService.get("views.cachedViewPositions",0);if(!e&&!t)return;const i=e?JSON.parse(e):[],o=t?JSON.parse(t):[],s={viewContainerLocations:i.reduce((n,[r,a])=>(n[r]=a,n),{}),viewLocations:o.reduce((n,[r,{containerId:a}])=>(n[r]=a,n),{}),viewContainerBadgeEnablementStates:{}};this.storageService.store(qt.VIEWS_CUSTOMIZATIONS,JSON.stringify(s),0,0),this.storageService.remove("views.cachedViewContainerLocations",0),this.storageService.remove("views.cachedViewPositions",0)}registerGroupedViews(e){for(const[t,i]of e.entries()){const o=this.viewContainersRegistry.get(t);if(!o||!this.viewContainerModels.has(o)){if(this.isGeneratedContainerId(t)){const n=this.viewContainersCustomLocations.get(t);n!==void 0&&this.registerGeneratedViewContainer(n,t)}continue}const s=i.filter(n=>this.getViewContainerModel(o).allViewDescriptors.filter(r=>r.id===n.id).length===0);this.addViews(o,s)}}deregisterGroupedViews(e){for(const[t,i]of e.entries()){const o=this.viewContainersRegistry.get(t);!o||!this.viewContainerModels.has(o)||this.removeViews(o,i)}}moveOrphanViewsToDefaultLocation(){for(const[e,t]of this.viewDescriptorsCustomLocations.entries()){if(this.viewContainersRegistry.get(t))continue;const i=this.viewsRegistry.getViewContainer(e),o=this.getViewDescriptorById(e);i&&o&&this.addViews(i,[o])}}whenExtensionsRegistered(){this.moveOrphanViewsToDefaultLocation();for(const e of[...this.viewContainersCustomLocations.keys()])this.cleanUpGeneratedViewContainer(e);this.saveViewCustomizations(),this.registerViewsVisibilityActions()}onDidRegisterViews(e){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(({views:t,viewContainer:i})=>{const o=this.regroupViews(i.id,t);this.registerGroupedViews(o),t.forEach(s=>this.getOrCreateMovableViewContextKey(s).set(!!s.canMoveView))})})}isGeneratedContainerId(e){return e.startsWith(qt.COMMON_CONTAINER_ID_PREFIX)}onDidDeregisterViews(e,t){const i=this.regroupViews(t.id,e);this.deregisterGroupedViews(i),this.contextKeyService.bufferChangeEvents(()=>{e.forEach(o=>this.getOrCreateMovableViewContextKey(o).set(!1))})}regroupViews(e,t){const i=new Map;for(const o of t){const s=this.viewDescriptorsCustomLocations.get(o.id)??e;let n=i.get(s);n||i.set(s,n=[]),n.push(o)}return i}getViewDescriptorById(e){return this.viewsRegistry.getView(e)}getViewLocationById(e){const t=this.getViewContainerByViewId(e);return t===null?null:this.getViewContainerLocation(t)}getViewContainerByViewId(e){const t=this.viewDescriptorsCustomLocations.get(e);return t?this.viewContainersRegistry.get(t)??null:this.getDefaultContainerById(e)}getViewContainerLocation(e){return this.viewContainersCustomLocations.get(e.id)??this.getDefaultViewContainerLocation(e)}getDefaultViewContainerLocation(e){return this.viewContainersRegistry.getViewContainerLocation(e)}getDefaultContainerById(e){return this.viewsRegistry.getViewContainer(e)??null}getViewContainerModel(e){return this.getOrRegisterViewContainerModel(e)}getViewContainerById(e){return this.viewContainersRegistry.get(e)||null}getViewContainersByLocation(e){return this.viewContainers.filter(t=>this.getViewContainerLocation(t)===e)}getDefaultViewContainer(e){return this.viewContainersRegistry.getDefaultViewContainer(e)}moveViewContainerToLocation(e,t,i){this.moveViewContainerToLocationWithoutSaving(e,t,i),this.saveViewCustomizations()}getViewContainerBadgeEnablementState(e){return this.viewContainerBadgeEnablementStates.get(e)??!0}setViewContainerBadgeEnablementState(e,t){this.viewContainerBadgeEnablementStates.set(e,t),this.saveViewCustomizations()}moveViewToLocation(e,t){const i=this.registerGeneratedViewContainer(t);this.moveViewsToContainer([e],i)}moveViewsToContainer(e,t,i){if(!e.length)return;const o=this.getViewContainerByViewId(e[0].id),s=t;o&&s&&o!==s&&(this.moveViewsWithoutSaving(e,o,s,i),this.cleanUpGeneratedViewContainer(o.id),this.saveViewCustomizations(),this.reportMovedViews(e,o,s))}reset(){for(const e of this.viewContainers){const t=this.getViewContainerModel(e);for(const s of t.allViewDescriptors){const n=this.getDefaultContainerById(s.id),r=this.getViewContainerByViewId(s.id);r&&n&&r!==n&&this.moveViewsWithoutSaving([s],r,n)}const i=this.getDefaultViewContainerLocation(e),o=this.getViewContainerLocation(e);i!==null&&o!==i&&this.moveViewContainerToLocationWithoutSaving(e,i),this.cleanUpGeneratedViewContainer(e.id)}this.viewContainersCustomLocations.clear(),this.viewDescriptorsCustomLocations.clear(),this.saveViewCustomizations()}isViewContainerRemovedPermanently(e){return this.isGeneratedContainerId(e)&&!this.viewContainersCustomLocations.has(e)}onDidChangeDefaultContainer(e,t,i){const o=e.filter(s=>!this.viewDescriptorsCustomLocations.has(s.id)||!this.viewContainers.includes(t)&&this.viewDescriptorsCustomLocations.get(s.id)===t.id);o.length&&this.moveViewsWithoutSaving(o,t,i)}reportMovedViews(e,t,i){const o=g=>g.id.startsWith(qt.COMMON_CONTAINER_ID_PREFIX)?"custom":g.extensionId?"extension":g.id,s=this.getViewContainerLocation(t),n=this.getViewContainerLocation(i),r=e.length,a=o(t),d=o(i),l=s===1?"panel":"sidebar",u=n===1?"panel":"sidebar";this.telemetryService.publicLog2("viewDescriptorService.moveViews",{viewCount:r,fromContainer:a,toContainer:d,fromLocation:l,toLocation:u})}moveViewsWithoutSaving(e,t,i,o=So.Expand){this.removeViews(t,e),this.addViews(i,e,o);const s=this.getViewContainerLocation(t),n=this.getViewContainerLocation(i);s!==n&&this._onDidChangeLocation.fire({views:e,from:s,to:n}),this._onDidChangeContainer.fire({views:e,from:t,to:i})}moveViewContainerToLocationWithoutSaving(e,t,i){const o=this.getViewContainerLocation(e),s=t;if(o!==s){const n=this.isGeneratedContainerId(e.id),r=s===this.getDefaultViewContainerLocation(e);n||!r?this.viewContainersCustomLocations.set(e.id,s):this.viewContainersCustomLocations.delete(e.id),this.getOrCreateDefaultViewContainerLocationContextKey(e).set(n||r),e.requestedIndex=i,this._onDidChangeContainerLocation.fire({viewContainer:e,from:o,to:s});const a=this.getViewsByContainer(e);this._onDidChangeLocation.fire({views:a,from:o,to:s})}}cleanUpGeneratedViewContainer(e){var i;if(!this.isGeneratedContainerId(e))return;const t=this.getViewContainerById(e);t&&((i=this.getViewContainerModel(t))!=null&&i.allViewDescriptors.length)||[...this.viewDescriptorsCustomLocations.values()].includes(e)||(t&&this.viewContainersRegistry.deregisterViewContainer(t),this.viewContainersCustomLocations.delete(e),this.viewContainerBadgeEnablementStates.delete(e),this.storageService.remove(uh((t==null?void 0:t.storageId)||td(e)),0))}registerGeneratedViewContainer(e,t){const i=t||this.generateContainerId(e),o=this.viewContainersRegistry.registerViewContainer({id:i,ctorDescriptor:new J(fa,[i,{mergeViewWithContainerWhenSingleView:!0}]),title:i,icon:e===0?Sd:void 0,storageId:td(i),hideIfEmpty:!0},e,{doNotRegisterOpenCommand:!0});return this.viewContainersCustomLocations.get(o.id)!==e&&this.viewContainersCustomLocations.set(o.id,e),this.getOrCreateDefaultViewContainerLocationContextKey(o).set(!0),o}onDidStorageChange(e){e.key===qt.VIEWS_CUSTOMIZATIONS&&e.scope===0&&JSON.stringify(this.viewCustomizations)!==this.getStoredViewCustomizationsValue()&&this.onDidViewCustomizationsStorageChange()}onDidViewCustomizationsStorageChange(){this._viewCustomizations=void 0;const e=new Map(Object.entries(this.viewCustomizations.viewContainerLocations)),t=new Map(Object.entries(this.viewCustomizations.viewLocations)),i=[],o=[];for(const[s,n]of e.entries()){const r=this.getViewContainerById(s);r?n!==this.getViewContainerLocation(r)&&i.push([r,n]):this.isGeneratedContainerId(s)&&this.registerGeneratedViewContainer(n,s)}for(const s of this.viewContainers)if(!e.has(s.id)){const n=this.getViewContainerLocation(s),r=this.getDefaultViewContainerLocation(s);n!==r&&i.push([s,r])}for(const[s,n]of t.entries()){const r=this.getViewDescriptorById(s);if(r){const a=this.getViewContainerByViewId(s),d=this.viewContainersRegistry.get(n);a&&d&&d!==a&&o.push({views:[r],from:a,to:d})}}for(const s of this.viewContainers){const n=this.getViewContainerModel(s);for(const r of n.allViewDescriptors)if(!t.has(r.id)){const a=this.getViewContainerByViewId(r.id),d=this.getDefaultContainerById(r.id);a&&d&&a!==d&&o.push({views:[r],from:a,to:d})}}for(const[s,n]of i)this.moveViewContainerToLocationWithoutSaving(s,n);for(const{views:s,from:n,to:r}of o)this.moveViewsWithoutSaving(s,n,r,So.Default);this.viewContainersCustomLocations=e,this.viewDescriptorsCustomLocations=t}generateContainerId(e){return`${qt.COMMON_CONTAINER_ID_PREFIX}.${wc(e)}.${Ed()}`}saveViewCustomizations(){const e={viewContainerLocations:{},viewLocations:{},viewContainerBadgeEnablementStates:{}};for(const[t,i]of this.viewContainersCustomLocations){const o=this.getViewContainerById(t);o&&!this.isGeneratedContainerId(t)&&i===this.getDefaultViewContainerLocation(o)||(e.viewContainerLocations[t]=i)}for(const[t,i]of this.viewDescriptorsCustomLocations){const o=this.getViewContainerById(i);if(o){const s=this.getDefaultContainerById(t);if((s==null?void 0:s.id)===o.id)continue}e.viewLocations[t]=i}for(const[t,i]of this.viewContainerBadgeEnablementStates)i===!1&&(e.viewContainerBadgeEnablementStates[t]=i);this.viewCustomizations=e}get viewCustomizations(){return this._viewCustomizations||(this._viewCustomizations=JSON.parse(this.getStoredViewCustomizationsValue()),this._viewCustomizations.viewContainerLocations=this._viewCustomizations.viewContainerLocations??{},this._viewCustomizations.viewLocations=this._viewCustomizations.viewLocations??{},this._viewCustomizations.viewContainerBadgeEnablementStates=this._viewCustomizations.viewContainerBadgeEnablementStates??{}),this._viewCustomizations}set viewCustomizations(e){const t=JSON.stringify(e);JSON.stringify(this.viewCustomizations)!==t&&(this._viewCustomizations=e,this.setStoredViewCustomizationsValue(t))}getStoredViewCustomizationsValue(){return this.storageService.get(qt.VIEWS_CUSTOMIZATIONS,0,"{}")}setStoredViewCustomizationsValue(e){this.storageService.store(qt.VIEWS_CUSTOMIZATIONS,e,0,0)}getViewsByContainer(e){const t=this.viewsRegistry.getViews(e).filter(i=>(this.viewDescriptorsCustomLocations.get(i.id)??e.id)===e.id);for(const[i,o]of this.viewDescriptorsCustomLocations.entries()){if(o!==e.id||this.viewsRegistry.getViewContainer(i)===e)continue;const s=this.getViewDescriptorById(i);s&&t.push(s)}return t}onDidRegisterViewContainer(e){const t=this.isGeneratedContainerId(e.id)?!0:this.getViewContainerLocation(e)===this.getDefaultViewContainerLocation(e);this.getOrCreateDefaultViewContainerLocationContextKey(e).set(t),this.getOrRegisterViewContainerModel(e)}getOrRegisterViewContainerModel(e){var i;let t=(i=this.viewContainerModels.get(e))==null?void 0:i.viewContainerModel;if(!t){const o=new A;t=o.add(this.instantiationService.createInstance(_r,e)),this.onDidChangeActiveViews({added:t.activeViewDescriptors,removed:[]}),t.onDidChangeActiveViewDescriptors(n=>this.onDidChangeActiveViews(n),this,o),this.onDidChangeVisibleViews({added:[...t.visibleViewDescriptors],removed:[]}),t.onDidAddVisibleViewDescriptors(n=>this.onDidChangeVisibleViews({added:n.map(({viewDescriptor:r})=>r),removed:[]}),this,o),t.onDidRemoveVisibleViewDescriptors(n=>this.onDidChangeVisibleViews({added:[],removed:n.map(({viewDescriptor:r})=>r)}),this,o),o.add(ie(()=>this.viewsVisibilityActionDisposables.deleteAndDispose(e))),o.add(this.registerResetViewContainerAction(e)),this.viewContainerModels.set(e,{viewContainerModel:t,disposables:o,dispose:()=>o.dispose()}),this.onDidRegisterViews([{views:this.viewsRegistry.getViews(e),viewContainer:e}]);const s=this.getViewsByContainer(e).filter(n=>this.getDefaultContainerById(n.id)!==e);s.length&&(this.addViews(e,s),this.contextKeyService.bufferChangeEvents(()=>{s.forEach(n=>this.getOrCreateMovableViewContextKey(n).set(!!n.canMoveView))}))}return t}onDidDeregisterViewContainer(e){this.viewContainerModels.deleteAndDispose(e)}onDidChangeActiveViews({added:e,removed:t}){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(i=>this.getOrCreateActiveViewContextKey(i).set(!0)),t.forEach(i=>this.getOrCreateActiveViewContextKey(i).set(!1))})}onDidChangeVisibleViews({added:e,removed:t}){this.contextKeyService.bufferChangeEvents(()=>{e.forEach(i=>this.getOrCreateVisibleViewContextKey(i).set(!0)),t.forEach(i=>this.getOrCreateVisibleViewContextKey(i).set(!1))})}registerViewsVisibilityActions(){for(const[e,{viewContainerModel:t,disposables:i}]of this.viewContainerModels)this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(t)),i.add(I.any(t.onDidChangeActiveViewDescriptors,t.onDidAddVisibleViewDescriptors,t.onDidRemoveVisibleViewDescriptors,t.onDidMoveVisibleViewDescriptors)(o=>this.viewsVisibilityActionDisposables.set(e,this.registerViewsVisibilityActionsForContainer(t))))}registerViewsVisibilityActionsForContainer(e){const t=new A;return e.activeViewDescriptors.forEach((i,o)=>{i.remoteAuthority||(t.add(te(class extends yc{constructor(){super({id:`${i.id}.toggleVisibility`,viewPaneContainerId:e.viewContainer.id,precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?v.true():v.false(),toggled:v.has(`${i.id}.visible`),title:i.name,menu:[{id:Lu,group:"1_toggleViews",when:v.and(v.equals("viewContainer",e.viewContainer.id),v.equals("viewContainerLocation",wc(0))),order:o},{id:b.ViewContainerTitleContext,when:v.and(v.equals("viewContainer",e.viewContainer.id)),order:o,group:"1_toggleVisibility"},{id:b.ViewTitleContext,when:v.and(e.visibleViewDescriptors.length>1?v.or(...e.visibleViewDescriptors.map(s=>v.equals("view",s.id))):v.false()),order:o,group:"2_toggleVisibility"}]})}async runInViewPaneContainer(s,n){n.toggleViewVisibility(i.id)}})),t.add(te(class extends yc{constructor(){super({id:`${i.id}.removeView`,viewPaneContainerId:e.viewContainer.id,title:p("hideView","Hide '{0}'",i.name),precondition:i.canToggleVisibility&&(!e.isVisible(i.id)||e.visibleViewDescriptors.length>1)?v.true():v.false(),menu:[{id:b.ViewTitleContext,when:v.and(v.equals("view",i.id),v.has(`${i.id}.visible`)),group:"1_hide",order:1}]})}async runInViewPaneContainer(s,n){n.toggleViewVisibility(i.id)}})))}),t}registerResetViewContainerAction(e){const t=this;return te(class extends qe{constructor(){super({id:`${e.id}.resetViewContainerLocation`,title:{original:"Reset Location",value:p("resetViewLocation","Reset Location")},menu:[{id:b.ViewContainerTitleContext,when:v.or(v.and(v.equals("viewContainer",e.id),v.equals(`${e.id}.defaultViewContainerLocation`,!1)))}]})}run(){t.moveViewContainerToLocation(e,t.getDefaultViewContainerLocation(e))}})}addViews(e,t,i=So.Default){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(o=>{const s=this.getDefaultContainerById(o.id)===e;this.getOrCreateDefaultViewLocationContextKey(o).set(s),s?this.viewDescriptorsCustomLocations.delete(o.id):this.viewDescriptorsCustomLocations.set(o.id,e.id)})}),this.getViewContainerModel(e).add(t.map(o=>({viewDescriptor:o,collapsed:i===So.Default?void 0:!1,visible:i===So.Default?void 0:!0})))}removeViews(e,t){this.contextKeyService.bufferChangeEvents(()=>{t.forEach(i=>{this.viewDescriptorsCustomLocations.get(i.id)===e.id&&this.viewDescriptorsCustomLocations.delete(i.id),this.getOrCreateDefaultViewLocationContextKey(i).set(!1)})}),this.getViewContainerModel(e).remove(t)}getOrCreateActiveViewContextKey(e){const t=`${e.id}.active`;let i=this.activeViewContextKeys.get(t);return i||(i=new N(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateVisibleViewContextKey(e){const t=`${e.id}.visible`;let i=this.activeViewContextKeys.get(t);return i||(i=new N(t,!1).bindTo(this.contextKeyService),this.activeViewContextKeys.set(t,i)),i}getOrCreateMovableViewContextKey(e){const t=`${e.id}.canMove`;let i=this.movableViewContextKeys.get(t);return i||(i=new N(t,!1).bindTo(this.contextKeyService),this.movableViewContextKeys.set(t,i)),i}getOrCreateDefaultViewLocationContextKey(e){const t=`${e.id}.defaultViewLocation`;let i=this.defaultViewLocationContextKeys.get(t);return i||(i=new N(t,!1).bindTo(this.contextKeyService),this.defaultViewLocationContextKeys.set(t,i)),i}getOrCreateDefaultViewContainerLocationContextKey(e){const t=`${e.id}.defaultViewContainerLocation`;let i=this.defaultViewContainerLocationContextKeys.get(t);return i||(i=new N(t,!1).bindTo(this.contextKeyService),this.defaultViewContainerLocationContextKeys.set(t,i)),i}};$o.VIEWS_CUSTOMIZATIONS="views.customizations";$o.COMMON_CONTAINER_ID_PREFIX="workbench.views.service";$o=x([h(0,D),h(1,H),h(2,Se),h(3,yi),h(4,Ye)],$o);const Di="workbench.action.globalActivity",Ns="workbench.action.accountsActivity";let kr=class extends R{constructor(e,t,i){super(),this.viewId=e,this.viewDescriptorService=t,this.activityService=i,this.activity=void 0,this.activityDisposable=R.None,this._register(I.filter(this.viewDescriptorService.onDidChangeContainer,o=>o.views.some(s=>s.id===e))(()=>this.update())),this._register(I.filter(this.viewDescriptorService.onDidChangeLocation,o=>o.views.some(s=>s.id===e))(()=>this.update()))}setActivity(e){this.activity=e,this.update()}clearActivity(){this.activity=void 0,this.update()}update(){this.activityDisposable.dispose();const e=this.viewDescriptorService.getViewContainerByViewId(this.viewId);e&&this.activity&&(this.activityDisposable=this.activityService.showViewContainerActivity(e.id,this.activity))}dispose(){this.activityDisposable.dispose()}};kr=x([h(1,nt),h(2,ts)],kr);let xr=class{constructor(e,t,i){this.paneCompositeService=e,this.viewDescriptorService=t,this.instantiationService=i,this.viewActivities=new Map}showViewContainerActivity(e,{badge:t,clazz:i,priority:o}){const s=this.viewDescriptorService.getViewContainerById(e);if(s){const n=this.viewDescriptorService.getViewContainerLocation(s);if(n!==null)return this.paneCompositeService.showActivity(s.id,n,t,i,o)}return R.None}showViewActivity(e,t){let i=this.viewActivities.get(e);i?i.id++:(i={id:1,activity:this.instantiationService.createInstance(kr,e)},this.viewActivities.set(e,i));const o=i.id;i.activity.setActivity(t);const s=i;return ie(()=>{s.id===o&&(s.activity.dispose(),this.viewActivities.delete(e))})}showAccountsActivity({badge:e,clazz:t,priority:i}){return this.paneCompositeService.showActivity(Ns,0,e,t,i)}showGlobalActivity({badge:e,clazz:t,priority:i}){return this.paneCompositeService.showActivity(Di,0,e,t,i)}};xr=x([h(0,zi),h(1,nt),h(2,D)],xr);var Pb='.monaco-workbench .part.activitybar{height:100%;width:48px}.monaco-workbench .activitybar.bordered:before{border-color:inherit;box-sizing:border-box;content:"";float:left;height:100%;position:absolute;width:0}.monaco-workbench .activitybar.left.bordered:before{border-right-style:solid;border-right-width:1px;right:0}.monaco-workbench .activitybar.right.bordered:before{border-left-style:solid;border-left-width:1px;left:0}.monaco-workbench .activitybar>.content{display:flex;flex-direction:column;height:100%;justify-content:space-between}.monaco-workbench .activitybar>.content .monaco-action-bar{background-color:inherit;text-align:left}.monaco-workbench .activitybar .action-item:focus{outline:0!important}.monaco-workbench .activitybar>.content>.composite-bar{margin-bottom:auto}.monaco-workbench .activitybar .menubar,.monaco-workbench .activitybar .menubar.compact .toolbar-toggle-more{height:35px;width:100%}';be(Pb,{});var Lb='.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item{display:block;position:relative}.monaco-workbench .activitybar>.content .composite-bar>.monaco-action-bar .action-item:after,.monaco-workbench .activitybar>.content .composite-bar>.monaco-action-bar .action-item:before{background-color:transparent;content:"";display:none;height:2px;position:absolute;transition-delay:.1s;transition-duration:0ms;transition-property:background-color;width:48px}.monaco-workbench .activitybar>.content.dragged-over .composite-bar>.monaco-action-bar .action-item:after,.monaco-workbench .activitybar>.content.dragged-over .composite-bar>.monaco-action-bar .action-item:before{display:block}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:before{margin-top:-2px;top:1px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:after{bottom:1px;margin-bottom:-2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:first-of-type:before{margin-top:-2px;top:2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:last-of-type:after{bottom:2px;margin-bottom:-2px}.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:before{transition-delay:0s}.monaco-workbench .activitybar>.content.dragged-over-head>.composite-bar>.monaco-action-bar .action-item:first-of-type:before,.monaco-workbench .activitybar>.content.dragged-over-tail>.composite-bar>.monaco-action-bar .action-item:last-of-type:after,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.bottom+.action-item:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item.top:before,.monaco-workbench .activitybar>.content>.composite-bar>.monaco-action-bar .action-item:last-of-type.bottom:after{background-color:var(--insert-border-color)}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label{box-sizing:border-box;display:flex;height:48px;margin-right:0;overflow:hidden;position:relative;width:48px;z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label:not(.codicon){font-size:15px;line-height:40px;padding:0 0 0 48px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-label.codicon{align-items:center;font-size:24px;justify-content:center}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.active .action-label.codicon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .action-label.codicon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .action-label.codicon{color:var(--vscode-activityBar-foreground)!important}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.active .action-label.uri-icon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .action-label.uri-icon,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .action-label.uri-icon{background-color:var(--vscode-activityBar-foreground)!important}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked .active-item-indicator:before,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .active-item-indicator:before{border-left:2px solid;content:"";height:100%;position:absolute;top:0;width:0;z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked .active-item-indicator:before{height:100%;top:0}.monaco-workbench.hc-black .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked:not(:focus) .active-item-indicator.action-item,.monaco-workbench.hc-light .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.checked:not(:focus) .active-item-indicator{display:none}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item.clicked:focus:before{border-left:none!important}.monaco-workbench .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item .active-item-indicator:before{left:0}.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item .active-item-indicator:before{right:0}.monaco-workbench.hc-black .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-black .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-light .activitybar.left>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before,.monaco-workbench.hc-light .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus:before{outline:none}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{bottom:0;height:100%;left:0;margin:auto;overflow:hidden;position:absolute;top:0;width:100%}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge{z-index:2}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{z-index:1}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator{pointer-events:none}.monaco-workbench.border .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .active-item-indicator{left:-2px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .badge-content{border-radius:20px;font-size:9px;font-weight:600;height:16px;line-height:16px;min-width:8px;padding:0 4px;position:absolute;right:8px;text-align:center;top:24px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge .profile-badge-content{background-color:var(--vscode-profileBadge-background);border:2px solid var(--vscode-activityBar-background);border-radius:7px;color:var(--vscode-profileBadge-foreground);font-size:9px;font-weight:600;line-height:10px;padding:2px 3px;position:absolute;right:6px;top:24px}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:active .profile-badge-content,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:focus .profile-badge-content,.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .action-item:hover .profile-badge-content{color:var(--vscode-activityBar-foreground)}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .codicon.badge-content{font-size:12px;font-weight:unset;justify-content:center;padding:0}.monaco-workbench .activitybar>.content :not(.monaco-menu)>.monaco-action-bar .badge .codicon.badge-content:before{text-align:center;vertical-align:baseline}.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .badge,.monaco-workbench .activitybar.right>.content :not(.monaco-menu)>.monaco-action-bar .profile-badge{left:auto;right:0}';be(Lb,{});async function Ob(c,e){const t=await c.getPassword(`${e.urlProtocol}.login`,"account");if(t)try{const i=JSON.parse(t);if(i&&Nt(i.id)&&Nt(i.accessToken)&&Nt(i.providerId))return i}catch{}}q.registerCommand("workbench.getCodeExchangeProxyEndpoints",function(c,e){var i;return(i=c.get(Ou).options)==null?void 0:i.codeExchangeProxyEndpoints});_.appendMenuItem(b.AccountsContext,{command:{id:"noAuthenticationProviders",title:p("authentication.Placeholder","No accounts requested yet..."),precondition:v.false()}});const Mb=bo("IAuthenticationService"),Nb=bo("credentialsService");let jo=class ph extends Ms{constructor(e,t,i,o,s){super(e),this.paneCompositePart=t,this.layoutService=i,this.telemetryService=o,this.configurationService=s,this.lastRun=0}updateActivity(e){this.activity=e}async run(e){if(e instanceof MouseEvent&&e.button===2)return;const t=Date.now();if(t>this.lastRun&&t-this.lastRun<ph.preventDoubleClickDelay)return;this.lastRun=t;const i=this.layoutService.isVisible("workbench.parts.sidebar"),o=this.paneCompositePart.getActivePaneComposite(),s=this.configurationService.getValue("workbench.activityBar.iconClickBehavior"),n=e&&"preserveFocus"in e?!e.preserveFocus:!0;if(i&&(o==null?void 0:o.getId())===this.activity.id){switch(s){case"focus":this.logAction("refocus"),this.paneCompositePart.openPaneComposite(this.activity.id,n);break;case"toggle":default:this.logAction("hide"),this.layoutService.setPartHidden(!0,"workbench.parts.sidebar");break}return}return this.logAction("show"),await this.paneCompositePart.openPaneComposite(this.activity.id,n),this.activate()}logAction(e){this.telemetryService.publicLog2("activityBarAction",{viewletId:this.activity.id,action:e})}};jo.preventDoubleClickDelay=300;jo=x([h(2,pt),h(3,Ye),h(4,L)],jo);let Dr=class extends Sb{constructor(e,t,i,o,s,n,r,a,d,l,u){super(e,i,()=>!0,o,s,d,u),this.contextMenuActionsProvider=t,this.menuService=n,this.contextMenuService=r,this.contextKeyService=a,this.environmentService=l}render(e){super.render(e),this._register(w(this.container,S.MOUSE_DOWN,async t=>{K.stop(t,!0),(t==null?void 0:t.button)!==2&&this.run()})),this._register(w(this.container,S.CONTEXT_MENU,async t=>{const i=new A,o=await this.resolveContextMenuActions(i),s=new _t(t),n={x:s.posx,y:s.posy};this.contextMenuService.showContextMenu({getAnchor:()=>n,getActions:()=>o,onHide:()=>i.dispose()})})),this._register(w(this.container,S.KEY_UP,t=>{const i=new Ct(t);(i.equals(3)||i.equals(10))&&(K.stop(t,!0),this.run())})),this._register(w(this.container,Te.Tap,t=>{K.stop(t,!0),this.run()}))}async resolveContextMenuActions(e){return this.contextMenuActionsProvider()}};Dr=x([h(3,X),h(4,gt),h(5,Xe),h(6,xe),h(7,H),h(8,L),h(9,Ut),h(10,we)],Dr);let Xs=class extends Dr{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f){super(t,i,{draggable:!1,colors:s,icon:o,hasPopup:!0,hoverOptions:n},r,a,d,l,u,g,m,f),this.menuId=e}async run(){const e=new A,t=e.add(this.menuService.createMenu(this.menuId,this.contextKeyService)),i=await this.resolveMainMenuActions(t,e);this.contextMenuService.showContextMenu({getAnchor:()=>this.container,anchorAlignment:this.configurationService.getValue("workbench.sideBar.location")==="left"?1:0,anchorAxisAlignment:1,getActions:()=>i,onHide:()=>e.dispose(),menuActionOptions:{renderShortTitle:!0}})}async resolveMainMenuActions(e,t){const i=[];return Ui(e,{renderShortTitle:!0},{primary:[],secondary:i}),i}};Xs=x([h(6,X),h(7,gt),h(8,Xe),h(9,xe),h(10,H),h(11,L),h(12,Ut),h(13,we)],Xs);let Pi=class gh extends Xs{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E,V){super(b.AccountsContext,e,t,!0,i,o,s,n,a,r,d,m,u,C),this.authenticationService=l,this.productService=g,this.storageService=f,this.credentialsService=E,this.logService=V,this.groupedAccounts=new Map,this.problematicProviders=new Set,this.initialized=!1,this.sessionFromEmbedder=Ob(this.credentialsService,this.productService),this.registerListeners(),this.initialize()}registerListeners(){this._register(this.authenticationService.onDidRegisterAuthenticationProvider(async e=>{await this.addAccountsFromProvider(e.id)})),this._register(this.authenticationService.onDidUnregisterAuthenticationProvider(e=>{this.groupedAccounts.delete(e.id),this.problematicProviders.delete(e.id)})),this._register(this.authenticationService.onDidChangeSessions(async e=>{for(const t of[...e.event.changed,...e.event.added])try{await this.addOrUpdateAccount(e.providerId,t.account)}catch(i){this.logService.error(i)}for(const t of e.event.removed)this.removeAccount(e.providerId,t.account)}))}async initialize(){const e=this.authenticationService.getProviderIds(),t=await Promise.allSettled(e.map(i=>this.addAccountsFromProvider(i)));for(const i of t)i.status==="rejected"&&this.logService.error(i.reason);this.initialized=!0}async resolveMainMenuActions(e,t){await super.resolveMainMenuActions(e,t);const i=this.authenticationService.getProviderIds(),o=e.getActions();let s=[];for(const n of i){if(!this.initialized){const d=t.add(new ke("noAccountsAvailable",p("loading","Loading..."),void 0,!1));s.push(d);break}const r=this.authenticationService.getLabel(n),a=this.groupedAccounts.get(n);if(!a){if(this.problematicProviders.has(n)){const d=t.add(new ke("providerUnavailable",p("authProviderUnavailable","{0} is currently unavailable",r),void 0,!1));s.push(d);try{await this.addAccountsFromProvider(n)}catch(l){this.logService.error(l)}}continue}for(const d of a){const u=[t.add(new ke(`configureSessions${d.label}`,p("manageTrustedExtensions","Manage Trusted Extensions"),void 0,!0,()=>this.authenticationService.manageTrustedExtensionsForAccount(n,d.label)))];if(d.canSignOut){const m=t.add(new ke("signOut",p("signOut","Sign Out"),void 0,!0,async()=>{const C=(await this.authenticationService.getSessions(n)).filter(E=>E.account.id===d.id);return await this.authenticationService.removeAccountSessions(n,d.label,C)}));u.push(m)}const g=new ao("activitybar.submenu",`${d.label} (${r})`,u);s.push(g)}}if(i.length&&!s.length){const n=t.add(new ke("noAccountsAvailable",p("noAccounts","You are not signed in to any accounts"),void 0,!1));s.push(n)}return s.length&&o.length&&s.push(new Fe),o.forEach((n,r)=>{const a=n[1];s=s.concat(a),r!==o.length-1&&s.push(new Fe)}),s}async resolveContextMenuActions(e){const t=await super.resolveContextMenuActions(e);return t.unshift(Ne({id:"hideAccounts",label:p("hideAccounts","Hide Accounts"),run:()=>this.storageService.store(gh.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,!1,0,0)}),new Fe),t}async addOrUpdateAccount(e,t){let i=this.groupedAccounts.get(e);if(i){const n=i.find(r=>r.id===t.id);if(n){n.label!==t.label&&(n.label=t.label);return}}else i=[],this.groupedAccounts.set(e,i);const o=await this.sessionFromEmbedder;let s=!!(o!=null&&o.canSignOut);s||(o!=null&&o.id?s=!(await this.authenticationService.getSessions(e)).filter(r=>r.account.id===t.id).some(r=>r.id===o.id):s=!0),i.push({...t,canSignOut:s})}removeAccount(e,t){const i=this.groupedAccounts.get(e);if(!i)return;const o=i.findIndex(s=>s.id===t.id);o!==-1&&(i.splice(o,1),i.length===0&&this.groupedAccounts.delete(e))}async addAccountsFromProvider(e){try{const t=await this.authenticationService.getSessions(e);this.problematicProviders.delete(e);for(const i of t)try{await this.addOrUpdateAccount(e,i.account)}catch(o){this.logService.error(o)}}catch(t){this.logService.error(t),this.problematicProviders.add(e)}}};Pi.ACCOUNTS_VISIBILITY_PREFERENCE_KEY="workbench.activity.showAccounts";Pi=x([h(4,X),h(5,gt),h(6,xe),h(7,Xe),h(8,H),h(9,Mb),h(10,Ut),h(11,Mu),h(12,L),h(13,Se),h(14,we),h(15,Nb),h(16,rt)],Pi);let Ir=class extends Xs{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m){super(b.GlobalActivity,e,t,!0,i,o,n,r,a,d,l,u,g,m),this.userDataProfileService=s,this._register(I.any(this.userDataProfileService.onDidUpdateCurrentProfile,this.userDataProfileService.onDidChangeCurrentProfile)(()=>this.updateProfileBadge()))}render(e){super.render(e),this.profileBadge=se(e,z(".profile-badge")),this.profileBadgeContent=se(this.profileBadge,z(".profile-badge-content")),this.updateProfileBadge()}updateProfileBadge(){!this.profileBadge||!this.profileBadgeContent||(oi(this.profileBadgeContent),mo(this.profileBadge),!this.userDataProfileService.currentProfile.isDefault&&(this.action.getBadge()||(this.profileBadgeContent.textContent=this.userDataProfileService.currentProfile.name.substring(0,2).toUpperCase(),go(this.profileBadge))))}updateBadge(){super.updateBadge(),this.updateProfileBadge()}computeTitle(){return this.userDataProfileService.currentProfile.isDefault?super.computeTitle():p("manage","Manage {0} (Profile)",this.userDataProfileService.currentProfile.name)}};Ir=x([h(4,Nu),h(5,X),h(6,gt),h(7,Xe),h(8,xe),h(9,H),h(10,L),h(11,Ut),h(12,we)],Ir);class Fb extends jo{}class id extends qa{constructor(e,t){super({id:e,name:e,classNames:void 0},t)}setActivity(e){this.label=e.name}}class mh extends Ya{constructor(e,t){super({id:e,name:e,classNames:void 0},t)}setActivity(e){this.label=e.name}}class fh extends qe{constructor(e,t){super(e),this.offset=t}async run(e){const t=e.get(zi),i=t.getVisiblePaneCompositeIds(0),o=t.getActivePaneComposite(0);if(!o)return;let s;for(let n=0;n<i.length;n++)if(i[n]===o.getId()){s=i[(n+i.length+this.offset)%i.length];break}await t.openPaneComposite(s,0,!0)}}te(class extends fh{constructor(){super({id:"workbench.action.previousSideBarView",title:{value:p("previousSideBarView","Previous Primary Side Bar View"),original:"Previous Primary Side Bar View"},category:ve.View,f1:!0},-1)}});te(class extends fh{constructor(){super({id:"workbench.action.nextSideBarView",title:{value:p("nextSideBarView","Next Primary Side Bar View"),original:"Next Primary Side Bar View"},category:ve.View,f1:!0},1)}});te(class extends qe{constructor(){super({id:"workbench.action.focusActivityBar",title:{value:p("focusActivityBar","Focus Activity Bar"),original:"Focus Activity Bar"},category:ve.View,f1:!0})}async run(e){const t=e.get(pt);t.setPartHidden(!1,"workbench.parts.activitybar"),t.focusPart("workbench.parts.activitybar")}});ba((c,e)=>{const t=c.getColor(_d);t&&e.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator:before {
				border-left-color: ${t};
			}
		`);const i=c.getColor(Fu);i&&e.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus::before {
				visibility: hidden;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:focus .active-item-indicator:before {
				visibility: visible;
				border-left-color: ${i};
			}
		`);const o=c.getColor(kd);o&&e.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked .active-item-indicator {
				z-index: 0;
				background-color: ${o};
			}
		`);const s=c.getColor(ro);if(s)e.addRule(`
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:before {
				content: "";
				position: absolute;
				top: 8px;
				left: 8px;
				height: 32px;
				width: 32px;
				z-index: 1;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.profile-activity-item:before {
				top: -6px;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:hover:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:hover:before {
				outline: 1px solid;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:hover:before {
				outline: 1px dashed;
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator:before {
				border-left-color: ${s};
			}

			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.active:hover:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item.checked:hover:before,
			.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:hover:before {
				outline-color: ${s};
			}
		`);else{const n=c.getColor(Bu);n&&e.addRule(`
				.monaco-workbench .activitybar > .content :not(.monaco-menu) > .monaco-action-bar .action-item:focus .active-item-indicator:before {
						border-left-color: ${n};
					}
				`)}});class bh{constructor(e,t,i,o,s){this.viewDescriptorService=e,this.targetContainerLocation=t,this.openComposite=i,this.moveComposite=o,this.getItems=s}drop(e,t,i,o){const s=e.getData();if(s.type==="composite"){const n=this.viewDescriptorService.getViewContainerById(s.id);if(this.viewDescriptorService.getViewContainerLocation(n)===this.targetContainerLocation)t&&this.moveComposite(s.id,t,o);else{if(this.viewDescriptorService.getViewContainerModel(n).allViewDescriptors.some(d=>!d.canMoveView))return;this.viewDescriptorService.moveViewContainerToLocation(n,this.targetContainerLocation,this.getTargetIndex(t,o))}}if(s.type==="view"){const n=this.viewDescriptorService.getViewDescriptorById(s.id);if(n&&n.canMoveView){this.viewDescriptorService.moveViewToLocation(n,this.targetContainerLocation);const r=this.viewDescriptorService.getViewContainerByViewId(n.id);t&&this.moveComposite(r.id,t,o),this.openComposite(r.id,!0).then(a=>{a==null||a.openView(n.id,!0)})}}}onDragEnter(e,t,i){return this.canDrop(e,t)}onDragOver(e,t,i){return this.canDrop(e,t)}getTargetIndex(e,t){if(!e)return;const i=this.getItems(),o=this.targetContainerLocation===1?t==null?void 0:t.horizontallyBefore:t==null?void 0:t.verticallyBefore;return i.filter(s=>s.visible).findIndex(s=>s.id===e)+(o?0:1)}canDrop(e,t){const i=e.getData();if(i.type==="composite"){const o=this.viewDescriptorService.getViewContainerById(i.id);return this.viewDescriptorService.getViewContainerLocation(o)===this.targetContainerLocation?i.id!==t:!this.viewDescriptorService.getViewContainerModel(o).allViewDescriptors.some(r=>!r.canMoveView)}else{const o=this.viewDescriptorService.getViewDescriptorById(i.id);return!(!o||!o.canMoveView)}}}let Js=class extends va{constructor(e,t,i,o,s){super(),this.options=t,this.instantiationService=i,this.contextMenuService=o,this.viewDescriptorService=s,this._onDidChange=this._register(new y),this.onDidChange=this._onDidChange.event,this.model=new Bb(e,t),this.visibleComposites=[],this.compositeSizeInBar=new Map,this.computeSizes(this.model.visibleItems)}getCompositeBarItems(){return[...this.model.items]}setCompositeBarItems(e){this.model.setItems(e)&&this.updateCompositeSwitcher()}getPinnedComposites(){return this.model.pinnedItems}getVisibleComposites(){return this.model.visibleItems}create(e){const t=e.appendChild(z(".composite-bar"));this.compositeSwitcherBar=this._register(new vo(t,{actionViewItemProvider:o=>{if(o instanceof Yc)return this.compositeOverflowActionViewItem;const s=this.model.findItem(o.id);return s&&this.instantiationService.createInstance(Eb,{draggable:!0,colors:this.options.colors,icon:this.options.icon,hoverOptions:this.options.activityHoverOptions},o,s.pinnedAction,s.toggleBadgeAction,n=>this.options.getContextMenuActionsForComposite(n),()=>this.getContextMenuActions(),this.options.dndHandler,this)},orientation:this.options.orientation,ariaLabel:p("activityBarAriaLabel","Active View Switcher"),ariaRole:"tablist",animated:!1,preventLoopNavigation:this.options.preventLoopNavigation,triggerKeys:{keyDown:!0}})),this._register(w(e,S.CONTEXT_MENU,o=>this.showContextMenu(o))),this._register(ii.addTarget(e)),this._register(w(e,Te.Contextmenu,o=>this.showContextMenu(o)));let i;return this._register(Mo.INSTANCE.registerTarget(e,{onDragOver:o=>{const s=this.getVisibleComposites();if(!s.length||o.eventData.target&&Ht(o.eventData.target,t)){i=this.updateFromDragging(e,!1,!1,!0);return}const n=this.insertAtFront(t,o.eventData),r=n?s[0]:s[s.length-1],a=this.options.dndHandler.onDragOver(o.dragAndDropData,r.id,o.eventData);xd(o.eventData.dataTransfer,"move",a),i=this.updateFromDragging(e,a,n,!0)},onDragLeave:o=>{i=this.updateFromDragging(e,!1,!1,!1)},onDragEnd:o=>{i=this.updateFromDragging(e,!1,!1,!1)},onDrop:o=>{const s=this.getVisibleComposites();if(s.length){const n=this.insertAtFront(t,o.eventData)?s[0]:s[s.length-1];this.options.dndHandler.drop(o.dragAndDropData,n.id,o.eventData,i)}i=this.updateFromDragging(e,!1,!1,!1)}})),t}insertAtFront(e,t){const i=e.getBoundingClientRect(),o=t.clientX,s=t.clientY;switch(this.options.orientation){case 0:return o<i.left;case 1:return s<i.top}}updateFromDragging(e,t,i,o){if(e.classList.toggle("dragged-over",o),e.classList.toggle("dragged-over-head",t&&i),e.classList.toggle("dragged-over-tail",t&&!i),!!t)return{verticallyBefore:i,horizontallyBefore:i}}focus(e){var t;(t=this.compositeSwitcherBar)==null||t.focus(e)}recomputeSizes(){this.computeSizes(this.model.visibleItems)}layout(e){this.dimension=e,!(e.height===0||e.width===0)&&(this.compositeSizeInBar.size===0&&this.computeSizes(this.model.visibleItems),this.updateCompositeSwitcher())}addComposite({id:e,name:t,order:i,requestedIndex:o}){this.model.add(e,t,i,o)&&(this.computeSizes([this.model.findItem(e)]),this.updateCompositeSwitcher())}removeComposite(e){this.isPinned(e)&&this.unpin(e),this.model.remove(e)&&this.updateCompositeSwitcher()}hideComposite(e){this.model.hide(e)&&(this.resetActiveComposite(e),this.updateCompositeSwitcher())}activateComposite(e){const t=this.model.activeItem;this.model.activate(e)&&(this.visibleComposites.indexOf(e)===-1||this.model.activeItem&&!this.model.activeItem.pinned||t&&!t.pinned)&&this.updateCompositeSwitcher()}deactivateComposite(e){const t=this.model.activeItem;this.model.deactivate()&&t&&!t.pinned&&this.updateCompositeSwitcher()}showActivity(e,t,i,o){if(!t)throw Hu("badge");typeof o!="number"&&(o=0);const s={badge:t,clazz:i,priority:o};return this.model.addActivity(e,s),ie(()=>this.model.removeActivity(e,s))}async pin(e,t){this.model.setPinned(e,!0)&&(this.updateCompositeSwitcher(),t&&(await this.options.openComposite(e),this.activateComposite(e)))}unpin(e){this.model.setPinned(e,!1)&&(this.updateCompositeSwitcher(),this.resetActiveComposite(e))}areBadgesEnabled(e){return this.viewDescriptorService.getViewContainerBadgeEnablementState(e)}toggleBadgeEnablement(e){this.viewDescriptorService.setViewContainerBadgeEnablementState(e,!this.areBadgesEnabled(e)),this.updateCompositeSwitcher();const t=this.model.findItem(e);t&&t.activityAction.setBadge(t.activityAction.getBadge(),t.activityAction.getClass())}resetActiveComposite(e){const t=this.options.getDefaultCompositeId();!this.model.activeItem||this.model.activeItem.id!==e||(this.deactivateComposite(e),t&&t!==e&&this.isPinned(t)?this.options.openComposite(t,!0):this.options.openComposite(this.visibleComposites.filter(i=>i!==e)[0]))}isPinned(e){const t=this.model.findItem(e);return t==null?void 0:t.pinned}move(e,t,i){if(i!==void 0){const o=this.model.items.findIndex(n=>n.id===e);let s=this.model.items.findIndex(n=>n.id===t);o>=0&&s>=0&&(!i&&o>s&&s++,i&&o<s&&s--,s<this.model.items.length&&s>=0&&s!==o&&this.model.move(this.model.items[o].id,this.model.items[s].id)&&setTimeout(()=>this.updateCompositeSwitcher(),0))}else this.model.move(e,t)&&setTimeout(()=>this.updateCompositeSwitcher(),0)}getAction(e){const t=this.model.findItem(e);return t==null?void 0:t.activityAction}computeSizes(e){const t=this.options.compositeSize;if(t)e.forEach(i=>this.compositeSizeInBar.set(i.id,t));else{const i=this.compositeSwitcherBar;if(i&&this.dimension&&this.dimension.height!==0&&this.dimension.width!==0){const o=i.viewItems.length;i.push(e.map(s=>s.activityAction)),e.forEach((s,n)=>this.compositeSizeInBar.set(s.id,this.options.orientation===1?i.getHeight(o+n):i.getWidth(o+n))),e.forEach(()=>i.pull(i.viewItems.length-1))}}}updateCompositeSwitcher(){var a,d;const e=this.compositeSwitcherBar;if(!e||!this.dimension)return;let t=this.model.visibleItems.filter(l=>l.pinned||this.model.activeItem&&this.model.activeItem.id===l.id).map(l=>l.id),i=t.length;const o=t.length;let s=0;const n=this.options.orientation===1?this.dimension.height:this.dimension.width;for(let l=0;l<t.length;l++){const u=this.compositeSizeInBar.get(t[l]);if(s+u>n){i=l;break}s+=u}for(o>i&&(t=t.slice(0,i)),this.model.activeItem&&t.every(l=>!!this.model.activeItem&&l!==this.model.activeItem.id)&&(s+=this.compositeSizeInBar.get(this.model.activeItem.id),t.push(this.model.activeItem.id));s>n&&t.length;){const l=t.length>1?t.splice(t.length-2,1)[0]:t.pop();s-=this.compositeSizeInBar.get(l)}for(o>t.length&&(s+=this.options.overflowActionSize);s>n&&t.length;){const l=t.length>1&&t[t.length-1]===((a=this.model.activeItem)==null?void 0:a.id)?t.splice(t.length-2,1)[0]:t.pop();s-=this.compositeSizeInBar.get(l)}o===t.length&&this.compositeOverflowAction&&(e.pull(e.length()-1),this.compositeOverflowAction.dispose(),this.compositeOverflowAction=void 0,(d=this.compositeOverflowActionViewItem)==null||d.dispose(),this.compositeOverflowActionViewItem=void 0);const r=[];this.visibleComposites.forEach((l,u)=>{t.includes(l)||r.push(u)}),r.reverse().forEach(l=>{const u=e.viewItems[l];e.pull(l),u.dispose(),this.visibleComposites.splice(l,1)}),t.forEach((l,u)=>{const g=this.visibleComposites.indexOf(l);if(u!==g){if(g!==-1){const m=e.viewItems[g];e.pull(g),m.dispose(),this.visibleComposites.splice(g,1)}e.push(this.model.findItem(l).activityAction,{label:!0,icon:this.options.icon,index:u}),this.visibleComposites.splice(u,0,l)}}),o>t.length&&!this.compositeOverflowAction&&(this.compositeOverflowAction=this.instantiationService.createInstance(Yc,()=>{var l;(l=this.compositeOverflowActionViewItem)==null||l.showMenu()}),this.compositeOverflowActionViewItem=this.instantiationService.createInstance(_b,this.compositeOverflowAction,()=>this.getOverflowingComposites(),()=>this.model.activeItem?this.model.activeItem.id:void 0,l=>{var g;const u=this.model.findItem(l);return(g=u==null?void 0:u.activity[0])==null?void 0:g.badge},this.options.getOnCompositeClickAction,this.options.colors,this.options.activityHoverOptions),e.push(this.compositeOverflowAction,{label:!1,icon:!0})),this._onDidChange.fire()}getOverflowingComposites(){let e=this.model.visibleItems.filter(t=>t.pinned).map(t=>t.id);return this.model.activeItem&&!this.model.activeItem.pinned&&e.push(this.model.activeItem.id),e=e.filter(t=>!this.visibleComposites.includes(t)),this.model.visibleItems.filter(t=>e.includes(t.id)).map(t=>{var i;return{id:t.id,name:((i=this.getAction(t.id))==null?void 0:i.label)||t.name}})}showContextMenu(e){K.stop(e,!0);const t=new _t(e);this.contextMenuService.showContextMenu({getAnchor:()=>({x:t.posx,y:t.posy}),getActions:()=>this.getContextMenuActions(e)})}getContextMenuActions(e){return this.model.visibleItems.map(({id:i,name:o,activityAction:s})=>Ne({id:i,label:this.getAction(i).label||o||i,checked:this.isPinned(i),enabled:s.enabled,run:()=>{this.isPinned(i)?this.unpin(i):this.pin(i,!0)}}))}};Js=x([h(2,D),h(3,xe),h(4,nt)],Js);class Bb{get items(){return this._items}constructor(e,t){this._items=[],this.options=t,this.setItems(e)}setItems(e){const t=[];let i=!1;if(!this.items||this.items.length===0)this._items=e.map(o=>this.createCompositeBarItem(o.id,o.name,o.order,o.pinned,o.visible)),i=!0;else{const o=this.items;for(let s=0;s<e.length;s++){const n=e[s],r=o.filter(({id:a})=>a===n.id)[0];r?r.pinned!==n.pinned||s!==o.indexOf(r)?(r.pinned=n.pinned,t.push(r),i=!0):t.push(r):(t.push(this.createCompositeBarItem(n.id,n.name,n.order,n.pinned,n.visible)),i=!0)}this._items=t}return i}get visibleItems(){return this.items.filter(e=>e.visible)}get pinnedItems(){return this.items.filter(e=>e.visible&&e.pinned)}createCompositeBarItem(e,t,i,o,s){const n=this.options;return{id:e,name:t,pinned:o,order:i,visible:s,activity:[],get activityAction(){return n.getActivityAction(e)},get pinnedAction(){return n.getCompositePinnedAction(e)},get toggleBadgeAction(){return n.getCompositeBadgeAction(e)}}}add(e,t,i,o){const s=this.findItem(e);if(s){let n=!1;return s.name=t,Ze(i)||(n=s.order!==i,s.order=i),s.visible||(s.visible=!0,n=!0),n}else{const n=this.createCompositeBarItem(e,t,i,!0,!0);if(Ze(o))if(Ze(i))this.items.push(n);else{let r=0;for(;r<this.items.length&&typeof this.items[r].order=="number"&&this.items[r].order<i;)r++;this.items.splice(r,0,n)}else{let r=0,a=o;for(;a>0&&r<this.items.length;)this.items[r++].visible&&a--;this.items.splice(r,0,n)}return!0}}remove(e){for(let t=0;t<this.items.length;t++)if(this.items[t].id===e)return this.items.splice(t,1),!0;return!1}hide(e){for(const t of this.items)if(t.id===e)return t.visible?(t.visible=!1,!0):!1;return!1}move(e,t){const i=this.findIndex(e),o=this.findIndex(t);if(i===-1||o===-1)return!1;const s=this.items.splice(i,1)[0];return this.items.splice(o,0,s),s.pinned=!0,!0}setPinned(e,t){for(const i of this.items)if(i.id===e)return i.pinned!==t?(i.pinned=t,!0):!1;return!1}addActivity(e,t){const i=this.findItem(e);if(i){const o=i.activity;for(let s=0;s<=o.length;s++)if(s===o.length){o.push(t);break}else if(o[s].priority<=t.priority){o.splice(s,0,t);break}return this.updateActivity(e),!0}return!1}removeActivity(e,t){const i=this.findItem(e);if(i){const o=i.activity.indexOf(t);if(o!==-1)return i.activity.splice(o,1),this.updateActivity(e),!0}return!1}updateActivity(e){const t=this.findItem(e);if(t)if(t.activity.length){const[{badge:i,clazz:o}]=t.activity;t.activityAction.setBadge(i,o)}else t.activityAction.setBadge(void 0)}activate(e){if(!this.activeItem||this.activeItem.id!==e){this.activeItem&&this.deactivate();for(const t of this.items)if(t.id===e)return this.activeItem=t,this.activeItem.activityAction.activate(),!0}return!1}deactivate(){return this.activeItem?(this.activeItem.activityAction.deactivate(),this.activeItem=void 0,!0):!1}findItem(e){return this.items.filter(t=>t.id===e)[0]}findIndex(e){for(let t=0;t<this.items.length;t++)if(this.items[t].id===e)return t;return-1}}var Hb=".monaco-workbench .menubar .toolbar-toggle-more,.monaco-workbench .menubar>.menubar-menu-button{color:var(--vscode-titleBar-activeForeground)}.monaco-workbench .activitybar .menubar.compact .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button{color:var(--vscode-activityBar-inactiveForeground)}.monaco-workbench .activitybar .menubar.compact:not(:focus-within)>.menubar-menu-button:hover,.monaco-workbench .activitybar .menubar.compact:not(:focus-within)>.menubar-menu-button:hover .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button.open,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button.open .toolbar-toggle-more,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button:focus,.monaco-workbench .activitybar .menubar.compact>.menubar-menu-button:focus .toolbar-toggle-more{color:var(--vscode-activityBar-foreground)}.monaco-workbench .menubar.inactive:not(.compact)>.menubar-menu-button,.monaco-workbench .menubar.inactive:not(.compact)>.menubar-menu-button .toolbar-toggle-more{color:var(--vscode-titleBar-inactiveForeground)}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open .toolbar-toggle-more,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .toolbar-toggle-more,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover .toolbar-toggle-more{color:var(--vscode-menubar-selectionForeground)}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .menubar-menu-title,.monaco-workbench .menubar:not(:focus-within):not(.compact)>.menubar-menu-button:hover .menubar-menu-title{background-color:var(--vscode-menubar-selectionBackground)}.monaco-workbench .menubar>.menubar-menu-button:hover .menubar-menu-title{outline:dashed 1px var(--vscode-menubar-selectionBorder)}.monaco-workbench .menubar>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:focus .menubar-menu-title{outline:solid 1px var(--vscode-menubar-selectionBorder)}.monaco-workbench .menubar>.menubar-menu-button.open .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:focus .menubar-menu-title,.monaco-workbench .menubar>.menubar-menu-button:hover .menubar-menu-title{outline-color:var(--vscode-menubar-selectionBorder);outline-offset:-1px}";be(Hb,{});var Wb='.menubar{box-sizing:border-box;display:flex;flex-shrink:1;height:100%;overflow:hidden}.menubar.overflow-menu-only{width:38px}.fullscreen .menubar:not(.compact){margin:0;padding:4px 5px}.menubar>.menubar-menu-button{-webkit-app-region:no-drag;zoom:1;align-items:center;box-sizing:border-box;cursor:default;display:flex;outline:0!important;white-space:nowrap}.monaco-workbench .menubar:not(.compact)>.menubar-menu-button:focus .menubar-menu-title{outline-color:var(--vscode-focusBorder);outline-offset:-1px;outline-style:solid;outline-width:1px}.menubar.compact{flex-shrink:0;overflow:visible}.menubar.compact>.menubar-menu-button{height:100%;padding:0;width:100%}.menubar-menu-title{border-radius:5px;padding:0 8px}.menubar .menubar-menu-items-holder{left:0;opacity:1;position:fixed;z-index:2000}.menubar.compact .menubar-menu-items-holder{position:fixed}.menubar .menubar-menu-items-holder.monaco-menu-container{border:none;outline:0}.menubar .menubar-menu-items-holder.monaco-menu-container :focus{outline:0}.menubar .toolbar-toggle-more{align-items:center;display:flex;height:22px;justify-content:center;padding:0 8px;vertical-align:sub;width:22px}.menubar.compact .toolbar-toggle-more{align-items:center;cursor:pointer;display:flex;justify-content:center;left:0;position:relative;top:0;width:100%}.menubar.compact .toolbar-toggle-more:before,.menubar:not(.compact) .menubar-menu-button:first-child .toolbar-toggle-more:before{content:"\\eb94"!important}.menubar.compact>.menubar-menu-button.open .menubar-menu-title,.menubar.compact>.menubar-menu-button:focus .menubar-menu-title,.menubar.compact>.menubar-menu-button:hover .menubar-menu-title{outline-offset:-8px!important;outline-width:1px!important}';be(Wb,{});const Ji=z;var ce;(function(c){c[c.HIDDEN=0]="HIDDEN",c[c.VISIBLE=1]="VISIBLE",c[c.FOCUSED=2]="FOCUSED",c[c.OPEN=3]="OPEN"})(ce||(ce={}));class re extends R{constructor(e,t,i){super(),this.container=e,this.options=t,this.menuStyle=i,this._mnemonicsInUse=!1,this.openedViaKeyboard=!1,this.awaitingAltRelease=!1,this.ignoreNextMouseUp=!1,this.updatePending=!1,this.numMenusShown=0,this.overflowLayoutScheduled=void 0,this.container.setAttribute("role","menubar"),this.isCompact&&this.container.classList.add("compact"),this.menus=[],this.mnemonics=new Map,this._focusState=ce.VISIBLE,this._onVisibilityChange=this._register(new y),this._onFocusStateChange=this._register(new y),this.createOverflowMenu(),this.menuUpdater=this._register(new pn(()=>this.update(),200)),this.actionRunner=this.options.actionRunner??this._register(new is),this._register(this.actionRunner.onWillRun(()=>{this.setUnfocusedState()})),this._register(Wu.getInstance().event(this.onModifierKeyToggled,this)),this._register(w(this.container,S.KEY_DOWN,o=>{const s=new Ct(o);let n=!0;const r=o.key?o.key.toLocaleLowerCase():"",a=le&&!this.isCompact;if(s.equals(15)||a&&s.equals(1026))this.focusPrevious();else if(s.equals(17)||a&&s.equals(2))this.focusNext();else if(s.equals(9)&&this.isFocused&&!this.isOpen)this.setUnfocusedState();else if(!this.isOpen&&!s.ctrlKey&&this.options.enableMnemonics&&this.mnemonicsInUse&&this.mnemonics.has(r)){const d=this.mnemonics.get(r);this.onMenuTriggered(d,!1)}else n=!1;!this.isCompact&&(s.equals(1026)||s.equals(2))&&s.preventDefault(),n&&(s.preventDefault(),s.stopPropagation())})),this._register(w(window,S.MOUSE_DOWN,()=>{this.isFocused&&this.setUnfocusedState()})),this._register(w(this.container,S.FOCUS_IN,o=>{const s=o;s.relatedTarget&&(this.container.contains(s.relatedTarget)||(this.focusToReturn=s.relatedTarget))})),this._register(w(this.container,S.FOCUS_OUT,o=>{const s=o;s.relatedTarget?s.relatedTarget&&!this.container.contains(s.relatedTarget)&&(this.focusToReturn=void 0,this.setUnfocusedState()):this.setUnfocusedState()})),this._register(w(window,S.KEY_DOWN,o=>{if(!this.options.enableMnemonics||!o.altKey||o.ctrlKey||o.defaultPrevented)return;const s=o.key.toLocaleLowerCase();if(!this.mnemonics.has(s))return;this.mnemonicsInUse=!0,this.updateMnemonicVisibility(!0);const n=this.mnemonics.get(s);this.onMenuTriggered(n,!1)})),this.setUnfocusedState()}push(e){ju(e).forEach(i=>{const o=this.menus.length,s=Cc(i.label),n=Sc.exec(i.label);if(n){const r=n[1]?n[1]:n[3];this.registerMnemonic(this.menus.length,r)}if(this.isCompact)this.menus.push(i);else{const r=Ji("div.menubar-menu-button",{role:"menuitem",tabindex:-1,"aria-label":s,"aria-haspopup":!0}),a=Ji("div.menubar-menu-title",{role:"none","aria-hidden":!0});r.appendChild(a),this.container.insertBefore(r,this.overflowMenu.buttonElement),this.updateLabels(a,r,i.label),this._register(w(r,S.KEY_UP,d=>{const l=new Ct(d);let u=!0;(l.equals(18)||l.equals(3))&&!this.isOpen?(this.focusedMenu={index:o},this.openedViaKeyboard=!0,this.focusState=ce.OPEN):u=!1,u&&(l.preventDefault(),l.stopPropagation())})),this._register(ii.addTarget(r)),this._register(w(r,Te.Tap,d=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&Ht(d.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(o,!0),d.preventDefault(),d.stopPropagation())})),this._register(w(r,S.MOUSE_DOWN,d=>{if(!new _t(d).leftButton){d.preventDefault();return}this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(o,!0)),d.preventDefault(),d.stopPropagation()})),this._register(w(r,S.MOUSE_UP,d=>{d.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(o,!0))})),this._register(w(r,S.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(o)?(r.focus(),this.cleanupCustomMenu(),this.showCustomMenu(o,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:o},r.focus())})),this.menus.push({label:i.label,actions:i.actions,buttonElement:r,titleElement:a})}})}createOverflowMenu(){const e=this.isCompact?p("mAppMenu","Application Menu"):p("mMore","More"),t=Ji("div.menubar-menu-button",{role:"menuitem",tabindex:this.isCompact?0:-1,"aria-label":e,"aria-haspopup":!0}),i=Ji("div.menubar-menu-title.toolbar-toggle-more"+me.asCSSSelector(M.menuBarMore),{role:"none","aria-hidden":!0});t.appendChild(i),this.container.appendChild(t),t.style.visibility="hidden",this._register(w(t,S.KEY_UP,o=>{const s=new Ct(o);let n=!0;const r=[3];this.isCompact?(r.push(10),this.options.compactMode===Ai.Right?r.push(17):this.options.compactMode===Ai.Left&&r.push(15)):r.push(18),r.some(a=>s.equals(a))&&!this.isOpen?(this.focusedMenu={index:re.OVERFLOW_INDEX},this.openedViaKeyboard=!0,this.focusState=ce.OPEN):n=!1,n&&(s.preventDefault(),s.stopPropagation())})),this._register(ii.addTarget(t)),this._register(w(t,Te.Tap,o=>{this.isOpen&&this.focusedMenu&&this.focusedMenu.holder&&Ht(o.initialTarget,this.focusedMenu.holder)||(this.ignoreNextMouseUp=!1,this.onMenuTriggered(re.OVERFLOW_INDEX,!0),o.preventDefault(),o.stopPropagation())})),this._register(w(t,S.MOUSE_DOWN,o=>{if(!new _t(o).leftButton){o.preventDefault();return}this.isOpen?this.ignoreNextMouseUp=!1:(this.ignoreNextMouseUp=!0,this.onMenuTriggered(re.OVERFLOW_INDEX,!0)),o.preventDefault(),o.stopPropagation()})),this._register(w(t,S.MOUSE_UP,o=>{o.defaultPrevented||(this.ignoreNextMouseUp?this.ignoreNextMouseUp=!1:this.isFocused&&this.onMenuTriggered(re.OVERFLOW_INDEX,!0))})),this._register(w(t,S.MOUSE_ENTER,()=>{this.isOpen&&!this.isCurrentMenu(re.OVERFLOW_INDEX)?(this.overflowMenu.buttonElement.focus(),this.cleanupCustomMenu(),this.showCustomMenu(re.OVERFLOW_INDEX,!1)):this.isFocused&&!this.isOpen&&(this.focusedMenu={index:re.OVERFLOW_INDEX},t.focus())})),this.overflowMenu={buttonElement:t,titleElement:i,label:"More",actions:[]}}updateMenu(e){const t=this.menus.filter(i=>i.label===e.label);t&&t.length&&(t[0].actions=e.actions)}dispose(){super.dispose(),this.menus.forEach(e=>{var t,i;(t=e.titleElement)==null||t.remove(),(i=e.buttonElement)==null||i.remove()}),this.overflowMenu.titleElement.remove(),this.overflowMenu.buttonElement.remove(),ue(this.overflowLayoutScheduled),this.overflowLayoutScheduled=void 0}blur(){this.setUnfocusedState()}getWidth(){if(!this.isCompact&&this.menus){const e=this.menus[0].buttonElement.getBoundingClientRect().left;return(this.hasOverflow?this.overflowMenu.buttonElement.getBoundingClientRect().right:this.menus[this.menus.length-1].buttonElement.getBoundingClientRect().right)-e}return 0}getHeight(){return this.container.clientHeight}toggleFocus(){!this.isFocused&&this.options.visibility!=="hidden"?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:re.OVERFLOW_INDEX},this.focusState=ce.FOCUSED):this.isOpen||this.setUnfocusedState()}updateOverflowAction(){var r,a;if(!this.menus||!this.menus.length)return;const e="overflow-menu-only";this.container.classList.toggle(e,!1);const t=this.container.offsetWidth;let i=0,o=this.isCompact;const s=this.numMenusShown;this.numMenusShown=0;const n=this.menus.filter(d=>d.buttonElement!==void 0&&d.titleElement!==void 0);for(const d of n){if(!o){const l=d.buttonElement.offsetWidth;i+l>t?o=!0:(i+=l,this.numMenusShown++,this.numMenusShown>s&&(d.buttonElement.style.visibility="visible"))}o&&(d.buttonElement.style.visibility="hidden")}if(this.numMenusShown-1<=n.length/2){for(const d of n)d.buttonElement.style.visibility="hidden";o=!0,this.numMenusShown=0,i=0}if(this.isCompact){this.overflowMenu.actions=[];for(let l=this.numMenusShown;l<this.menus.length;l++)this.overflowMenu.actions.push(new ao(`menubar.submenu.${this.menus[l].label}`,this.menus[l].label,this.menus[l].actions||[]));const d=(a=(r=this.options).getCompactMenuActions)==null?void 0:a.call(r);d&&d.length&&(this.overflowMenu.actions.push(new Fe),this.overflowMenu.actions.push(...d)),this.overflowMenu.buttonElement.style.visibility="visible"}else if(o){for(;i+this.overflowMenu.buttonElement.offsetWidth>t&&this.numMenusShown>0;){this.numMenusShown--;const d=n[this.numMenusShown].buttonElement.offsetWidth;n[this.numMenusShown].buttonElement.style.visibility="hidden",i-=d}this.overflowMenu.actions=[];for(let d=this.numMenusShown;d<n.length;d++)this.overflowMenu.actions.push(new ao(`menubar.submenu.${n[d].label}`,n[d].label,n[d].actions||[]));this.overflowMenu.buttonElement.nextElementSibling!==n[this.numMenusShown].buttonElement&&(this.overflowMenu.buttonElement.remove(),this.container.insertBefore(this.overflowMenu.buttonElement,n[this.numMenusShown].buttonElement)),this.overflowMenu.buttonElement.style.visibility="visible"}else this.overflowMenu.buttonElement.remove(),this.container.appendChild(this.overflowMenu.buttonElement),this.overflowMenu.buttonElement.style.visibility="hidden";this.container.classList.toggle(e,this.numMenusShown===0)}updateLabels(e,t,i){const o=Cc(i);if(this.options.enableMnemonics){const n=Gu(i);Mn.lastIndex=0;let r=Mn.exec(n);for(;r&&r[1];)r=Mn.exec(n);const a=d=>d.replace(/&amp;&amp;/g,"&amp;");r?(e.innerText="",e.append(zu(a(n.substr(0,r.index))," "),Ji("mnemonic",{"aria-hidden":"true"},r[3]),Uu(a(n.substr(r.index+r[0].length))," "))):e.innerText=a(n).trim()}else e.innerText=o.replace(/&&/g,"&");const s=Sc.exec(i);if(s){const n=s[1]?s[1]:s[3];this.options.enableMnemonics?t.setAttribute("aria-keyshortcuts","Alt+"+n.toLocaleLowerCase()):t.removeAttribute("aria-keyshortcuts")}}update(e){if(e&&(this.options=e),this.isFocused){this.updatePending=!0;return}this.menus.forEach(t=>{!t.buttonElement||!t.titleElement||this.updateLabels(t.titleElement,t.buttonElement,t.label)}),this.overflowLayoutScheduled||(this.overflowLayoutScheduled=nr(()=>{this.updateOverflowAction(),this.overflowLayoutScheduled=void 0})),this.setUnfocusedState()}registerMnemonic(e,t){this.mnemonics.set(t.toLocaleLowerCase(),e)}hideMenubar(){this.container.style.display!=="none"&&(this.container.style.display="none",this._onVisibilityChange.fire(!1))}showMenubar(){this.container.style.display!=="flex"&&(this.container.style.display="flex",this._onVisibilityChange.fire(!0),this.updateOverflowAction())}get focusState(){return this._focusState}set focusState(e){var s,n;if(this._focusState>=ce.FOCUSED&&e<ce.FOCUSED&&this.updatePending&&(this.menuUpdater.schedule(),this.updatePending=!1),e===this._focusState)return;const t=this.isVisible,i=this.isOpen,o=this.isFocused;switch(this._focusState=e,e){case ce.HIDDEN:t&&this.hideMenubar(),i&&this.cleanupCustomMenu(),o&&(this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case ce.VISIBLE:t||this.showMenubar(),i&&this.cleanupCustomMenu(),o&&(this.focusedMenu&&(this.focusedMenu.index===re.OVERFLOW_INDEX?this.overflowMenu.buttonElement.blur():(s=this.menus[this.focusedMenu.index].buttonElement)==null||s.blur()),this.focusedMenu=void 0,this.focusToReturn&&(this.focusToReturn.focus(),this.focusToReturn=void 0));break;case ce.FOCUSED:t||this.showMenubar(),i&&this.cleanupCustomMenu(),this.focusedMenu&&(this.focusedMenu.index===re.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():(n=this.menus[this.focusedMenu.index].buttonElement)==null||n.focus());break;case ce.OPEN:t||this.showMenubar(),this.focusedMenu&&this.showCustomMenu(this.focusedMenu.index,this.openedViaKeyboard);break}this._focusState=e,this._onFocusStateChange.fire(this.focusState>=ce.FOCUSED)}get isVisible(){return this.focusState>=ce.VISIBLE}get isFocused(){return this.focusState>=ce.FOCUSED}get isOpen(){return this.focusState>=ce.OPEN}get hasOverflow(){return this.isCompact||this.numMenusShown<this.menus.length}get isCompact(){return this.options.compactMode!==void 0}setUnfocusedState(){this.options.visibility==="toggle"||this.options.visibility==="hidden"?this.focusState=ce.HIDDEN:this.options.visibility==="classic"&&Dd()?this.focusState=ce.HIDDEN:this.focusState=ce.VISIBLE,this.ignoreNextMouseUp=!1,this.mnemonicsInUse=!1,this.updateMnemonicVisibility(!1)}focusPrevious(){var t;if(!this.focusedMenu||this.numMenusShown===0)return;let e=(this.focusedMenu.index-1+this.numMenusShown)%this.numMenusShown;this.focusedMenu.index===re.OVERFLOW_INDEX?e=this.numMenusShown-1:this.focusedMenu.index===0&&this.hasOverflow&&(e=re.OVERFLOW_INDEX),e!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(e)):this.isFocused&&(this.focusedMenu.index=e,e===re.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():(t=this.menus[e].buttonElement)==null||t.focus()))}focusNext(){var t;if(!this.focusedMenu||this.numMenusShown===0)return;let e=(this.focusedMenu.index+1)%this.numMenusShown;this.focusedMenu.index===re.OVERFLOW_INDEX?e=0:this.focusedMenu.index===this.numMenusShown-1&&(e=re.OVERFLOW_INDEX),e!==this.focusedMenu.index&&(this.isOpen?(this.cleanupCustomMenu(),this.showCustomMenu(e)):this.isFocused&&(this.focusedMenu.index=e,e===re.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():(t=this.menus[e].buttonElement)==null||t.focus()))}updateMnemonicVisibility(e){this.menus&&this.menus.forEach(t=>{if(t.titleElement&&t.titleElement.children.length){const i=t.titleElement.children.item(0);i&&(i.style.textDecoration=this.options.alwaysOnMnemonics||e?"underline":"")}})}get mnemonicsInUse(){return this._mnemonicsInUse}set mnemonicsInUse(e){this._mnemonicsInUse=e}get shouldAltKeyFocus(){return le?!1:!this.options.disableAltFocus||this.options.visibility==="toggle"}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}onMenuTriggered(e,t){this.isOpen?this.isCurrentMenu(e)?this.setUnfocusedState():(this.cleanupCustomMenu(),this.showCustomMenu(e,this.openedViaKeyboard)):(this.focusedMenu={index:e},this.openedViaKeyboard=!t,this.focusState=ce.OPEN)}onModifierKeyToggled(e){const t=!e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey;this.options.visibility!=="hidden"&&(e.event&&this.shouldAltKeyFocus&&Ku.toEnum(e.event.code)===159&&e.event.preventDefault(),this.isFocused&&e.lastKeyPressed==="alt"&&e.altKey&&(this.setUnfocusedState(),this.mnemonicsInUse=!1,this.awaitingAltRelease=!0),t&&e.lastKeyPressed==="alt"&&e.lastKeyReleased==="alt"&&(this.awaitingAltRelease||(!this.isFocused&&this.shouldAltKeyFocus?(this.mnemonicsInUse=!0,this.focusedMenu={index:this.numMenusShown>0?0:re.OVERFLOW_INDEX},this.focusState=ce.FOCUSED):this.isOpen||this.setUnfocusedState())),!e.altKey&&e.lastKeyReleased==="alt"&&(this.awaitingAltRelease=!1),this.options.enableMnemonics&&this.menus&&!this.isOpen&&this.updateMnemonicVisibility(!this.awaitingAltRelease&&e.altKey||this.mnemonicsInUse))}isCurrentMenu(e){return this.focusedMenu?this.focusedMenu.index===e:!1}cleanupCustomMenu(){var e,t,i;this.focusedMenu&&(this.focusedMenu.index===re.OVERFLOW_INDEX?this.overflowMenu.buttonElement.focus():(e=this.menus[this.focusedMenu.index].buttonElement)==null||e.focus(),this.focusedMenu.holder&&((t=this.focusedMenu.holder.parentElement)==null||t.classList.remove("open"),this.focusedMenu.holder.remove()),(i=this.focusedMenu.widget)==null||i.dispose(),this.focusedMenu={index:this.focusedMenu.index})}showCustomMenu(e,t=!0){const i=e>=this.numMenusShown?re.OVERFLOW_INDEX:e,o=i===re.OVERFLOW_INDEX?this.overflowMenu:this.menus[i];if(!o.actions||!o.buttonElement||!o.titleElement)return;const s=Ji("div.menubar-menu-items-holder",{title:""});o.buttonElement.classList.add("open");const n=o.titleElement.getBoundingClientRect(),r=Id(o.titleElement);this.options.compactMode===Ai.Right?(s.style.top=`${n.top}px`,s.style.left=`${n.left+this.container.clientWidth}px`):this.options.compactMode===Ai.Left?(s.style.top=`${n.top}px`,s.style.right=`${this.container.clientWidth}px`,s.style.left="auto"):(s.style.top=`${n.bottom*r}px`,s.style.left=`${n.left*r}px`),o.buttonElement.appendChild(s);const a={getKeyBinding:this.options.getKeybinding,actionRunner:this.actionRunner,enableMnemonics:this.options.alwaysOnMnemonics||this.mnemonicsInUse&&this.options.enableMnemonics,ariaLabel:Bt(o.buttonElement.getAttribute("aria-label")),expandDirection:this.isCompact?this.options.compactMode:Ai.Right,useEventAsContext:!0},d=this._register(new $u(s,o.actions,a,this.menuStyle));this._register(d.onDidCancel(()=>{this.focusState=ce.FOCUSED})),i!==e?d.trigger(e-this.numMenusShown):d.focus(t),this.focusedMenu={index:i,holder:s,widget:d}}}re.OVERFLOW_INDEX=-1;function od(c){return c&&c.hasOwnProperty("folderUri")}function Gb(c){return c&&c.hasOwnProperty("workspace")}const vh="inRecentFilesPicker";class zb extends qe{constructor(e){super(e),this.removeFromRecentlyOpened={iconClass:me.asClassName(M.removeClose),tooltip:p("remove","Remove from Recently Opened")},this.dirtyRecentlyOpenedFolder={iconClass:"dirty-workspace "+me.asClassName(M.closeDirty),tooltip:p("dirtyRecentlyOpenedFolder","Folder With Unsaved Files"),alwaysVisible:!0},this.dirtyRecentlyOpenedWorkspace={...this.dirtyRecentlyOpenedFolder,tooltip:p("dirtyRecentlyOpenedWorkspace","Workspace With Unsaved Files")}}async run(e){const t=e.get(wa),i=e.get(Kt),o=e.get(at),s=e.get(Ci),n=e.get(we),r=e.get(Ad),a=e.get(Yu),d=e.get(os),l=e.get(gn),u=await t.getRecentlyOpened(),g=await t.getDirtyWorkspaces();let m=!1;const f=new Zt,C=new Zt;for(const W of g)od(W)?f.set(W.folderUri,!0):(C.set(W.workspace.configPath,W.workspace),m=!0);const E=new Zt,V=new Zt;for(const W of u.workspaces)Vs(W)?E.set(W.folderUri,!0):(V.set(W.workspace.configPath,W.workspace),m=!0);const B=[];for(const W of u.workspaces){const Co=Vs(W)?f.has(W.folderUri):C.has(W.workspace.configPath);B.push(this.toQuickPick(r,a,s,W,Co))}for(const W of g)od(W)&&!E.has(W.folderUri)?B.push(this.toQuickPick(r,a,s,W,!0)):Gb(W)&&!V.has(W.workspace.configPath)&&B.push(this.toQuickPick(r,a,s,W,!0));const De=u.files.map(W=>this.toQuickPick(r,a,s,W,!1)),Me=u.workspaces[0],bt=Me&&o.isCurrentWorkspace(rr(Me)?Me.workspace:Me.folderUri);let Ke;const T={type:"separator",label:m?p("workspacesAndFolders","folders & workspaces"):p("folders","folders")},ne={type:"separator",label:p("files","files")},ye=[T,...B,ne,...De],li=await i.pick(ye,{contextKey:vh,activeItem:[...B,...De][bt?1:0],placeHolder:le?p("openRecentPlaceholderMac","Select to open (hold Cmd-key to force new window or Option-key for same window)"):p("openRecentPlaceholder","Select to open (hold Ctrl-key to force new window or Alt-key for same window)"),matchOnDescription:!0,onKeyMods:W=>Ke=W,quickNavigate:this.isQuickNavigate()?{keybindings:n.lookupKeybindings(this.desc.id)}:void 0,hideInput:this.isQuickNavigate(),onDidTriggerItemButton:async W=>{if(W.button===this.removeFromRecentlyOpened)await t.removeRecentlyOpened([W.item.resource]),W.removeItem();else if(W.button===this.dirtyRecentlyOpenedFolder||W.button===this.dirtyRecentlyOpenedWorkspace){const Co=W.button===this.dirtyRecentlyOpenedWorkspace,{confirmed:yu}=await l.confirm({title:Co?p("dirtyWorkspace","Workspace with Unsaved Files"):p("dirtyFolder","Folder with Unsaved Files"),message:Co?p("dirtyWorkspaceConfirm","Do you want to open the workspace to review the unsaved files?"):p("dirtyFolderConfirm","Do you want to open the folder to review the unsaved files?"),detail:Co?p("dirtyWorkspaceConfirmDetail","Workspaces with unsaved files cannot be removed until all unsaved files have been saved or reverted."):p("dirtyFolderConfirmDetail","Folders with unsaved files cannot be removed until all unsaved files have been saved or reverted.")});yu&&(d.openWindow([W.item.openable],{remoteAuthority:W.item.remoteAuthority||null}),i.cancel())}}});if(li)return d.openWindow([li.openable],{forceNewWindow:Ke==null?void 0:Ke.ctrlCmd,forceReuseWindow:Ke==null?void 0:Ke.alt,remoteAuthority:li.remoteAuthority||null})}toQuickPick(e,t,i,o,s){let n,r,a,d,l=!1;Vs(o)?(d=o.folderUri,r=Nn(e,t,d,Ve.FOLDER),n={folderUri:d},a=o.label||i.getWorkspaceLabel(d,{verbose:2})):rr(o)?(d=o.workspace.configPath,r=Nn(e,t,d,Ve.ROOT_FOLDER),n={workspaceUri:d},a=o.label||i.getWorkspaceLabel(o.workspace,{verbose:2}),l=!0):(d=o.fileUri,r=Nn(e,t,d,Ve.FILE),n={fileUri:d},a=o.label||i.getUriLabel(d));const{name:u,parentPath:g}=Xu(a);return{iconClasses:r,label:u,ariaLabel:s?l?p("recentDirtyWorkspaceAriaLabel","{0}, workspace with unsaved changes",u):p("recentDirtyFolderAriaLabel","{0}, folder with unsaved changes",u):u,description:g,buttons:s?[l?this.dirtyRecentlyOpenedWorkspace:this.dirtyRecentlyOpenedFolder]:[this.removeFromRecentlyOpened],openable:n,resource:d,remoteAuthority:o.remoteAuthority}}}class In extends zb{constructor(){super({id:In.ID,title:{value:p("openRecent","Open Recent..."),mnemonicTitle:p({key:"miMore",comment:["&& denotes a mnemonic"]},"&&More..."),original:"Open Recent..."},category:ve.File,f1:!0,keybinding:{weight:200,primary:2096,mac:{primary:304}},menu:{id:b.MenubarRecentMenu,group:"y_more",order:1}})}isQuickNavigate(){return!1}}In.ID="workbench.action.openRecent";class Za extends qe{constructor(){super({id:Za.ID,title:{value:p("reloadWindow","Reload Window"),original:"Reload Window"},category:ve.Developer,f1:!0,keybinding:{weight:200+50,when:qu,primary:2096}})}run(e){return e.get(os).reload()}}Za.ID="workbench.action.reloadWindow";const wh=v.and(Ab,v.has(vh)),sd="workbench.action.quickOpenNavigateNextInRecentFilesPicker";k.registerCommandAndKeybindingRule({id:sd,weight:200+50,handler:ch(sd,!0),when:wh,primary:2096,mac:{primary:304}});const nd="workbench.action.quickOpenNavigatePreviousInRecentFilesPicker";k.registerCommandAndKeybindingRule({id:nd,weight:200+50,handler:ch(nd,!1),when:wh,primary:3120,mac:{primary:1328}});q.registerCommand("workbench.action.toggleConfirmBeforeClose",c=>{const e=c.get(L),t=e.inspect("window.confirmBeforeClose").userValue;return e.updateValue("window.confirmBeforeClose",t==="never"?"keyboardOnly":"never")});_.appendMenuItem(b.MenubarMainMenu,{submenu:b.MenubarFileMenu,title:{value:"File",original:"File",mnemonicTitle:p({key:"mFile",comment:["&& denotes a mnemonic"]},"&&File")},order:1});_.appendMenuItem(b.MenubarMainMenu,{submenu:b.MenubarEditMenu,title:{value:"Edit",original:"Edit",mnemonicTitle:p({key:"mEdit",comment:["&& denotes a mnemonic"]},"&&Edit")},order:2});_.appendMenuItem(b.MenubarMainMenu,{submenu:b.MenubarSelectionMenu,title:{value:"Selection",original:"Selection",mnemonicTitle:p({key:"mSelection",comment:["&& denotes a mnemonic"]},"&&Selection")},order:3});_.appendMenuItem(b.MenubarMainMenu,{submenu:b.MenubarViewMenu,title:{value:"View",original:"View",mnemonicTitle:p({key:"mView",comment:["&& denotes a mnemonic"]},"&&View")},order:4});_.appendMenuItem(b.MenubarMainMenu,{submenu:b.MenubarGoMenu,title:{value:"Go",original:"Go",mnemonicTitle:p({key:"mGoto",comment:["&& denotes a mnemonic"]},"&&Go")},order:5});_.appendMenuItem(b.MenubarMainMenu,{submenu:b.MenubarTerminalMenu,title:{value:"Terminal",original:"Terminal",mnemonicTitle:p({key:"mTerminal",comment:["&& denotes a mnemonic"]},"&&Terminal")},order:7});_.appendMenuItem(b.MenubarMainMenu,{submenu:b.MenubarHelpMenu,title:{value:"Help",original:"Help",mnemonicTitle:p({key:"mHelp",comment:["&& denotes a mnemonic"]},"&&Help")},order:8});_.appendMenuItem(b.MenubarMainMenu,{submenu:b.MenubarPreferencesMenu,title:{value:"Preferences",original:"Preferences",mnemonicTitle:p({key:"mPreferences",comment:["&& denotes a mnemonic"]},"Preferences")},when:Ju,order:9});class qo extends R{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f){super(),this.menuService=e,this.workspacesService=t,this.contextKeyService=i,this.keybindingService=o,this.configurationService=s,this.labelService=n,this.updateService=r,this.storageService=a,this.notificationService=d,this.preferencesService=l,this.environmentService=u,this.accessibilityService=g,this.hostService=m,this.commandService=f,this.keys=["window.menuBarVisibility","window.enableMenuBarMnemonics","window.customMenuBarAltFocus","workbench.sideBar.location","window.nativeTabs"],this.menus={},this.topLevelTitles={},this.recentlyOpened={files:[],workspaces:[]},this.mainMenu=this._register(this.menuService.createMenu(b.MenubarMainMenu,this.contextKeyService)),this.mainMenuDisposables=this._register(new A),this.setupMainMenu(),this.menuUpdater=this._register(new pn(()=>this.doUpdateMenubar(!1),200)),this.notifyUserOfCustomMenubarAccessibility()}registerListeners(){this._register(this.hostService.onDidChangeFocus(e=>this.onDidChangeWindowFocus(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this.updateService.onStateChange(()=>this.onUpdateStateChange()),this._register(this.workspacesService.onDidChangeRecentlyOpened(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.keybindingService.onDidUpdateKeybindings(()=>this.updateMenubar())),this._register(this.labelService.onDidChangeFormatters(()=>{this.onDidChangeRecentlyOpened()})),this._register(this.mainMenu.onDidChange(()=>{this.setupMainMenu(),this.doUpdateMenubar(!0)}))}setupMainMenu(){this.mainMenuDisposables.clear(),this.menus={},this.topLevelTitles={};const[,e]=this.mainMenu.getActions()[0];for(const t of e)t instanceof ar&&typeof t.item.title!="string"&&(this.menus[t.item.title.original]=this.mainMenuDisposables.add(this.menuService.createMenu(t.item.submenu,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.topLevelTitles[t.item.title.original]=t.item.title.mnemonicTitle??t.item.title.value)}updateMenubar(){this.menuUpdater.schedule()}calculateActionLabel(e){return e.label}onUpdateStateChange(){this.updateMenubar()}onUpdateKeybindings(){this.updateMenubar()}getOpenRecentActions(){if(!this.recentlyOpened)return[];const{workspaces:e,files:t}=this.recentlyOpened,i=[];if(e.length>0){for(let o=0;o<qo.MAX_MENU_RECENT_ENTRIES&&o<e.length;o++)i.push(this.createOpenRecentMenuAction(e[o]));i.push(new Fe)}if(t.length>0){for(let o=0;o<qo.MAX_MENU_RECENT_ENTRIES&&o<t.length;o++)i.push(this.createOpenRecentMenuAction(t[o]));i.push(new Fe)}return i}onDidChangeWindowFocus(e){e&&this.onDidChangeRecentlyOpened()}onConfigurationUpdated(e){this.keys.some(t=>e.affectsConfiguration(t))&&this.updateMenubar(),e.affectsConfiguration("editor.accessibilitySupport")&&this.notifyUserOfCustomMenubarAccessibility(),e.affectsConfiguration("window.menuBarVisibility")&&this.onDidChangeRecentlyOpened()}get menubarHidden(){return le&&ya?!1:Lo(this.configurationService)==="hidden"}onDidChangeRecentlyOpened(){this.menubarHidden||this.workspacesService.getRecentlyOpened().then(e=>{this.recentlyOpened=e,this.updateMenubar()})}createOpenRecentMenuAction(e){let t,i,o,s;const n=e.remoteAuthority;Vs(e)?(i=e.folderUri,t=e.label||this.labelService.getWorkspaceLabel(i,{verbose:2}),o="openRecentFolder",s={folderUri:i}):rr(e)?(i=e.workspace.configPath,t=e.label||this.labelService.getWorkspaceLabel(e.workspace,{verbose:2}),o="openRecentWorkspace",s={workspaceUri:i}):(i=e.fileUri,t=e.label||this.labelService.getUriLabel(i),o="openRecentFile",s={fileUri:i});const r=new ke(o,tp(t),void 0,void 0,a=>{const d=a,l=a&&(!le&&(d.ctrlKey||d.shiftKey)||le&&(d.metaKey||d.altKey));return this.hostService.openWindow([s],{forceNewWindow:!!l,remoteAuthority:n||null})});return Object.assign(r,{uri:i,remoteAuthority:n})}notifyUserOfCustomMenubarAccessibility(){if(Qe||le)return;const e=this.storageService.getBoolean("menubar/accessibleMenubarNotified",-1,!1),t=Ib(this.configurationService)==="custom";if(e||t||!this.accessibilityService.isScreenReaderOptimized())return;const i=p("menubar.customTitlebarAccessibilityNotification","Accessibility support is enabled for you. For the most accessible experience, we recommend the custom title bar style.");this.notificationService.prompt(wt.Info,i,[{label:p("goToSetting","Open Settings"),run:()=>this.preferencesService.openUserSettings({query:"window.titleBarStyle"})}]),this.storageService.store("menubar/accessibleMenubarNotified",!0,-1,0)}}qo.MAX_MENU_RECENT_ENTRIES=10;let Ar=class extends qo{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E){super(e,t,i,o,s,n,r,a,d,l,u,g,C,E),this.layoutService=m,this.telemetryService=f,this.alwaysOnMnemonics=!1,this.focusInsideMenubar=!1,this.pendingFirstTimeUpdate=!1,this.visible=!0,this.webNavigationMenu=this._register(this.menuService.createMenu(b.MenubarHomeMenu,this.contextKeyService)),this.reinstallDisposables=this._register(new A),this._onVisibilityChange=this._register(new y),this._onFocusStateChange=this._register(new y),this.actionRunner=this._register(new is),this.actionRunner.onDidRun(V=>{this.telemetryService.publicLog2("workbenchActionExecuted",{id:V.action.id,from:"menu"})}),this.workspacesService.getRecentlyOpened().then(V=>{this.recentlyOpened=V}),this.registerListeners(),this.registerActions()}doUpdateMenubar(e){this.focusInsideMenubar||this.setupCustomMenubar(e),e&&(this.pendingFirstTimeUpdate=!0)}registerActions(){const e=this;Qe&&this._register(te(class extends qe{constructor(){super({id:"workbench.actions.menubar.focus",title:{value:p("focusMenu","Focus Application Menu"),original:"Focus Application Menu"},keybinding:{primary:68,weight:200,when:Do},f1:!0})}async run(){var t;(t=e.menubar)==null||t.toggleFocus()}}))}getUpdateAction(){switch(this.updateService.state.type){case"uninitialized":return null;case"idle":return new ke("update.check",p({key:"checkForUpdates",comment:["&& denotes a mnemonic"]},"Check for &&Updates..."),void 0,!0,()=>this.updateService.checkForUpdates(!0));case"checking for updates":return new ke("update.checking",p("checkingForUpdates","Checking for Updates..."),void 0,!1);case"available for download":return new ke("update.downloadNow",p({key:"download now",comment:["&& denotes a mnemonic"]},"D&&ownload Update"),void 0,!0,()=>this.updateService.downloadUpdate());case"downloading":return new ke("update.downloading",p("DownloadingUpdate","Downloading Update..."),void 0,!1);case"downloaded":return new ke("update.install",p({key:"installUpdate...",comment:["&& denotes a mnemonic"]},"Install &&Update..."),void 0,!0,()=>this.updateService.applyUpdate());case"updating":return new ke("update.updating",p("installingUpdate","Installing Update..."),void 0,!1);case"ready":return new ke("update.restart",p({key:"restartToUpdate",comment:["&& denotes a mnemonic"]},"Restart to &&Update"),void 0,!0,()=>this.updateService.quitAndInstall())}}get currentMenubarVisibility(){return Lo(this.configurationService)}get currentDisableMenuBarAltFocus(){const e=this.configurationService.getValue("window.customMenuBarAltFocus");let t=!1;return typeof e=="boolean"&&(t=!e),t}insertActionsBefore(e,t){switch(e.id){case In.ID:t.push(...this.getOpenRecentActions());break;case"workbench.action.showAboutDialog":if(!le&&!Qe){const i=this.getUpdateAction();i&&(i.label=hi(i.label),t.push(i),t.push(new Fe))}break}}get currentEnableMenuBarMnemonics(){let e=this.configurationService.getValue("window.enableMenuBarMnemonics");return typeof e!="boolean"&&(e=!0),e&&(!Qe||Dd())}get currentCompactMenuMode(){return this.currentMenubarVisibility!=="compact"?void 0:this.configurationService.getValue("workbench.sideBar.location")==="right"?Ai.Left:Ai.Right}onDidVisibilityChange(e){this.visible=e,this.onDidChangeRecentlyOpened(),this._onVisibilityChange.fire(e)}toActionsArray(e){const t=[];return Gs(e,{shouldForwardArgs:!0},t),t}setupCustomMenubar(e){var i;if(!this.container)return;e?(this.menubar&&this.reinstallDisposables.clear(),this.menubar=this.reinstallDisposables.add(new re(this.container,this.getMenuBarOptions(),ip)),this.accessibilityService.alwaysUnderlineAccessKeys().then(o=>{var s;this.alwaysOnMnemonics=o,(s=this.menubar)==null||s.update(this.getMenuBarOptions())}),this.reinstallDisposables.add(this.menubar.onFocusStateChange(o=>{this._onFocusStateChange.fire(o),o||(this.pendingFirstTimeUpdate?(this.setupCustomMenubar(!0),this.pendingFirstTimeUpdate=!1):this.updateMenubar(),this.focusInsideMenubar=!1)})),this.reinstallDisposables.add(this.menubar.onVisibilityChange(o=>this.onDidVisibilityChange(o))),this.reinstallDisposables.add(w(this.container,S.FOCUS_IN,()=>{this.focusInsideMenubar=!0})),this.reinstallDisposables.add(w(this.container,S.FOCUS_OUT,()=>{this.focusInsideMenubar=!1})),this.menubar.isVisible&&this.onDidVisibilityChange(!0)):(i=this.menubar)==null||i.update(this.getMenuBarOptions());const t=(o,s,n)=>{s.splice(0);for(const r of o)if(this.insertActionsBefore(r,s),r instanceof Fe)s.push(r);else if(r instanceof ar||r instanceof Ec){let a=typeof r.item.title=="string"?r.item.title:r.item.title.mnemonicTitle??r.item.title.value;if(r instanceof ar){const d=[];t(r.actions,d,n),d.length>0&&s.push(new ao(r.id,hi(a),d))}else{np(r.item.toggled)&&(a=r.item.toggled.mnemonicTitle??r.item.toggled.title??a);const d=new ke(r.id,hi(a),r.class,r.enabled,()=>this.commandService.executeCommand(r.id));d.tooltip=r.tooltip,d.checked=r.checked,s.push(d)}}if(n==="File"&&this.currentCompactMenuMode===void 0){const r=this.getWebNavigationActions();r.length&&s.push(...r)}};for(const o of Object.keys(this.topLevelTitles)){const s=this.menus[o];e&&s&&(this.reinstallDisposables.add(s.onDidChange(()=>{var r;if(!this.focusInsideMenubar){const a=[];t(this.toActionsArray(s),a,o),(r=this.menubar)==null||r.updateMenu({actions:a,label:hi(this.topLevelTitles[o])})}})),s===this.menus.File&&this.reinstallDisposables.add(this.webNavigationMenu.onDidChange(()=>{var r;if(!this.focusInsideMenubar){const a=[];t(this.toActionsArray(s),a,o),(r=this.menubar)==null||r.updateMenu({actions:a,label:hi(this.topLevelTitles[o])})}})));const n=[];s&&t(this.toActionsArray(s),n,o),this.menubar&&(e?this.menubar.push({actions:n,label:hi(this.topLevelTitles[o])}):this.menubar.updateMenu({actions:n,label:hi(this.topLevelTitles[o])}))}}getWebNavigationActions(){if(!Qe)return[];const e=[];for(const t of this.webNavigationMenu.getActions()){const[,i]=t;for(const o of i)if(o instanceof Ec){const s=typeof o.item.title=="string"?o.item.title:o.item.title.mnemonicTitle??o.item.title.value;e.push(new ke(o.id,hi(s),o.class,o.enabled,async n=>{this.commandService.executeCommand(o.id,n)}))}e.push(new Fe)}return e.length&&e.pop(),e}getMenuBarOptions(){return{enableMnemonics:this.currentEnableMenuBarMnemonics,disableAltFocus:this.currentDisableMenuBarAltFocus,visibility:this.currentMenubarVisibility,actionRunner:this.actionRunner,getKeybinding:e=>this.keybindingService.lookupKeybinding(e.id),alwaysOnMnemonics:this.alwaysOnMnemonics,compactMode:this.currentCompactMenuMode,getCompactMenuActions:()=>Qe?this.getWebNavigationActions():[]}}onDidChangeWindowFocus(e){var t;this.visible&&(super.onDidChangeWindowFocus(e),this.container&&(e?this.container.classList.remove("inactive"):(this.container.classList.add("inactive"),(t=this.menubar)==null||t.blur())))}onUpdateStateChange(){this.visible&&super.onUpdateStateChange()}onDidChangeRecentlyOpened(){this.visible&&super.onDidChangeRecentlyOpened()}onUpdateKeybindings(){this.visible&&super.onUpdateKeybindings()}registerListeners(){super.registerListeners(),this._register(w(window,S.RESIZE,()=>{this.menubar&&!(op&&sp.pointerEvents)&&this.menubar.blur()})),Qe&&(this._register(this.layoutService.onDidChangeFullscreen(e=>this.updateMenubar())),this._register(this.webNavigationMenu.onDidChange(()=>this.updateMenubar())))}get onVisibilityChange(){return this._onVisibilityChange.event}get onFocusStateChange(){return this._onFocusStateChange.event}getMenubarItemsDimensions(){return this.menubar?new G(this.menubar.getWidth(),this.menubar.getHeight()):new G(0,0)}create(e){return this.container=e,this.container&&this.doUpdateMenubar(!0),this.container}layout(e){var t;(t=this.menubar)==null||t.update(this.getMenuBarOptions())}toggleFocus(){var e;(e=this.menubar)==null||e.toggleFocus()}};Ar=x([h(0,Xe),h(1,wa),h(2,H),h(3,we),h(4,L),h(5,Ci),h(6,Zu),h(7,Se),h(8,Be),h(9,Qu),h(10,Ut),h(11,ep),h(12,pt),h(13,Ye),h(14,os),h(15,It)],Ar);let ni=class We extends xn{constructor(e,t,i,o,s,n,r,a,d,l){super("workbench.parts.activitybar",{hasTitle:!1},o,s,i),this.paneCompositePart=e,this.instantiationService=t,this.storageService=s,this.extensionService=n,this.viewDescriptorService=r,this.contextKeyService=a,this.configurationService=d,this.environmentService=l,this.minimumWidth=48,this.maximumWidth=48,this.minimumHeight=0,this.maximumHeight=Number.POSITIVE_INFINITY,this.globalActivity=[],this.accountsActivity=[],this.compositeActions=new Map,this.viewContainerDisposables=new Map,this.keyboardNavigationDisposables=this._register(new A),this.location=0,this.hasExtensionsRegistered=!1,this.enabledViewContainersContextKeys=new Map,this._cachedViewContainers=void 0;for(const u of this.cachedViewContainers)u.visible=!this.shouldBeHidden(u.id,u);this.compositeBar=this.createCompositeBar(),this.onDidRegisterViewContainers(this.getViewContainers()),this.registerListeners()}createCompositeBar(){const e=this.cachedViewContainers.map(t=>({id:t.id,name:t.name,visible:t.visible,order:t.order,pinned:t.pinned}));return this._register(this.instantiationService.createInstance(Js,e,{icon:!0,orientation:1,activityHoverOptions:this.getActivityHoverOptions(),preventLoopNavigation:!0,openComposite:async(t,i)=>await this.paneCompositePart.openPaneComposite(t,!i)??null,getActivityAction:t=>this.getCompositeActions(t).activityAction,getCompositePinnedAction:t=>this.getCompositeActions(t).pinnedAction,getCompositeBadgeAction:t=>this.getCompositeActions(t).badgeAction,getOnCompositeClickAction:t=>Ne({id:t,label:"",run:async()=>{var i;return((i=this.paneCompositePart.getActivePaneComposite())==null?void 0:i.getId())===t?this.paneCompositePart.hideActivePaneComposite():this.paneCompositePart.openPaneComposite(t)}}),fillExtraContextMenuActions:(t,i)=>{const o=Lo(this.configurationService);(o==="compact"||o==="hidden"||o==="toggle")&&t.unshift(Ne({id:"toggleMenuVisibility",label:p("menu","Menu"),checked:o==="compact",run:()=>this.configurationService.updateValue("window.menuBarVisibility",o==="compact"?"toggle":"compact")}),new Fe),o==="compact"&&this.menuBarContainer&&(i!=null&&i.target)&&Ht(i.target,this.menuBarContainer)&&t.unshift(Ne({id:"hideCompactMenu",label:p("hideMenu","Hide Menu"),run:()=>this.configurationService.updateValue("window.menuBarVisibility","toggle")}),new Fe),t.push(new Fe),t.push(Ne({id:"toggleAccountsVisibility",label:p("accounts","Accounts"),checked:this.accountsVisibilityPreference,run:()=>this.accountsVisibilityPreference=!this.accountsVisibilityPreference})),t.push(new Fe),t.push(Ne({id:Yn.ID,label:Yn.getLabel(this.layoutService),run:()=>this.instantiationService.invokeFunction(s=>new Yn().run(s))})),t.push(Ne({id:Xc.ID,label:p("hideActivitBar","Hide Activity Bar"),run:()=>this.instantiationService.invokeFunction(s=>new Xc().run(s))}))},getContextMenuActionsForComposite:t=>this.getContextMenuActionsForComposite(t),getDefaultCompositeId:()=>{var t;return(t=this.viewDescriptorService.getDefaultViewContainer(this.location))==null?void 0:t.id},hidePart:()=>this.layoutService.setPartHidden(!0,"workbench.parts.sidebar"),dndHandler:new bh(this.viewDescriptorService,0,async(t,i)=>await this.paneCompositePart.openPaneComposite(t,i)??null,(t,i,o)=>this.compositeBar.move(t,i,o==null?void 0:o.verticallyBefore),()=>this.compositeBar.getCompositeBarItems()),compositeSize:52,colors:t=>this.getActivitybarItemColors(t),overflowActionSize:We.ACTION_HEIGHT}))}getActivityHoverOptions(){return{position:()=>this.layoutService.getSideBarPosition()===0?1:0}}getContextMenuActionsForComposite(e){const t=[],i=this.viewDescriptorService.getViewContainerById(e),o=this.viewDescriptorService.getDefaultViewContainerLocation(i);if(o!==this.viewDescriptorService.getViewContainerLocation(i))t.push(Ne({id:"resetLocationAction",label:p("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewContainerToLocation(i,o)}));else{const s=this.viewDescriptorService.getViewContainerModel(i);if(s.allViewDescriptors.length===1){const n=s.allViewDescriptors[0],r=this.viewDescriptorService.getDefaultContainerById(n.id);r!==i&&t.push(Ne({id:"resetLocationAction",label:p("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewsToContainer([n],r)}))}}return t}registerListeners(){this._register(this.viewDescriptorService.onDidChangeViewContainers(({added:t,removed:i})=>this.onDidChangeViewContainers(t,i))),this._register(this.viewDescriptorService.onDidChangeContainerLocation(({viewContainer:t,from:i,to:o})=>this.onDidChangeViewContainerLocation(t,i,o))),this.paneCompositePart.onDidPaneCompositeOpen(t=>this.onDidChangeViewContainerVisibility(t.getId(),!0)),this.paneCompositePart.onDidPaneCompositeClose(t=>this.onDidChangeViewContainerVisibility(t.getId(),!1));const e=this._register(new A);this._register(this.extensionService.onDidRegisterExtensions(()=>{e.clear(),this.onDidRegisterExtensions(),this.compositeBar.onDidChange(()=>this.saveCachedViewContainers(),this,e),this.storageService.onDidChangeValue(t=>this.onDidStorageValueChange(t),this,e)})),this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration("window.menuBarVisibility")&&(Lo(this.configurationService)==="compact"?this.installMenubar():this.uninstallMenubar())}))}onDidChangeViewContainers(e,t){t.filter(({location:i})=>i===0).forEach(({container:i})=>this.onDidDeregisterViewContainer(i)),this.onDidRegisterViewContainers(e.filter(({location:i})=>i===0).map(({container:i})=>i))}onDidChangeViewContainerLocation(e,t,i){t===this.location&&this.onDidDeregisterViewContainer(e),i===this.location&&this.onDidRegisterViewContainers([e])}onDidChangeViewContainerVisibility(e,t){t?this.onDidViewContainerVisible(e):this.compositeBar.deactivateComposite(e)}onDidRegisterExtensions(){this.hasExtensionsRegistered=!0;for(const{id:e}of this.cachedViewContainers){const t=this.getViewContainer(e);t?this.showOrHideViewContainer(t):this.viewDescriptorService.isViewContainerRemovedPermanently(e)?this.removeComposite(e):this.hideComposite(e)}this.saveCachedViewContainers()}onDidViewContainerVisible(e){const t=this.getViewContainer(e);t&&(this.addComposite(t),this.compositeBar.activateComposite(t.id),this.shouldBeHidden(t)&&this.viewDescriptorService.getViewContainerModel(t).activeViewDescriptors.length===0&&this.hideComposite(t.id))}showActivity(e,t,i,o){return this.getViewContainer(e)?this.compositeBar.showActivity(e,t,i,o):e===Di?this.showGlobalActivity(Di,t,i,o):e===Ns?this.showGlobalActivity(Ns,t,i,o):R.None}showGlobalActivity(e,t,i,o){typeof o!="number"&&(o=0);const s={badge:t,clazz:i,priority:o},n=e===Di?this.globalActivity:this.accountsActivity;for(let r=0;r<=n.length;r++)if(r===n.length){n.push(s);break}else if(n[r].priority<=o){n.splice(r,0,s);break}return this.updateGlobalActivity(e),ie(()=>this.removeGlobalActivity(e,s))}removeGlobalActivity(e,t){const i=e===Di?this.globalActivity:this.accountsActivity,o=i.indexOf(t);o!==-1&&(i.splice(o,1),this.updateGlobalActivity(e))}updateGlobalActivity(e){const t=e===Di?this.globalActivityAction:this.accountsActivityAction;if(!t)return;const i=e===Di?this.globalActivity:this.accountsActivity;if(i.length){const[{badge:o,clazz:s,priority:n}]=i;if(o instanceof Io&&i.length>1){const r=this.getCumulativeNumberBadge(i,n);t.setBadge(r)}else t.setBadge(o,s)}else t.setBadge(void 0)}getCumulativeNumberBadge(e,t){const i=e.filter(n=>n.badge instanceof Io&&n.priority===t),o=i.reduce((n,r)=>n+r.badge.number,0),s=()=>i.reduce((n,r,a)=>(n=n+r.badge.getDescription(),a<i.length-1&&(n=`${n}
`),n),"");return new Io(o,s)}uninstallMenubar(){this.menuBar&&(this.menuBar.dispose(),this.menuBar=void 0),this.menuBarContainer&&(this.menuBarContainer.remove(),this.menuBarContainer=void 0,this.registerKeyboardNavigationListeners())}installMenubar(){if(this.menuBar)return;this.menuBarContainer=document.createElement("div"),this.menuBarContainer.classList.add("menubar"),j(this.content).prepend(this.menuBarContainer),this.menuBar=this._register(this.instantiationService.createInstance(Ar)),this.menuBar.create(this.menuBarContainer),this.registerKeyboardNavigationListeners()}createContentArea(e){return this.element=e,this.content=document.createElement("div"),this.content.classList.add("content"),e.appendChild(this.content),Lo(this.configurationService)==="compact"&&this.installMenubar(),this.compositeBarContainer=this.compositeBar.create(this.content),this.globalActivitiesContainer=document.createElement("div"),this.content.appendChild(this.globalActivitiesContainer),this.registerKeyboardNavigationListeners(),this.content}registerKeyboardNavigationListeners(){this.keyboardNavigationDisposables.clear(),this.menuBarContainer&&this.keyboardNavigationDisposables.add(w(this.menuBarContainer,S.KEY_DOWN,e=>{var i;const t=new Ct(e);(t.equals(18)||t.equals(17))&&((i=this.compositeBar)==null||i.focus())})),this.compositeBarContainer&&this.keyboardNavigationDisposables.add(w(this.compositeBarContainer,S.KEY_DOWN,e=>{var i,o;const t=new Ct(e);t.equals(18)||t.equals(17)?(i=this.globalActivityActionBar)==null||i.focus(!0):(t.equals(16)||t.equals(15))&&((o=this.menuBar)==null||o.toggleFocus())})),this.globalActivitiesContainer&&this.keyboardNavigationDisposables.add(w(this.globalActivitiesContainer,S.KEY_DOWN,e=>{var i;const t=new Ct(e);(t.equals(16)||t.equals(15))&&((i=this.compositeBar)==null||i.focus(this.getVisiblePaneCompositeIds().length-1))}))}createGlobalActivityActionBar(e){this.globalActivityActionBar=this._register(new vo(e,{actionViewItemProvider:t=>{if(t.id==="workbench.actions.manage")return this.instantiationService.createInstance(Ir,t,()=>this.compositeBar.getContextMenuActions(),i=>this.getActivitybarItemColors(i),this.getActivityHoverOptions());if(t.id==="workbench.actions.accounts")return this.instantiationService.createInstance(Pi,t,()=>this.compositeBar.getContextMenuActions(),i=>this.getActivitybarItemColors(i),this.getActivityHoverOptions());throw new Error(`No view item for action '${t.id}'`)},orientation:1,ariaLabel:p("manage","Manage"),animated:!1,preventLoopNavigation:!0})),this.globalActivityAction=this._register(new Ms({id:"workbench.actions.manage",name:p("manage","Manage"),classNames:me.asClassNameArray(We.GEAR_ICON)})),this.accountsVisibilityPreference&&(this.accountsActivityAction=this._register(new Ms({id:"workbench.actions.accounts",name:p("accounts","Accounts"),classNames:me.asClassNameArray(We.ACCOUNTS_ICON)})),this.globalActivityActionBar.push(this.accountsActivityAction,{index:We.ACCOUNTS_ACTION_INDEX})),this.globalActivityActionBar.push(this.globalActivityAction)}toggleAccountsActivity(){!!this.accountsActivityAction!==this.accountsVisibilityPreference&&(this.globalActivityActionBar&&(this.accountsActivityAction?(this.globalActivityActionBar.pull(We.ACCOUNTS_ACTION_INDEX),this.accountsActivityAction=void 0):(this.accountsActivityAction=this._register(new Ms({id:"workbench.actions.accounts",name:p("accounts","Accounts"),classNames:me.asClassNameArray(M.account)})),this.globalActivityActionBar.push(this.accountsActivityAction,{index:We.ACCOUNTS_ACTION_INDEX}))),this.updateGlobalActivity(Ns))}getCompositeActions(e){let t=this.compositeActions.get(e);if(!t){const i=this.getViewContainer(e);if(i){const o=this.viewDescriptorService.getViewContainerModel(i);t={activityAction:this.instantiationService.createInstance(jo,this.toActivity(o),this.paneCompositePart),pinnedAction:new qa(this.toActivity(o),this.compositeBar),badgeAction:new Ya(this.toActivity(o),this.compositeBar)}}else{const o=this.cachedViewContainers.filter(s=>s.id===e)[0];t={activityAction:this.instantiationService.createInstance(Fb,We.toActivity(e,e,o==null?void 0:o.icon,void 0),this.paneCompositePart),pinnedAction:new id(e,this.compositeBar),badgeAction:new mh(e,this.compositeBar)}}this.compositeActions.set(e,t)}return t}onDidRegisterViewContainers(e){for(const t of e){this.addComposite(t),this.cachedViewContainers.filter(({id:r})=>r===t.id)[0]||this.compositeBar.pin(t.id);const o=this.paneCompositePart.getActivePaneComposite();(o==null?void 0:o.getId())===t.id&&this.compositeBar.activateComposite(t.id);const s=this.viewDescriptorService.getViewContainerModel(t);this.updateActivity(t,s),this.showOrHideViewContainer(t);const n=new A;n.add(s.onDidChangeContainerInfo(()=>this.updateActivity(t,s))),n.add(s.onDidChangeActiveViewDescriptors(()=>this.showOrHideViewContainer(t))),this.viewContainerDisposables.set(t.id,n)}}onDidDeregisterViewContainer(e){const t=this.viewContainerDisposables.get(e.id);t==null||t.dispose(),this.viewContainerDisposables.delete(e.id),this.removeComposite(e.id)}updateActivity(e,t){const i=this.toActivity(t),{activityAction:o,pinnedAction:s}=this.getCompositeActions(e.id);o.updateActivity(i),s instanceof id&&s.setActivity(i),this.saveCachedViewContainers()}toActivity(e){return We.toActivity(e.viewContainer.id,e.title,e.icon,e.keybindingId)}static toActivity(e,t,i,o){let s,n;if(P.isUri(i)){n=i;const r=Ca(i),a=new Td;a.update(r);const d=`activity-${e.replace(/\./g,"-")}-${a.digest()}`,l=`.monaco-workbench .activitybar .monaco-action-bar .action-label.${d}`;s=[d,"uri-icon"],Vd(l,`
				mask: ${r} no-repeat 50% 50%;
				mask-size: 24px;
				-webkit-mask: ${r} no-repeat 50% 50%;
				-webkit-mask-size: 24px;
			`)}else me.isThemeIcon(i)&&(s=me.asClassNameArray(i));return{id:e,name:t,classNames:s,iconUrl:n,keybindingId:o}}showOrHideViewContainer(e){let t=this.enabledViewContainersContextKeys.get(e.id);t||(t=this.contextKeyService.createKey(Rd(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,t)),this.shouldBeHidden(e)?(t.set(!1),this.hideComposite(e.id)):(t.set(!0),this.addComposite(e))}shouldBeHidden(e,t){var s;const i=Nt(e)?this.getViewContainer(e):e,o=Nt(e)?e:e.id;if(i)if(i.hideIfEmpty){if(this.viewDescriptorService.getViewContainerModel(i).activeViewDescriptors.length>0)return!1}else return!1;if(!this.hasExtensionsRegistered&&!(this.environmentService.remoteAuthority&&ya)){if(t=t||this.cachedViewContainers.find(({id:n})=>n===o),!i&&(t!=null&&t.isBuiltin)&&(t!=null&&t.visible))return!1;if((s=t==null?void 0:t.views)!=null&&s.length)return t.views.every(({when:n})=>!!n&&!this.contextKeyService.contextMatchesRules(v.deserialize(n)))}return!0}addComposite(e){this.compositeBar.addComposite({id:e.id,name:typeof e.title=="string"?e.title:e.title.value,order:e.order,requestedIndex:e.requestedIndex})}hideComposite(e){this.compositeBar.hideComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}removeComposite(e){this.compositeBar.removeComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}getPinnedPaneCompositeIds(){const e=this.compositeBar.getPinnedComposites().map(t=>t.id);return this.getViewContainers().filter(t=>this.compositeBar.isPinned(t.id)).sort((t,i)=>e.indexOf(t.id)-e.indexOf(i.id)).map(t=>t.id)}getVisiblePaneCompositeIds(){return this.compositeBar.getVisibleComposites().filter(e=>{var t;return((t=this.paneCompositePart.getActivePaneComposite())==null?void 0:t.getId())===e.id||this.compositeBar.isPinned(e.id)}).map(e=>e.id)}focus(){this.compositeBar.focus()}updateStyles(){super.updateStyles();const e=j(this.getContainer()),t=this.getColor(rp)||"";e.style.backgroundColor=t;const i=this.getColor(ap)||this.getColor(ot)||"";e.classList.toggle("bordered",!!i),e.style.borderColor=i||""}getActivitybarItemColors(e){return{activeForegroundColor:e.getColor(cp),inactiveForegroundColor:e.getColor(dp),activeBorderColor:e.getColor(_d),activeBackground:e.getColor(kd),badgeBackground:e.getColor(lp),badgeForeground:e.getColor(hp),dragAndDropBorder:e.getColor(up),activeBackgroundColor:void 0,inactiveBackgroundColor:void 0,activeBorderBottomColor:void 0}}layout(e,t){if(!this.layoutService.isVisible("workbench.parts.activitybar"))return;let o=super.layoutContents(e,t).contentSize.height;this.menuBarContainer&&(o-=this.menuBarContainer.clientHeight),this.globalActivityActionBar&&(o-=this.globalActivityActionBar.viewItems.length*We.ACTION_HEIGHT),this.compositeBar.layout(new G(e,o))}getViewContainer(e){const t=this.viewDescriptorService.getViewContainerById(e);return t&&this.viewDescriptorService.getViewContainerLocation(t)===this.location?t:void 0}getViewContainers(){return this.viewDescriptorService.getViewContainersByLocation(this.location)}onDidStorageValueChange(e){if(e.key===We.PINNED_VIEW_CONTAINERS&&e.scope===0&&this.pinnedViewContainersValue!==this.getStoredPinnedViewContainersValue()){this._pinnedViewContainersValue=void 0,this._cachedViewContainers=void 0;const t=[],i=this.compositeBar.getCompositeBarItems();for(const o of this.cachedViewContainers)t.push({id:o.id,name:o.name,order:o.order,pinned:o.pinned,visible:!!i.find(({id:s})=>s===o.id)});for(let o=0;o<i.length;o++)if(!t.some(({id:s})=>s===i[o].id)){const s=this.viewDescriptorService.getViewContainerById(i[o].id);t.splice(o,0,{...i[o],pinned:!0,visible:!0,order:s==null?void 0:s.order})}this.compositeBar.setCompositeBarItems(t)}e.key===Pi.ACCOUNTS_VISIBILITY_PREFERENCE_KEY&&e.scope===0&&this.toggleAccountsActivity()}saveCachedViewContainers(){const e=[],t=this.compositeBar.getCompositeBarItems();for(const i of t){const o=this.getViewContainer(i.id);if(o){const s=this.viewDescriptorService.getViewContainerModel(o),n=[];for(const{when:r}of s.allViewDescriptors)n.push({when:r?r.serialize():void 0});e.push({id:i.id,name:s.title,icon:P.isUri(s.icon)&&this.environmentService.remoteAuthority?void 0:s.icon,views:n,pinned:i.pinned,order:i.order,visible:i.visible,isBuiltin:!o.extensionId})}else e.push({id:i.id,pinned:i.pinned,order:i.order,visible:!1,isBuiltin:!1})}this.storeCachedViewContainersState(e)}get cachedViewContainers(){if(this._cachedViewContainers===void 0){this._cachedViewContainers=this.getPinnedViewContainers();for(const e of this.getPlaceholderViewContainers()){const t=this._cachedViewContainers.filter(i=>i.id===e.id)[0];t&&(t.name=e.name,t.icon=e.themeIcon?e.themeIcon:e.iconUrl?P.revive(e.iconUrl):void 0,P.isUri(t.icon)&&this.environmentService.remoteAuthority&&(t.icon=void 0),t.views=e.views,t.isBuiltin=e.isBuiltin)}}return this._cachedViewContainers}storeCachedViewContainersState(e){this.setPinnedViewContainers(e.map(({id:t,pinned:i,visible:o,order:s})=>({id:t,pinned:i,visible:o,order:s}))),this.setPlaceholderViewContainers(e.map(({id:t,icon:i,name:o,views:s,isBuiltin:n})=>({id:t,iconUrl:P.isUri(i)?i:void 0,themeIcon:me.isThemeIcon(i)?i:void 0,name:o,isBuiltin:n,views:s})))}getPinnedViewContainers(){return JSON.parse(this.pinnedViewContainersValue)}setPinnedViewContainers(e){this.pinnedViewContainersValue=JSON.stringify(e)}get pinnedViewContainersValue(){return this._pinnedViewContainersValue||(this._pinnedViewContainersValue=this.getStoredPinnedViewContainersValue()),this._pinnedViewContainersValue}set pinnedViewContainersValue(e){this.pinnedViewContainersValue!==e&&(this._pinnedViewContainersValue=e,this.setStoredPinnedViewContainersValue(e))}getStoredPinnedViewContainersValue(){return this.storageService.get(We.PINNED_VIEW_CONTAINERS,0,"[]")}setStoredPinnedViewContainersValue(e){this.storageService.store(We.PINNED_VIEW_CONTAINERS,e,0,0)}getPlaceholderViewContainers(){return JSON.parse(this.placeholderViewContainersValue)}setPlaceholderViewContainers(e){this.placeholderViewContainersValue=JSON.stringify(e)}get placeholderViewContainersValue(){return this._placeholderViewContainersValue||(this._placeholderViewContainersValue=this.getStoredPlaceholderViewContainersValue()),this._placeholderViewContainersValue}set placeholderViewContainersValue(e){this.placeholderViewContainersValue!==e&&(this._placeholderViewContainersValue=e,this.setStoredPlaceholderViewContainersValue(e))}getStoredPlaceholderViewContainersValue(){return this.storageService.get(We.PLACEHOLDER_VIEW_CONTAINERS,0,"[]")}setStoredPlaceholderViewContainersValue(e){this.storageService.store(We.PLACEHOLDER_VIEW_CONTAINERS,e,0,1)}get accountsVisibilityPreference(){return this.storageService.getBoolean(Pi.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,0,!0)}set accountsVisibilityPreference(e){this.storageService.store(Pi.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,e,0,0)}toJSON(){return{type:"workbench.parts.activitybar"}}};ni.PINNED_VIEW_CONTAINERS="workbench.activity.pinnedViewlets2";ni.PLACEHOLDER_VIEW_CONTAINERS="workbench.activity.placeholderViewlets";ni.ACTION_HEIGHT=48;ni.ACCOUNTS_ACTION_INDEX=0;ni.GEAR_ICON=pe("settings-view-bar-icon",M.settingsGear,p("settingsViewBarIcon","Settings icon in the view bar."));ni.ACCOUNTS_ICON=pe("accounts-view-bar-icon",M.account,p("accountsViewBarIcon","Accounts icon in the view bar."));ni=x([h(1,D),h(2,pt),h(3,X),h(4,Se),h(5,yi),h(6,nt),h(7,H),h(8,L),h(9,Ut)],ni);var Ub='.monaco-workbench .workbench-hover{background:var(--vscode-editorHoverWidget-background);border:1px solid var(--vscode-editorHoverWidget-border);border-radius:3px;box-shadow:0 2px 8px var(--vscode-widget-shadow);color:var(--vscode-editorHoverWidget-foreground);font-size:13px;line-height:19px;max-width:700px;overflow:hidden;position:relative;z-index:40}.monaco-workbench .workbench-hover hr{border-bottom:none}.monaco-workbench .workbench-hover:not(.skip-fade-in){animation:fadein .1s linear}.monaco-workbench .workbench-hover.compact{font-size:12px}.monaco-workbench .workbench-hover.compact .hover-contents{padding:2px 8px}.monaco-workbench .workbench-hover-container.locked .workbench-hover{outline:1px solid var(--vscode-editorHoverWidget-border)}.monaco-workbench .workbench-hover-container.locked .workbench-hover:focus,.monaco-workbench .workbench-hover-lock:focus{outline:1px solid var(--vscode-focusBorder)}.monaco-workbench .workbench-hover-container.locked .workbench-hover-lock:hover{background:var(--vscode-toolbar-hoverBackground)}.monaco-workbench .workbench-hover-pointer{pointer-events:none;position:absolute;z-index:41}.monaco-workbench .workbench-hover-pointer:after{background-color:var(--vscode-editorHoverWidget-background);border-bottom:1px solid var(--vscode-editorHoverWidget-border);border-right:1px solid var(--vscode-editorHoverWidget-border);content:"";height:5px;position:absolute;width:5px}.monaco-workbench .locked .workbench-hover-pointer:after{border-bottom-width:2px;border-right-width:2px;height:4px;width:4px}.monaco-workbench .workbench-hover-pointer.left{left:-3px}.monaco-workbench .workbench-hover-pointer.right{right:3px}.monaco-workbench .workbench-hover-pointer.top{top:-3px}.monaco-workbench .workbench-hover-pointer.bottom{bottom:3px}.monaco-workbench .workbench-hover-pointer.left:after{transform:rotate(135deg)}.monaco-workbench .workbench-hover-pointer.right:after{transform:rotate(315deg)}.monaco-workbench .workbench-hover-pointer.top:after{transform:rotate(225deg)}.monaco-workbench .workbench-hover-pointer.bottom:after{transform:rotate(45deg)}.monaco-workbench .workbench-hover a{color:var(--vscode-textLink-foreground)}.monaco-workbench .workbench-hover a:focus{outline:1px solid;outline-color:var(--vscode-focusBorder);outline-offset:-1px;text-decoration:underline}.monaco-workbench .workbench-hover a:active,.monaco-workbench .workbench-hover a:hover{color:var(--vscode-textLink-activeForeground)}.monaco-workbench .workbench-hover code{background:var(--vscode-textCodeBlock-background)}.monaco-workbench .workbench-hover .hover-row .actions{background:var(--vscode-editorHoverWidget-statusBarBackground)}.monaco-workbench .workbench-hover.right-aligned{left:1px}.monaco-workbench .workbench-hover.right-aligned .hover-row.status-bar .actions{flex-direction:row-reverse}.monaco-workbench .workbench-hover.right-aligned .hover-row.status-bar .actions .action-container{margin-left:16px;margin-right:0}';be(Ub,{});const Vt=z;let Tr=class extends va{get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,o,s){super(),this._keybindingService=t,this._configurationService=i,this._openerService=o,this._instantiationService=s,this._messageListeners=new A,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new y),this._onRequestLayout=this._register(new y),this._linkHandler=e.linkHandler||(u=>pp(this._openerService,u,Ao(e.content)?e.content.isTrusted:void 0)),this._target="targetElements"in e.target?e.target:new Kb(e.target),this._hoverPointer=e.showPointer?Vt("div.workbench-hover-pointer"):void 0,this._hover=this._register(new gp),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),e.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),e.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),e.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=e.hoverPosition??3,this.onmousedown(this._hover.containerDomNode,u=>u.stopPropagation()),this.onkeydown(this._hover.containerDomNode,u=>{u.equals(9)&&this.dispose()}),this._register(w(window,"blur",()=>this.dispose()));const n=Vt("div.hover-row.markdown-hover"),r=Vt("div.hover-contents");if(typeof e.content=="string")r.textContent=e.content,r.style.whiteSpace="pre-wrap";else if(e.content instanceof HTMLElement)r.appendChild(e.content),r.classList.add("html-hover-contents");else{const u=e.content,g=this._instantiationService.createInstance(mp,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||fp.fontFamily}),{element:m}=g.render(u,{actionHandler:{callback:f=>this._linkHandler(f),disposables:this._messageListeners},asyncRenderCallback:()=>{r.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});r.appendChild(m)}if(n.appendChild(r),this._hover.contentsDomNode.appendChild(n),e.actions&&e.actions.length>0){const u=Vt("div.hover-row.status-bar"),g=Vt("div.actions");e.actions.forEach(m=>{const f=this._keybindingService.lookupKeybinding(m.commandId),C=f?f.getLabel():null;bp.render(g,{label:m.label,commandId:m.commandId,run:E=>{m.run(E),this.dispose()},iconClass:m.iconClass},C)}),u.appendChild(g),this._hover.containerDomNode.appendChild(u)}this._hoverContainer=Vt("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let a;if(e.actions&&e.actions.length>0?a=!1:e.hideOnHover===void 0?a=typeof e.content=="string"||Ao(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):a=e.hideOnHover,a&&e.showHoverHint){const u=Vt("div.hover-row.status-bar"),g=Vt("div.info");g.textContent=p("hoverhint","Hold {0} key to mouse over",le?"Option":"Alt"),u.appendChild(g),this._hover.containerDomNode.appendChild(u)}const d=[...this._target.targetElements];a||d.push(this._hoverContainer);const l=this._register(new rd(d));if(this._register(l.onMouseOut(()=>{this._isLocked||this.dispose()})),a){const u=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new rd(u)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=l}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=Pd(this._hoverContainer,Vt("div")),o=se(this._hoverContainer,Vt("div"));i.tabIndex=0,o.tabIndex=0,this._register(w(o,"focus",s=>{e.focus(),s.preventDefault()})),this._register(w(i,"focus",s=>{t.focus(),s.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const s=i;if(typeof s.tabIndex=="number"&&s.tabIndex>=0)return s}const o=this.findLastFocusableChild(i);if(o)return o}}render(e){e.appendChild(this._hoverContainer),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=l=>{const u=Id(l),g=l.getBoundingClientRect();return{top:g.top*u,bottom:g.bottom*u,right:g.right*u,left:g.left*u}},t=this._target.targetElements.map(l=>e(l)),i=Math.min(...t.map(l=>l.top)),o=Math.max(...t.map(l=>l.right)),s=Math.max(...t.map(l=>l.bottom)),n=Math.min(...t.map(l=>l.left)),r=o-n,a=s-i,d={top:i,right:o,bottom:s,left:n,width:r,height:a,center:{x:n+r/2,y:i+a/2}};if(this.adjustHorizontalHoverPosition(d),this.adjustVerticalHoverPosition(d),this.adjustHoverMaxHeight(d),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:d.left+=3,d.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:d.left-=3,d.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:d.top+=3,d.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:d.top-=3,d.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}d.center.x=d.left+r/2,d.center.y=d.top+a/2}this.computeXCordinate(d),this.computeYCordinate(d),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(d)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=document.documentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(document.documentElement.clientWidth-t-2,document.documentElement.clientLeft))),this._x<document.documentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>window.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x===void 0){if(this._forcePosition){const t=(this._hoverPointer?3:0)+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${document.documentElement.clientWidth-e.right-t}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-t}px`);return}this._hoverPosition===1?document.documentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth&&(e.left>=this._hover.containerDomNode.clientWidth?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth&&(document.documentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth<=document.documentElement.clientLeft&&(this._hoverPosition=1))}}adjustVerticalHoverPosition(e){this._target.y!==void 0||this._forcePosition||(this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.clientHeight>window.innerHeight&&(this._hoverPosition=3))}adjustHoverMaxHeight(e){let t=window.innerHeight/2;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,window.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const o=this._x+i;(o<e.left||o>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}hide(){this.dispose()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};Tr=x([h(1,we),h(2,L),h(3,Ki),h(4,D)],Tr);class rd extends va{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e){super(),this._elements=e,this._isMouseIn=!0,this._onMouseOut=this._register(new y),this._elements.forEach(t=>this.onmouseover(t,()=>this._onTargetMouseOver())),this._elements.forEach(t=>this.onmouseleave(t,()=>this._onTargetMouseLeave()))}_onTargetMouseOver(){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout()}_onTargetMouseLeave(){this._isMouseIn=!1,this._evaluateMouseState()}_evaluateMouseState(){this._clearEvaluateMouseStateTimeout(),this._mouseTimeout=window.setTimeout(()=>this._fireIfMouseOutside(),0)}_clearEvaluateMouseStateTimeout(){this._mouseTimeout&&(clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class Kb{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}let Vr=class{constructor(e,t,i,o){this._instantiationService=e,this._contextViewService=t,this._keybindingService=o,i.onDidShowContextMenu(()=>this.hideHover())}showHover(e,t){if(ad(this._currentHoverOptions)===ad(e))return;this._currentHoverOptions=e,e.trapFocus&&document.activeElement?this._lastFocusedElementBeforeOpen=document.activeElement:this._lastFocusedElementBeforeOpen=void 0;const i=new A,o=this._instantiationService.createInstance(Tr,e);o.onDispose(()=>{var r;(r=this._lastFocusedElementBeforeOpen)==null||r.focus(),this._currentHoverOptions===e&&(this._currentHoverOptions=void 0),i.dispose()});const s=this._contextViewService;if(s.showContextView(new $b(o,t),e.container),o.onRequestLayout(()=>s.layout()),"targetElements"in e.target)for(const r of e.target.targetElements)i.add(w(r,S.CLICK,()=>this.hideHover()));else i.add(w(e.target,S.CLICK,()=>this.hideHover()));const n=document.activeElement;if(n&&(i.add(w(n,S.KEY_DOWN,r=>this._keyDown(r,o,!!e.hideOnKeyDown))),i.add(w(document,S.KEY_DOWN,r=>this._keyDown(r,o,!!e.hideOnKeyDown))),i.add(w(n,S.KEY_UP,r=>this._keyUp(r,o))),i.add(w(document,S.KEY_UP,r=>this._keyUp(r,o)))),"IntersectionObserver"in window){const r=new IntersectionObserver(d=>this._intersectionChange(d,o),{threshold:0}),a="targetElements"in e.target?e.target.targetElements[0]:e.target;r.observe(a),i.add(ie(()=>r.disconnect()))}return this._currentHover=o,o}hideHover(){var e;(e=this._currentHover)!=null&&e.isLocked||!this._currentHoverOptions||(this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewService.hideContextView())}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}_keyDown(e,t,i){var n,r;if(e.key==="Alt"){t.isLocked=!0;return}const o=new Ct(e);this._keybindingService.resolveKeyboardEvent(o).getSingleModifierDispatchChords().some(a=>!!a)||this._keybindingService.softDispatch(o,o.target).kind!==0||i&&(!((n=this._currentHoverOptions)!=null&&n.trapFocus)||e.key!=="Tab")&&(this.hideHover(),(r=this._lastFocusedElementBeforeOpen)==null||r.focus())}_keyUp(e,t){var i;e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),(i=this._lastFocusedElementBeforeOpen)==null||i.focus()))}};Vr=x([h(0,D),h(1,ss),h(2,xe),h(3,we)],Vr);function ad(c){if(c!==void 0)return(c==null?void 0:c.id)??c}class $b{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}ba((c,e)=>{const t=c.getColor(vp);t&&(e.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});class Yo{constructor(){this.uris=[]}async perform(){return this}toString(){return"(noop)"}}class yh{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="rename"}}let Rr=class Ch{constructor(e,t,i,o){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o}get uris(){return this._edits.map(e=>[e.newUri,e.oldUri]).flat()}async perform(e){const t=[],i=[];for(const o of this._edits)o.options.overwrite===void 0&&o.options.ignoreIfExists&&await this._fileService.exists(o.newUri)||(t.push({file:{source:o.oldUri,target:o.newUri},overwrite:o.options.overwrite}),i.push(new yh(o.oldUri,o.newUri,o.options)));return t.length===0?new Yo:(await this._workingCopyFileService.move(t,e,this._undoRedoInfo),new Ch(i,{isUndoing:!0},this._workingCopyFileService,this._fileService))}toString(){return`(rename ${this._edits.map(e=>`${e.oldUri} to ${e.newUri}`).join(", ")})`}};Rr=x([h(2,mn),h(3,Ue)],Rr);class jb{constructor(e,t,i){this.newUri=e,this.oldUri=t,this.options=i,this.type="copy"}}let Pr=class{constructor(e,t,i,o,s){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._instaService=s}get uris(){return this._edits.map(e=>[e.newUri,e.oldUri]).flat()}async perform(e){const t=[];for(const s of this._edits)s.options.overwrite===void 0&&s.options.ignoreIfExists&&await this._fileService.exists(s.newUri)||t.push({file:{source:s.oldUri,target:s.newUri},overwrite:s.options.overwrite});if(t.length===0)return new Yo;const i=await this._workingCopyFileService.copy(t,e,this._undoRedoInfo),o=[];for(let s=0;s<i.length;s++){const n=i[s],r=this._edits[s];o.push(new Qa(n.resource,{recursive:!0,folder:this._edits[s].options.folder||n.isDirectory,...r.options},!1))}return this._instaService.createInstance(Xo,o,{isUndoing:!0})}toString(){return`(copy ${this._edits.map(e=>`${e.oldUri} to ${e.newUri}`).join(", ")})`}};Pr=x([h(2,mn),h(3,Ue),h(4,D)],Pr);class Sh{constructor(e,t,i){this.newUri=e,this.options=t,this.contents=i,this.type="create"}}let Zs=class{constructor(e,t,i,o,s,n){this._edits=e,this._undoRedoInfo=t,this._fileService=i,this._workingCopyFileService=o,this._instaService=s,this._textFileService=n}get uris(){return this._edits.map(e=>e.newUri)}async perform(e){const t=[],i=[],o=[];for(const s of this._edits)if(!(s.options.overwrite===void 0&&s.options.ignoreIfExists&&await this._fileService.exists(s.newUri))){if(s.options.folder)t.push({resource:s.newUri});else{const n=typeof s.contents<"u"?s.contents:await this._textFileService.getEncodedReadable(s.newUri);i.push({resource:s.newUri,contents:n,overwrite:s.options.overwrite})}o.push(new Qa(s.newUri,s.options,!s.options.folder&&!s.contents))}return t.length===0&&i.length===0?new Yo:(await this._workingCopyFileService.createFolder(t,e,this._undoRedoInfo),await this._workingCopyFileService.create(i,e,this._undoRedoInfo),this._instaService.createInstance(Xo,o,{isUndoing:!0}))}toString(){return`(create ${this._edits.map(e=>{var t;return e.options.folder?`folder ${e.newUri}`:`file ${e.newUri} with ${((t=e.contents)==null?void 0:t.byteLength)||0} bytes`}).join(", ")})`}};Zs=x([h(2,Ue),h(3,mn),h(4,D),h(5,Ld)],Zs);class Qa{constructor(e,t,i){this.oldUri=e,this.options=t,this.undoesCreate=i,this.type="delete"}}let Xo=class{constructor(e,t,i,o,s,n,r){this._edits=e,this._undoRedoInfo=t,this._workingCopyFileService=i,this._fileService=o,this._configurationService=s,this._instaService=n,this._logService=r}get uris(){return this._edits.map(e=>e.oldUri)}async perform(e){const t=[],i=[];for(const o of this._edits){let s;try{s=await this._fileService.resolve(o.oldUri,{resolveMetadata:!0})}catch{if(!o.options.ignoreIfNotExists)throw new Error(`${o.oldUri} does not exist and can not be deleted`);continue}t.push({resource:o.oldUri,recursive:o.options.recursive,useTrash:!o.options.skipTrashBin&&this._fileService.hasCapability(o.oldUri,4096)&&this._configurationService.getValue("files.enableTrash")});let n;if(!o.undoesCreate&&!o.options.folder&&!(typeof o.options.maxSize=="number"&&s.size>o.options.maxSize))try{n=await this._fileService.readFile(o.oldUri)}catch(r){this._logService.error(r)}n!==void 0&&i.push(new Sh(o.oldUri,o.options,n.value))}return t.length===0?new Yo:(await this._workingCopyFileService.delete(t,e,this._undoRedoInfo),i.length===0?new Yo:this._instaService.createInstance(Zs,i,{isUndoing:!0}))}toString(){return`(delete ${this._edits.map(e=>e.oldUri).join(", ")})`}};Xo=x([h(2,mn),h(3,Ue),h(4,L),h(5,D),h(6,rt)],Xo);class qb{constructor(e,t,i,o){this.label=e,this.code=t,this.operations=i,this.confirmBeforeUndo=o,this.type=1,this.resources=i.map(s=>s.uris).flat()}async undo(){await this._reverse()}async redo(){await this._reverse()}async _reverse(){for(let e=0;e<this.operations.length;e++){const i=await this.operations[e].perform(Fi.None);this.operations[e]=i}}toString(){return this.operations.map(e=>String(e)).join(", ")}}let Lr=class{constructor(e,t,i,o,s,n,r,a,d,l){this._label=e,this._code=t,this._undoRedoGroup=i,this._undoRedoSource=o,this._confirmBeforeUndo=s,this._progress=n,this._token=r,this._edits=a,this._instaService=d,this._undoRedoService=l}async apply(){var n,r;const e=[],t={undoRedoGroupId:this._undoRedoGroup.id},i=[];for(const a of this._edits)a.newResource&&a.oldResource&&!((n=a.options)!=null&&n.copy)?i.push(new yh(a.newResource,a.oldResource,a.options??{})):a.newResource&&a.oldResource&&((r=a.options)!=null&&r.copy)?i.push(new jb(a.newResource,a.oldResource,a.options??{})):!a.newResource&&a.oldResource?i.push(new Qa(a.oldResource,a.options??{},!1)):a.newResource&&!a.oldResource&&i.push(new Sh(a.newResource,a.options??{},await a.options.contents));if(i.length===0)return[];const o=[];o[0]=[i[0]];for(let a=1;a<i.length;a++){const d=i[a],l=Md(o);l[0].type===d.type?l.push(d):o.push([d])}for(const a of o){if(this._token.isCancellationRequested)break;let d;switch(a[0].type){case"rename":d=this._instaService.createInstance(Rr,a,t);break;case"copy":d=this._instaService.createInstance(Pr,a,t);break;case"delete":d=this._instaService.createInstance(Xo,a,t);break;case"create":d=this._instaService.createInstance(Zs,a,t);break}if(d){const l=await d.perform(this._token);e.push(l)}this._progress.report(void 0)}const s=new qb(this._label,this._code,e,this._confirmBeforeUndo);return this._undoRedoService.pushElement(s,this._undoRedoGroup,this._undoRedoSource),s.resources}};Lr=x([h(8,D),h(9,Od)],Lr);class Eh{constructor(e){this._modelReference=e,this.model=this._modelReference.object.textEditorModel,this._edits=[]}dispose(){this._modelReference.dispose()}isNoOp(){return!(this._edits.length>0||this._newEol!==void 0&&this._newEol!==this.model.getEndOfLineSequence())}addEdit(e){this._expectedModelVersionId=e.versionId;const{textEdit:t}=e;if(typeof t.eol=="number"&&(this._newEol=t.eol),!t.range&&!t.text||tt.isEmpty(t.range)&&!t.text)return;let i;t.range?i=tt.lift(t.range):i=this.model.getFullModelRange(),this._edits.push({...Cp.replaceMove(i,t.text),insertAsSnippet:t.insertAsSnippet})}validate(){return typeof this._expectedModelVersionId>"u"||this.model.getVersionId()===this._expectedModelVersionId?{canApply:!0}:{canApply:!1,reason:this.model.uri}}getBeforeCursorState(){return null}apply(){this._edits.length>0&&(this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((e,t)=>tt.compareRangesUsingStarts(e.range,t.range)),this.model.pushEditOperations(null,this._edits,()=>null)),this._newEol!==void 0&&this.model.pushEOL(this._newEol)}_transformSnippetStringToInsertText(e){if(!e.insertAsSnippet||!e.text)return e;const t=Nd.asInsertText(e.text);return{...e,insertAsSnippet:!1,text:t}}}class Yb extends Eh{constructor(e,t){super(e),this._editor=t}getBeforeCursorState(){return this._canUseEditor()?this._editor.getSelections():null}apply(){if(!this._canUseEditor()){super.apply();return}if(this._edits.length>0){const e=Sp.get(this._editor);if(e&&this._edits.some(t=>t.insertAsSnippet)){const t=[];for(const i of this._edits)i.range&&i.text!==null&&t.push({range:tt.lift(i.range),template:i.insertAsSnippet?i.text:Nd.escape(i.text)});e.apply(t,{undoStopBefore:!1,undoStopAfter:!1})}else this._edits=this._edits.map(this._transformSnippetStringToInsertText,this).sort((t,i)=>tt.compareRangesUsingStarts(t.range,i.range)),this._editor.executeEdits("",this._edits)}this._newEol!==void 0&&this._editor.hasModel()&&this._editor.getModel().pushEOL(this._newEol)}_canUseEditor(){var e,t;return((t=(e=this._editor)==null?void 0:e.getModel())==null?void 0:t.uri.toString())===this.model.uri.toString()}}let Or=class{constructor(e,t,i,o,s,n,r,a,d,l,u,g){this._label=e,this._code=t,this._editor=i,this._undoRedoGroup=o,this._undoRedoSource=s,this._progress=n,this._token=r,this._editorWorker=d,this._modelService=l,this._textModelResolverService=u,this._undoRedoService=g,this._edits=new Zt;for(const m of a){let f=this._edits.get(m.resource);f||(f=[],this._edits.set(m.resource,f)),f.push(m)}}_validateBeforePrepare(){for(const e of this._edits.values())for(const t of e)if(typeof t.versionId=="number"){const i=this._modelService.getModel(t.resource);if(i&&i.getVersionId()!==t.versionId)throw new Error(`${i.uri.toString()} has changed in the meantime`)}}async _createEditsTasks(){const e=[],t=[];for(const[i,o]of this._edits){const s=this._textModelResolverService.createModelReference(i).then(async n=>{var d,l;let r,a=!1;((l=(d=this._editor)==null?void 0:d.getModel())==null?void 0:l.uri.toString())===n.object.textEditorModel.uri.toString()?(r=new Yb(n,this._editor),a=!0):r=new Eh(n);for(const u of o)if(a&&!u.textEdit.insertAsSnippet){const g=await this._editorWorker.computeMoreMinimalEdits(u.resource,[u.textEdit]);if(!g)r.addEdit(u);else for(const m of g)r.addEdit(new Fo(u.resource,m,u.versionId,u.metadata))}else r.addEdit(u);e.push(r)});t.push(s)}return await Promise.all(t),e}_validateTasks(e){for(const t of e){const i=t.validate();if(!i.canApply)return i}return{canApply:!0}}async apply(){this._validateBeforePrepare();const e=await this._createEditsTasks();try{if(this._token.isCancellationRequested)return[];const t=[],i=this._validateTasks(e);if(!i.canApply)throw new Error(`${i.reason.toString()} has changed in the meantime`);if(e.length===1){const o=e[0];if(!o.isNoOp()){const s=new _c(this._label,this._code,o.model,o.getBeforeCursorState());this._undoRedoService.pushElement(s,this._undoRedoGroup,this._undoRedoSource),o.apply(),s.close(),t.push(o.model.uri)}this._progress.report(void 0)}else{const o=new yp(this._label,this._code,e.map(s=>new _c(this._label,this._code,s.model,s.getBeforeCursorState())));this._undoRedoService.pushElement(o,this._undoRedoGroup,this._undoRedoSource);for(const s of e)s.apply(),this._progress.report(void 0),t.push(s.model.uri);o.close()}return t}finally{ue(e)}}};Or=x([h(8,wp),h(9,Ad),h(10,ns),h(11,Od)],Or);function Xb(c){return c.map(e=>{if(Fo.is(e))return Fo.lift(e);if(zs.is(e))return zs.lift(e);if(cr.is(e))return cr.lift(e);throw new Error("Unsupported edit")})}let Mr=class{constructor(e,t,i,o,s,n,r,a,d,l,u){this._label=e,this._code=t,this._editor=i,this._progress=o,this._token=s,this._edits=n,this._undoRedoGroup=r,this._undoRedoSource=a,this._confirmBeforeUndo=d,this._instaService=l,this._logService=u}ariaMessage(){const e=new Zt,t=new Zt;let i=0;for(const o of this._edits)o instanceof Fo?(i+=1,t.set(o.resource,!0)):o instanceof zs&&e.set(o.oldResource??o.newResource,!0);return this._edits.length===0?p("summary.0","Made no edits"):e.size===0?i>1&&t.size>1?p("summary.nm","Made {0} text edits in {1} files",i,t.size):p("summary.n0","Made {0} text edits in one file",i):p("summary.textFiles","Made {0} text edits in {1} files, also created or deleted {2} files",i,t.size,e.size)}async perform(){if(this._edits.length===0)return[];const e=[1];for(let n=1;n<this._edits.length;n++)Object.getPrototypeOf(this._edits[n-1])===Object.getPrototypeOf(this._edits[n])?e[e.length-1]++:e.push(1);const t=this._edits.length>1?0:void 0;this._progress.report({increment:t,total:100});const i={report:n=>this._progress.report({increment:100/this._edits.length})},o=[];let s=0;for(const n of e){if(this._token.isCancellationRequested)break;const r=this._edits.slice(s,s+n);r[0]instanceof zs?o.push(await this._performFileEdits(r,this._undoRedoGroup,this._undoRedoSource,this._confirmBeforeUndo,i)):r[0]instanceof Fo?o.push(await this._performTextEdits(r,this._undoRedoGroup,this._undoRedoSource,i)):r[0]instanceof cr?o.push(await this._performCellEdits(r,this._undoRedoGroup,this._undoRedoSource,i)):console.log("UNKNOWN EDIT"),s=s+n}return o.flat()}async _performFileEdits(e,t,i,o,s){return this._logService.debug("_performFileEdits",JSON.stringify(e)),await this._instaService.createInstance(Lr,this._label||p("workspaceEdit","Workspace Edit"),this._code||"undoredo.workspaceEdit",t,i,o,s,this._token,e).apply()}async _performTextEdits(e,t,i,o){return this._logService.debug("_performTextEdits",JSON.stringify(e)),await this._instaService.createInstance(Or,this._label||p("workspaceEdit","Workspace Edit"),this._code||"undoredo.workspaceEdit",this._editor,t,i,o,this._token,e).apply()}async _performCellEdits(e,t,i,o){return this._logService.debug("_performCellEdits",JSON.stringify(e)),await this._instaService.createInstance(kp,t,i,o,this._token,e).apply()}};Mr=x([h(9,D),h(10,rt)],Mr);let Nr=class{constructor(e,t,i,o,s,n,r){this._instaService=e,this._logService=t,this._editorService=i,this._lifecycleService=o,this._dialogService=s,this._workingCopyService=n,this._configService=r,this._activeUndoRedoGroups=new xp}setPreviewHandler(e){return this._previewHandler=e,ie(()=>{this._previewHandler===e&&(this._previewHandler=void 0)})}hasPreviewHandler(){return!!this._previewHandler}async apply(e,t){let i=Xb(Array.isArray(e)?e:e.edits);if(i.length===0)return{ariaSummary:p("nothing","Made no edits"),isApplied:!1};this._previewHandler&&(t!=null&&t.showPreview||i.some(l=>{var u;return(u=l.metadata)==null?void 0:u.needsConfirmation}))&&(i=await this._previewHandler(i,t));let o=t==null?void 0:t.editor;if(!o){const l=this._editorService.activeTextEditorControl;Rs(l)&&(o=l)}o&&o.getOption(88)&&(o=void 0);let s,n=()=>{};if(typeof(t==null?void 0:t.undoRedoGroupId)=="number"){for(const l of this._activeUndoRedoGroups)if(l.id===t.undoRedoGroupId){s=l;break}}s||(s=new Dp,n=this._activeUndoRedoGroups.push(s));const r=(t==null?void 0:t.quotableLabel)||(t==null?void 0:t.label),a=this._instaService.createInstance(Mr,r,t==null?void 0:t.code,o,(t==null?void 0:t.progress)??Ip.None,(t==null?void 0:t.token)??Fi.None,i,s,t==null?void 0:t.undoRedoSource,!!(t!=null&&t.confirmBeforeUndo));let d;try{d=this._lifecycleService.onBeforeShutdown(u=>u.veto(this._shouldVeto(r,u.reason),"veto.blukEditService"));const l=await a.perform();return t!=null&&t.respectAutoSaveConfig&&this._configService.getValue(_h)===!0&&l.length>1&&await this._saveAll(l),{ariaSummary:a.ariaMessage(),isApplied:i.length>0}}catch(l){throw this._logService.error(l),l}finally{d==null||d.dispose(),n()}}async _saveAll(e){const t=new dr(e),i=this._workingCopyService.dirtyWorkingCopies.map(async s=>{t.has(s.resource)&&await s.save()}),o=await Promise.allSettled(i);for(const s of o)s.status==="rejected"&&this._logService.warn(s.reason)}async _shouldVeto(e,t){let i,o;switch(t){case 1:i=p("closeTheWindow.message","Are you sure you want to close the window?"),o=p({key:"closeTheWindow",comment:["&& denotes a mnemonic"]},"&&Close Window");break;case 4:i=p("changeWorkspace.message","Are you sure you want to change the workspace?"),o=p({key:"changeWorkspace",comment:["&& denotes a mnemonic"]},"Change &&Workspace");break;case 3:i=p("reloadTheWindow.message","Are you sure you want to reload the window?"),o=p({key:"reloadTheWindow",comment:["&& denotes a mnemonic"]},"&&Reload Window");break;default:i=p("quit.message","Are you sure you want to quit?"),o=p({key:"quit",comment:["&& denotes a mnemonic"]},"&&Quit");break}return!(await this._dialogService.confirm({message:i,detail:p("areYouSureQuiteBulkEdit.detail","'{0}' is in progress.",e||p("fileOperation","File operation")),primaryButton:o})).confirmed}};Nr=x([h(0,D),h(1,rt),h(2,U),h(3,Sa),h(4,gn),h(5,Ep),h(6,L)],Nr);const _h="files.refactoring.autoSave";de.as(_p.Configuration).registerConfiguration({id:"files",properties:{[_h]:{description:p("refactoring.autoSave","Controls if files that were part of a refactoring are saved automatically"),default:!0,type:"boolean"}}});var Jb='.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .actions-container{justify-content:flex-end}.monaco-workbench .part.basepanel>.composite.title>.global-actions .monaco-action-bar .action-item,.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .action-item{margin-right:4px}.monaco-workbench .part.basepanel>.composite.title>.title-actions .monaco-action-bar .action-item .action-label{outline-offset:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container.composite-bar>.monaco-action-bar .action-label.codicon-more{align-items:center;color:inherit!important;display:flex;justify-content:center;margin-left:0;margin-right:0}.monaco-workbench .part.basepanel .empty-panel-message-area{display:none;height:100%;width:100%}.monaco-workbench .part.basepanel .empty-panel-message-area.visible{align-content:center;align-items:center;display:flex;justify-content:center}.monaco-workbench .part.basepanel .empty-panel-message-area .empty-panel-message{margin:12px;text-align:center}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar{height:35px;line-height:27px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item{display:flex;font-size:11px;padding:2px 10px;text-transform:uppercase}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon{padding-left:2px;padding-right:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .action-label:not(.codicon){height:16px;width:16px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:before{background-color:var(--insert-border-color);content:"";display:none;height:24px;opacity:0;position:absolute;transition-delay:.1s;transition-duration:0ms;transition-property:opacity;width:2px}.monaco-workbench .part.basepanel>.composite.title.dragged-over>.panel-switcher-container>.monaco-action-bar .action-item:after,.monaco-workbench .part.basepanel>.composite.title.dragged-over>.panel-switcher-container>.monaco-action-bar .action-item:before{display:block}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:before{left:1px;margin-left:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:after{margin-right:-2px;right:1px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:first-of-type:before{left:2px;margin-left:-2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type:after{margin-right:-2px;right:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right:before{transition-delay:0s}.monaco-workbench .part.basepanel>.composite.title.dragged-over-head>.panel-switcher-container>.monaco-action-bar .action-item:first-of-type:before,.monaco-workbench .part.basepanel>.composite.title.dragged-over-tail>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type:after,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.left:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.right+.action-item:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:last-of-type.right:after{opacity:1}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item .action-label{border-radius:0;margin-right:0;padding:2px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .action-label.codicon,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:not(.icon) .action-label{background:none!important}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.checked .action-label{margin-right:0}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .badge{align-items:center;display:flex;margin-left:8px}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .badge{margin-left:0}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .badge .badge-content{border-radius:11px;box-sizing:border-box;display:inline-block;font-size:11px;font-weight:400;height:18px;line-height:11px;min-width:18px;padding:3px 5px;position:relative;text-align:center}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item .active-item-indicator{bottom:0;height:100%;left:10px;overflow:hidden;pointer-events:none;position:absolute;top:-4px;width:calc(100% - 20px);z-index:1}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.icon .active-item-indicator{left:2px;top:1px;width:calc(100% - 4px)}.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item.checked .active-item-indicator:before,.monaco-workbench .part.basepanel>.composite.title>.panel-switcher-container>.monaco-action-bar .action-item:focus .active-item-indicator:before{border-top-style:solid;border-top-width:1px;bottom:0;content:"";height:0;position:absolute;width:100%;z-index:1}.monaco-workbench .part.basepanel>.title>.panel-switcher-container>.monaco-action-bar .action-item.clicked:not(.checked):focus .active-item-indicator:before{border-top-color:transparent!important}.monaco-workbench .part.basepanel.right .global-actions .codicon-panel-maximize:before,.monaco-workbench .part.basepanel.right .global-actions .codicon-panel-restore:before,.monaco-workbench .part.basepanel.right .title-actions .codicon-split-horizontal:before{display:inline-block;transform:rotate(-90deg)}.monaco-workbench .part.basepanel.left .global-actions .codicon-panel-maximize:before,.monaco-workbench .part.basepanel.left .global-actions .codicon-panel-restore:before,.monaco-workbench .part.basepanel.left .title-actions .codicon-split-horizontal:before{display:inline-block;transform:rotate(90deg)}';be(Jb,{});let Qs=class Fr extends dh{get preferredHeight(){return this.layoutService.dimension.height*.4}get preferredWidth(){const e=this.getActivePaneComposite();if(!e)return;const t=e.getOptimalWidth();if(typeof t=="number")return Math.max(t,300)}get onDidPaneCompositeOpen(){return I.map(this.onDidCompositeOpen.event,e=>e.composite)}constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E,V,B,De,Me,bt){var Ke;super(e,t,i,o,s,n,r,a,de.as(E),m,((Ke=d.getDefaultViewContainer(B))==null?void 0:Ke.id)||"","panel","panel",void 0,g,bt),this.viewDescriptorService=d,this.contextKeyService=l,this.extensionService=u,this.partId=g,this.pinnedPanelsKey=f,this.placeholdeViewContainersKey=C,this.backgroundColor=V,this.viewContainerLocation=B,this.activePanelContextKey=De,this.panelFocusContextKey=Me,this.panelOptions=bt,this.minimumWidth=300,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=77,this.maximumHeight=Number.POSITIVE_INFINITY,this.snap=!0,this.onDidPaneCompositeClose=this.onDidCompositeClose.event,this.compositeActions=new Map,this.panelDisposables=new Map,this.blockOpeningPanel=!1,this.extensionsRegistered=!1,this.enabledViewContainersContextKeys=new Map,this.panelRegistry=de.as(E),this.dndHandler=new bh(this.viewDescriptorService,this.viewContainerLocation,(T,ne)=>this.openPaneComposite(T,ne).then(ye=>ye||null),(T,ne,ye)=>this.compositeBar.move(T,ne,ye==null?void 0:ye.horizontallyBefore),()=>this.compositeBar.getCompositeBarItems()),this.compositeBar=this._register(this.instantiationService.createInstance(Js,this.getCachedPanels(),{icon:!!this.panelOptions.useIcons,orientation:0,activityHoverOptions:this.getActivityHoverOptions(),openComposite:(T,ne)=>this.openPaneComposite(T,!ne).then(ye=>ye||null),getActivityAction:T=>this.getCompositeActions(T).activityAction,getCompositePinnedAction:T=>this.getCompositeActions(T).pinnedAction,getCompositeBadgeAction:T=>this.getCompositeActions(T).badgeAction,getOnCompositeClickAction:T=>this.instantiationService.createInstance(Jc,j(this.getPaneComposite(T)),this.viewContainerLocation),fillExtraContextMenuActions:T=>this.fillExtraContextMenuActions(T),getContextMenuActionsForComposite:T=>this.getContextMenuActionsForComposite(T),getDefaultCompositeId:()=>{var T;return(T=d.getDefaultViewContainer(this.viewContainerLocation))==null?void 0:T.id},hidePart:()=>this.layoutService.setPartHidden(!0,this.partId),dndHandler:this.dndHandler,compositeSize:0,overflowActionSize:44,colors:T=>({activeBackgroundColor:T.getColor(this.backgroundColor),inactiveBackgroundColor:T.getColor(this.backgroundColor),activeBorderBottomColor:T.getColor(Ap),activeForegroundColor:T.getColor(Tp),inactiveForegroundColor:T.getColor(Vp),badgeBackground:T.getColor(Rp),badgeForeground:T.getColor(Pp),dragAndDropBorder:T.getColor(Lp)})})),this.registerListeners(),this.onDidRegisterPanels([...this.getPaneComposites()]),this.globalActions=this._register(this.instantiationService.createInstance(Op,g==="workbench.parts.panel"?b.PanelTitle:b.AuxiliaryBarTitle,void 0,void 0)),this._register(this.globalActions.onDidChange(()=>this.updateGlobalToolbarActions()))}getContextMenuActionsForComposite(e){const t=[],i=this.viewDescriptorService.getViewContainerById(e),o=this.viewDescriptorService.getDefaultViewContainerLocation(i);if(o!==this.viewDescriptorService.getViewContainerLocation(i))t.push(Ne({id:"resetLocationAction",label:p("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewContainerToLocation(i,o)}));else{const s=this.viewDescriptorService.getViewContainerModel(i);if(s.allViewDescriptors.length===1){const n=s.allViewDescriptors[0],r=this.viewDescriptorService.getDefaultContainerById(n.id);r!==i&&t.push(Ne({id:"resetLocationAction",label:p("resetLocation","Reset Location"),run:()=>this.viewDescriptorService.moveViewsToContainer([n],r)}))}}return t}onDidRegisterPanels(e){const t=this.getCachedPanels();for(const i of e){const o=t.filter(({id:r})=>r===i.id)[0],s=this.getActivePaneComposite(),n=(s==null?void 0:s.getId())===i.id||this.extensionsRegistered&&this.compositeBar.getVisibleComposites().length===0;if(n||!this.shouldBeHidden(i.id,o)){const r={id:i.id,name:i.name,order:i.order,requestedIndex:i.requestedIndex};this.compositeBar.addComposite(r),o||this.compositeBar.pin(i.id),n&&(this.compositeBar.activateComposite(i.id),!s&&this.element&&this.layoutService.isVisible(this.partId)&&this.doOpenPanel(i.id))}}for(const i of e){const o=this.getViewContainer(i.id),s=this.viewDescriptorService.getViewContainerModel(o);this.updateActivity(o,s),this.showOrHideViewContainer(o,s);const n=new A;n.add(s.onDidChangeActiveViewDescriptors(()=>this.showOrHideViewContainer(o,s))),n.add(s.onDidChangeContainerInfo(()=>this.updateActivity(o,s))),this.panelDisposables.set(i.id,n)}}async onDidDeregisterPanel(e){var o,s;const t=this.panelDisposables.get(e);t==null||t.dispose(),this.panelDisposables.delete(e);const i=this.viewDescriptorService.getViewContainersByLocation(this.viewContainerLocation).filter(n=>this.viewDescriptorService.getViewContainerModel(n).activeViewDescriptors.length>0);if(i.length){if(((o=this.getActivePaneComposite())==null?void 0:o.getId())===e){const n=(s=this.viewDescriptorService.getDefaultViewContainer(this.viewContainerLocation))==null?void 0:s.id,r=i.filter(a=>a.id===n)[0]||i[0];await this.openPaneComposite(r.id)}}else this.layoutService.setPartHidden(!0,this.partId);this.removeComposite(e)}updateActivity(e,t){var r;const i=(r=this.getPlaceholderViewContainers().filter(a=>a.id===e.id)[0])==null?void 0:r.name,o={id:e.id,name:this.extensionsRegistered||i===void 0?t.title:i,keybindingId:t.keybindingId},{activityAction:s,pinnedAction:n}=this.getCompositeActions(e.id);s.setActivity(this.toActivity(t)),n instanceof Zc&&n.setActivity(o),this.compositeBar.recomputeSizes(),this.layoutCompositeBar(),this.extensionsRegistered&&this.saveCachedPanels()}toActivity(e){return Fr.toActivity(e.viewContainer.id,e.title,this.panelOptions.useIcons?e.icon:void 0,e.keybindingId)}static toActivity(e,t,i,o){let s,n;if(P.isUri(i)){n=i;const r=Ca(i),a=new Td;a.update(r);const d=`activity-${e.replace(/\./g,"-")}-${a.digest()}`;s=[d,"uri-icon"];const l=`.monaco-workbench .basepanel .monaco-action-bar .action-label.${d}`;Vd(l,`
				mask: ${r} no-repeat 50% 50%;
				mask-size: 16px;
				-webkit-mask: ${r} no-repeat 50% 50%;
				-webkit-mask-size: 16px;
				mask-origin: padding;
				-webkit-mask-origin: padding;
			`)}else me.isThemeIcon(i)&&(s=me.asClassNameArray(i));return{id:e,name:t,classNames:s,iconUrl:n,keybindingId:o}}showOrHideViewContainer(e,t){let i=this.enabledViewContainersContextKeys.get(e.id);if(i||(i=this.contextKeyService.createKey(Rd(e.id),!1),this.enabledViewContainersContextKeys.set(e.id,i)),t.activeViewDescriptors.length){if(i.set(!0),this.compositeBar.addComposite({id:e.id,name:typeof e.title=="string"?e.title:e.title.value,order:e.order,requestedIndex:e.requestedIndex}),this.layoutService.isRestored()&&this.layoutService.isVisible(this.partId)){const o=this.getActiveComposite();(o===void 0||o.getId()===e.id)&&this.compositeBar.activateComposite(e.id)}this.layoutCompositeBar(),this.layoutEmptyMessage()}else e.hideIfEmpty&&(i.set(!1),this.hideComposite(e.id))}shouldBeHidden(e,t){const i=this.getViewContainer(e);return!i||!i.hideIfEmpty?!1:t!=null&&t.views&&t.views.length?t.views.every(({when:o})=>!!o&&!this.contextKeyService.contextMatchesRules(v.deserialize(o))):!1}registerListeners(){this._register(this.registry.onDidRegister(t=>this.onDidRegisterPanels([t]))),this._register(this.registry.onDidDeregister(t=>this.onDidDeregisterPanel(t.id))),this._register(this.onDidPaneCompositeOpen(t=>this.onPanelOpen(t))),this._register(this.onDidPaneCompositeClose(this.onPanelClose,this));const e=this._register(new A);this._register(this.extensionService.onDidRegisterExtensions(()=>{e.clear(),this.onDidRegisterExtensions(),this.compositeBar.onDidChange(()=>this.saveCachedPanels(),this,e),this.storageService.onDidChangeValue(t=>this.onDidStorageValueChange(t),this,e)}))}onDidRegisterExtensions(){this.extensionsRegistered=!0;const e=this.getPaneComposites();for(const{id:t}of this.getCachedPanels())e.every(i=>i.id!==t)&&(this.viewDescriptorService.isViewContainerRemovedPermanently(t)?this.removeComposite(t):this.hideComposite(t));this.saveCachedPanels()}hideComposite(e){this.compositeBar.hideComposite(e);const t=this.compositeActions.get(e);t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e))}onPanelOpen(e){this.activePanelContextKey.set(e.getId());const t=this.panelRegistry.getPaneComposite(e.getId());t&&this.compositeBar.addComposite(t),this.compositeBar.activateComposite(e.getId());const i=this.panelRegistry.getPaneComposite(e.getId());if(i){const o=this.getViewContainer(i.id);o!=null&&o.hideIfEmpty&&this.viewDescriptorService.getViewContainerModel(o).activeViewDescriptors.length===0&&this.hideComposite(i.id)}this.layoutCompositeBar(),this.layoutEmptyMessage()}onPanelClose(e){const t=e.getId();this.activePanelContextKey.get()===t&&this.activePanelContextKey.reset(),this.compositeBar.deactivateComposite(e.getId()),this.layoutEmptyMessage()}create(e){this.element=e,super.create(e),this.createEmptyPanelMessage();const t=this._register(fo(e));this._register(t.onDidFocus(()=>this.panelFocusContextKey.set(!0))),this._register(t.onDidBlur(()=>this.panelFocusContextKey.set(!1)))}createEmptyPanelMessage(){const e=this.getContentArea();this.emptyPanelMessageElement=document.createElement("div"),this.emptyPanelMessageElement.classList.add("empty-panel-message-area");const t=document.createElement("div");t.classList.add("empty-panel-message"),t.innerText=p("panel.emptyMessage","Drag a view here to display."),this.emptyPanelMessageElement.appendChild(t),e.appendChild(this.emptyPanelMessageElement),this._register(Mo.INSTANCE.registerTarget(this.emptyPanelMessageElement,{onDragOver:i=>{K.stop(i.eventData,!0);const o=this.dndHandler.onDragEnter(i.dragAndDropData,void 0,i.eventData);xd(i.eventData.dataTransfer,"move",o)},onDragEnter:i=>{var s;K.stop(i.eventData,!0);const o=this.dndHandler.onDragEnter(i.dragAndDropData,void 0,i.eventData);this.emptyPanelMessageElement.style.backgroundColor=o&&((s=this.theme.getColor(fn))==null?void 0:s.toString())||""},onDragLeave:i=>{K.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor=""},onDragEnd:i=>{K.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor=""},onDrop:i=>{K.stop(i.eventData,!0),this.emptyPanelMessageElement.style.backgroundColor="",this.dndHandler.drop(i.dragAndDropData,void 0,i.eventData)}}))}createTitleArea(e){const t=super.createTitleArea(e),i=t.appendChild(z(".global-actions"));return this.globalToolBar=this._register(new Mp(i,this.contextMenuService,{actionViewItemProvider:o=>this.actionViewItemProvider(o),orientation:0,getKeyBinding:o=>this.keybindingService.lookupKeybinding(o.id),anchorAlignmentProvider:()=>this.getTitleAreaDropDownAnchorAlignment(),toggleMenuTitle:p("moreActions","More Actions...")})),this.updateGlobalToolbarActions(),t}updateStyles(){super.updateStyles();const e=j(this.getContainer());e.style.backgroundColor=this.getColor(this.backgroundColor)||"";const t=this.getColor(ot)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t;const i=this.getTitleArea();i&&(i.style.borderTopColor=this.getColor(ot)||"")}doOpenPanel(e,t){if(!this.blockOpeningPanel){if(!this.layoutService.isVisible(this.partId))try{this.blockOpeningPanel=!0,this.layoutService.setPartHidden(!1,this.partId)}finally{this.blockOpeningPanel=!1}return this.openComposite(e,t)}}async openPaneComposite(e,t){if(typeof e=="string"&&this.getPaneComposite(e))return this.doOpenPanel(e,t);if(await this.extensionService.whenInstalledExtensionsRegistered(),typeof e=="string"&&this.getPaneComposite(e))return this.doOpenPanel(e,t)}showActivity(e,t,i){return this.compositeBar.showActivity(e,t,i)}getPaneComposite(e){return this.panelRegistry.getPaneComposite(e)}getPaneComposites(){return this.panelRegistry.getPaneComposites().sort((e,t)=>typeof e.order!="number"?1:typeof t.order!="number"?-1:e.order-t.order)}getPinnedPaneCompositeIds(){const e=this.compositeBar.getPinnedComposites().map(t=>t.id);return this.getPaneComposites().filter(t=>e.includes(t.id)).sort((t,i)=>e.indexOf(t.id)-e.indexOf(i.id)).map(t=>t.id)}getVisiblePaneCompositeIds(){return this.compositeBar.getVisibleComposites().filter(e=>{var t;return((t=this.getActivePaneComposite())==null?void 0:t.getId())===e.id||this.compositeBar.isPinned(e.id)}).map(e=>e.id)}getActivePaneComposite(){return this.getActiveComposite()}getLastActivePaneCompositeId(){return this.getLastActiveCompositeId()}hideActivePaneComposite(){this.layoutService.isVisible(this.partId)&&this.layoutService.setPartHidden(!0,this.partId),this.hideActiveComposite()}createTitleLabel(e){return this.compositeBar.create(e).classList.add("panel-switcher-container"),{updateTitle:(i,o,s)=>{const n=this.compositeBar.getAction(i);n&&(n.label=o)},updateStyles:()=>{}}}onTitleAreaUpdate(e){super.onTitleAreaUpdate(e),this.layoutCompositeBar()}layout(e,t,i,o){this.layoutService.isVisible(this.partId)&&(this.contentDimension=new G(e,t),super.layout(this.contentDimension.width,this.contentDimension.height,i,o),this.layoutCompositeBar(),this.layoutEmptyMessage())}layoutCompositeBar(){if(this.contentDimension&&this.dimension){let e=this.contentDimension.width-40;this.toolBar&&(e=Math.max(Fr.MIN_COMPOSITE_BAR_WIDTH,e-this.getToolbarWidth())),this.compositeBar.layout(new G(e,this.dimension.height))}}layoutEmptyMessage(){var e;(e=this.emptyPanelMessageElement)==null||e.classList.toggle("visible",this.compositeBar.getVisibleComposites().length===0)}getViewContainer(e){const t=this.viewDescriptorService.getViewContainerById(e);return t&&this.viewDescriptorService.getViewContainerLocation(t)===this.viewContainerLocation?t:void 0}updateGlobalToolbarActions(){var i;const e=this.globalActions.getPrimaryActions(),t=this.globalActions.getSecondaryActions();(i=this.globalToolBar)==null||i.setActions(no(e),no(t))}getCompositeActions(e){let t=this.compositeActions.get(e);if(!t){const i=this.getViewContainer(e);if(i){const o=this.viewDescriptorService.getViewContainerModel(i);t={activityAction:this.instantiationService.createInstance(Jc,this.toActivity(o),this.viewContainerLocation),pinnedAction:new qa(this.toActivity(o),this.compositeBar),badgeAction:new Ya(this.toActivity(o),this.compositeBar)}}else t={activityAction:this.instantiationService.createInstance(kb,e,this.viewContainerLocation),pinnedAction:new Zc(e,this.compositeBar),badgeAction:new mh(e,this.compositeBar)};this.compositeActions.set(e,t)}return t}removeComposite(e){if(super.removeComposite(e)){this.compositeBar.removeComposite(e);const t=this.compositeActions.get(e);return t&&(t.activityAction.dispose(),t.pinnedAction.dispose(),this.compositeActions.delete(e)),!0}return!1}getToolbarWidth(){var t;return!this.getActivePaneComposite()||!this.toolBar?0:this.toolBar.getItemsWidth()+(((t=this.globalToolBar)==null?void 0:t.getItemsWidth())??0)}onDidStorageValueChange(e){if(e.key===this.pinnedPanelsKey&&e.scope===0&&this.cachedPanelsValue!==this.getStoredCachedPanelsValue()){this._cachedPanelsValue=void 0;const t=[],i=this.compositeBar.getCompositeBarItems(),o=this.getCachedPanels();for(const s of o)t.push({id:s.id,name:s.name,order:s.order,pinned:s.pinned,visible:!!i.find(({id:n})=>n===s.id)});for(let s=0;s<i.length;s++)t.some(({id:n})=>n===i[s].id)||t.splice(s,0,i[s]);this.compositeBar.setCompositeBarItems(t)}}saveCachedPanels(){const e=[],t=[],i=this.compositeBar.getCompositeBarItems();for(const o of i){const s=this.getViewContainer(o.id);if(s){const n=this.viewDescriptorService.getViewContainerModel(s);e.push({id:o.id,name:n.title,pinned:o.pinned,order:o.order,visible:o.visible}),t.push({id:o.id,name:this.getCompositeActions(o.id).activityAction.label})}else e.push({id:o.id,name:o.name,pinned:o.pinned,order:o.order,visible:o.visible})}this.cachedPanelsValue=JSON.stringify(e),this.setPlaceholderViewContainers(t)}getCachedPanels(){const e=this.getPaneComposites(),i=JSON.parse(this.cachedPanelsValue).map(o=>{const s=typeof o=="string"?{id:o,pinned:!0,order:void 0,visible:!0}:o,n=e.some(r=>r.id===s.id);return s.visible=n?Ze(s.visible)?!0:s.visible:!1,s});for(const o of this.getPlaceholderViewContainers()){const s=i.filter(n=>n.id===o.id)[0];s&&(s.name=o.name)}return i}get cachedPanelsValue(){return this._cachedPanelsValue||(this._cachedPanelsValue=this.getStoredCachedPanelsValue()),this._cachedPanelsValue}set cachedPanelsValue(e){this.cachedPanelsValue!==e&&(this._cachedPanelsValue=e,this.setStoredCachedViewletsValue(e))}getStoredCachedPanelsValue(){return this.storageService.get(this.pinnedPanelsKey,0,"[]")}setStoredCachedViewletsValue(e){this.storageService.store(this.pinnedPanelsKey,e,0,0)}getPlaceholderViewContainers(){return JSON.parse(this.placeholderViewContainersValue)}setPlaceholderViewContainers(e){this.placeholderViewContainersValue=JSON.stringify(e)}get placeholderViewContainersValue(){return this._placeholderViewContainersValue||(this._placeholderViewContainersValue=this.getStoredPlaceholderViewContainersValue()),this._placeholderViewContainersValue}set placeholderViewContainersValue(e){this.placeholderViewContainersValue!==e&&(this._placeholderViewContainersValue=e,this.setStoredPlaceholderViewContainersValue(e))}getStoredPlaceholderViewContainersValue(){return this.storageService.get(this.placeholdeViewContainersKey,1,"[]")}setStoredPlaceholderViewContainersValue(e){this.storageService.store(this.placeholdeViewContainersKey,e,1,1)}};Qs.MIN_COMPOSITE_BAR_WIDTH=50;Qs=x([h(0,Be),h(1,Se),h(2,Ye),h(3,xe),h(4,pt),h(5,we),h(6,D),h(7,X),h(8,nt),h(9,H),h(10,yi)],Qs);let en=class kh extends Qs{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m){super(e,t,i,o,s,n,r,a,d,l,u,"workbench.parts.panel",kh.activePanelSettingsKey,"workbench.panel.pinnedPanels","workbench.panel.placeholderPanels",qs.Panels,lr,1,Np.bindTo(l),Fp.bindTo(l),{useIcons:!1,hasTitle:!0}),this.commandService=g,this.menuService=m}updateStyles(){super.updateStyles();const e=j(this.getContainer()),t=this.getColor(kc)||this.getColor(ot)||"";e.style.borderLeftColor=t,e.style.borderRightColor=t;const i=this.getTitleArea();i&&(i.style.borderTopColor=this.getColor(kc)||this.getColor(ot)||"")}getActivityHoverOptions(){return{position:()=>this.layoutService.getPanelPosition()===2&&!this.layoutService.isPanelMaximized()?3:2}}fillExtraContextMenuActions(e){const t=this.menuService.createMenu(b.PanelPositionMenu,this.contextKeyService),i=this.menuService.createMenu(b.PanelAlignmentMenu,this.contextKeyService),o=[],s=[];Gs(t,{shouldForwardArgs:!0},{primary:[],secondary:o}),Gs(i,{shouldForwardArgs:!0},{primary:[],secondary:s}),i.dispose(),t.dispose(),e.push(new Fe,new ao("workbench.action.panel.position",p("panel position","Panel Position"),o),new ao("workbench.action.panel.align",p("align panel","Align Panel"),s),Ne({id:Qc.ID,label:p("hidePanel","Hide Panel"),run:()=>this.commandService.executeCommand(Qc.ID)}))}layout(e,t,i,o){let s;this.layoutService.getPanelPosition()===1?s=new G(e-1,t):s=new G(e,t),super.layout(s.width,s.height,i,o)}toJSON(){return{type:"workbench.parts.panel"}}};en.activePanelSettingsKey="workbench.panelpart.activepanelid";en=x([h(0,Be),h(1,Se),h(2,Ye),h(3,xe),h(4,pt),h(5,we),h(6,D),h(7,X),h(8,nt),h(9,H),h(10,yi),h(11,It),h(12,Xe)],en);var Zb=".monaco-grid-view{overflow:hidden;position:relative}.monaco-grid-branch-node,.monaco-grid-view{height:100%;width:100%}";be(Zb,{});const Qb={separatorBorder:bi.transparent};function Mt(c){return c===0?1:0}class ev{constructor(e){this.isLayoutEnabled=e}}function tv(c,e){return e===1?{left:c.start,right:c.end,top:c.orthogonalStart,bottom:c.orthogonalEnd}:{top:c.start,bottom:c.end,left:c.orthogonalStart,right:c.orthogonalEnd}}function iv(c,e){return e===1?{start:c.left,end:c.right,orthogonalStart:c.top,orthogonalEnd:c.bottom}:{start:c.top,end:c.bottom,orthogonalStart:c.left,orthogonalEnd:c.right}}function vt(c,e){if(Math.abs(c)>e)throw new Error("Invalid index");return Bp(c,e+1)}class Z{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get absoluteOffset(){return this._absoluteOffset}get absoluteOrthogonalOffset(){return this._absoluteOrthogonalOffset}get styles(){return this._styles}get width(){return this.orientation===1?this.size:this.orthogonalSize}get height(){return this.orientation===1?this.orthogonalSize:this.size}get top(){return this.orientation===1?this._absoluteOffset:this._absoluteOrthogonalOffset}get left(){return this.orientation===1?this._absoluteOrthogonalOffset:this._absoluteOffset}get minimumSize(){return this.children.length===0?0:Math.max(...this.children.map(e=>e.minimumOrthogonalSize))}get maximumSize(){return Math.min(...this.children.map(e=>e.maximumOrthogonalSize))}get priority(){if(this.children.length===0)return 0;const e=this.children.map(t=>typeof t.priority>"u"?0:t.priority);return e.some(t=>t===2)?2:e.some(t=>t===1)?1:0}get proportionalLayout(){return this.children.length===0?!0:this.children.every(e=>e.proportionalLayout)}get minimumOrthogonalSize(){return this.splitview.minimumSize}get maximumOrthogonalSize(){return this.splitview.maximumSize}get minimumWidth(){return this.orientation===1?this.minimumOrthogonalSize:this.minimumSize}get minimumHeight(){return this.orientation===1?this.minimumSize:this.minimumOrthogonalSize}get maximumWidth(){return this.orientation===1?this.maximumOrthogonalSize:this.maximumSize}get maximumHeight(){return this.orientation===1?this.maximumSize:this.maximumOrthogonalSize}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.splitview.orthogonalStartSash=e.orthogonalStart,this.splitview.orthogonalEndSash=e.orthogonalEnd;for(let t=0;t<this.children.length;t++){const i=this.children[t],o=t===0,s=t===this.children.length-1;i.boundarySashes={start:e.orthogonalStart,end:e.orthogonalEnd,orthogonalStart:o?e.start:i.boundarySashes.orthogonalStart,orthogonalEnd:s?e.end:i.boundarySashes.orthogonalEnd}}}get edgeSnapping(){return this._edgeSnapping}set edgeSnapping(e){if(this._edgeSnapping!==e){this._edgeSnapping=e;for(const t of this.children)t instanceof Z&&(t.edgeSnapping=e);this.updateSplitviewEdgeSnappingEnablement()}}constructor(e,t,i,o,s=0,n=0,r=!1,a){if(this.orientation=e,this.layoutController=t,this.splitviewProportionalLayout=o,this.children=[],this._absoluteOffset=0,this._absoluteOrthogonalOffset=0,this.absoluteOrthogonalSize=0,this._onDidChange=new y,this.onDidChange=this._onDidChange.event,this._onDidScroll=new y,this.onDidScrollDisposable=R.None,this.onDidScroll=this._onDidScroll.event,this.childrenChangeDisposable=R.None,this._onDidSashReset=new y,this.onDidSashReset=this._onDidSashReset.event,this.splitviewSashResetDisposable=R.None,this.childrenSashResetDisposable=R.None,this._boundarySashes={},this._edgeSnapping=!1,this._styles=i,this._size=s,this._orthogonalSize=n,this.element=z(".monaco-grid-branch-node"),!a)this.splitview=new Bo(this.element,{orientation:e,styles:i,proportionalLayout:o}),this.splitview.layout(s,{orthogonalSize:n,absoluteOffset:0,absoluteOrthogonalOffset:0,absoluteSize:s,absoluteOrthogonalSize:n});else{const l={views:a.map(g=>({view:g.node,size:g.node.size,visible:g.node instanceof Ee&&g.visible!==void 0?g.visible:!0})),size:this.orthogonalSize},u={proportionalLayout:o,orientation:e,styles:i};this.children=a.map(g=>g.node),this.splitview=new Bo(this.element,{...u,descriptor:l}),this.children.forEach((g,m)=>{const f=m===0,C=m===this.children.length;g.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:f?this.boundarySashes.start:this.splitview.sashes[m-1],orthogonalEnd:C?this.boundarySashes.end:this.splitview.sashes[m]}})}const d=I.map(this.splitview.onDidSashReset,l=>[l]);this.splitviewSashResetDisposable=d(this._onDidSashReset.fire,this._onDidSashReset),this.updateChildrenEvents()}style(e){this._styles=e,this.splitview.style(e);for(const t of this.children)t instanceof Z&&t.style(e)}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=i.orthogonalSize,this._orthogonalSize=e,this._absoluteOffset=i.absoluteOffset+t,this._absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this.absoluteOrthogonalSize=i.absoluteOrthogonalSize,this.splitview.layout(i.orthogonalSize,{orthogonalSize:e,absoluteOffset:this._absoluteOrthogonalOffset,absoluteOrthogonalOffset:this._absoluteOffset,absoluteSize:i.absoluteOrthogonalSize,absoluteOrthogonalSize:i.absoluteSize}),this.updateSplitviewEdgeSnappingEnablement()}}setVisible(e){for(const t of this.children)t.setVisible(e)}addChild(e,t,i,o){i=vt(i,this.children.length),this.splitview.addView(e,t,i,o),this._addChild(e,i),this.onDidChildrenChange()}_addChild(e,t){const i=t===0,o=t===this.children.length;this.children.splice(t,0,e),e.boundarySashes={start:this.boundarySashes.orthogonalStart,end:this.boundarySashes.orthogonalEnd,orthogonalStart:i?this.boundarySashes.start:this.splitview.sashes[t-1],orthogonalEnd:o?this.boundarySashes.end:this.splitview.sashes[t]},i||(this.children[t-1].boundarySashes={...this.children[t-1].boundarySashes,orthogonalEnd:this.splitview.sashes[t-1]}),o||(this.children[t+1].boundarySashes={...this.children[t+1].boundarySashes,orthogonalStart:this.splitview.sashes[t]})}removeChild(e,t){e=vt(e,this.children.length),this.splitview.removeView(e,t),this._removeChild(e),this.onDidChildrenChange()}_removeChild(e){const t=e===0,i=e===this.children.length-1,[o]=this.children.splice(e,1);return t||(this.children[e-1].boundarySashes={...this.children[e-1].boundarySashes,orthogonalEnd:this.splitview.sashes[e-1]}),i||(this.children[e].boundarySashes={...this.children[e].boundarySashes,orthogonalStart:this.splitview.sashes[Math.max(e-1,0)]}),o}moveChild(e,t){if(e=vt(e,this.children.length),t=vt(t,this.children.length),e===t)return;e<t&&t--,this.splitview.moveView(e,t);const i=this._removeChild(e);this._addChild(i,t),this.onDidChildrenChange()}swapChildren(e,t){e=vt(e,this.children.length),t=vt(t,this.children.length),e!==t&&(this.splitview.swapViews(e,t),[this.children[e].boundarySashes,this.children[t].boundarySashes]=[this.children[e].boundarySashes,this.children[t].boundarySashes],[this.children[e],this.children[t]]=[this.children[t],this.children[e]],this.onDidChildrenChange())}resizeChild(e,t){e=vt(e,this.children.length),this.splitview.resizeView(e,t)}isChildSizeMaximized(e){return this.splitview.isViewSizeMaximized(e)}distributeViewSizes(e=!1){if(this.splitview.distributeViewSizes(),e)for(const t of this.children)t instanceof Z&&t.distributeViewSizes(!0)}getChildSize(e){return e=vt(e,this.children.length),this.splitview.getViewSize(e)}isChildVisible(e){return e=vt(e,this.children.length),this.splitview.isViewVisible(e)}setChildVisible(e,t){e=vt(e,this.children.length),this.splitview.isViewVisible(e)!==t&&this.splitview.setViewVisible(e,t)}getChildCachedVisibleSize(e){return e=vt(e,this.children.length),this.splitview.getViewCachedVisibleSize(e)}onDidChildrenChange(){this.updateChildrenEvents(),this._onDidChange.fire(void 0)}updateChildrenEvents(){const e=I.map(I.any(...this.children.map(o=>o.onDidChange)),()=>{});this.childrenChangeDisposable.dispose(),this.childrenChangeDisposable=e(this._onDidChange.fire,this._onDidChange);const t=I.any(...this.children.map((o,s)=>I.map(o.onDidSashReset,n=>[s,...n])));this.childrenSashResetDisposable.dispose(),this.childrenSashResetDisposable=t(this._onDidSashReset.fire,this._onDidSashReset);const i=I.any(I.signal(this.splitview.onDidScroll),...this.children.map(o=>o.onDidScroll));this.onDidScrollDisposable.dispose(),this.onDidScrollDisposable=i(this._onDidScroll.fire,this._onDidScroll)}trySet2x2(e){if(this.children.length!==2||e.children.length!==2)return R.None;if(this.getChildSize(0)!==e.getChildSize(0))return R.None;const[t,i]=this.children,[o,s]=e.children;if(!(t instanceof Ee)||!(i instanceof Ee))return R.None;if(!(o instanceof Ee)||!(s instanceof Ee))return R.None;this.orientation===0?(i.linkedWidthNode=o.linkedHeightNode=t,t.linkedWidthNode=s.linkedHeightNode=i,s.linkedWidthNode=t.linkedHeightNode=o,o.linkedWidthNode=i.linkedHeightNode=s):(o.linkedWidthNode=i.linkedHeightNode=t,s.linkedWidthNode=t.linkedHeightNode=i,t.linkedWidthNode=s.linkedHeightNode=o,i.linkedWidthNode=o.linkedHeightNode=s);const n=this.splitview.sashes[0],r=e.splitview.sashes[0];return n.linkedSash=r,r.linkedSash=n,this._onDidChange.fire(void 0),e._onDidChange.fire(void 0),ie(()=>{n.linkedSash=r.linkedSash=void 0,t.linkedHeightNode=t.linkedWidthNode=void 0,i.linkedHeightNode=i.linkedWidthNode=void 0,o.linkedHeightNode=o.linkedWidthNode=void 0,s.linkedHeightNode=s.linkedWidthNode=void 0})}updateSplitviewEdgeSnappingEnablement(){this.splitview.startSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset>0,this.splitview.endSnappingEnabled=this._edgeSnapping||this._absoluteOrthogonalOffset+this._size<this.absoluteOrthogonalSize}dispose(){for(const e of this.children)e.dispose();this._onDidChange.dispose(),this._onDidSashReset.dispose(),this.splitviewSashResetDisposable.dispose(),this.childrenSashResetDisposable.dispose(),this.childrenChangeDisposable.dispose(),this.splitview.dispose()}}function ov(c){const[e,t]=I.split(c.onDidChange,Vi);return I.any(t,I.map(I.latch(I.map(e,i=>[c.minimumWidth,c.maximumWidth,c.minimumHeight,c.maximumHeight]),co),i=>{}))}class Ee{get size(){return this._size}get orthogonalSize(){return this._orthogonalSize}get linkedWidthNode(){return this._linkedWidthNode}set linkedWidthNode(e){this._onDidLinkedWidthNodeChange.input=e?e._onDidViewChange:I.None,this._linkedWidthNode=e,this._onDidSetLinkedNode.fire(void 0)}get linkedHeightNode(){return this._linkedHeightNode}set linkedHeightNode(e){this._onDidLinkedHeightNodeChange.input=e?e._onDidViewChange:I.None,this._linkedHeightNode=e,this._onDidSetLinkedNode.fire(void 0)}constructor(e,t,i,o,s=0){this.view=e,this.orientation=t,this.layoutController=i,this._size=0,this.absoluteOffset=0,this.absoluteOrthogonalOffset=0,this.onDidScroll=I.None,this.onDidSashReset=I.None,this._onDidLinkedWidthNodeChange=new ei,this._linkedWidthNode=void 0,this._onDidLinkedHeightNodeChange=new ei,this._linkedHeightNode=void 0,this._onDidSetLinkedNode=new y,this.disposables=new A,this._boundarySashes={},this.cachedWidth=0,this.cachedHeight=0,this.cachedTop=0,this.cachedLeft=0,this._orthogonalSize=o,this._size=s;const n=ov(e);this._onDidViewChange=I.map(n,r=>r&&(this.orientation===0?r.width:r.height),this.disposables),this.onDidChange=I.any(this._onDidViewChange,this._onDidSetLinkedNode.event,this._onDidLinkedWidthNodeChange.event,this._onDidLinkedHeightNodeChange.event)}get width(){return this.orientation===1?this.orthogonalSize:this.size}get height(){return this.orientation===1?this.size:this.orthogonalSize}get top(){return this.orientation===1?this.absoluteOffset:this.absoluteOrthogonalOffset}get left(){return this.orientation===1?this.absoluteOrthogonalOffset:this.absoluteOffset}get element(){return this.view.element}get minimumWidth(){return this.linkedWidthNode?Math.max(this.linkedWidthNode.view.minimumWidth,this.view.minimumWidth):this.view.minimumWidth}get maximumWidth(){return this.linkedWidthNode?Math.min(this.linkedWidthNode.view.maximumWidth,this.view.maximumWidth):this.view.maximumWidth}get minimumHeight(){return this.linkedHeightNode?Math.max(this.linkedHeightNode.view.minimumHeight,this.view.minimumHeight):this.view.minimumHeight}get maximumHeight(){return this.linkedHeightNode?Math.min(this.linkedHeightNode.view.maximumHeight,this.view.maximumHeight):this.view.maximumHeight}get minimumSize(){return this.orientation===1?this.minimumHeight:this.minimumWidth}get maximumSize(){return this.orientation===1?this.maximumHeight:this.maximumWidth}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return this.view.snap}get minimumOrthogonalSize(){return this.orientation===1?this.minimumWidth:this.minimumHeight}get maximumOrthogonalSize(){return this.orientation===1?this.maximumWidth:this.maximumHeight}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){var t,i;this._boundarySashes=e,(i=(t=this.view).setBoundarySashes)==null||i.call(t,tv(e,this.orientation))}layout(e,t,i){if(this.layoutController.isLayoutEnabled){if(typeof i>"u")throw new Error("Invalid state");this._size=e,this._orthogonalSize=i.orthogonalSize,this.absoluteOffset=i.absoluteOffset+t,this.absoluteOrthogonalOffset=i.absoluteOrthogonalOffset,this._layout(this.width,this.height,this.top,this.left)}}_layout(e,t,i,o){this.cachedWidth===e&&this.cachedHeight===t&&this.cachedTop===i&&this.cachedLeft===o||(this.cachedWidth=e,this.cachedHeight=t,this.cachedTop=i,this.cachedLeft=o,this.view.layout(e,t,i,o))}setVisible(e){var t,i;(i=(t=this.view).setVisible)==null||i.call(t,e)}dispose(){this.disposables.dispose()}}function xh(c,e,t){if(c instanceof Z){const i=new Z(Mt(c.orientation),c.layoutController,c.styles,c.splitviewProportionalLayout,e,t,c.edgeSnapping);let o=0;for(let s=c.children.length-1;s>=0;s--){const n=c.children[s],r=n instanceof Z?n.orthogonalSize:n.size;let a=c.size===0?0:Math.round(e*r/c.size);o+=a,s===0&&(a+=e-o),i.addChild(xh(n,t,a),a,0,!0)}return i}else return new Ee(c.view,Mt(c.orientation),c.layoutController,t)}class oo{get root(){return this._root}set root(e){const t=this._root;t&&(this.element.removeChild(t.element),t.dispose()),this._root=e,this.element.appendChild(e.element),this.onDidSashResetRelay.input=e.onDidSashReset,this._onDidChange.input=I.map(e.onDidChange,()=>{}),this._onDidScroll.input=e.onDidScroll}get width(){return this.root.width}get height(){return this.root.height}get minimumWidth(){return this.root.minimumWidth}get minimumHeight(){return this.root.minimumHeight}get maximumWidth(){return this.root.maximumHeight}get maximumHeight(){return this.root.maximumHeight}get orientation(){return this._root.orientation}get boundarySashes(){return this._boundarySashes}set orientation(e){if(this._root.orientation===e)return;const{size:t,orthogonalSize:i,absoluteOffset:o,absoluteOrthogonalOffset:s}=this._root;this.root=xh(this._root,i,t),this.root.layout(t,0,{orthogonalSize:i,absoluteOffset:s,absoluteOrthogonalOffset:o,absoluteSize:t,absoluteOrthogonalSize:i}),this.boundarySashes=this.boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.root.boundarySashes=iv(e,this.orientation)}set edgeSnapping(e){this.root.edgeSnapping=e}constructor(e={}){this.onDidSashResetRelay=new ei,this._onDidScroll=new ei,this._onDidChange=new ei,this._boundarySashes={},this.disposable2x2=R.None,this.onDidSashReset=this.onDidSashResetRelay.event,this.onDidScroll=this._onDidScroll.event,this.onDidChange=this._onDidChange.event,this.element=z(".monaco-grid-view"),this.styles=e.styles||Qb,this.proportionalLayout=typeof e.proportionalLayout<"u"?!!e.proportionalLayout:!0,this.layoutController=new ev(!1),this.root=new Z(0,this.layoutController,this.styles,this.proportionalLayout)}style(e){this.styles=e,this.root.style(e)}layout(e,t,i=0,o=0){this.layoutController.isLayoutEnabled=!0;const[s,n,r,a]=this.root.orientation===1?[t,e,i,o]:[e,t,o,i];this.root.layout(s,0,{orthogonalSize:n,absoluteOffset:r,absoluteOrthogonalOffset:a,absoluteSize:s,absoluteOrthogonalSize:n})}addView(e,t,i){this.disposable2x2.dispose(),this.disposable2x2=R.None;const[o,s]=ge(i),[n,r]=this.getNode(o);if(r instanceof Z){const a=new Ee(e,Mt(r.orientation),this.layoutController,r.orthogonalSize);r.addChild(a,t,s)}else{const[,a]=ge(n),[,d]=ge(o);let l=0;const u=a.getChildCachedVisibleSize(d);typeof u=="number"&&(l=yt.Invisible(u)),a.removeChild(d);const g=new Z(r.orientation,r.layoutController,this.styles,this.proportionalLayout,r.size,r.orthogonalSize,a.edgeSnapping);a.addChild(g,r.size,d);const m=new Ee(r.view,a.orientation,this.layoutController,r.size);g.addChild(m,l,0),typeof t!="number"&&t.type==="split"&&(t=yt.Split(0));const f=new Ee(e,a.orientation,this.layoutController,r.size);g.addChild(f,t,s)}this.trySet2x2()}removeView(e,t){this.disposable2x2.dispose(),this.disposable2x2=R.None;const[i,o]=ge(e),[s,n]=this.getNode(i);if(!(n instanceof Z))throw new Error("Invalid location");const r=n.children[o];if(!(r instanceof Ee))throw new Error("Invalid location");if(n.removeChild(o,t),n.children.length===0)throw new Error("Invalid grid state");if(n.children.length>1)return this.trySet2x2(),r.view;if(s.length===0){const m=n.children[0];return m instanceof Ee||(n.removeChild(0),this.root=m,this.boundarySashes=this.boundarySashes,this.trySet2x2()),r.view}const[,a]=ge(s),[,d]=ge(i),l=n.children[0],u=n.isChildVisible(0);n.removeChild(0);const g=a.children.map((m,f)=>a.getChildSize(f));if(a.removeChild(d,t),l instanceof Z){g.splice(d,1,...l.children.map(m=>m.size));for(let m=0;m<l.children.length;m++){const f=l.children[m];a.addChild(f,f.size,d+m)}}else{const m=new Ee(l.view,Mt(l.orientation),this.layoutController,l.size),f=u?l.orthogonalSize:yt.Invisible(l.orthogonalSize);a.addChild(m,f,d)}for(let m=0;m<g.length;m++)a.resizeChild(m,g[m]);return this.trySet2x2(),r.view}moveView(e,t,i){const[,o]=this.getNode(e);if(!(o instanceof Z))throw new Error("Invalid location");o.moveChild(t,i),this.trySet2x2()}swapViews(e,t){const[i,o]=ge(e),[,s]=this.getNode(i);if(!(s instanceof Z))throw new Error("Invalid from location");const n=s.getChildSize(o),r=s.children[o];if(!(r instanceof Ee))throw new Error("Invalid from location");const[a,d]=ge(t),[,l]=this.getNode(a);if(!(l instanceof Z))throw new Error("Invalid to location");const u=l.getChildSize(d),g=l.children[d];if(!(g instanceof Ee))throw new Error("Invalid to location");s===l?s.swapChildren(o,d):(s.removeChild(o),l.removeChild(d),s.addChild(g,n,o),l.addChild(r,u,d)),this.trySet2x2()}resizeView(e,t){const[i,o]=ge(e),[s,n]=this.getNode(i);if(!(n instanceof Z))throw new Error("Invalid location");if(!t.width&&!t.height)return;const[r,a]=n.orientation===1?[t.width,t.height]:[t.height,t.width];if(typeof a=="number"&&s.length>0){const[,d]=ge(s),[,l]=ge(i);d.resizeChild(l,a)}typeof r=="number"&&n.resizeChild(o,r),this.trySet2x2()}getViewSize(e){if(!e)return{width:this.root.width,height:this.root.height};const[,t]=this.getNode(e);return{width:t.width,height:t.height}}getViewCachedVisibleSize(e){const[t,i]=ge(e),[,o]=this.getNode(t);if(!(o instanceof Z))throw new Error("Invalid location");return o.getChildCachedVisibleSize(i)}maximizeViewSize(e){const[t,i]=this.getNode(e);if(!(i instanceof Ee))throw new Error("Invalid location");for(let o=0;o<t.length;o++)t[o].resizeChild(e[o],Number.POSITIVE_INFINITY)}isViewSizeMaximized(e){const[t,i]=this.getNode(e);if(!(i instanceof Ee))throw new Error("Invalid location");for(let o=0;o<t.length;o++)if(!t[o].isChildSizeMaximized(e[o]))return!1;return!0}distributeViewSizes(e){if(!e){this.root.distributeViewSizes(!0);return}const[,t]=this.getNode(e);if(!(t instanceof Z))throw new Error("Invalid location");t.distributeViewSizes(),this.trySet2x2()}isViewVisible(e){const[t,i]=ge(e),[,o]=this.getNode(t);if(!(o instanceof Z))throw new Error("Invalid from location");return o.isChildVisible(i)}setViewVisible(e,t){const[i,o]=ge(e),[,s]=this.getNode(i);if(!(s instanceof Z))throw new Error("Invalid from location");s.setChildVisible(o,t)}getView(e){const t=e?this.getNode(e)[1]:this._root;return this._getViews(t,this.orientation)}static deserialize(e,t,i={}){var r;if(typeof e.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof e.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof e.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");if(((r=e.root)==null?void 0:r.type)!=="branch")throw new Error("Invalid JSON: 'root' property must have 'type' value of branch.");const o=e.orientation,s=e.height,n=new oo(i);return n._deserialize(e.root,o,t,s),n}_deserialize(e,t,i,o){this.root=this._deserializeNode(e,t,i,o)}_deserializeNode(e,t,i,o){let s;if(e.type==="branch"){const r=e.data.map(a=>({node:this._deserializeNode(a,Mt(t),i,e.size),visible:a.visible}));s=new Z(t,this.layoutController,this.styles,this.proportionalLayout,e.size,o,void 0,r)}else s=new Ee(i.fromJSON(e.data),t,this.layoutController,o,e.size);return s}_getViews(e,t,i){const o={top:e.top,left:e.left,width:e.width,height:e.height};if(e instanceof Ee)return{view:e.view,box:o,cachedVisibleSize:i};const s=[];for(let n=0;n<e.children.length;n++){const r=e.children[n],a=e.getChildCachedVisibleSize(n);s.push(this._getViews(r,Mt(t),a))}return{children:s,box:o}}getNode(e,t=this.root,i=[]){if(e.length===0)return[i,t];if(!(t instanceof Z))throw new Error("Invalid location");const[o,...s]=e;if(o<0||o>=t.children.length)throw new Error("Invalid location");const n=t.children[o];return i.push(t),this.getNode(s,n,i)}trySet2x2(){if(this.disposable2x2.dispose(),this.disposable2x2=R.None,this.root.children.length!==2)return;const[e,t]=this.root.children;!(e instanceof Z)||!(t instanceof Z)||(this.disposable2x2=e.trySet2x2(t))}getViewMap(e,t){t||(t=this.root),t instanceof Z?t.children.forEach(i=>this.getViewMap(e,i)):e.set(t.view,t.element)}dispose(){this.onDidSashResetRelay.dispose(),this.root.dispose(),this.element&&this.element.parentElement&&this.element.parentElement.removeChild(this.element)}}function sv(c){switch(c){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}}function Ni(c){return!!c.children}function Dh(c,e){if(e.length===0)return c;if(!Ni(c))throw new Error("Invalid location");const[t,...i]=e;return Dh(c.children[t],i)}function nv(c,e){return!(c.start>=e.end||e.start>=c.end)}function Ih(c,e){const t=ec(e),i=e===0?c.top:e===3?c.left+c.width:e===1?c.top+c.height:c.left,o={start:t===1?c.top:c.left,end:t===1?c.top+c.height:c.left+c.width};return{offset:i,range:o}}function rv(c,e,t){const i=[];function o(s,n,r){if(Ni(s))for(const a of s.children)o(a,n,r);else{const{offset:a,range:d}=Ih(s.box,n);a===r.offset&&nv(d,r.range)&&i.push(s)}}return o(c,e,t),i}function Br(c,e){return e.length%2===0?Mt(c):c}function ec(c){return c===0||c===1?0:1}function cd(c,e,t){const i=Br(c,e),o=ec(t);if(i===o){let[s,n]=ge(e);return(t===3||t===1)&&(n+=1),[...s,n]}else{const s=t===3||t===1?1:0;return[...e,s]}}function av(c){const e=c.parentElement;if(!e)throw new Error("Invalid grid element");let t=e.firstElementChild,i=0;for(;t!==c&&t!==e.lastElementChild&&t;)t=t.nextElementSibling,i++;return i}function Ah(c){const e=c.parentElement;if(!e)throw new Error("Invalid grid element");if(/\bmonaco-grid-view\b/.test(e.className))return[];const t=av(e),i=e.parentElement.parentElement.parentElement.parentElement;return[...Ah(i),t]}var Jo;(function(c){c.Distribute={type:"distribute"},c.Split={type:"split"};function e(t){return{type:"invisible",cachedVisibleSize:t}}c.Invisible=e})(Jo||(Jo={}));class cv extends R{get orientation(){return this.gridview.orientation}set orientation(e){this.gridview.orientation=e}get width(){return this.gridview.width}get height(){return this.gridview.height}get minimumWidth(){return this.gridview.minimumWidth}get minimumHeight(){return this.gridview.minimumHeight}get maximumWidth(){return this.gridview.maximumWidth}get maximumHeight(){return this.gridview.maximumHeight}get boundarySashes(){return this.gridview.boundarySashes}set boundarySashes(e){this.gridview.boundarySashes=e}set edgeSnapping(e){this.gridview.edgeSnapping=e}get element(){return this.gridview.element}constructor(e,t={}){super(),this.views=new Map,this.didLayout=!1,e instanceof oo?(this.gridview=e,this.gridview.getViewMap(this.views)):this.gridview=new oo(t),this._register(this.gridview),this._register(this.gridview.onDidSashReset(this.onDidSashReset,this)),e instanceof oo||this._addView(e,0,[0]),this.onDidChange=this.gridview.onDidChange,this.onDidScroll=this.gridview.onDidScroll}style(e){this.gridview.style(e)}layout(e,t,i=0,o=0){this.gridview.layout(e,t,i,o),this.didLayout=!0}addView(e,t,i,o){if(this.views.has(e))throw new Error("Can't add same view twice");const s=ec(o);this.views.size===1&&this.orientation!==s&&(this.orientation=s);const n=this.getViewLocation(i),r=cd(this.gridview.orientation,n,o);let a;if(typeof t=="number")a=t;else if(t.type==="split"){const[,d]=ge(n);a=yt.Split(d)}else t.type==="distribute"?a=yt.Distribute:a=t;this._addView(e,a,r)}addViewAt(e,t,i){if(this.views.has(e))throw new Error("Can't add same view twice");let o;typeof t=="number"?o=t:t.type==="distribute"?o=yt.Distribute:o=t,this._addView(e,o,i)}_addView(e,t,i){this.views.set(e,e.element),this.gridview.addView(e,t,i)}removeView(e,t){if(this.views.size===1)throw new Error("Can't remove last view");const i=this.getViewLocation(e);this.gridview.removeView(i,t&&t.type==="distribute"?yt.Distribute:void 0),this.views.delete(e)}moveView(e,t,i,o){const s=this.getViewLocation(e),[n,r]=ge(s),a=this.getViewLocation(i),d=cd(this.gridview.orientation,a,o),[l,u]=ge(d);co(n,l)?this.gridview.moveView(n,r,u):(this.removeView(e,typeof t=="number"?void 0:t),this.addView(e,t,i,o))}moveViewTo(e,t){const i=this.getViewLocation(e),[o,s]=ge(i),[n,r]=ge(t);if(co(o,n))this.gridview.moveView(o,s,r);else{const a=this.getViewSize(e),d=Br(this.gridview.orientation,i),l=this.getViewCachedVisibleSize(e),u=typeof l>"u"?d===1?a.width:a.height:Jo.Invisible(l);this.removeView(e),this.addViewAt(e,u,t)}}swapViews(e,t){const i=this.getViewLocation(e),o=this.getViewLocation(t);return this.gridview.swapViews(i,o)}resizeView(e,t){const i=this.getViewLocation(e);return this.gridview.resizeView(i,t)}isViewSizeMaximized(e){const t=this.getViewLocation(e);return this.gridview.isViewSizeMaximized(t)}getViewSize(e){if(!e)return this.gridview.getViewSize();const t=this.getViewLocation(e);return this.gridview.getViewSize(t)}getViewCachedVisibleSize(e){const t=this.getViewLocation(e);return this.gridview.getViewCachedVisibleSize(t)}maximizeViewSize(e){const t=this.getViewLocation(e);this.gridview.maximizeViewSize(t)}distributeViewSizes(){this.gridview.distributeViewSizes()}isViewVisible(e){const t=this.getViewLocation(e);return this.gridview.isViewVisible(t)}setViewVisible(e,t){const i=this.getViewLocation(e);this.gridview.setViewVisible(i,t)}getViews(){return this.gridview.getView()}getNeighborViews(e,t,i=!1){if(!this.didLayout)throw new Error("Can't call getNeighborViews before first layout");const o=this.getViewLocation(e),s=this.getViews(),n=Dh(s,o);let r=Ih(n.box,t);return i&&(t===0&&n.box.top===0?r={offset:s.box.top+s.box.height,range:r.range}:t===3&&n.box.left+n.box.width===s.box.width?r={offset:0,range:r.range}:t===1&&n.box.top+n.box.height===s.box.height?r={offset:0,range:r.range}:t===2&&n.box.left===0&&(r={offset:s.box.left+s.box.width,range:r.range})),rv(s,sv(t),r).map(a=>a.view)}getViewLocation(e){const t=this.views.get(e);if(!t)throw new Error("View not found");return Ah(t)}onDidSashReset(e){const t=s=>{const n=this.gridview.getView(s);if(Ni(n))return!1;const r=Br(this.orientation,s),a=r===1?n.view.preferredWidth:n.view.preferredHeight;if(typeof a!="number")return!1;const d=r===1?{width:Math.round(a)}:{height:Math.round(a)};return this.gridview.resizeView(s,d),!0};if(t(e))return;const[i,o]=ge(e);t([...i,o+1])||this.gridview.distributeViewSizes(i)}}class Li extends cv{constructor(){super(...arguments),this.initialLayoutContext=!0}static serializeNode(e,t){const i=t===0?e.box.width:e.box.height;return Ni(e)?{type:"branch",data:e.children.map(o=>Li.serializeNode(o,Mt(t))),size:i}:typeof e.cachedVisibleSize=="number"?{type:"leaf",data:e.view.toJSON(),size:e.cachedVisibleSize,visible:!1}:{type:"leaf",data:e.view.toJSON(),size:i}}static deserialize(e,t,i={}){if(typeof e.orientation!="number")throw new Error("Invalid JSON: 'orientation' property must be a number.");if(typeof e.width!="number")throw new Error("Invalid JSON: 'width' property must be a number.");if(typeof e.height!="number")throw new Error("Invalid JSON: 'height' property must be a number.");const o=oo.deserialize(e,t,i);return new Li(o,i)}static from(e,t={}){return Li.deserialize(Lh(e),{fromJSON:i=>i},t)}serialize(){return{root:Li.serializeNode(this.getViews(),this.orientation),orientation:this.orientation,width:this.width,height:this.height}}layout(e,t,i=0,o=0){super.layout(e,t,i,o),this.initialLayoutContext&&(this.initialLayoutContext=!1,this.gridview.trySet2x2())}}function Th(c){return!!c.groups}function Vh(c,e){if(!e&&c.groups&&c.groups.length<=1&&(c.groups=void 0),!Th(c))return;let t=0,i=0;for(const r of c.groups)Vh(r,!1),r.size&&(t+=r.size,i++);const o=i>0?t:1,s=c.groups.length-i,n=o/s;for(const r of c.groups)r.size||(r.size=n)}function Rh(c){return Th(c)?{type:"branch",data:c.groups.map(e=>Rh(e)),size:c.size}:{type:"leaf",data:c.data,size:c.size}}function Ph(c,e){if(c.type==="branch"){const t=c.data.map(i=>Ph(i,Mt(e)));if(e===0){const i=c.size||(t.length===0?void 0:Math.max(...t.map(s=>s.width||0))),o=t.length===0?void 0:t.reduce((s,n)=>s+(n.height||0),0);return{width:i,height:o}}else{const i=t.length===0?void 0:t.reduce((s,n)=>s+(n.width||0),0),o=c.size||(t.length===0?void 0:Math.max(...t.map(s=>s.height||0)));return{width:i,height:o}}}else{const t=e===0?c.size:void 0,i=e===0?void 0:c.size;return{width:t,height:i}}}function Lh(c){Vh(c,!0);const e=Rh(c),{width:t,height:i}=Ph(e,c.orientation);return{root:e,orientation:c.orientation,width:t||1,height:i||1}}var dv='.monaco-workbench .part.editor>.content .editor-group-container{height:100%}.monaco-workbench .part.editor>.content .editor-group-container.empty{opacity:.5}.monaco-workbench .part.editor>.content .editor-group-container.empty.active,.monaco-workbench .part.editor>.content .editor-group-container.empty.dragged-over{opacity:1}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty.active:focus{outline:1px solid var(--vscode-editorGroup-focusedEmptyBorder);outline-offset:-2px}.monaco-workbench .part.editor>.content.empty .editor-group-container.empty.active:focus{outline:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;margin:auto;max-width:290px}.monaco-workbench .part.editor>.content .editor-group-container:not(.empty)>.editor-group-watermark{display:none}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty>.editor-group-watermark{height:calc(100% - 70px);max-width:200px}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.letterpress{aspect-ratio:1/1;background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIG9wYWNpdHk9Ii4xIj48cGF0aCBkPSJNMjU5Ljk5NiAyNDIuMDAySC0uMDAzVjE4aDI2MHYyMjRaTTUuOTk3IDI0LjAwNnYyMTEuOTkxaDI0OFYyNC4wMDZoLTI0OFoiLz48cGF0aCBkPSJNNzcgMjJoMTh2MjE2SDc3ek0xMTIgNDJoNzB2MThoLTcwek0xMTIgMTgyaDcwdjE4aC03MHpNMTI5LjQ5OCA3N2g4OHYxOGgtODh6TTEyOS40OTggMTEyaDg4djE4aC04OHpNMTI5LjQ5OCAxNDdoODh2MThoLTg4eiIvPjwvZz48L3N2Zz4=");background-position-x:center;background-repeat:no-repeat;background-size:contain;max-height:100%;width:100%}.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIG9wYWNpdHk9Ii4zIj48cGF0aCBkPSJNMjU5Ljk5NiAyNDIuMDAySC0uMDAzVjE4aDI2MHYyMjRaTTUuOTk3IDI0LjAwNnYyMTEuOTkxaDI0OFYyNC4wMDZoLTI0OFoiLz48cGF0aCBkPSJNNzcgMjJoMTh2MjE2SDc3ek0xMTIgNDJoNzB2MThoLTcwek0xMTIgMTgyaDcwdjE4aC03MHpNMTI5LjQ5OCA3N2g4OHYxOGgtODh6TTEyOS40OTggMTEyaDg4djE4aC04OHpNMTI5LjQ5OCAxNDdoODh2MThoLTg4eiIvPjwvZz48L3N2Zz4=")}.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIGZpbGw9IiNkOWQ5ZDkiPjxwYXRoIGQ9Ik0yNTkuOTk2IDI0Mi4wMDJILS4wMDNWMThoMjYwdjIyNFpNNS45OTcgMjQuMDA2djIxMS45OTFoMjQ4VjI0LjAwNmgtMjQ4WiIvPjxwYXRoIGQ9Ik03NyAyMmgxOHYyMTZINzd6TTExMiA0Mmg3MHYxOGgtNzB6TTExMiAxODJoNzB2MThoLTcwek0xMjkuNDk4IDc3aDg4djE4aC04OHpNMTI5LjQ5OCAxMTJoODh2MThoLTg4ek0xMjkuNDk4IDE0N2g4OHYxOGgtODh6Ii8+PC9nPjwvc3ZnPg==")}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.letterpress{background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjYwIDI2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWw6c3BhY2U9InByZXNlcnZlIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEuNDE0MjEiPjxnIGZpbGw9IiMzQzNDM0MiPjxwYXRoIGQ9Ik0yNTkuOTk2IDI0Mi4wMDJILS4wMDNWMThoMjYwdjIyNFpNNS45OTcgMjQuMDA2djIxMS45OTFoMjQ4VjI0LjAwNmgtMjQ4WiIvPjxwYXRoIGQ9Ik03NyAyMmgxOHYyMTZINzd6TTExMiA0Mmg3MHYxOGgtNzB6TTExMiAxODJoNzB2MThoLTcwek0xMjkuNDk4IDc3aDg4djE4aC04OHpNMTI5LjQ5OCAxMTJoODh2MThoLTg4ek0xMjkuNDk4IDE0N2g4OHYxOGgtODh6Ii8+PC9nPjwvc3ZnPg==")}.monaco-workbench .part.editor>.content .editor-group-container.max-height-478px>.editor-group-watermark>.shortcuts,.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container>.editor-group-watermark>.shortcuts{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts>.watermark-box{border-collapse:separate;border-spacing:11px 17px;display:inline-table}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dl{cursor:default;display:table-row;opacity:.8}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{letter-spacing:.04em;text-align:right}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dd{text-align:left}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dd,.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{display:table-cell;vertical-align:middle}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dl,.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-watermark>.shortcuts dt{color:rgba(0,0,0,.68)}.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl,.monaco-workbench.vs-dark .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt{color:hsla(0,0%,100%,.6)}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt,.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dt{color:var(--vscode-editor-foreground)}.monaco-workbench.hc-black .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl,.monaco-workbench.hc-light .part.editor>.content .editor-group-container .editor-group-watermark>.shortcuts dl{color:var(--vscode-editor-foreground);opacity:1}.monaco-workbench .part.editor>.content .editor-group-container>.title{box-sizing:border-box;overflow:hidden;position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title:not(.tabs){display:flex;flex-wrap:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title.title-border-bottom:after{background-color:var(--title-border-bottom-color);bottom:0;content:"";height:1px;left:0;pointer-events:none;position:absolute;width:100%;z-index:9}.monaco-workbench .part.editor>.content .editor-group-container.empty>.title{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar{display:none;height:35px}.monaco-workbench .part.editor>.content:not(.empty) .editor-group-container.empty>.editor-group-container-toolbar{display:block}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar .actions-container{justify-content:flex-end}.monaco-workbench .part.editor>.content .editor-group-container>.editor-group-container-toolbar .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container.empty>.editor-container{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.editor-container>.editor-instance{height:100%}.monaco-workbench .part.editor>.content .grid-view-container{height:100%;width:100%}';be(dv,{});var lv='.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container{display:flex;position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.tabs-border-bottom:after{background-color:var(--tabs-border-bottom-color);bottom:0;content:"";height:1px;left:0;pointer-events:none;position:absolute;width:100%;z-index:9}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container>.monaco-scrollable-element{flex:1}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container>.monaco-scrollable-element .scrollbar{cursor:default;z-index:11}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container{display:flex;height:35px;scrollbar-width:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.scroll{overflow:scroll!important}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container{flex-wrap:wrap;height:auto}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container::-webkit-scrollbar{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab{box-sizing:border-box;cursor:pointer;display:flex;height:35px;padding-left:10px;position:relative;white-space:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab:last-child{margin-right:var(--last-tab-margin-right)}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab.last-in-row:not(:last-child){border-right:0!important}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.has-icon.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.has-icon.tab-actions-right,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.has-icon.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.has-icon.tab-actions-right{padding-left:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit{flex-shrink:0;min-width:fit-content;width:120px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed{flex:1 0 0;max-width:var(--tab-sizing-current-width,var(--tab-sizing-fixed-max-width,160px));min-width:var(--tab-sizing-current-width,50px)}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.last-in-row{min-width:calc(var(--tab-sizing-current-width, 50px) - 1px)}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .tabs-container>.tab.sizing-fit.last-in-row:not(:last-child){flex-grow:1}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink{flex-basis:0;flex-grow:1;max-width:fit-content;min-width:80px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-shrink{flex-basis:0;flex-grow:0;position:sticky;z-index:8}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-compact{max-width:38px;min-width:38px;width:38px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.sticky-shrink{max-width:80px;min-width:80px;width:80px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fit.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fit.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fixed.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-fixed.sticky-shrink,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-shrink.sticky-compact,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container.disable-sticky-tabs>.tab.sizing-shrink.sticky-shrink{position:static}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-left:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-off:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-left:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-off:after{content:"";display:flex;flex:0;width:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-left,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-left{min-width:80px;padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dragged{transform:translateZ(0)}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dragged-over div{pointer-events:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-left{flex-direction:row-reverse;padding-left:0;padding-right:10px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-border-bottom-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-border-top-container{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-bottom>.tab-border-bottom-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-top>.tab-border-top-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty-border-top>.tab-border-top-container{display:block;left:0;pointer-events:none;position:absolute;width:100%}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-top>.tab-border-top-container{background-color:var(--tab-border-top-color);height:1px;top:0;z-index:6}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active.tab-border-bottom>.tab-border-bottom-container{background-color:var(--tab-border-bottom-color);bottom:0;height:1px;z-index:10}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty-border-top>.tab-border-top-container{background-color:var(--tab-dirty-border-top-color);height:2px;top:0;z-index:6}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label{line-height:35px;margin-bottom:auto;margin-top:auto}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed .tab-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink .tab-label{position:relative}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.tab-label>.monaco-icon-label-container:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.tab-label>.monaco-icon-label-container:after{bottom:1px;content:"";height:calc(100% - 2px);opacity:1;padding:0;position:absolute;right:0;top:1px;width:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed:focus>.tab-label>.monaco-icon-label-container:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink:focus>.tab-label>.monaco-icon-label-container:after{opacity:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.tab-label.tab-label-has-badge:after,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.tab-label.tab-label-has-badge:after{padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky-compact:not(.has-icon) .monaco-icon-label{text-align:center}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit .monaco-icon-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fit .monaco-icon-label>.monaco-icon-label-container{overflow:visible}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container{flex:none;text-overflow:clip}.monaco-workbench.hc-black .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-black .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-light .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed>.monaco-icon-label>.monaco-icon-label-container,.monaco-workbench.hc-light .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink>.monaco-icon-label>.monaco-icon-label-container{text-overflow:ellipsis}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions{margin-bottom:auto;margin-top:auto;width:28px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions>.monaco-action-bar{width:28px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink>.tab-actions{flex:0;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty.tab-actions-right.sizing-shrink>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.tab-actions-right.sizing-fixed>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.tab-actions-right.sizing-shrink>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed:hover>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-fixed>.tab-actions:focus-within,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink:hover>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-right.sizing-shrink>.tab-actions:focus-within{overflow:visible}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.sticky-compact>.tab-actions,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off:not(.dirty):not(.sticky)>.tab-actions{display:none}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.active:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.active>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.dirty>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.sticky>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab>.tab-actions .action-label:focus{opacity:1}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions .actions-container{justify-content:center}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab>.tab-actions .action-label.codicon{color:inherit;font-size:16px;height:16px;padding:2px;width:16px}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.sticky.dirty>.tab-actions .action-label:not(:hover):before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky.dirty>.tab-actions .action-label:not(:hover):before{content:"\\ebb2"}.monaco-workbench .part.editor>.content .editor-group-container.active>.title .tabs-container>.tab.dirty>.tab-actions .action-label:not(:hover):before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty>.tab-actions .action-label:not(:hover):before{content:"\\ea71"}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active:hover>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.active>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.dirty>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sticky>.tab-actions .action-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab:hover>.tab-actions .action-label{opacity:.5}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab>.tab-actions .action-label{opacity:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off{padding-right:10px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-fixed.tab-actions-off:not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.sizing-shrink.tab-actions-off:not(.sticky-compact){padding-right:5px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.dirty-border-top>.tab-actions{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.dirty:not(.dirty-border-top):not(.sticky-compact),.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off.sticky:not(.sticky-compact){padding-right:0}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab.tab-actions-off>.tab-actions{pointer-events:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control{cursor:default;flex:1 100%;height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-icon-label{height:22px;line-height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-icon-label:before{height:22px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .outline-element-icon{height:22px;line-height:22px;padding-right:3px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item{max-width:80%}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:before{align-items:center;display:flex;height:22px;justify-content:center;width:16px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child{padding-right:8px}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child .codicon:last-child{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title .editor-actions{cursor:default;flex:initial;height:35px;padding:0 8px 0 4px}.monaco-workbench .part.editor>.content .editor-group-container>.title .editor-actions .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.tabs-and-actions-container.wrapping .editor-actions{bottom:0;position:absolute;right:0}';be(lv,{});var hv=".monaco-workbench .part.editor>.content .editor-group-container>.title{cursor:pointer}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label{flex:1;white-space:nowrap}.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label a{font-size:13px}.monaco-workbench .part.editor>.content .editor-group-container>.title .monaco-icon-label:before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .monaco-icon-label:before,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .tabs-container>.tab .tab-label span,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label a,.monaco-workbench .part.editor>.content .editor-group-container>.title .title-label h2{cursor:pointer}.monaco-workbench .part.editor>.content .editor-group-container>.title .monaco-icon-label:before{height:35px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .monaco-icon-label:after,.monaco-workbench .part.editor>.content .editor-group-container>.title.tabs .monaco-icon-label:after{margin-right:0}.monaco-editor-group-drag-image{border-radius:10px;display:inline-block;font-size:12px;padding:1px 7px;position:absolute}";be(hv,{});class tc{dispose(){}}class uv{constructor(e,t,i,o){this._disposables=new A,this._onDidSelectItem=new y,this._onDidFocusItem=new y,this._onDidChangeFocus=new y,this.onDidSelectItem=this._onDidSelectItem.event,this.onDidFocusItem=this._onDidFocusItem.event,this.onDidChangeFocus=this._onDidChangeFocus.event,this._items=new Array,this._nodes=new Array,this._freeNodes=new Array,this._enabled=!0,this._focusedItemIdx=-1,this._selectedItemIdx=-1,this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs",this._domNode.tabIndex=0,this._domNode.setAttribute("role","list"),this._scrollable=new Hp(this._domNode,{vertical:2,horizontal:1,horizontalScrollbarSize:t,useShadows:!1,scrollYToX:!0}),this._separatorIcon=i,this._disposables.add(this._scrollable),this._disposables.add(Fd(this._domNode,"click",r=>this._onClick(r))),e.appendChild(this._scrollable.getDomNode());const s=Bd(this._domNode);this._style(s,o);const n=fo(this._domNode);this._disposables.add(n),this._disposables.add(n.onDidBlur(r=>this._onDidChangeFocus.fire(!1))),this._disposables.add(n.onDidFocus(r=>this._onDidChangeFocus.fire(!0)))}setHorizontalScrollbarSize(e){this._scrollable.updateOptions({horizontalScrollbarSize:e})}dispose(){var e;this._disposables.dispose(),(e=this._pendingLayout)===null||e===void 0||e.dispose(),this._onDidSelectItem.dispose(),this._onDidFocusItem.dispose(),this._onDidChangeFocus.dispose(),this._domNode.remove(),this._nodes.length=0,this._freeNodes.length=0}layout(e){var t;e&&G.equals(e,this._dimension)||((t=this._pendingLayout)===null||t===void 0||t.dispose(),e?this._pendingLayout=this._updateDimensions(e):this._pendingLayout=this._updateScrollbar())}_updateDimensions(e){const t=new A;return t.add(Wp(()=>{this._dimension=e,this._domNode.style.width=`${e.width}px`,this._domNode.style.height=`${e.height}px`,t.add(this._updateScrollbar())})),t}_updateScrollbar(){return xc(()=>{xc(()=>{this._scrollable.setRevealOnScroll(!1),this._scrollable.scanDomNode(),this._scrollable.setRevealOnScroll(!0)})})}_style(e,t){let i="";t.breadcrumbsBackground&&(i+=`.monaco-breadcrumbs { background-color: ${t.breadcrumbsBackground}}`),t.breadcrumbsForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item { color: ${t.breadcrumbsForeground}}
`),t.breadcrumbsFocusForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused { color: ${t.breadcrumbsFocusForeground}}
`),t.breadcrumbsFocusAndSelectionForeground&&(i+=`.monaco-breadcrumbs .monaco-breadcrumb-item.focused.selected { color: ${t.breadcrumbsFocusAndSelectionForeground}}
`),t.breadcrumbsHoverForeground&&(i+=`.monaco-breadcrumbs:not(.disabled	) .monaco-breadcrumb-item:hover:not(.focused):not(.selected) { color: ${t.breadcrumbsHoverForeground}}
`),e.innerText=i}setEnabled(e){this._enabled=e,this._domNode.classList.toggle("disabled",!this._enabled)}domFocus(){const e=this._focusedItemIdx>=0?this._focusedItemIdx:this._items.length-1;e>=0&&e<this._items.length?this._focus(e,void 0):this._domNode.focus()}isDOMFocused(){let e=document.activeElement;for(;e;){if(this._domNode===e)return!0;e=e.parentElement}return!1}getFocused(){return this._items[this._focusedItemIdx]}setFocused(e,t){this._focus(this._items.indexOf(e),t)}focusPrev(e){this._focusedItemIdx>0&&this._focus(this._focusedItemIdx-1,e)}focusNext(e){this._focusedItemIdx+1<this._nodes.length&&this._focus(this._focusedItemIdx+1,e)}_focus(e,t){this._focusedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){const o=this._nodes[i];i!==e?o.classList.remove("focused"):(this._focusedItemIdx=i,o.classList.add("focused"),o.focus())}this._reveal(this._focusedItemIdx,!0),this._onDidFocusItem.fire({type:"focus",item:this._items[this._focusedItemIdx],node:this._nodes[this._focusedItemIdx],payload:t})}reveal(e){const t=this._items.indexOf(e);t>=0&&this._reveal(t,!1)}revealLast(){this._reveal(this._items.length-1,!1)}_reveal(e,t){if(e<0||e>=this._nodes.length)return;const i=this._nodes[e];if(!i)return;const{width:o}=this._scrollable.getScrollDimensions(),{scrollLeft:s}=this._scrollable.getScrollPosition();(!t||i.offsetLeft>s+o||i.offsetLeft<s)&&(this._scrollable.setRevealOnScroll(!1),this._scrollable.setScrollPosition({scrollLeft:i.offsetLeft}),this._scrollable.setRevealOnScroll(!0))}getSelection(){return this._items[this._selectedItemIdx]}setSelection(e,t){this._select(this._items.indexOf(e),t)}_select(e,t){this._selectedItemIdx=-1;for(let i=0;i<this._nodes.length;i++){const o=this._nodes[i];i!==e?o.classList.remove("selected"):(this._selectedItemIdx=i,o.classList.add("selected"))}this._onDidSelectItem.fire({type:"select",item:this._items[this._selectedItemIdx],node:this._nodes[this._selectedItemIdx],payload:t})}getItems(){return this._items}setItems(e){let t,i=[];try{t=Gp(this._items,e,(o,s)=>o.equals(s)),i=this._items.splice(t,this._items.length-t,...e.slice(t)),this._render(t),ue(i),this._focus(-1,void 0)}catch(o){const s=new Error(`BreadcrumbsItem#setItems: newItems: ${e.length}, prefix: ${t}, removed: ${i.length}`);throw s.name=o.name,s.stack=o.stack,s}}_render(e){let t=!1;for(;e<this._items.length&&e<this._nodes.length;e++){const i=this._items[e],o=this._nodes[e];this._renderItem(i,o),t=!0}for(;e<this._nodes.length;){const i=this._nodes.pop();i&&(this._freeNodes.push(i),i.remove(),t=!0)}for(;e<this._items.length;e++){const i=this._items[e],o=this._freeNodes.length>0?this._freeNodes.pop():document.createElement("div");o&&(this._renderItem(i,o),this._domNode.appendChild(o),this._nodes.push(o),t=!0)}t&&this.layout(void 0)}_renderItem(e,t){oi(t),t.className="";try{e.render(t)}catch(o){t.innerText="<<RENDER ERROR>>",console.error(o)}t.tabIndex=-1,t.setAttribute("role","listitem"),t.classList.add("monaco-breadcrumb-item");const i=z(me.asCSSSelector(this._separatorIcon));t.appendChild(i)}_onClick(e){if(this._enabled)for(let t=e.target;t;t=t.parentElement){const i=this._nodes.indexOf(t);if(i>=0){this._focus(i,e),this._select(i,e);break}}}}var pv=".monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control.hidden{display:none}.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.focused .hint-more,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.focused .monaco-icon-label,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.selected .hint-more,.monaco-workbench .part.editor>.content .editor-group-container .breadcrumbs-control .monaco-breadcrumb-item.selected .monaco-icon-label{text-decoration-line:underline}.monaco-workbench .monaco-breadcrumb-item.shows-symbol-icon .codicon[class*=codicon-symbol-]{padding-right:6px}.monaco-workbench .monaco-breadcrumbs-picker .arrow{border-style:solid;position:absolute;width:0}.monaco-workbench .monaco-breadcrumbs-picker .picker-item{flex:1;line-height:22px}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree{display:flex;flex-direction:column;height:100%;overflow:hidden}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree>.input{box-sizing:border-box;height:36px;padding:5px 9px;position:relative}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree>.tree{height:calc(100% - 36px)}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree.inactive>.input{display:none}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree.inactive>.tree{height:100%}.monaco-workbench .monaco-breadcrumbs-picker .highlighting-tree .monaco-highlighted-label .highlight{font-weight:700}";be(pv,{});class tn{constructor(e,t){this.uri=e,this.kind=t}}class Hr{constructor(e,t){this.element=e,this.outline=t}}let Wr=class{constructor(e,t,i,o,s){this.resource=e,this._workspaceService=o,this._outlineService=s,this._disposables=new A,this._currentOutline=new je,this._outlineDisposables=new A,this._onDidUpdate=new y,this.onDidUpdate=this._onDidUpdate.event,this._cfgFilePath=Ft.FilePath.bindTo(i),this._cfgSymbolPath=Ft.SymbolPath.bindTo(i),this._disposables.add(this._cfgFilePath.onDidChange(n=>this._onDidUpdate.fire(this))),this._disposables.add(this._cfgSymbolPath.onDidChange(n=>this._onDidUpdate.fire(this))),this._workspaceService.onDidChangeWorkspaceFolders(this._onDidChangeWorkspaceFolders,this,this._disposables),this._fileInfo=this._initFilePathInfo(e),t&&(this._bindToEditor(t),this._disposables.add(s.onDidChange(()=>this._bindToEditor(t))),this._disposables.add(t.onDidChangeControl(()=>this._bindToEditor(t)))),this._onDidUpdate.fire(this)}dispose(){this._disposables.dispose(),this._cfgFilePath.dispose(),this._cfgSymbolPath.dispose(),this._currentOutline.dispose(),this._outlineDisposables.dispose(),this._onDidUpdate.dispose()}isRelative(){return!!this._fileInfo.folder}getElements(){let e=[];if(this._cfgFilePath.getValue()==="on"?e=e.concat(this._fileInfo.path):this._cfgFilePath.getValue()==="last"&&this._fileInfo.path.length>0&&(e=e.concat(this._fileInfo.path.slice(-1))),this._cfgSymbolPath.getValue()==="off"||!this._currentOutline.value)return e;const t=this._currentOutline.value.config.breadcrumbsDataSource.getBreadcrumbElements();for(let i=this._cfgSymbolPath.getValue()==="last"&&t.length>0?t.length-1:0;i<t.length;i++)e.push(new Hr(t[i],this._currentOutline.value));return t.length===0&&!this._currentOutline.value.isEmpty&&e.push(new Hr(this._currentOutline.value,this._currentOutline.value)),e}_initFilePathInfo(e){if(Up(e,Re.untitled,Re.data))return{folder:void 0,path:[]};const t={folder:Bt(this._workspaceService.getWorkspaceFolder(e)),path:[]};let i=e;for(;i&&i.path!=="/"&&!(t.folder&&Qt(t.folder.uri,i));){t.path.unshift(new tn(i,t.path.length===0?Ve.FILE:Ve.FOLDER));const o=i.path.length;if(i=Ea(i),i.path.length===o)break}return t.folder&&this._workspaceService.getWorkbenchState()===3&&t.path.unshift(new tn(t.folder.uri,Ve.ROOT_FOLDER)),t}_onDidChangeWorkspaceFolders(){this._fileInfo=this._initFilePathInfo(this.resource),this._onDidUpdate.fire(this)}_bindToEditor(e){const t=new st;this._currentOutline.clear(),this._outlineDisposables.clear(),this._outlineDisposables.add(ie(()=>t.dispose(!0))),this._outlineService.createOutline(e,2,t.token).then(i=>{t.token.isCancellationRequested&&(i==null||i.dispose(),i=void 0),this._currentOutline.value=i,this._onDidUpdate.fire(this),i&&this._outlineDisposables.add(i.onDidChange(()=>this._onDidUpdate.fire(this)))}).catch(i=>{this._onDidUpdate.fire(this),Ho(i)})}};Wr=x([h(2,L),h(3,at),h(4,zp)],Wr);let on=class{constructor(e,t,i,o,s){this.resource=t,this._instantiationService=i,this._themeService=o,this._configurationService=s,this._disposables=new A,this._fakeEvent=new UIEvent("fakeEvent"),this._onWillPickElement=new y,this.onWillPickElement=this._onWillPickElement.event,this._previewDispoables=new je,this._domNode=document.createElement("div"),this._domNode.className="monaco-breadcrumbs-picker show-file-icons",e.appendChild(this._domNode)}dispose(){this._disposables.dispose(),this._previewDispoables.dispose(),this._onWillPickElement.dispose(),this._domNode.remove(),setTimeout(()=>this._tree.dispose(),0)}async show(e,t,i,o,s){const r=this._themeService.getColorTheme().getColor(Hd);this._arrow=document.createElement("div"),this._arrow.className="arrow",this._arrow.style.borderColor=`transparent transparent ${r?r.toString():""}`,this._domNode.appendChild(this._arrow),this._treeContainer=document.createElement("div"),this._treeContainer.style.background=r?r.toString():"",this._treeContainer.style.paddingTop="2px",this._treeContainer.style.borderRadius="3px",this._treeContainer.style.boxShadow=`0 0 8px 2px ${this._themeService.getColorTheme().getColor($p)}`,this._treeContainer.style.border=`1px solid ${this._themeService.getColorTheme().getColor(jp)}`,this._domNode.appendChild(this._treeContainer),this._layoutInfo={maxHeight:t,width:i,arrowSize:o,arrowOffset:s,inputHeight:0},this._tree=this._createTree(this._treeContainer,e),this._disposables.add(this._tree.onDidOpen(async a=>{const{element:d,editorOptions:l,sideBySide:u}=a;await this._revealElement(d,{...l,preserveFocus:!1},u)})),this._disposables.add(this._tree.onDidChangeFocus(a=>{this._previewDispoables.value=this._previewElement(a.elements[0])})),this._disposables.add(this._tree.onDidChangeContentHeight(()=>{this._layout()})),this._domNode.focus();try{await this._setInput(e),this._layout()}catch(a){Ho(a)}}_layout(){const e=2*this._layoutInfo.arrowSize,t=Math.min(this._layoutInfo.maxHeight-e,this._tree.contentHeight),i=t+e;this._domNode.style.height=`${i}px`,this._domNode.style.width=`${this._layoutInfo.width}px`,this._arrow.style.top=`-${2*this._layoutInfo.arrowSize}px`,this._arrow.style.borderWidth=`${this._layoutInfo.arrowSize}px`,this._arrow.style.marginLeft=`${this._layoutInfo.arrowOffset}px`,this._treeContainer.style.height=`${t}px`,this._treeContainer.style.width=`${this._layoutInfo.width}px`,this._tree.layout(t,this._layoutInfo.width)}restoreViewState(){}};on=x([h(2,D),h(3,X),h(4,L)],on);class gv{getHeight(e){return 22}getTemplateId(e){return"FileStat"}}class mv{getId(e){return P.isUri(e)?e.toString():hr(e)?e.id:si(e)?e.uri.toString():e.resource.toString()}}let Gr=class{constructor(e){this._fileService=e}hasChildren(e){return P.isUri(e)||hr(e)||si(e)||e.isDirectory}async getChildren(e){if(hr(e))return e.folders;let t;return si(e)?t=e.uri:P.isUri(e)?t=e:t=e.resource,(await this._fileService.resolve(t)).children??[]}};Gr=x([h(0,Ue)],Gr);let zr=class{constructor(e,t){this._labels=e,this._configService=t,this.templateId="FileStat"}renderTemplate(e){return this._labels.create(e,{supportHighlights:!0})}renderElement(e,t,i){const o=this._configService.getValue("explorer.decorations"),{element:s}=e;let n,r;si(s)?(n=s.uri,r=Ve.ROOT_FOLDER):(n=s.resource,r=s.isDirectory?Ve.FOLDER:Ve.FILE),i.setFile(n,{fileKind:r,hidePath:!0,fileDecorations:o,matches:Wo(e.filterData),extraClasses:["picker-item"]})}disposeTemplate(e){e.dispose()}};zr=x([h(1,L)],zr);class fv{getKeyboardNavigationLabel(e){return e.name}}class bv{getWidgetAriaLabel(){return p("breadcrumbs","Breadcrumbs")}getAriaLabel(e){return e.name}}let Ur=class{constructor(e,t){this._workspaceService=e,this._cachedExpressions=new Map,this._disposables=new A;const i=Ft.FileExcludes.bindTo(t),o=()=>{e.getWorkspace().folders.forEach(s=>{const n=i.getValue({resource:s.uri});if(!n)return;const r={};for(const a in n){if(typeof n[a]!="boolean")continue;const d=a.indexOf("**/")!==0?Wd.join(s.uri.path,a):a;r[d]=n[a]}this._cachedExpressions.set(s.uri.toString(),Yp(r))})};o(),this._disposables.add(i),this._disposables.add(i.onDidChange(o)),this._disposables.add(e.onDidChangeWorkspaceFolders(o))}dispose(){this._disposables.dispose()}filter(e,t){if(si(e))return!0;const i=this._workspaceService.getWorkspaceFolder(e.resource);return!i||!this._cachedExpressions.has(i.uri.toString())?!0:!this._cachedExpressions.get(i.uri.toString())(qp(i.uri.path,e.resource.path),rs(e.resource))}};Ur=x([h(0,at),h(1,L)],Ur);class vv{compare(e,t){return si(e)&&si(t)?e.index-t.index:e.isDirectory===t.isDirectory?Xp(e.name,t.name):e.isDirectory?-1:1}}let Kr=class extends on{constructor(e,t,i,o,s,n,r){super(e,t,i,o,s),this._workspaceService=n,this._editorService=r}_createTree(e){this._treeContainer.classList.add("file-icon-themable-tree"),this._treeContainer.classList.add("show-file-icons");const t=o=>{this._treeContainer.classList.toggle("align-icons-and-twisties",o.hasFileIcons&&!o.hasFolderIcons),this._treeContainer.classList.toggle("hide-arrows",o.hidesExplorerArrows===!0)};this._disposables.add(this._themeService.onDidFileIconThemeChange(t)),t(this._themeService.getFileIconTheme());const i=this._instantiationService.createInstance(bn,_a);return this._disposables.add(i),this._instantiationService.createInstance(as,"BreadcrumbsFilePicker",e,new gv,[this._instantiationService.createInstance(zr,i)],this._instantiationService.createInstance(Gr),{multipleSelectionSupport:!1,sorter:new vv,filter:this._instantiationService.createInstance(Ur),identityProvider:new mv,keyboardNavigationLabelProvider:new fv,accessibilityProvider:this._instantiationService.createInstance(bv),showNotFoundMessage:!1,overrideStyles:{listBackground:Hd}})}async _setInput(e){const{uri:t,kind:i}=e;let o;i===Ve.ROOT_FOLDER?o=this._workspaceService.getWorkspace():o=Ea(t);const s=this._tree;await s.setInput(o);let n;for(const{element:r}of s.getNode().children)if(si(r)&&Qt(r.uri,t)){n=r;break}else if(Qt(r.resource,t)){n=r;break}n&&(s.reveal(n,.5),s.setFocus([n],this._fakeEvent)),s.domFocus()}_previewElement(e){return R.None}async _revealElement(e,t,i){return!si(e)&&e.isFile?(this._onWillPickElement.fire(),await this._editorService.openEditor({resource:e.resource,options:t},i?vi:void 0),!0):!1}};Kr=x([h(2,D),h(3,X),h(4,L),h(5,at),h(6,U)],Kr);let $r=class{constructor(e,t,i){this.comparator=e,this._order=i.getValue(t,"breadcrumbs.symbolSortOrder")}compare(e,t){return this._order==="name"?this.comparator.compareByName(e,t):this._order==="type"?this.comparator.compareByType(e,t):this.comparator.compareByPosition(e,t)}};$r=x([h(2,Kp)],$r);class wv extends on{_createTree(e,t){const{config:i}=t.outline;return this._instantiationService.createInstance(Gd,"BreadcrumbsOutlinePicker",e,i.delegate,i.renderers,i.treeDataSource,{...i.options,sorter:this._instantiationService.createInstance($r,i.comparator,void 0),collapseByDefault:!0,expandOnlyOnTwistieClick:!0,multipleSelectionSupport:!1,showNotFoundMessage:!1})}_setInput(e){const t=e.outline.captureViewState();this.restoreViewState=()=>{t.dispose()};const i=this._tree;return i.setInput(e.outline),e.element!==e.outline&&(i.reveal(e.element,.5),i.setFocus([e.element],this._fakeEvent)),i.domFocus(),Promise.resolve()}_previewElement(e){return this._tree.getInput().preview(e)}async _revealElement(e,t,i){return this._onWillPickElement.fire(),await this._tree.getInput().reveal(e,t,i),!0}}class sn extends tc{constructor(e,t,i){super(),this.model=e,this.element=t,this.options=i,this._disposables=new A}dispose(){this._disposables.dispose()}equals(e){return e instanceof sn?this.element.element===e.element.element&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){const{element:t,outline:i}=this.element;if(t===i){const r=z("span",void 0,"");e.appendChild(r);return}const o=i.config.delegate.getTemplateId(t),s=i.config.renderers.find(r=>r.templateId===o);if(!s){e.innerText="<<NO RENDERER>>";return}const n=s.renderTemplate(e);s.renderElement({element:t,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:0,collapsible:!1,collapsed:!1,visible:!0,filterData:void 0},0,n,void 0),this._disposables.add(ie(()=>{s.disposeTemplate(n)}))}}class nn extends tc{constructor(e,t,i,o){super(),this.model=e,this.element=t,this.options=i,this._labels=o,this._disposables=new A}dispose(){this._disposables.dispose()}equals(e){return e instanceof nn?eg.isEqual(this.element.uri,e.element.uri)&&this.options.showFileIcons===e.options.showFileIcons&&this.options.showSymbolIcons===e.options.showSymbolIcons:!1}render(e){const t=this._labels.create(e);t.setFile(this.element.uri,{hidePath:!0,hideIcon:this.element.kind===Ve.FOLDER||!this.options.showFileIcons,fileKind:this.element.kind,fileDecorations:{colors:this.options.showDecorationColors,badges:!1}}),e.classList.add(Ve[this.element.kind].toLowerCase()),this._disposables.add(t)}}const yv=pe("breadcrumb-separator",M.chevronRight,p("separatorIcon","Icon for the separator in the breadcrumbs."));let F=class Yt{constructor(e,t,i,o,s,n,r,a,d,l,u,g){this._options=t,this._editorGroup=i,this._contextKeyService=o,this._contextViewService=s,this._instantiationService=n,this._quickInputService=r,this._fileService=a,this._editorService=d,this._labelService=l,this._disposables=new A,this._breadcrumbsDisposables=new A,this._model=new je,this._breadcrumbsPickerShowing=!1,this.domNode=document.createElement("div"),this.domNode.classList.add("breadcrumbs-control"),se(e,this.domNode),this._cfUseQuickPick=Ft.UseQuickPick.bindTo(u),this._cfShowIcons=Ft.Icons.bindTo(u),this._cfTitleScrollbarSizing=Ft.TitleScrollbarSizing.bindTo(u),this._labels=this._instantiationService.createInstance(bn,_a);const m=this._cfTitleScrollbarSizing.getValue()??"default",f=t.widgetStyles??zd;this._widget=new uv(this.domNode,Yt.SCROLLBAR_SIZES[m],yv,f),this._widget.onDidSelectItem(this._onSelectEvent,this,this._disposables),this._widget.onDidFocusItem(this._onFocusEvent,this,this._disposables),this._widget.onDidChangeFocus(this._updateCkBreadcrumbsActive,this,this._disposables),this._ckBreadcrumbsPossible=Yt.CK_BreadcrumbsPossible.bindTo(this._contextKeyService),this._ckBreadcrumbsVisible=Yt.CK_BreadcrumbsVisible.bindTo(this._contextKeyService),this._ckBreadcrumbsActive=Yt.CK_BreadcrumbsActive.bindTo(this._contextKeyService),this._disposables.add(g.register(this._editorGroup.id,this._widget)),this.hide()}dispose(){this._disposables.dispose(),this._breadcrumbsDisposables.dispose(),this._ckBreadcrumbsPossible.reset(),this._ckBreadcrumbsVisible.reset(),this._ckBreadcrumbsActive.reset(),this._cfUseQuickPick.dispose(),this._cfShowIcons.dispose(),this._widget.dispose(),this._labels.dispose(),this.domNode.remove()}get model(){return this._model.value}layout(e){this._widget.layout(e)}isHidden(){return this.domNode.classList.contains("hidden")}hide(){this._breadcrumbsDisposables.clear(),this._ckBreadcrumbsVisible.set(!1),this.domNode.classList.toggle("hidden",!0)}revealLast(){this._widget.revealLast()}update(){this._breadcrumbsDisposables.clear();const e=ee.getCanonicalUri(this._editorGroup.activeEditor,{supportSideBySide:$.PRIMARY}),t=this.isHidden();if(!e||!this._fileService.hasProvider(e))return this._ckBreadcrumbsPossible.set(!1),t?!1:(this.hide(),!0);const i=ee.getOriginalUri(this._editorGroup.activeEditor,{supportSideBySide:$.PRIMARY});this.domNode.classList.toggle("hidden",!1),this._ckBreadcrumbsVisible.set(!0),this._ckBreadcrumbsPossible.set(!0);const o=this._instantiationService.createInstance(Wr,i??e,this._editorGroup.activeEditorPane);this._model.value=o,this.domNode.classList.toggle("backslash-path",this._labelService.getSeparator(e.scheme,e.authority)==="\\");const s=()=>{this.domNode.classList.toggle("relative-path",o.isRelative());const l=this._cfShowIcons.getValue(),u={...this._options,showFileIcons:this._options.showFileIcons&&l,showSymbolIcons:this._options.showSymbolIcons&&l},g=o.getElements().map(m=>m instanceof tn?new nn(o,m,u,this._labels):new sn(o,m,u));g.length===0?(this._widget.setEnabled(!1),this._widget.setItems([new class extends tc{render(m){m.innerText=p("empty","no elements")}equals(m){return m===this}}])):(this._widget.setEnabled(!0),this._widget.setItems(g),this._widget.reveal(g[g.length-1]))},n=o.onDidUpdate(s),r=this._cfShowIcons.onDidChange(s);s(),this._breadcrumbsDisposables.clear(),this._breadcrumbsDisposables.add(n),this._breadcrumbsDisposables.add(ie(()=>this._model.clear())),this._breadcrumbsDisposables.add(r),this._breadcrumbsDisposables.add(ie(()=>this._widget.setItems([])));const a=()=>{const l=this._cfTitleScrollbarSizing.getValue()??"default";this._widget.setHorizontalScrollbarSize(Yt.SCROLLBAR_SIZES[l])};a();const d=this._cfTitleScrollbarSizing.onDidChange(a);return this._breadcrumbsDisposables.add(d),this._breadcrumbsDisposables.add({dispose:()=>{this._breadcrumbsPickerShowing&&this._contextViewService.hideContextView({source:this})}}),t!==this.isHidden()}_onFocusEvent(e){e.item&&this._breadcrumbsPickerShowing&&(this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setSelection(e.item))}_onSelectEvent(e){if(!e.item)return;if(e.item===this._breadcrumbsPickerIgnoreOnceItem){this._breadcrumbsPickerIgnoreOnceItem=void 0,this._widget.setFocused(void 0),this._widget.setSelection(void 0);return}const{element:t}=e.item;this._editorGroup.focus();const i=this._getEditorGroup(e.payload);if(i!==void 0){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._revealInEditor(e,t,i);return}if(this._cfUseQuickPick.getValue()){this._widget.setFocused(void 0),this._widget.setSelection(void 0),this._quickInputService.quickAccess.show(t instanceof Hr?"@":"");return}let o,s;this._contextViewService.showContextView({render:n=>{e.item instanceof nn?o=this._instantiationService.createInstance(Kr,n,e.item.model.resource):e.item instanceof sn&&(o=this._instantiationService.createInstance(wv,n,e.item.model.resource));const r=o.onWillPickElement(()=>this._contextViewService.hideContextView({source:this,didPick:!0})),a=Jp.onDidChange(()=>this._contextViewService.hideContextView({source:this})),d=fo(n),l=d.onDidBlur(()=>{this._breadcrumbsPickerIgnoreOnceItem=this._widget.isDOMFocused()?e.item:void 0,this._contextViewService.hideContextView({source:this})});return this._breadcrumbsPickerShowing=!0,this._updateCkBreadcrumbsActive(),ur(o,r,a,d,l)},getAnchor:()=>{if(!s){const n=window.innerWidth-8;let r=Math.min(window.innerHeight*.7,300);const a=Math.min(n,Math.max(240,n/4.17)),d=8;let l;const u=Zp(e.node.firstChild),g=u.top+u.height+d;g+r>=window.innerHeight&&(r=window.innerHeight-g-30);let m=u.left;if(m+a>=n&&(m=n-a),e.payload instanceof _t){const f=a-2*d;l=e.payload.posx-m,l>f&&(m=Math.min(n-a,m+l-f),l=f)}else l=u.left+u.width*.3-m;o.show(t,r,a,d,Math.max(0,l)),s={x:m,y:g}}return s},onHide:n=>{n!=null&&n.didPick||o.restoreViewState(),this._breadcrumbsPickerShowing=!1,this._updateCkBreadcrumbsActive(),(n==null?void 0:n.source)===this&&(this._widget.setFocused(void 0),this._widget.setSelection(void 0)),o.dispose()}})}_updateCkBreadcrumbsActive(){const e=this._widget.isDOMFocused()||this._breadcrumbsPickerShowing;this._ckBreadcrumbsActive.set(e)}async _revealInEditor(e,t,i,o=!1){if(t instanceof tn)if(t.kind===Ve.FILE)await this._editorService.openEditor({resource:t.uri,options:{pinned:o}},i);else{const s=this._widget.getItems(),n=s.indexOf(e.item);this._widget.setFocused(s[n+1]),this._widget.setSelection(s[n+1],Yt.Payload_Pick)}else t.outline.reveal(t,{pinned:o},i===vi)}_getEditorGroup(e){return e===Yt.Payload_RevealAside?vi:e===Yt.Payload_Reveal?Qp:void 0}};F.HEIGHT=22;F.SCROLLBAR_SIZES={default:3,large:8};F.Payload_Reveal={};F.Payload_RevealAside={};F.Payload_Pick={};F.CK_BreadcrumbsPossible=new N("breadcrumbsPossible",!1,p("breadcrumbsPossible","Whether the editor can show breadcrumbs"));F.CK_BreadcrumbsVisible=new N("breadcrumbsVisible",!1,p("breadcrumbsVisible","Whether breadcrumbs are currently visible"));F.CK_BreadcrumbsActive=new N("breadcrumbsActive",!1,p("breadcrumbsActive","Whether breadcrumbs have focus"));F=x([h(3,H),h(4,ss),h(5,D),h(6,Kt),h(7,Ue),h(8,U),h(9,Ci),h(10,L),h(11,$t)],F);te(class extends qe{constructor(){super({id:"breadcrumbs.toggle",title:{value:p("cmd.toggle","Toggle Breadcrumbs"),mnemonicTitle:p({key:"miBreadcrumbs",comment:["&& denotes a mnemonic"]},"Toggle &&Breadcrumbs"),original:"Toggle Breadcrumbs"},category:ve.View,toggled:{condition:v.equals("config.breadcrumbs.enabled",!0),title:p("cmd.toggle2","Breadcrumbs"),mnemonicTitle:p({key:"miBreadcrumbs2",comment:["&& denotes a mnemonic"]},"&&Breadcrumbs")},menu:[{id:b.CommandPalette},{id:b.MenubarAppearanceMenu,group:"4_editor",order:2},{id:b.NotebookToolbar,group:"notebookLayout",order:2},{id:b.StickyScrollContext}]})}run(e){const t=e.get(L),i=Ft.IsEnabled.bindTo(t).getValue();Ft.IsEnabled.bindTo(t).updateValue(!i)}});function ic(c,e){const t=c.get(oe),o=c.get($t).getWidget(t.activeGroup.id);if(o){const s=Md(o.getItems());o.setFocused(s),e&&o.setSelection(s,F.Payload_Pick)}}te(class extends qe{constructor(){super({id:"breadcrumbs.focusAndSelect",title:{value:p("cmd.focusAndSelect","Focus and Select Breadcrumbs"),original:"Focus and Select Breadcrumbs"},precondition:F.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3161,when:F.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){ic(e,!0)}});te(class extends qe{constructor(){super({id:"breadcrumbs.focus",title:{value:p("cmd.focus","Focus Breadcrumbs"),original:"Focus Breadcrumbs"},precondition:F.CK_BreadcrumbsVisible,keybinding:{weight:200,primary:3157,when:F.CK_BreadcrumbsPossible},f1:!0})}run(e,...t){ic(e,!1)}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.toggleToOn",weight:200,primary:3161,when:v.not("config.breadcrumbs.enabled"),handler:async c=>{const e=c.get(D),t=c.get(L),i=Ft.IsEnabled.bindTo(t);return i.getValue()||(await i.updateValue(!0),await ka(50)),e.invokeFunction(ic,!0)}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNext",weight:200,primary:17,secondary:[2065],mac:{primary:17,secondary:[529]},when:v.and(F.CK_BreadcrumbsVisible,F.CK_BreadcrumbsActive),handler(c){const e=c.get(oe),i=c.get($t).getWidget(e.activeGroup.id);i&&i.focusNext()}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPrevious",weight:200,primary:15,secondary:[2063],mac:{primary:15,secondary:[527]},when:v.and(F.CK_BreadcrumbsVisible,F.CK_BreadcrumbsActive),handler(c){const e=c.get(oe),i=c.get($t).getWidget(e.activeGroup.id);i&&i.focusPrev()}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.focusNextWithPicker",weight:200+1,primary:2065,mac:{primary:529},when:v.and(F.CK_BreadcrumbsVisible,F.CK_BreadcrumbsActive,Y),handler(c){const e=c.get(oe),i=c.get($t).getWidget(e.activeGroup.id);i&&i.focusNext()}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.focusPreviousWithPicker",weight:200+1,primary:2063,mac:{primary:527},when:v.and(F.CK_BreadcrumbsVisible,F.CK_BreadcrumbsActive,Y),handler(c){const e=c.get(oe),i=c.get($t).getWidget(e.activeGroup.id);i&&i.focusPrev()}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.selectFocused",weight:200,primary:3,secondary:[18],when:v.and(F.CK_BreadcrumbsVisible,F.CK_BreadcrumbsActive),handler(c){const e=c.get(oe),i=c.get($t).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),F.Payload_Pick)}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocused",weight:200,primary:10,secondary:[2051],when:v.and(F.CK_BreadcrumbsVisible,F.CK_BreadcrumbsActive),handler(c){const e=c.get(oe),i=c.get($t).getWidget(e.activeGroup.id);i&&i.setSelection(i.getFocused(),F.Payload_Reveal)}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.selectEditor",weight:200+1,primary:9,when:v.and(F.CK_BreadcrumbsVisible,F.CK_BreadcrumbsActive),handler(c){var o;const e=c.get(oe),i=c.get($t).getWidget(e.activeGroup.id);i&&(i.setFocused(void 0),i.setSelection(void 0),(o=e.activeGroup.activeEditorPane)==null||o.focus())}});k.registerCommandAndKeybindingRule({id:"breadcrumbs.revealFocusedFromTreeAside",weight:200,primary:2051,when:v.and(F.CK_BreadcrumbsVisible,F.CK_BreadcrumbsActive,Y),handler(c){const e=c.get(U),i=c.get(O).lastFocusedList;if(!(i instanceof Gd)&&!(i instanceof as))return;const o=i.getFocus()[0];if(P.isUri(o==null?void 0:o.resource))return e.openEditor({resource:o.resource,options:{pinned:!0}},vi);const s=i.getInput();if(s&&typeof s.outlineKind=="string")return s.reveal(o,{pinned:!0,preserveFocus:!1},!0)}});class Oh extends is{constructor(e){super(),this.context=e}run(e,t){let i=this.context;return t!=null&&t.preserveFocus&&(i={...this.context,preserveFocus:!0}),super.run(e,i)}}let rn=class extends vn{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m){super(u),this.accessor=t,this.group=i,this.contextMenuService=o,this.instantiationService=s,this.contextKeyService=n,this.keybindingService=r,this.notificationService=a,this.menuService=d,this.quickInputService=l,this.configurationService=g,this.fileService=m,this.editorTransfer=ti.getInstance(),this.groupTransfer=ti.getInstance(),this.treeItemsTransfer=ti.getInstance(),this.breadcrumbsControl=void 0,this.editorToolBarMenuDisposables=this._register(new A),this.resourceContext=this._register(s.createInstance(fe)),this.editorPinnedContext=Ud.bindTo(n),this.editorIsFirstContext=Kd.bindTo(n),this.editorIsLastContext=$d.bindTo(n),this.editorStickyContext=jd.bindTo(n),this.editorCanSplitInGroupContext=tg.bindTo(n),this.sideBySideEditorContext=ig.bindTo(n),this.groupLockedContext=qd.bindTo(n),this.renderDropdownAsChildElement=!1,this.create(e)}createBreadcrumbsControl(e,t){const i=this._register(Ft.IsEnabled.bindTo(this.configurationService));this._register(i.onDidChange(()=>{const o=i.getValue();!o&&this.breadcrumbsControl?(this.breadcrumbsControl.dispose(),this.breadcrumbsControl=void 0,this.handleBreadcrumbsEnablementChange()):o&&!this.breadcrumbsControl&&(this.breadcrumbsControl=this.instantiationService.createInstance(F,e,t,this.group),this.breadcrumbsControl.update(),this.handleBreadcrumbsEnablementChange())})),i.getValue()&&(this.breadcrumbsControl=this.instantiationService.createInstance(F,e,t,this.group)),this._register(this.fileService.onDidChangeFileSystemProviderRegistrations(o=>{var s,n;(s=this.breadcrumbsControl)!=null&&s.model&&this.breadcrumbsControl.model.resource.scheme!==o.scheme||(n=this.breadcrumbsControl)!=null&&n.update()&&this.handleBreadcrumbsEnablementChange()}))}createEditorActionsToolBar(e){const t={groupId:this.group.id};this.editorActionsToolbar=this._register(this.instantiationService.createInstance(wd,e,{actionViewItemProvider:i=>this.actionViewItemProvider(i),orientation:0,ariaLabel:p("ariaLabelEditorActions","Editor actions"),getKeyBinding:i=>this.getKeybinding(i),actionRunner:this._register(new Oh(t)),anchorAlignmentProvider:()=>1,renderDropdownAsChildElement:this.renderDropdownAsChildElement,telemetrySource:"editorPart",resetMenu:b.EditorTitle,maxNumberOfItems:9})),this.editorActionsToolbar.context=t,this._register(this.editorActionsToolbar.actionRunner.onDidRun(i=>{i.error&&!Gi(i.error)&&this.notificationService.error(i.error)}))}actionViewItemProvider(e){const t=this.group.activeEditorPane;if(t instanceof Dc){const i=t.getActionViewItem(e);if(i)return i}return un(this.instantiationService,e,{menuAsChild:this.renderDropdownAsChildElement})}updateEditorActionsToolbar(){const{primary:e,secondary:t}=this.prepareEditorActions(this.getEditorActions());j(this.editorActionsToolbar).setActions(no(e),no(t))}getEditorActions(){const e=[],t=[];if(this.editorToolBarMenuDisposables.clear(),this.contextKeyService.bufferChangeEvents(()=>{const o=this.group.activeEditor;this.resourceContext.set(Ic(ee.getOriginalUri(o,{supportSideBySide:$.PRIMARY}))),this.editorPinnedContext.set(o?this.group.isPinned(o):!1),this.editorIsFirstContext.set(o?this.group.isFirst(o):!1),this.editorIsLastContext.set(o?this.group.isLast(o):!1),this.editorStickyContext.set(o?this.group.isSticky(o):!1),this.editorCanSplitInGroupContext.set(o?o.hasCapability(32):!1),this.sideBySideEditorContext.set((o==null?void 0:o.typeId)===Pt.ID),this.groupLockedContext.set(this.group.isLocked)}),this.group.activeEditorPane instanceof Dc){const o=this.getEditorPaneAwareContextKeyService(),s=this.menuService.createMenu(b.EditorTitle,o,{emitEventsForSubmenuChanges:!0,eventDebounceDelay:0});this.editorToolBarMenuDisposables.add(s),this.editorToolBarMenuDisposables.add(s.onDidChange(()=>{this.updateEditorActionsToolbar()}));const n=(r,a)=>a==="navigation"&&r.actions.length<=1;Ui(s,{arg:this.resourceContext.get(),shouldForwardArgs:!0},{primary:e,secondary:t},"navigation",n)}return{primary:e,secondary:t}}getEditorPaneAwareContextKeyService(){var e;return((e=this.group.activeEditorPane)==null?void 0:e.scopedContextKeyService)??this.contextKeyService}clearEditorActionsToolbar(){var e;(e=this.editorActionsToolbar)==null||e.setActions([],[])}enableGroupDragging(e){this._register(w(e,S.DRAG_START,t=>{var o;if(t.target!==e)return;this.groupTransfer.setData([new Ge(this.group.id)],Ge.prototype),t.dataTransfer&&(t.dataTransfer.effectAllowed="copyMove");let i=!1;if(this.accessor.partOptions.showTabs?i=this.doFillResourceDataTransfers(this.group.getEditors(1),t):this.group.activeEditor&&(i=this.doFillResourceDataTransfers([this.group.activeEditor],t)),!i&&og&&((o=t.dataTransfer)==null||o.setData(to.TEXT,String(this.group.label))),this.group.activeEditor){let s=this.group.activeEditor.getName();this.accessor.partOptions.showTabs&&this.group.count>1&&(s=p("draggedEditorGroup","{0} (+{1})",s,this.group.count-1)),sg(t,s,"monaco-editor-group-drag-image",this.getColor(rg),this.getColor(ng))}})),this._register(w(e,S.DRAG_END,()=>{this.groupTransfer.clearData(Ge.prototype)}))}doFillResourceDataTransfers(e,t){return e.length?(this.instantiationService.invokeFunction(Yd,e.map(i=>({editor:i,groupId:this.group.id})),t),!0):!1}onContextMenu(e,t,i){const o=this.resourceContext.get();this.resourceContext.set(Ic(ee.getOriginalUri(e,{supportSideBySide:$.PRIMARY})));const s=!!this.editorPinnedContext.get();this.editorPinnedContext.set(this.group.isPinned(e));const n=!!this.editorIsFirstContext.get();this.editorIsFirstContext.set(this.group.isFirst(e));const r=!!this.editorIsLastContext.get();this.editorIsLastContext.set(this.group.isLast(e));const a=!!this.editorStickyContext.get();this.editorStickyContext.set(this.group.isSticky(e));const d=!!this.groupLockedContext.get();this.groupLockedContext.set(this.group.isLocked);const l=!!this.editorCanSplitInGroupContext.get();this.editorCanSplitInGroupContext.set(e.hasCapability(32));const u=!!this.sideBySideEditorContext.get();this.sideBySideEditorContext.set(e.typeId===Pt.ID);let g=i;if(t instanceof MouseEvent){const m=new _t(t);g={x:m.posx,y:m.posy}}this.contextMenuService.showContextMenu({getAnchor:()=>g,menuId:b.EditorTitleContext,menuActionOptions:{shouldForwardArgs:!0,arg:this.resourceContext.get()},contextKeyService:this.contextKeyService,getActionsContext:()=>({groupId:this.group.id,editorIndex:this.group.getIndexOfEditor(e)}),getKeyBinding:m=>this.getKeybinding(m),onHide:()=>{this.resourceContext.set(o||null),this.editorPinnedContext.set(s),this.editorIsFirstContext.set(n),this.editorIsLastContext.set(r),this.editorStickyContext.set(a),this.groupLockedContext.set(d),this.editorCanSplitInGroupContext.set(l),this.sideBySideEditorContext.set(u),this.accessor.activeGroup.focus()}})}getKeybinding(e){return this.keybindingService.lookupKeybinding(e.id,this.getEditorPaneAwareContextKeyService())}getKeybindingLabel(e){const t=this.getKeybinding(e);return t?Bt(t.getLabel()):void 0}dispose(){ue(this.breadcrumbsControl),this.breadcrumbsControl=void 0,super.dispose()}};rn=x([h(3,xe),h(4,D),h(5,H),h(6,we),h(7,Be),h(8,Xe),h(9,Kt),h(10,X),h(11,L),h(12,Ue)],rn);let ri=class $e extends rn{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E,V){super(e,t,i,o,s,n,r,a,d,l,u,g,m),this.editorService=f,this.pathService=C,this.editorGroupService=E,this.treeViewsDragAndDropService=V,this.closeEditorAction=this._register(this.instantiationService.createInstance(Fn,Fn.ID,Fn.LABEL)),this.unpinEditorAction=this._register(this.instantiationService.createInstance(Bn,Bn.ID,Bn.LABEL)),this.tabResourceLabels=this._register(this.instantiationService.createInstance(bn,_a)),this.tabLabels=[],this.tabActionBars=[],this.tabDisposables=[],this.dimensions={container:G.None,available:G.None},this.layoutScheduler=this._register(new je),this.path=wn?mg:Wd,this.lastMouseWheelEventTime=0,this.isMouseOverTabs=!1,this.updateEditorLabelScheduler=this._register(new pn(()=>this.doUpdateEditorLabels(),0)),(async()=>this.path=await this.pathService.path)(),this._register(this.tabResourceLabels.onDidChangeDecorations(()=>this.doHandleDecorationsChange()))}create(e){this.titleContainer=e,this.tabsAndActionsContainer=document.createElement("div"),this.tabsAndActionsContainer.classList.add("tabs-and-actions-container"),this.titleContainer.appendChild(this.tabsAndActionsContainer),this.tabsContainer=document.createElement("div"),this.tabsContainer.setAttribute("role","tablist"),this.tabsContainer.draggable=!0,this.tabsContainer.classList.add("tabs-container"),this._register(ii.addTarget(this.tabsContainer)),this.tabSizingFixedDisposables=this._register(new A),this.updateTabSizing(!1),this.tabsScrollbar=this._register(this.createTabsScrollbar(this.tabsContainer)),this.tabsAndActionsContainer.appendChild(this.tabsScrollbar.getDomNode()),this.registerTabsContainerListeners(this.tabsContainer,this.tabsScrollbar),this.editorToolbarContainer=document.createElement("div"),this.editorToolbarContainer.classList.add("editor-actions"),this.tabsAndActionsContainer.appendChild(this.editorToolbarContainer),this.createEditorActionsToolBar(this.editorToolbarContainer);const t=document.createElement("div");t.classList.add("tabs-breadcrumbs"),this.titleContainer.appendChild(t),this.createBreadcrumbsControl(t,{showFileIcons:!0,showSymbolIcons:!0,showDecorationColors:!1,showPlaceholder:!0})}createTabsScrollbar(e){const t=new fg(e,{horizontal:1,horizontalScrollbarSize:this.getTabsScrollbarSizing(),vertical:2,scrollYToX:!0,useShadows:!1});return t.onScroll(i=>{i.scrollLeftChanged&&(e.scrollLeft=i.scrollLeft)}),t}updateTabsScrollbarSizing(){var e;(e=this.tabsScrollbar)==null||e.updateOptions({horizontalScrollbarSize:this.getTabsScrollbarSizing()})}updateTabSizing(e){const[t,i]=Zi(this.tabsContainer,this.tabSizingFixedDisposables);i.clear();const o=this.accessor.partOptions;o.tabSizing==="fixed"?(t.style.setProperty("--tab-sizing-fixed-max-width",`${o.tabSizingFixedMaxWidth}px`),i.add(w(t,S.MOUSE_ENTER,()=>{this.isMouseOverTabs=!0})),i.add(w(t,S.MOUSE_LEAVE,()=>{this.isMouseOverTabs=!1,this.updateTabsFixedWidth(!1)}))):e&&(t.style.removeProperty("--tab-sizing-fixed-max-width"),this.updateTabsFixedWidth(!1))}updateTabsFixedWidth(e){this.forEachTab((t,i,o)=>{if(e){const{width:s}=o.getBoundingClientRect();o.style.setProperty("--tab-sizing-current-width",`${s}px`)}else o.style.removeProperty("--tab-sizing-current-width")})}getTabsScrollbarSizing(){return this.accessor.partOptions.titleScrollbarSizing!=="large"?$e.SCROLLBAR_SIZES.default:$e.SCROLLBAR_SIZES.large}registerTabsContainerListeners(e,t){this.enableGroupDragging(e),this._register(w(e,S.SCROLL,()=>{e.classList.contains("scroll")&&t.setScrollPosition({scrollLeft:e.scrollLeft})}));for(const o of[Te.Tap,S.DBLCLICK])this._register(w(e,o,s=>{if(o===S.DBLCLICK){if(s.target!==e)return}else if(s.tapCount!==2||s.initialTarget!==e)return;K.stop(s),this.editorService.openEditor({resource:void 0,options:{pinned:!0,index:this.group.count,override:Rt.id}},this.group.id)}));this._register(w(e,S.MOUSE_DOWN,o=>{o.button===1&&o.preventDefault()})),this._register(new fr(e,{onDragEnter:o=>{if(e.classList.add("scroll"),o.target!==e){this.updateDropFeedback(e,!1);return}if(!this.isSupportedDropTransfer(o)){o.dataTransfer&&(o.dataTransfer.dropEffect="none");return}let s=!1;if(this.editorTransfer.hasData(Ce.prototype)){s=!0;const n=this.editorTransfer.getData(Ce.prototype);if(Array.isArray(n)){const r=n[0].identifier;if(this.group.id===r.groupId&&this.group.getIndexOfEditor(r.editor)===this.group.count-1){o.dataTransfer&&(o.dataTransfer.dropEffect="none");return}}}s||o.dataTransfer&&(o.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0)},onDragLeave:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll")},onDragEnd:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll")},onDrop:o=>{this.updateDropFeedback(e,!1),e.classList.remove("scroll"),o.target===e&&this.onDrop(o,this.group.count,e)}})),this._register(w(e,S.MOUSE_WHEEL,o=>{const s=this.group.activeEditor;if(!s||this.group.count<2)return;if(this.accessor.partOptions.scrollToSwitchTabs===!0){if(o.shiftKey)return}else if(!o.shiftKey)return;const n=Date.now();if(n-this.lastMouseWheelEventTime<$e.MOUSE_WHEEL_EVENT_THRESHOLD-2*(Math.abs(o.deltaX)+Math.abs(o.deltaY)))return;this.lastMouseWheelEventTime=n;let r;if(o.deltaX+o.deltaY<-$e.MOUSE_WHEEL_DISTANCE_THRESHOLD)r=-1;else if(o.deltaX+o.deltaY>$e.MOUSE_WHEEL_DISTANCE_THRESHOLD)r=1;else return;const a=this.group.getEditorByIndex(this.group.getIndexOfEditor(s)+r);a&&(this.group.openEditor(a),K.stop(o,!0))}));const i=o=>{K.stop(o);let s=e;if(o instanceof MouseEvent){const n=new _t(o);s={x:n.posx,y:n.posy}}this.contextMenuService.showContextMenu({getAnchor:()=>s,menuId:b.EditorTabsBarContext,contextKeyService:this.contextKeyService,menuActionOptions:{shouldForwardArgs:!0},getActionsContext:()=>({groupId:this.group.id}),getKeyBinding:n=>this.getKeybinding(n),onHide:()=>this.group.focus()})};this._register(w(e,Te.Contextmenu,o=>i(o))),this._register(w(e,S.CONTEXT_MENU,o=>i(o)))}doHandleDecorationsChange(){this.layout(this.dimensions)}updateEditorActionsToolbar(){super.updateEditorActionsToolbar(),this.layout(this.dimensions)}openEditor(e){this.handleOpenedEditors()}openEditors(e){this.handleOpenedEditors()}handleOpenedEditors(){var n,r;const[e,t]=Zi(this.tabsContainer,this.tabsScrollbar);for(let a=e.children.length;a<this.group.count;a++)e.appendChild(this.createTab(a,e,t));const i=this.didActiveEditorChange(),o=this.activeTabLabel,s=this.tabLabels.length;this.computeTabLabels(),i||s!==this.tabLabels.length||!this.equalsEditorInputLabel(o,this.activeTabLabel)?(this.redraw({forceRevealActiveTab:!0}),(n=this.breadcrumbsControl)==null||n.update()):(this.layout(this.dimensions,{forceRevealActiveTab:!0}),(r=this.breadcrumbsControl)==null||r.revealLast())}didActiveEditorChange(){var e,t,i;return!!(!((e=this.activeTabLabel)!=null&&e.editor)&&this.group.activeEditor||(t=this.activeTabLabel)!=null&&t.editor&&!this.group.activeEditor||!((i=this.activeTabLabel)!=null&&i.editor)||!this.group.isActive(this.activeTabLabel.editor))}equalsEditorInputLabel(e,t){return e===t?!0:!e||!t?!1:e.name===t.name&&e.description===t.description&&e.forceDescription===t.forceDescription&&e.title===t.title&&e.ariaLabel===t.ariaLabel}beforeCloseEditor(e){if(this.isMouseOverTabs&&this.accessor.partOptions.tabSizing==="fixed"){const t=this.group.isLast(e);this.updateTabsFixedWidth(!t)}}closeEditor(e){this.handleClosedEditors()}closeEditors(e){this.handleClosedEditors()}handleClosedEditors(){var e,t;if(this.group.activeEditor){const i=j(this.tabsContainer);for(;i.children.length>this.group.count;)(e=i.lastChild)==null||e.remove(),ue(this.tabDisposables.pop());this.computeTabLabels(),this.redraw({forceRevealActiveTab:!0})}else this.tabsContainer&&oi(this.tabsContainer),this.tabDisposables=ue(this.tabDisposables),this.tabResourceLabels.clear(),this.tabLabels=[],this.activeTabLabel=void 0,this.tabActionBars=[],this.clearEditorActionsToolbar(),(t=this.breadcrumbsControl)==null||t.update()}moveEditor(e,t,i){const o=this.tabLabels[t];this.tabLabels.splice(t,1),this.tabLabels.splice(i,0,o),this.forEachTab((s,n,r,a,d,l)=>{this.redrawTab(s,n,r,a,d,l)},Math.min(t,i),Math.max(t,i)),this.layout(this.dimensions,{forceRevealActiveTab:!0})}pinEditor(e){this.withTab(e,(t,i,o,s,n)=>this.redrawTabLabel(t,i,o,s,n))}stickEditor(e){this.doHandleStickyEditorChange(e)}unstickEditor(e){this.doHandleStickyEditorChange(e)}doHandleStickyEditorChange(e){this.withTab(e,(t,i,o,s,n,r)=>this.redrawTab(t,i,o,s,n,r)),this.forEachTab((t,i,o,s,n)=>{this.redrawTabBorders(i,o)}),this.layout(this.dimensions,{forceRevealActiveTab:!0})}setActive(e){this.forEachTab((t,i,o,s,n,r)=>{this.redrawTabActiveAndDirty(e,t,o,r)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,{forceRevealActiveTab:!0})}updateEditorLabel(e){this.updateEditorLabelScheduler.schedule()}doUpdateEditorLabels(){this.computeTabLabels(),this.forEachTab((e,t,i,o,s)=>{this.redrawTabLabel(e,t,i,o,s)}),this.layout(this.dimensions)}updateEditorDirty(e){this.withTab(e,(t,i,o,s,n,r)=>this.redrawTabActiveAndDirty(this.accessor.activeGroup===this.group,t,o,r))}updateOptions(e,t){e.labelFormat!==t.labelFormat&&this.computeTabLabels(),e.titleScrollbarSizing!==t.titleScrollbarSizing&&this.updateTabsScrollbarSizing(),(e.tabSizingFixedMaxWidth!==t.tabSizingFixedMaxWidth||e.tabSizing!==t.tabSizing)&&this.updateTabSizing(!0),(e.labelFormat!==t.labelFormat||e.tabCloseButton!==t.tabCloseButton||e.tabSizing!==t.tabSizing||e.pinnedTabSizing!==t.pinnedTabSizing||e.showIcons!==t.showIcons||e.hasIcons!==t.hasIcons||e.highlightModifiedTabs!==t.highlightModifiedTabs||e.wrapTabs!==t.wrapTabs||!Aa(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}forEachTab(e,t,i){this.group.editors.forEach((o,s)=>{typeof t=="number"&&t>s||typeof i=="number"&&i<s||this.doWithTab(s,o,e)})}withTab(e,t){this.doWithTab(this.group.getIndexOfEditor(e),e,t)}doWithTab(e,t,i){const s=j(this.tabsContainer).children[e],n=this.tabResourceLabels.get(e),r=this.tabLabels[e],a=this.tabActionBars[e];s&&n&&r&&i(t,e,s,n,r,a)}createTab(e,t,i){const o=document.createElement("div");o.draggable=!0,o.setAttribute("role","tab"),o.classList.add("tab"),this._register(ii.addTarget(o));const s=document.createElement("div");s.classList.add("tab-border-top-container"),o.appendChild(s);const n=this.tabResourceLabels.create(o),r=document.createElement("div");r.classList.add("tab-actions"),o.appendChild(r);const a=new Oh({groupId:this.group.id,editorIndex:e}),d=new vo(r,{ariaLabel:p("ariaLabelTabActions","Tab actions"),actionRunner:a});d.onWillRun(m=>{m.action.id===this.closeEditorAction.id&&this.blockRevealActiveTabOnce()});const l=ur(d,ie(el(this.tabActionBars,d))),u=document.createElement("div");u.classList.add("tab-border-bottom-container"),o.appendChild(u);const g=this.registerTabListeners(o,e,t,i);return this.tabDisposables.push(ur(g,l,a,n)),o}registerTabListeners(e,t,i,o){const s=new A,n=(a,d)=>{if(e.blur(),a instanceof MouseEvent&&(a.button!==0||le&&a.ctrlKey)){a.button===1&&a.preventDefault();return}if(this.originatesFromTabActionBar(a))return;const l=this.group.getEditorByIndex(t);l&&this.group.openEditor(l,{preserveFocus:d,activation:Ri.ACTIVATE})},r=a=>{K.stop(a);const d=this.group.getEditorByIndex(t);d&&this.onContextMenu(d,a,e)};s.add(w(e,S.MOUSE_DOWN,a=>n(a,!1))),s.add(w(e,Te.Tap,a=>n(a,!0))),s.add(w(e,Te.Change,a=>{o.setScrollPosition({scrollLeft:o.getScrollPosition().scrollLeft-a.translationX})})),s.add(w(e,S.MOUSE_UP,a=>{K.stop(a),e.blur()})),s.add(w(e,S.AUXCLICK,a=>{a.button===1&&(K.stop(a,!0),this.blockRevealActiveTabOnce(),this.closeEditorAction.run({groupId:this.group.id,editorIndex:t}))})),s.add(w(e,S.KEY_DOWN,a=>{const d=new Ct(a);d.shiftKey&&d.keyCode===68&&r(a)})),s.add(w(e,Te.Contextmenu,a=>{r(a)})),s.add(w(e,S.KEY_UP,a=>{const d=new Ct(a);let l=!1;if(d.equals(3)||d.equals(10)){l=!0;const u=this.group.getEditorByIndex(t);u&&this.group.openEditor(u)}else if([15,17,16,18,14,13].some(u=>d.equals(u))){let u;d.equals(15)||d.equals(16)?u=t-1:d.equals(17)||d.equals(18)?u=t+1:d.equals(14)?u=0:u=this.group.count-1;const g=this.group.getEditorByIndex(u);g&&(l=!0,this.group.openEditor(g,{preserveFocus:!0}),i.childNodes[u].focus())}l&&K.stop(a,!0),o.setScrollPosition({scrollLeft:i.scrollLeft})}));for(const a of[Te.Tap,S.DBLCLICK])s.add(w(e,a,d=>{if(a===S.DBLCLICK)K.stop(d);else if(d.tapCount!==2)return;const l=this.group.getEditorByIndex(t);l&&this.group.isPinned(l)?this.accessor.arrangeGroups(2,this.group):this.group.pinEditor(l)}));return s.add(w(e,S.CONTEXT_MENU,a=>{K.stop(a,!0);const d=this.group.getEditorByIndex(t);d&&this.onContextMenu(d,a,e)},!0)),s.add(w(e,S.DRAG_START,a=>{const d=this.group.getEditorByIndex(t);d&&(this.editorTransfer.setData([new Ce({editor:d,groupId:this.group.id})],Ce.prototype),a.dataTransfer&&(a.dataTransfer.effectAllowed="copyMove"),this.doFillResourceDataTransfers([d],a),e.classList.add("dragged"),nr(()=>e.classList.remove("dragged")))})),s.add(new fr(e,{onDragEnter:a=>{if(e.classList.add("dragged-over"),!this.isSupportedDropTransfer(a)){a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}let d=!1;if(this.editorTransfer.hasData(Ce.prototype)){d=!0;const l=this.editorTransfer.getData(Ce.prototype);if(Array.isArray(l)){const u=l[0].identifier;if(u.editor===this.group.getEditorByIndex(t)&&u.groupId===this.group.id){a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}}}d||a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),this.updateDropFeedback(e,!0,t)},onDragOver:(a,d)=>{if(d>=$e.DRAG_OVER_OPEN_TAB_THRESHOLD){const l=this.group.getEditorByIndex(t);l&&this.group.activeEditor!==l&&this.group.openEditor(l,{preserveFocus:!0})}},onDragLeave:()=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t)},onDragEnd:()=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t),this.editorTransfer.clearData(Ce.prototype)},onDrop:a=>{e.classList.remove("dragged-over"),this.updateDropFeedback(e,!1,t),this.onDrop(a,t,i)}})),s}isSupportedDropTransfer(e){if(this.groupTransfer.hasData(Ge.prototype)){const t=this.groupTransfer.getData(Ge.prototype);return!(Array.isArray(t)&&t[0].identifier===this.group.id)}return!!(this.editorTransfer.hasData(Ce.prototype)||e.dataTransfer&&e.dataTransfer.types.length>0)}updateDropFeedback(e,t,i){const o=typeof i=="number",s=typeof i=="number"?this.group.getEditorByIndex(i):void 0,n=o&&!!s&&this.group.isActive(s),r=o?this.getColor(n?gr:mr):"";e.style.backgroundColor=(t?this.getColor(fn):r)||"";const a=this.getColor(ro);a&&t?(e.style.outlineWidth="2px",e.style.outlineStyle="dashed",e.style.outlineColor=a,e.style.outlineOffset=o?"-5px":"-3px"):(e.style.outlineWidth="",e.style.outlineStyle="",e.style.outlineColor=a||"",e.style.outlineOffset="")}computeTabLabels(){const{labelFormat:e}=this.accessor.partOptions,{verbosity:t,shortenDuplicates:i}=this.getLabelConfigFlags(e),o=[];let s=-1;for(let n=0;n<this.group.editors.length;n++){const r=this.group.editors[n];o.push({editor:r,name:r.getName(),description:r.getDescription(t),forceDescription:r.hasCapability(64),title:r.getTitle(2),ariaLabel:bg(r,n,this.group,this.editorGroupService.count)}),r===this.group.activeEditor&&(s=n)}i&&this.shortenTabLabels(o),this.tabLabels=o,this.activeTabLabel=o[s]}shortenTabLabels(e){const t=new Map;for(const i of e)typeof i.description=="string"?Hn(t,i.name,[]).push(i):i.description="";for(const[,i]of t){if(i.length===1&&!i[0].forceDescription){i[0].description="";continue}const o=new Map;for(const a of i)Hn(o,a.description,[]).push(a);let s=!1;for(const[,a]of o)if(!s&&a.length>1){const[d,...l]=a.map(({editor:u})=>u.getDescription(2));s=l.some(u=>u!==d)}if(s){o.clear();for(const a of i)a.description=a.editor.getDescription(2),Hn(o,a.description,[]).push(a)}const n=[];for(const[a]of o)n.push(a);if(n.length===1){for(const a of o.get(n[0])||[])a.forceDescription||(a.description="");continue}const r=vg(n,this.path.sep);n.forEach((a,d)=>{for(const l of o.get(a)||[])l.description=r[d]})}}getLabelConfigFlags(e){switch(e){case"short":return{verbosity:0,shortenDuplicates:!1};case"medium":return{verbosity:1,shortenDuplicates:!1};case"long":return{verbosity:2,shortenDuplicates:!1};default:return{verbosity:1,shortenDuplicates:!0}}}redraw(e){if(this.tabsAndActionsContainer){let t=this.getColor(wg);!t&&Da(this.theme.type)&&(t=this.getColor(pr)||this.getColor(ot)),t?(this.tabsAndActionsContainer.classList.add("tabs-border-bottom"),this.tabsAndActionsContainer.style.setProperty("--tabs-border-bottom-color",t.toString())):(this.tabsAndActionsContainer.classList.remove("tabs-border-bottom"),this.tabsAndActionsContainer.style.removeProperty("--tabs-border-bottom-color"))}this.forEachTab((t,i,o,s,n,r)=>{this.redrawTab(t,i,o,s,n,r)}),this.updateEditorActionsToolbar(),this.layout(this.dimensions,e)}redrawTab(e,t,i,o,s,n){const r=this.group.isSticky(t),a=this.accessor.partOptions;this.redrawTabLabel(e,t,i,o,s);const d=r?this.unpinEditorAction:this.closeEditorAction;n.hasAction(d)||(n.isEmpty()||n.clear(),n.push(d,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(d)}));const l=r&&a.pinnedTabSizing==="compact"?"off":a.tabCloseButton;for(const g of["off","left","right"])i.classList.toggle(`tab-actions-${g}`,l===g);const u=r&&a.pinnedTabSizing==="shrink"?"shrink":a.tabSizing;for(const g of["fit","shrink","fixed"])i.classList.toggle(`sizing-${g}`,u===g);i.classList.toggle("has-icon",a.showIcons&&a.hasIcons),i.classList.toggle("sticky",r);for(const g of["normal","compact","shrink"])i.classList.toggle(`sticky-${g}`,r&&a.pinnedTabSizing===g);if(!a.wrapTabs&&r&&a.pinnedTabSizing!=="normal"){let g=0;switch(a.pinnedTabSizing){case"compact":g=$e.TAB_WIDTH.compact;break;case"shrink":g=$e.TAB_WIDTH.shrink;break}i.style.left=`${t*g}px`}else i.style.left="auto";this.redrawTabBorders(t,i),this.redrawTabActiveAndDirty(this.accessor.activeGroup===this.group,e,i,n)}redrawTabLabel(e,t,i,o,s){var m,f,C;const n=this.accessor.partOptions;let r,a=!1,d=!!((m=n.decorations)!=null&&m.badges),l;n.pinnedTabSizing==="compact"&&this.group.isSticky(t)?(r=n.showIcons&&n.hasIcons?"":(f=s.name)==null?void 0:f.charAt(0).toUpperCase(),l="",a=!0,d=!1):(r=s.name,l=s.description||""),s.ariaLabel&&(i.setAttribute("aria-label",s.ariaLabel),i.setAttribute("aria-description",""));const u=s.title||"";i.title=u,o.setResource({name:r,description:l,resource:ee.getOriginalUri(e,{supportSideBySide:$.BOTH})},{title:u,extraClasses:et(["tab-label",d?"tab-label-has-badge":void 0].concat(e.getLabelExtraClasses())),italic:!this.group.isPinned(e),forceLabel:a,fileDecorations:{colors:!!((C=n.decorations)!=null&&C.colors),badges:d}});const g=ee.getOriginalUri(e,{supportSideBySide:$.PRIMARY});g?i.setAttribute("data-resource-name",yg(g)):i.removeAttribute("data-resource-name")}redrawTabActiveAndDirty(e,t,i,o){const s=this.group.isActive(t),n=this.doRedrawTabDirty(e,s,t,i);this.doRedrawTabActive(e,!n,t,i,o)}doRedrawTabActive(e,t,i,o,s){if(this.group.isActive(i)){o.classList.add("active"),o.setAttribute("aria-selected","true"),o.tabIndex=0,o.style.backgroundColor=this.getColor(e?gr:Zd)||"";const n=this.getColor(e?Cg:Sg);n?(o.classList.add("tab-border-bottom"),o.style.setProperty("--tab-border-bottom-color",n.toString())):(o.classList.remove("tab-border-bottom"),o.style.removeProperty("--tab-border-bottom-color"));const r=t?this.getColor(e?Eg:_g):void 0;r?(o.classList.add("tab-border-top"),o.style.setProperty("--tab-border-top-color",r.toString())):(o.classList.remove("tab-border-top"),o.style.removeProperty("--tab-border-top-color")),o.style.color=this.getColor(e?tl:il)||"",s.setFocusable(!0)}else o.classList.remove("active"),o.setAttribute("aria-selected","false"),o.tabIndex=-1,o.style.backgroundColor=this.getColor(e?mr:Qd)||"",o.style.boxShadow="",o.style.color=this.getColor(e?kg:xg)||"",s.setFocusable(!1)}doRedrawTabDirty(e,t,i,o){let s=!1;if(i.isDirty()&&!i.isSaving())if(o.classList.add("dirty"),this.accessor.partOptions.highlightModifiedTabs){let n;e&&t?n=this.getColor(Dg):e&&!t?n=this.getColor(Ig):!e&&t?n=this.getColor(Ag):n=this.getColor(Tg),n&&(s=!0,o.classList.add("dirty-border-top"),o.style.setProperty("--tab-dirty-border-top-color",n))}else o.classList.remove("dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");else o.classList.remove("dirty","dirty-border-top"),o.style.removeProperty("--tab-dirty-border-top-color");return s}redrawTabBorders(e,t){const s=(this.group.isSticky(e)&&this.group.stickyCount===e+1?this.getColor(Vg):void 0)||this.getColor(pr)||this.getColor(ot);t.style.borderRight=s?`1px solid ${s}`:"",t.style.outlineColor=this.getColor(ro)||""}prepareEditorActions(e){return this.accessor.activeGroup===this.group?e:{primary:e.primary.filter(i=>i.id===ol),secondary:e.secondary}}getHeight(){const e=this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden();return this.dimensions.used?{total:this.dimensions.used.height,offset:e?this.dimensions.used.height-F.HEIGHT:this.dimensions.used.height}:this.computeHeight()}computeHeight(){var i;let e;this.accessor.partOptions.wrapTabs&&((i=this.tabsAndActionsContainer)!=null&&i.classList.contains("wrapping"))?e=this.tabsAndActionsContainer.offsetHeight:e=$e.TAB_HEIGHT;const t=e;return this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()&&(e+=F.HEIGHT),{total:e,offset:t}}layout(e,t){if(Object.assign(this.dimensions,e),!this.layoutScheduler.value){const i=nr(()=>{var o;this.doLayout(this.dimensions,(o=this.layoutScheduler.value)==null?void 0:o.options),this.layoutScheduler.clear()});this.layoutScheduler.value={options:t,dispose:()=>i.dispose()}}return t!=null&&t.forceRevealActiveTab&&(this.layoutScheduler.value.options={...this.layoutScheduler.value.options,forceRevealActiveTab:!0}),this.dimensions.used||(this.dimensions.used=new G(e.container.width,this.computeHeight().total)),this.dimensions.used}doLayout(e,t){const i=this.group.activeEditor?this.getTabAndIndex(this.group.activeEditor):void 0;if(i&&e.container!==G.None&&e.available!==G.None){this.doLayoutBreadcrumbs(e);const[n,r]=i;this.doLayoutTabs(n,r,e,t)}const o=this.dimensions.used,s=this.dimensions.used=new G(e.container.width,this.computeHeight().total);o&&o.height!==s.height&&this.group.relayout()}handleBreadcrumbsEnablementChange(){this.group.relayout()}doLayoutBreadcrumbs(e){this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()&&this.breadcrumbsControl.layout(new G(e.container.width,F.HEIGHT))}doLayoutTabs(e,t,i,o){this.doLayoutTabsWrapping(i)||this.doLayoutTabsNonWrapping(e,t,o)}doLayoutTabsWrapping(e){const[t,i,o,s]=Zi(this.tabsAndActionsContainer,this.tabsContainer,this.editorToolbarContainer,this.tabsScrollbar),n=t.classList.contains("wrapping");let r=n;function a(d){r=d,t.classList.toggle("wrapping",r),i.style.setProperty("--last-tab-margin-right",r?`${o.offsetWidth}px`:"0")}if(this.accessor.partOptions.wrapTabs){const d=i.offsetWidth,l=i.scrollWidth,u=()=>{const g=this.getLastTab();return g?!(g.offsetWidth+o.offsetWidth-e.available.width>1):!0};(r||l>d&&u())&&a(!0),r&&(i.offsetHeight>e.available.height||l===d&&i.offsetHeight===$e.TAB_HEIGHT||!u())&&a(!1)}else n&&a(!1);if(r&&!n){const d=i.offsetWidth;s.setScrollDimensions({width:d,scrollWidth:d})}if(r){const d=new Map;let l,u;for(const g of i.children){const m=g,f=m.offsetTop;f!==l&&(l=f,u&&d.set(u,!0)),u=m,d.set(m,!1)}u&&d.set(u,!0);for(const[g,m]of d)g.classList.toggle("last-in-row",m)}return r}doLayoutTabsNonWrapping(e,t,i){const[o,s]=Zi(this.tabsContainer,this.tabsScrollbar),n=o.offsetWidth,r=o.scrollWidth;let a=0;if(this.group.stickyCount>0){let De=0;switch(this.accessor.partOptions.pinnedTabSizing){case"compact":De=$e.TAB_WIDTH.compact;break;case"shrink":De=$e.TAB_WIDTH.shrink;break}a=this.group.stickyCount*De}let d=this.accessor.partOptions.pinnedTabSizing!=="normal"&&this.group.isSticky(t),l=n-a;this.group.stickyCount>0&&l<$e.TAB_WIDTH.fit?(o.classList.add("disable-sticky-tabs"),l=n,a=0,d=!1):o.classList.remove("disable-sticky-tabs");let u,g;this.blockRevealActiveTab||(u=e.offsetLeft,g=e.offsetWidth);const{width:m,scrollWidth:f}=s.getScrollDimensions();s.setScrollDimensions({width:n,scrollWidth:r});const C=m!==n||f!==r;if(this.blockRevealActiveTab||typeof u!="number"||typeof g!="number"||d||!C&&!(i!=null&&i.forceRevealActiveTab)){this.blockRevealActiveTab=!1;return}const E=s.getScrollPosition().scrollLeft,V=g<=l,B=u-a;V&&E+l<B+g?s.setScrollPosition({scrollLeft:E+(B+g-(E+l))}):(E>B||!V)&&s.setScrollPosition({scrollLeft:B})}getTabAndIndex(e){const t=this.group.getIndexOfEditor(e),i=this.getTabAtIndex(t);if(i)return[i,t]}getTabAtIndex(e){if(e>=0)return j(this.tabsContainer).children[e]}getLastTab(){return this.getTabAtIndex(this.group.count-1)}blockRevealActiveTabOnce(){this.blockRevealActiveTab=!0}originatesFromTabActionBar(e){let t;return e instanceof MouseEvent?t=e.target||e.srcElement:t=e.initialTarget,!!Us(t,"action-item","tab")}async onDrop(e,t,i){if(K.stop(e,!0),this.updateDropFeedback(i,!1),i.classList.remove("scroll"),this.groupTransfer.hasData(Ge.prototype)){const o=this.groupTransfer.getData(Ge.prototype);if(Array.isArray(o)){const s=this.accessor.getGroup(o[0].identifier);if(s){const n={index:t};this.isMoveOperation(e,s.id)||(n.mode=0),this.accessor.mergeGroup(s,this.group,n)}this.group.focus(),this.groupTransfer.clearData(Ge.prototype)}}else if(this.editorTransfer.hasData(Ce.prototype)){const o=this.editorTransfer.getData(Ce.prototype);if(Array.isArray(o)){const s=o[0].identifier,n=this.accessor.getGroup(s.groupId);n&&(this.isMoveOperation(e,s.groupId,s.editor)?n.moveEditor(s.editor,this.group,{index:t}):n.copyEditor(s.editor,this.group,{index:t})),this.group.focus(),this.editorTransfer.clearData(Ce.prototype)}}else if(this.treeItemsTransfer.hasData(Lt.prototype)){const o=this.treeItemsTransfer.getData(Lt.prototype);if(Array.isArray(o)){const s=[];for(const n of o){const r=await this.treeViewsDragAndDropService.removeDragOperationTransfer(n.identifier);if(r){const a=await sl(r);s.push(...a.map(d=>({...d,options:{...d.options,pinned:!0,index:t}})))}}this.editorService.openEditors(s,this.group,{validateTrust:!0})}this.treeItemsTransfer.clearData(Lt.prototype)}else this.instantiationService.createInstance(nl,{allowWorkspaceOpen:!1}).handleDrop(e,()=>this.group,()=>this.group.focus(),t)}isMoveOperation(e,t,i){return i!=null&&i.hasCapability(8)?!0:!(e.ctrlKey&&!le||e.altKey&&le)||t===this.group.id}dispose(){super.dispose(),this.tabDisposables=ue(this.tabDisposables)}};ri.SCROLLBAR_SIZES={default:3,large:10};ri.TAB_WIDTH={compact:38,shrink:80,fit:120};ri.TAB_HEIGHT=35;ri.DRAG_OVER_OPEN_TAB_THRESHOLD=1500;ri.MOUSE_WHEEL_EVENT_THRESHOLD=150;ri.MOUSE_WHEEL_DISTANCE_THRESHOLD=1.5;ri=x([h(3,xe),h(4,D),h(5,H),h(6,we),h(7,Be),h(8,Xe),h(9,Kt),h(10,X),h(11,L),h(12,Ue),h(13,U),h(14,Xd),h(15,oe),h(16,xa)],ri);ba((c,e)=>{const t=c.getColor(pr);t&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title > .tabs-and-actions-container.wrapping .tabs-container > .tab {
				border-bottom: 1px solid ${t};
			}
		`);const i=c.getColor(ro);i&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active,
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab.active:hover  {
				outline: 1px solid;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active {
				outline: 1px dotted;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				outline: 1px dashed;
				outline-offset: -5px;
			}

			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.active:hover > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.dirty > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab.sticky > .tab-actions .action-label,
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-actions .action-label {
				opacity: 1 !important;
			}
		`);const o=c.getColor(ot);o&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .editor-actions {
				outline: 1px solid ${o}
			}
		`);const s=c.getColor(ag);s&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {
				background-color: ${s} !important;
			}
		`);const n=c.getColor(cg);n&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				background-color: ${n} !important;
			}
		`);const r=c.getColor(dg);r&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover  {
				color: ${r} !important;
			}
		`);const a=c.getColor(lg);a&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover  {
				color: ${a} !important;
			}
		`);const d=c.getColor(hg);d&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container.active > .title .tabs-container > .tab:hover > .tab-border-bottom-container {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${d};
			}
		`);const l=c.getColor(ug);if(l&&e.addRule(`
			.monaco-workbench .part.editor > .content .editor-group-container > .title .tabs-container > .tab:hover > .tab-border-bottom-container  {
				display: block;
				position: absolute;
				left: 0;
				pointer-events: none;
				width: 100%;
				z-index: 10;
				bottom: 0;
				height: 1px;
				background-color: ${l};
			}
		`),!Da(c.type)&&!pg&&!i){const u=gg(c),g=c.getColor(Ia),m=c.getColor(Jd),f=c.getColor(fn);let C;m&&g&&(C=m.flatten(g,g,u));let E;m&&g&&f&&g&&(E=m.flatten(g,f,g,u));const V=(T,ne,ye=!1)=>`
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${ye?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${ye?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${T}, transparent) !important;
			}

			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${ye?".active":""} > .title .tabs-container > .tab.sizing-shrink:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after,
			.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${ye?".active":""} > .title .tabs-container > .tab.sizing-fixed:not(.dragged):not(.sticky-compact):hover > .tab-label > .monaco-icon-label-container::after {
				background: linear-gradient(to left, ${ne}, transparent) !important;
			}
		`;if(s&&C&&E){const T=s.flatten(C),ne=s.flatten(E);e.addRule(V(T,ne,!0))}if(n&&C&&E){const T=n.flatten(C),ne=n.flatten(E);e.addRule(V(T,ne))}if(f&&E){const T=f.flatten(E);e.addRule(`
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-shrink.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container.active > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.active):not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container:not(.active) > .title .tabs-container > .tab.sizing-fixed.dragged-over:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${T}, transparent) !important;
				}
		`)}const B=(T,ne,ye,li)=>`
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${ye?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${li?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content:not(.dragged-over) .editor-group-container${ye?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${li?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${T}, transparent);
				}

				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${ye?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-shrink${li?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after,
				.monaco-workbench .part.editor > .content.dragged-over .editor-group-container${ye?".active":":not(.active)"} > .title .tabs-container > .tab.sizing-fixed${li?".active":""}:not(.dragged):not(.sticky-compact) > .tab-label > .monaco-icon-label-container::after {
					background: linear-gradient(to left, ${ne}, transparent);
				}
		`,De=c.getColor(gr);if(De&&C&&E){const T=De.flatten(C),ne=De.flatten(E);e.addRule(B(T,ne,!0,!0))}const Me=c.getColor(Zd);if(Me&&C&&E){const T=Me.flatten(C),ne=Me.flatten(E);e.addRule(B(T,ne,!1,!0))}const bt=c.getColor(mr);if(bt&&C&&E){const T=bt.flatten(C),ne=bt.flatten(E);e.addRule(B(T,ne,!0,!1))}const Ke=c.getColor(Qd);if(Ke&&C&&E){const T=Ke.flatten(C),ne=Ke.flatten(E);e.addRule(B(T,ne,!1,!1))}}});let jr=class extends R{get minimumWidth(){var e;return((e=this._activeEditorPane)==null?void 0:e.minimumWidth)??Ac.width}get minimumHeight(){var e;return((e=this._activeEditorPane)==null?void 0:e.minimumHeight)??Ac.height}get maximumWidth(){var e;return((e=this._activeEditorPane)==null?void 0:e.maximumWidth)??Tc.width}get maximumHeight(){var e;return((e=this._activeEditorPane)==null?void 0:e.maximumHeight)??Tc.height}get activeEditorPane(){return this._activeEditorPane}constructor(e,t,i,o,s,n,r,a,d){super(),this.editorGroupParent=e,this.editorPanesParent=t,this.groupView=i,this.layoutService=o,this.instantiationService=s,this.editorProgressService=n,this.workspaceTrustService=r,this.logService=a,this.dialogService=d,this._onDidFocus=this._register(new y),this.onDidFocus=this._onDidFocus.event,this._onDidChangeSizeConstraints=this._register(new y),this.onDidChangeSizeConstraints=this._onDidChangeSizeConstraints.event,this._activeEditorPane=null,this.editorPanes=[],this.activeEditorPaneDisposables=this._register(new A),this.editorOperation=this._register(new Pg(this.editorProgressService)),this.editorPanesRegistry=de.as(rl.EditorPane),this.registerListeners()}registerListeners(){this._register(this.workspaceTrustService.onDidChangeTrust(()=>this.onDidChangeWorkspaceTrust()))}onDidChangeWorkspaceTrust(){var i,o;const e=(i=this._activeEditorPane)==null?void 0:i.input,t=(o=this._activeEditorPane)==null?void 0:o.options;e!=null&&e.hasCapability(16)&&this.groupView.openEditor(e,t)}async openEditor(e,t,i=Object.create(null)){try{return await this.doOpenEditor(this.getEditorPaneDescriptor(e),e,t,i)}catch(o){return t!=null&&t.ignoreError?{error:o}:this.doShowError(o,e,t,i)}}async doShowError(e,t,i,o){this.logService.error(e);let s=!1;if((i==null?void 0:i.source)===al.USER&&(!Vc(e)||e.allowDialog)&&(s=await this.doShowErrorDialog(e,t)),s)return{error:e};const n={...i};return Gi(e)||(n.error=e),{...await this.doOpenEditor(Lg.DESCRIPTOR,t,n,o),error:e}}async doShowErrorDialog(e,t){let i=Ks.Error,o,s=Go(e),n;Vc(e)&&(n=e.actions,i=e.forceSeverity??Ks.Error,e.forceMessage&&(o=e.message,s=void 0)),o||(o=p("editorOpenErrorDialog","Unable to open '{0}'",t.getName()));const r=[];if(n&&n.length>0)for(const u of n)r.push({label:u.label,run:()=>u});else r.push({label:p({key:"ok",comment:["&& denotes a mnemonic"]},"&&OK"),run:()=>{}});let a;r.length===1&&(a={run:()=>{d=!0}});let d=!1;const{result:l}=await this.dialogService.prompt({type:i,message:o,detail:s,buttons:r,cancelButton:a});if(l){const u=l.run();u instanceof Promise&&u.catch(g=>this.dialogService.error(Go(g))),d=!0}return d}async doOpenEditor(e,t,i,o=Object.create(null)){const s=this.doShowEditorPane(e),n=document.activeElement,{changed:r,cancelled:a}=await this.doSetInput(s,t,i,o),d=!i||!i.preserveFocus;return!a&&d&&this.shouldRestoreFocus(n)&&s.focus(),{pane:s,changed:r,cancelled:a}}shouldRestoreFocus(e){if(!this.layoutService.isRestored()||!e)return!0;const t=document.activeElement;return!!(!t||t===document.body||e===t||t.tagName!=="INPUT"&&t.tagName!=="TEXTAREA"||Ht(t,this.editorGroupParent))}getEditorPaneDescriptor(e){return e.hasCapability(16)&&!this.workspaceTrustService.isWorkspaceTrusted()?Og.DESCRIPTOR:j(this.editorPanesRegistry.getEditorPane(e))}doShowEditorPane(e){if(this._activeEditorPane&&e.describes(this._activeEditorPane))return this._activeEditorPane;this.doHideActiveEditorPane();const t=this.doCreateEditorPane(e);this.doSetActiveEditorPane(t);const i=j(t.getContainer());return this.editorPanesParent.appendChild(i),go(i),t.setVisible(!0,this.groupView),this.pagePosition&&t.layout(new G(this.pagePosition.width,this.pagePosition.height),{top:this.pagePosition.top,left:this.pagePosition.left}),this.boundarySashes&&t.setBoundarySashes(this.boundarySashes),t}doCreateEditorPane(e){const t=this.doInstantiateEditorPane(e);if(!t.getContainer()){const i=document.createElement("div");i.classList.add("editor-instance"),t.create(i)}return t}doInstantiateEditorPane(e){const t=this.editorPanes.find(o=>e.describes(o));if(t)return t;const i=this._register(e.instantiate(this.instantiationService));return this.editorPanes.push(i),i}doSetActiveEditorPane(e){this._activeEditorPane=e,this.activeEditorPaneDisposables.clear(),e&&(this.activeEditorPaneDisposables.add(e.onDidChangeSizeConstraints(t=>this._onDidChangeSizeConstraints.fire(t))),this.activeEditorPaneDisposables.add(e.onDidFocus(()=>this._onDidFocus.fire()))),this._onDidChangeSizeConstraints.fire(void 0)}async doSetInput(e,t,i,o){var a;const s=(a=e.input)==null?void 0:a.matches(t);if(s&&!(i!=null&&i.forceReload))return e.setOptions(i),{changed:!1,cancelled:!1};const n=this.editorOperation.start(this.layoutService.isRestored()?800:3200);let r=!1;try{e.clearInput(),await e.setInput(t,i,o,n.token),n.isCurrent()||(r=!0)}catch(d){if(!n.isCurrent())r=!0;else throw d}finally{n.stop()}return{changed:!s,cancelled:r}}doHideActiveEditorPane(){if(!this._activeEditorPane)return;this.editorOperation.stop(),this._activeEditorPane.clearInput(),this._activeEditorPane.setVisible(!1,this.groupView);const e=this._activeEditorPane.getContainer();e&&(this.editorPanesParent.removeChild(e),mo(e)),this.doSetActiveEditorPane(null)}closeEditor(e){var t;(t=this._activeEditorPane)!=null&&t.input&&e.matches(this._activeEditorPane.input)&&this.doHideActiveEditorPane()}setVisible(e){var t;(t=this._activeEditorPane)==null||t.setVisible(e,this.groupView)}layout(e){var t;this.pagePosition=e,(t=this._activeEditorPane)==null||t.layout(new G(e.width,e.height),e)}setBoundarySashes(e){var t;this.boundarySashes=e,(t=this._activeEditorPane)==null||t.setBoundarySashes(e)}};jr=x([h(3,pt),h(4,D),h(5,ga),h(6,Rg),h(7,rt),h(8,gn)],jr);var Cv='.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container{align-items:center;display:flex;flex:auto;height:35px;justify-content:flex-start;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container>.title-label{line-height:35px;overflow:hidden;padding-left:20px;position:relative;text-overflow:ellipsis}.monaco-workbench .part.editor>.content .editor-group-container>.title>.label-container>.title-label>.monaco-icon-label-container{flex:initial}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .no-tabs.title-label{flex:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control{flex:1 50%;margin-left:.45em;overflow:hidden}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item{font-size:.9em}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.preview .monaco-breadcrumb-item{font-style:italic}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:before{background-image:none;content:"/";height:inherit;opacity:1;width:inherit}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.backslash-path .monaco-breadcrumb-item:before{content:"\\\\"}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder+.monaco-breadcrumb-item:before,.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder:before,.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control.relative-path .monaco-breadcrumb-item:nth-child(2):before,.monaco-workbench.windows .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:nth-child(2):before{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item.root_folder:after{content:"\\00a0\\00a0";padding:0}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item:last-child{padding-right:4px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item .codicon[class*=codicon-symbol-]{padding:0 1px}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-breadcrumb-item .codicon:last-child{display:none}.monaco-workbench .part.editor>.content .editor-group-container>.title.breadcrumbs .breadcrumbs-control .monaco-icon-label:before{height:18px;padding-right:2px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.title-actions{display:flex;flex:initial;height:35px;opacity:.5;padding-right:8px}.monaco-workbench .part.editor>.content .editor-group-container>.title>.title-actions .action-item{margin-right:4px}.monaco-workbench .part.editor>.content .editor-group-container.active>.title>.title-actions{opacity:1}';be(Cv,{});class An extends rn{constructor(){super(...arguments),this.activeLabel=Object.create(null)}create(e){const t=this.titleContainer=e;t.draggable=!0,this.registerContainerListeners(t),this._register(ii.addTarget(t));const i=document.createElement("div");i.classList.add("label-container"),t.appendChild(i),this.editorLabel=this._register(this.instantiationService.createInstance(Mg,i,void 0)).element,this._register(w(this.editorLabel.element,S.CLICK,s=>this.onTitleLabelClick(s))),this.createBreadcrumbsControl(i,{showFileIcons:!1,showSymbolIcons:!0,showDecorationColors:!1,widgetStyles:{...zd,breadcrumbsBackground:bi.transparent.toString()},showPlaceholder:!1}),t.classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this._register(ie(()=>t.classList.remove("breadcrumbs")));const o=document.createElement("div");o.classList.add("title-actions"),t.appendChild(o),this.createEditorActionsToolBar(o)}registerContainerListeners(e){this.enableGroupDragging(e),this._register(w(e,S.DBLCLICK,t=>this.onTitleDoubleClick(t))),this._register(w(e,S.AUXCLICK,t=>this.onTitleAuxClick(t))),this._register(w(e,Te.Tap,t=>this.onTitleTap(t)));for(const t of[S.CONTEXT_MENU,Te.Contextmenu])this._register(w(e,t,i=>{this.group.activeEditor&&this.onContextMenu(this.group.activeEditor,i,e)}))}onTitleLabelClick(e){K.stop(e,!1),setTimeout(()=>this.quickInputService.quickAccess.show())}onTitleDoubleClick(e){K.stop(e),this.group.pinEditor()}onTitleAuxClick(e){e.button===1&&this.group.activeEditor&&(K.stop(e,!0),this.group.closeEditor(this.group.activeEditor))}onTitleTap(e){const t=e.initialTarget;!(t instanceof HTMLElement)||!this.editorLabel||!Ht(t,this.editorLabel.element)||setTimeout(()=>this.quickInputService.quickAccess.show(),50)}openEditor(e){this.doHandleOpenEditor()}openEditors(e){this.doHandleOpenEditor()}doHandleOpenEditor(){this.ifActiveEditorChanged(()=>this.redraw())||this.ifActiveEditorPropertiesChanged(()=>this.redraw())}beforeCloseEditor(e){}closeEditor(e){this.ifActiveEditorChanged(()=>this.redraw())}closeEditors(e){this.ifActiveEditorChanged(()=>this.redraw())}moveEditor(e,t,i){this.ifActiveEditorChanged(()=>this.redraw())}pinEditor(e){this.ifEditorIsActive(e,()=>this.redraw())}stickEditor(e){}unstickEditor(e){}setActive(e){this.redraw()}updateEditorLabel(e){this.ifEditorIsActive(e,()=>this.redraw())}updateEditorDirty(e){this.ifEditorIsActive(e,()=>{const t=j(this.titleContainer);e.isDirty()&&!e.isSaving()?t.classList.add("dirty"):t.classList.remove("dirty")})}updateOptions(e,t){(e.labelFormat!==t.labelFormat||!Aa(e.decorations,t.decorations))&&this.redraw()}updateStyles(){this.redraw()}handleBreadcrumbsEnablementChange(){j(this.titleContainer).classList.toggle("breadcrumbs",!!this.breadcrumbsControl),this.redraw()}ifActiveEditorChanged(e){return!this.activeLabel.editor&&this.group.activeEditor||this.activeLabel.editor&&!this.group.activeEditor||!this.activeLabel.editor||!this.group.isActive(this.activeLabel.editor)?(e(),!0):!1}ifActiveEditorPropertiesChanged(e){!this.activeLabel.editor||!this.group.activeEditor||this.activeLabel.pinned!==this.group.isPinned(this.group.activeEditor)&&e()}ifEditorIsActive(e,t){this.group.isActive(e)&&t()}redraw(){var r,a;const e=Bt(this.group.activeEditor),t=this.accessor.partOptions,i=e?this.group.isPinned(e):!1,o=this.accessor.activeGroup===this.group;this.activeLabel={editor:e,pinned:i},this.breadcrumbsControl&&(o?(this.breadcrumbsControl.update(),this.breadcrumbsControl.domNode.classList.toggle("preview",!i)):this.breadcrumbsControl.hide());const[s,n]=Zi(this.titleContainer,this.editorLabel);if(!e)s.classList.remove("dirty"),n.clear(),this.clearEditorActionsToolbar();else{this.updateEditorDirty(e);const{labelFormat:d}=this.accessor.partOptions;let l;this.breadcrumbsControl&&!this.breadcrumbsControl.isHidden()||d==="default"&&!o?l="":l=e.getDescription(this.getVerbosity(d))||"";let u=e.getTitle(2);l===u&&(u=""),n.setResource({resource:ee.getOriginalUri(e,{supportSideBySide:$.BOTH}),name:e.getName(),description:l},{title:u,italic:!i,extraClasses:["no-tabs","title-label"].concat(e.getLabelExtraClasses()),fileDecorations:{colors:!!((r=t.decorations)!=null&&r.colors),badges:!!((a=t.decorations)!=null&&a.badges)}}),o?s.style.color=this.getColor(tl)||"":s.style.color=this.getColor(il)||"",this.updateEditorActionsToolbar()}}getVerbosity(e){switch(e){case"short":return 0;case"long":return 2;default:return 1}}prepareEditorActions(e){return this.accessor.activeGroup===this.group?e:{primary:e.primary.filter(i=>i.id===cl||i.id===ol),secondary:e.secondary}}getHeight(){return{total:An.HEIGHT,offset:0}}layout(e){var t;return(t=this.breadcrumbsControl)==null||t.layout(void 0),new G(e.container.width,this.getHeight().total)}}An.HEIGHT=35;const Mh={text:p("watermark.showCommands","Show All Commands"),id:"workbench.action.showCommands"},Sv={text:p("watermark.quickAccess","Go to File"),id:"workbench.action.quickOpen"},Ev={text:p("watermark.openFile","Open File"),id:"workbench.action.files.openFile",mac:!1},_v={text:p("watermark.openFolder","Open Folder"),id:"workbench.action.files.openFolder",mac:!1},kv={text:p("watermark.openFileFolder","Open File or Folder"),id:"workbench.action.files.openFileFolder",mac:!0},xv={text:p("watermark.openRecent","Open Recent"),id:"workbench.action.openRecent"},Dv={text:p("watermark.newUntitledFile","New Untitled Text File"),id:"workbench.action.files.newUntitledFile"},Iv=Object.assign({mac:!0},Dv),Av={text:p("watermark.findInFiles","Find in Files"),id:"workbench.action.findInFiles"},Tv={text:p({key:"watermark.toggleTerminal",comment:["toggle is a verb here"]},"Toggle Terminal"),id:"workbench.action.terminal.toggleTerminal",when:v.equals("terminalProcessSupported",!0)},Vv={text:p("watermark.startDebugging","Start Debugging"),id:"workbench.action.debug.start",when:v.equals("terminalProcessSupported",!0)},Rv={text:p({key:"watermark.toggleFullscreen",comment:["toggle is a verb here"]},"Toggle Full Screen"),id:"workbench.action.toggleFullScreen",when:v.equals("terminalProcessSupported",!0).negate()},Pv={text:p("watermark.showSettings","Show Settings"),id:"workbench.action.openSettings",when:v.equals("terminalProcessSupported",!0).negate()},dd=[Mh,Ev,_v,kv,xv,Iv],ld=[Mh,Sv,Av,Vv,Tv,Rv,Pv];let qr=class extends R{constructor(e,t,i,o,s,n,r){super(),this.lifecycleService=t,this.keybindingService=i,this.contextService=o,this.contextKeyService=s,this.configurationService=n,this.telemetryService=r,this.transientDisposables=this._register(new A),this.enabled=!1;const a=Wn(".editor-group-watermark",[Wn(".letterpress"),Wn(".shortcuts@shortcuts")]);se(e,a.root),this.shortcuts=a.shortcuts,this.registerListeners(),this.workbenchState=o.getWorkbenchState(),this.render()}registerListeners(){this.lifecycleService.onDidShutdown(()=>this.dispose()),this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration("workbench.tips.enabled")&&this.render()})),this._register(this.contextService.onDidChangeWorkbenchState(i=>{this.workbenchState!==i&&(this.workbenchState=i,this.render())}));const e=[...dd,...ld].filter(i=>i.when!==void 0).map(i=>i.when),t=new Set;e.forEach(i=>i.keys().forEach(o=>t.add(o))),this._register(this.contextKeyService.onDidChangeContext(i=>{i.affectsSome(t)&&this.render()}))}render(){const e=this.configurationService.getValue("workbench.tips.enabled");if(e===this.enabled||(this.enabled=e,this.clear(),!e))return;const t=se(this.shortcuts,z(".watermark-box"));(this.workbenchState!==1?ld:dd).filter(s=>!("when"in s)||this.contextKeyService.contextMatchesRules(s.when)).filter(s=>!("mac"in s)||s.mac===(le&&!Qe)).filter(s=>!!q.getCommand(s.id));const o=()=>{oi(t)};o(),this.transientDisposables.add(this.keybindingService.onDidUpdateKeybindings(o)),this.telemetryService.publicLog("watermark:open")}clear(){oi(this.shortcuts),this.transientDisposables.clear()}dispose(){super.dispose(),this.clear()}};qr=x([h(1,Sa),h(2,we),h(3,at),h(4,H),h(5,L),h(6,Ye)],qr);let Qi=class Ii extends vn{static createNew(e,t,i){return i.createInstance(Ii,e,null,t)}static createFromSerialized(e,t,i,o){return o.createInstance(Ii,t,e,i)}static createCopy(e,t,i,o){return o.createInstance(Ii,t,e,i)}constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C){super(n),this.accessor=e,this._index=i,this.instantiationService=o,this.contextKeyService=s,this.telemetryService=r,this.keybindingService=a,this.menuService=d,this.contextMenuService=l,this.fileDialogService=u,this.editorService=g,this.filesConfigurationService=m,this.uriIdentityService=f,this.logService=C,this._onDidFocus=this._register(new y),this.onDidFocus=this._onDidFocus.event,this._onWillDispose=this._register(new y),this.onWillDispose=this._onWillDispose.event,this._onDidModelChange=this._register(new y),this.onDidModelChange=this._onDidModelChange.event,this._onDidActiveEditorChange=this._register(new y),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidOpenEditorFail=this._register(new y),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onWillCloseEditor=this._register(new y),this.onWillCloseEditor=this._onWillCloseEditor.event,this._onDidCloseEditor=this._register(new y),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onWillMoveEditor=this._register(new y),this.onWillMoveEditor=this._onWillMoveEditor.event,this._onWillOpenEditor=this._register(new y),this.onWillOpenEditor=this._onWillOpenEditor.event,this.disposedEditorsWorker=this._register(new Fg(V=>this.handleDisposedEditors(V),0)),this.mapEditorToPendingConfirmation=new Map,this.containerToolBarMenuDisposable=this._register(new je),this.whenRestoredPromise=new br,this.whenRestored=this.whenRestoredPromise.p,this._disposed=!1,this.element=document.createElement("div"),this._onDidChange=this._register(new ei),this.onDidChange=this._onDidChange.event,t instanceof Ii?this.model=this._register(t.model.clone()):ll(t)?this.model=this._register(o.createInstance(Rc,t)):this.model=this._register(o.createInstance(Rc,void 0)),this.scopedContextKeyService=this._register(this.contextKeyService.createScoped(this.element)),this.element.classList.add("editor-group-container"),this.registerContainerListeners(),this.createContainerToolbar(),this.createContainerContextMenu(),this._register(this.instantiationService.createInstance(qr,this.element)),this.progressBar=this._register(new yd(this.element,Cd)),this.progressBar.hide(),this.scopedInstantiationService=this.instantiationService.createChild(new vd([H,this.scopedContextKeyService],[ga,this._register(new Bg(this.progressBar,this))])),this.handleGroupContextKeys(),this.titleContainer=document.createElement("div"),this.titleContainer.classList.add("title"),this.element.appendChild(this.titleContainer),this.titleAreaControl=this.createTitleAreaControl(),this.editorContainer=document.createElement("div"),this.editorContainer.classList.add("editor-container"),this.element.appendChild(this.editorContainer),this.editorPane=this._register(this.scopedInstantiationService.createInstance(jr,this.element,this.editorContainer,this)),this._onDidChange.input=this.editorPane.onDidChangeSizeConstraints,this.doTrackFocus(),this.updateTitleContainer(),this.updateContainer(),this.updateStyles(),(this.restoreEditors(t)??Promise.resolve()).finally(()=>{this.whenRestoredPromise.complete()}),this.registerListeners()}handleGroupContextKeys(){const e=Hg.bindTo(this.scopedContextKeyService),t=Ud.bindTo(this.scopedContextKeyService),i=Kd.bindTo(this.scopedContextKeyService),o=$d.bindTo(this.scopedContextKeyService),s=jd.bindTo(this.scopedContextKeyService),n=Wg.bindTo(this.scopedContextKeyService),r=qd.bindTo(this.scopedContextKeyService),a=new je,d=()=>{a.clear();const l=this.model.activeEditor;l?(e.set(l.isDirty()&&!l.isSaving()),a.value=l.onDidChangeDirty(()=>{e.set(l.isDirty()&&!l.isSaving())})):e.set(!1)};this._register(this.onDidModelChange(l=>{switch(l.kind){case 2:r.set(this.isLocked);break;case 6:case 4:case 3:case 5:i.set(this.model.isFirst(this.model.activeEditor)),o.set(this.model.isLast(this.model.activeEditor));break;case 9:l.editor&&l.editor===this.model.activeEditor&&t.set(this.model.isPinned(this.model.activeEditor));break;case 10:l.editor&&l.editor===this.model.activeEditor&&s.set(this.model.isSticky(this.model.activeEditor));break}n.set(this.count)})),this._register(this.onDidActiveEditorChange(()=>{d()})),d()}registerContainerListeners(){this._register(w(this.element,S.DBLCLICK,e=>{this.isEmpty&&(K.stop(e),this.editorService.openEditor({resource:void 0,options:{pinned:!0,override:Rt.id}},this.id))})),this._register(w(this.element,S.AUXCLICK,e=>{this.isEmpty&&e.button===1&&(K.stop(e,!0),this.accessor.removeGroup(this))}))}createContainerToolbar(){const e=document.createElement("div");e.classList.add("editor-group-container-toolbar"),this.element.appendChild(e);const t=this._register(new vo(e,{ariaLabel:p("ariaLabelGroupActions","Empty editor group actions")})),i=this._register(this.menuService.createMenu(b.EmptyEditorGroup,this.scopedContextKeyService)),o=()=>{const s={primary:[],secondary:[]};this.containerToolBarMenuDisposable.value=ie(()=>t.clear()),Ui(i,{arg:{groupId:this.id},shouldForwardArgs:!0},s,"navigation");for(const n of[...s.primary,...s.secondary]){const r=this.keybindingService.lookupKeybinding(n.id);t.push(n,{icon:!0,label:!1,keybinding:r==null?void 0:r.getLabel()})}};o(),this._register(i.onDidChange(o))}createContainerContextMenu(){this._register(w(this.element,S.CONTEXT_MENU,e=>this.onShowContainerContextMenu(e))),this._register(w(this.element,Te.Contextmenu,()=>this.onShowContainerContextMenu()))}onShowContainerContextMenu(e){if(!this.isEmpty)return;let t=this.element;if(e instanceof MouseEvent){const i=new _t(e);t={x:i.posx,y:i.posy}}this.contextMenuService.showContextMenu({menuId:b.EmptyEditorGroupContext,contextKeyService:this.contextKeyService,getAnchor:()=>t,onHide:()=>{this.focus()}})}doTrackFocus(){const e=this._register(fo(this.element));this._register(e.onDidFocus(()=>{this.isEmpty&&this._onDidFocus.fire()}));const t=i=>{let o;if(i instanceof MouseEvent){if(i.button!==0||le&&i.ctrlKey)return;o=i.target}else o=i.initialTarget;Us(o,"monaco-action-bar",this.titleContainer)||Us(o,"monaco-breadcrumb-item",this.titleContainer)||setTimeout(()=>{this.focus()})};this._register(w(this.titleContainer,S.MOUSE_DOWN,i=>t(i))),this._register(w(this.titleContainer,Te.Tap,i=>t(i))),this._register(this.editorPane.onDidFocus(()=>{this._onDidFocus.fire()}))}updateContainer(){this.isEmpty?(this.element.classList.add("empty"),this.element.tabIndex=0,this.element.setAttribute("aria-label",p("emptyEditorGroup","{0} (empty)",this.label))):(this.element.classList.remove("empty"),this.element.removeAttribute("tabIndex"),this.element.removeAttribute("aria-label")),this.updateStyles()}updateTitleContainer(){this.titleContainer.classList.toggle("tabs",this.accessor.partOptions.showTabs),this.titleContainer.classList.toggle("show-file-icons",this.accessor.partOptions.showIcons)}createTitleAreaControl(){return this.titleAreaControl&&(this.titleAreaControl.dispose(),oi(this.titleContainer)),this.accessor.partOptions.showTabs?this.titleAreaControl=this.scopedInstantiationService.createInstance(ri,this.titleContainer,this.accessor,this):this.titleAreaControl=this.scopedInstantiationService.createInstance(An,this.titleContainer,this.accessor,this),this.titleAreaControl}restoreEditors(e){if(this.count===0)return;let t;e instanceof Ii?t=vr(e):t=Object.create(null);const i=this.model.activeEditor;if(!i)return;t.pinned=this.model.isPinned(i),t.sticky=this.model.isSticky(i),t.preserveFocus=!0;const o=document.activeElement;return this.doShowEditor(i,{active:!0,isNew:!1},t).then(()=>{this.accessor.activeGroup===this&&o===document.activeElement&&this.focus()})}registerListeners(){this._register(this.model.onDidModelChange(e=>this.onDidGroupModelChange(e))),this._register(this.accessor.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this._register(this.accessor.onDidVisibilityChange(e=>this.onDidVisibilityChange(e)))}onDidGroupModelChange(e){if(this._onDidModelChange.fire(e),!!e.editor)switch(e.kind){case 3:zg(e)&&this.onDidOpenEditor(e.editor,e.editorIndex);break;case 4:Gg(e)&&this.handleOnDidCloseEditor(e.editor,e.editorIndex,e.context,e.sticky);break;case 12:this.onWillDisposeEditor(e.editor);break;case 11:this.onDidChangeEditorDirty(e.editor);break;case 7:this.onDidChangeEditorLabel(e.editor);break}}onDidOpenEditor(e,t){this.telemetryService.publicLog("editorOpened",this.toEditorTelemetryDescriptor(e)),this.updateContainer()}handleOnDidCloseEditor(e,t,i,o){this._onWillCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o});const s=[e];e instanceof Pt&&s.push(e.primary,e.secondary);for(const n of s)this.canDispose(n)&&n.dispose();this.telemetryService.publicLog("editorClosed",this.toEditorTelemetryDescriptor(e)),this.updateContainer(),this._onDidCloseEditor.fire({groupId:this.id,editor:e,context:i,index:t,sticky:o})}canDispose(e){for(const t of this.accessor.groups)if(t instanceof Ii&&t.model.contains(e,{strictEquals:!0,supportSideBySide:$.ANY}))return!1;return!0}toEditorTelemetryDescriptor(e){const t=e.getTelemetryDescriptor(),i=ee.getOriginalUri(e),o=i?i.scheme===Re.file?i.fsPath:i.path:void 0;if(i&&o){let s=xi(i);const n=s.indexOf("?");return s=n!==-1?s.substr(0,n):s,t.resource={mimeType:new hl(Ug(i).join(", ")),scheme:i.scheme,ext:s,path:zo(o)},t}return t}onWillDisposeEditor(e){this.disposedEditorsWorker.work(e)}handleDisposedEditors(e){let t;const i=[];for(const o of e)this.model.isActive(o)?t=o:this.model.contains(o)&&i.push(o);for(const o of i)this.doCloseEditor(o,!1);t&&this.doCloseEditor(t,!1)}onDidChangeEditorPartOptions(e){this.updateTitleContainer(),e.oldPartOptions.showTabs!==e.newPartOptions.showTabs?(this.createTitleAreaControl(),this.relayout(),this.model.activeEditor&&this.titleAreaControl.openEditor(this.model.activeEditor)):this.titleAreaControl.updateOptions(e.oldPartOptions,e.newPartOptions),this.updateStyles(),e.oldPartOptions.enablePreview&&!e.newPartOptions.enablePreview&&this.model.previewEditor&&this.pinEditor(this.model.previewEditor)}onDidChangeEditorDirty(e){this.pinEditor(e),this.titleAreaControl.updateEditorDirty(e)}onDidChangeEditorLabel(e){this.titleAreaControl.updateEditorLabel(e)}onDidVisibilityChange(e){this.editorPane.setVisible(e)}get index(){return this._index}get label(){return p("groupLabel","Group {0}",this._index+1)}get ariaLabel(){return p("groupAriaLabel","Editor Group {0}",this._index+1)}get disposed(){return this._disposed}get isEmpty(){return this.count===0}get titleHeight(){return this.titleAreaControl.getHeight()}notifyIndexChanged(e){this._index!==e&&(this._index=e,this.model.setIndex(e))}setActive(e){this.active=e,this.element.classList.toggle("active",e),this.element.classList.toggle("inactive",!e),this.titleAreaControl.setActive(e),this.updateStyles(),this.model.setActive(void 0)}get id(){return this.model.id}get editors(){return this.model.getEditors(1)}get count(){return this.model.count}get stickyCount(){return this.model.stickyCount}get activeEditorPane(){return this.editorPane?Bt(this.editorPane.activeEditorPane):void 0}get activeEditor(){return this.model.activeEditor}get previewEditor(){return this.model.previewEditor}isPinned(e){return this.model.isPinned(e)}isSticky(e){return this.model.isSticky(e)}isActive(e){return this.model.isActive(e)}contains(e,t){return this.model.contains(e,t)}getEditors(e,t){return this.model.getEditors(e,t)}findEditors(e,t){const i=this.uriIdentityService.asCanonicalUri(e);return this.getEditors(1).filter(o=>{if(o.resource&&Qt(o.resource,i))return!0;if((t==null?void 0:t.supportSideBySide)===$.PRIMARY||(t==null?void 0:t.supportSideBySide)===$.ANY){const s=ee.getCanonicalUri(o,{supportSideBySide:$.PRIMARY});if(s&&Qt(s,i))return!0}if((t==null?void 0:t.supportSideBySide)===$.SECONDARY||(t==null?void 0:t.supportSideBySide)===$.ANY){const s=ee.getCanonicalUri(o,{supportSideBySide:$.SECONDARY});if(s&&Qt(s,i))return!0}return!1})}getEditorByIndex(e){return this.model.getEditorByIndex(e)}getIndexOfEditor(e){return this.model.indexOf(e)}isFirst(e){return this.model.isFirst(e)}isLast(e){return this.model.isLast(e)}focus(){this.activeEditorPane?this.activeEditorPane.focus():this.element.focus(),this._onDidFocus.fire()}pinEditor(e=this.activeEditor||void 0){if(e&&!this.model.isPinned(e)){const t=this.model.pin(e);t&&this.titleAreaControl.pinEditor(t)}}stickEditor(e=this.activeEditor||void 0){this.doStickEditor(e,!0)}unstickEditor(e=this.activeEditor||void 0){this.doStickEditor(e,!1)}doStickEditor(e,t){if(e&&this.model.isSticky(e)!==t){const i=this.getIndexOfEditor(e),o=t?this.model.stick(e):this.model.unstick(e);if(!o)return;const s=this.getIndexOfEditor(o);s!==i&&this.titleAreaControl.moveEditor(o,i,s),t?this.titleAreaControl.stickEditor(o):this.titleAreaControl.unstickEditor(o)}}async openEditor(e,t){return this.doOpenEditor(e,t,{supportSideBySide:$.BOTH})}async doOpenEditor(e,t,i){var u;if(!e||e.isDisposed())return;this._onWillOpenEditor.fire({editor:e,groupId:this.id});const o=(t==null?void 0:t.sticky)||!this.accessor.partOptions.enablePreview||e.isDirty()||((t==null?void 0:t.pinned)??typeof(t==null?void 0:t.index)=="number")||typeof(t==null?void 0:t.index)=="number"&&this.model.isSticky(t.index)||e.hasCapability(512),s={index:t?t.index:void 0,pinned:o,sticky:(t==null?void 0:t.sticky)||typeof(t==null?void 0:t.index)=="number"&&this.model.isSticky(t.index),active:this.count===0||!t||!t.inactive,supportSideBySide:i==null?void 0:i.supportSideBySide};t!=null&&t.sticky&&typeof(t==null?void 0:t.index)=="number"&&!this.model.isSticky(t.index)&&(s.sticky=!1),!s.active&&!s.pinned&&this.model.activeEditor&&!this.model.isPinned(this.model.activeEditor)&&(s.active=!0);let n=!1,r=!1;if((t==null?void 0:t.activation)===Ri.ACTIVATE?n=!0:(t==null?void 0:t.activation)===Ri.RESTORE?r=!0:(t==null?void 0:t.activation)===Ri.PRESERVE?(n=!1,r=!1):s.active&&(n=!t||!t.preserveFocus,r=!n),typeof s.index=="number"){const g=this.model.indexOf(e);g!==-1&&g!==s.index&&this.doMoveEditorInsideGroup(e,s)}const{editor:a,isNew:d}=this.model.openEditor(e,s);d&&this.count===1&&this.accessor.groups.length>1&&a.editorId&&(u=this.accessor.partOptions.autoLockGroups)!=null&&u.has(a.editorId)&&this.lock(!0);const l=this.doShowEditor(a,{active:!!s.active,isNew:d},t,i);return n?this.accessor.activateGroup(this):r&&this.accessor.restoreGroup(this),l}doShowEditor(e,t,i,o){let s;return t.active?s=(async()=>{const{pane:n,changed:r,cancelled:a,error:d}=await this.editorPane.openEditor(e,i,{newInGroup:t.isNew});if(!a){if(r&&this._onDidActiveEditorChange.fire({editor:e}),d&&this._onDidOpenEditorFail.fire(e),!n&&this.activeEditor===e){const l=!i||!i.preserveFocus;this.doCloseEditor(e,l,{fromError:!0})}return n}})():s=Promise.resolve(void 0),o!=null&&o.skipTitleUpdate||this.titleAreaControl.openEditor(e),s}async openEditors(e){const t=et(e).filter(({editor:r})=>!r.isDisposed()),i=Ta(t);if(!i)return;const o={supportSideBySide:$.BOTH};await this.doOpenEditor(i.editor,i.options,o);const s=t.slice(1),n=this.getIndexOfEditor(i.editor)+1;return await To.settled(s.map(({editor:r,options:a},d)=>this.doOpenEditor(r,{...a,inactive:!0,pinned:!0,index:n+d},{...o,skipTitleUpdate:!0}))),this.titleAreaControl.openEditors(s.map(({editor:r})=>r)),Bt(this.editorPane.activeEditorPane)}moveEditors(e,t){const i={skipTitleUpdate:this!==t};for(const{editor:o,options:s}of e)this.moveEditor(o,t,s,i);if(i.skipTitleUpdate){const o=e.map(({editor:s})=>s);t.titleAreaControl.openEditors(o),this.titleAreaControl.closeEditors(o)}}moveEditor(e,t,i,o){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,{...o,keepCopy:!1})}doMoveEditorInsideGroup(e,t){const i=t?t.index:void 0;if(typeof i!="number")return;const o=this.model.indexOf(e);if(o===-1||o===i)return;const s=this.model.getEditorByIndex(o);s&&(this.model.moveEditor(s,i),this.model.pin(s),this.titleAreaControl.moveEditor(s,o,i),this.titleAreaControl.pinEditor(s))}doMoveOrCopyEditorAcrossGroups(e,t,i,o){const s=o==null?void 0:o.keepCopy,n=vr(this,e,{...i,pinned:!0,sticky:!s&&this.model.isSticky(e)});s||this._onWillMoveEditor.fire({groupId:this.id,editor:e,target:t.id}),t.doOpenEditor(s?e.copy():e,n,o),s||this.doCloseEditor(e,!1,{...o,context:Ti.MOVE})}copyEditors(e,t){const i={skipTitleUpdate:this!==t};for(const{editor:o,options:s}of e)this.copyEditor(o,t,s,i);if(i.skipTitleUpdate){const o=e.map(({editor:s})=>s);t.titleAreaControl.openEditors(o)}}copyEditor(e,t,i,o){this===t?this.doMoveEditorInsideGroup(e,i):this.doMoveOrCopyEditorAcrossGroups(e,t,i,{...o,keepCopy:!0})}async closeEditor(e=this.activeEditor||void 0,t){return this.doCloseEditorWithConfirmationHandling(e,t)}async doCloseEditorWithConfirmationHandling(e=this.activeEditor||void 0,t,i){return!e||await this.handleCloseConfirmation([e])?!1:(this.doCloseEditor(e,t!=null&&t.preserveFocus?!1:void 0,i),!0)}doCloseEditor(e,t=this.accessor.activeGroup===this,i){i!=null&&i.skipTitleUpdate||this.titleAreaControl.beforeCloseEditor(e),this.model.isActive(e)?this.doCloseActiveEditor(t,i):this.doCloseInactiveEditor(e,i),i!=null&&i.skipTitleUpdate||this.titleAreaControl.closeEditor(e)}doCloseActiveEditor(e=this.accessor.activeGroup===this,t){const i=this.activeEditor,o=this.shouldRestoreFocus(this.element),s=this.accessor.partOptions.closeEmptyGroups;if(s&&this.active&&this.count===1){const a=this.accessor.getGroups(1)[1];a&&(o?a.focus():this.accessor.activateGroup(a))}i&&this.model.closeEditor(i,t==null?void 0:t.context);const n=this.model.activeEditor;if(n){const r=!e;let a;r&&this.accessor.activeGroup!==this&&(a=Ri.PRESERVE);const d={preserveFocus:r,activation:a,ignoreError:t==null?void 0:t.fromError};this.doOpenEditor(n,d)}else i&&this.editorPane.closeEditor(i),o&&!s&&this.focus(),this._onDidActiveEditorChange.fire({editor:void 0}),s&&this.accessor.removeGroup(this)}shouldRestoreFocus(e){const t=document.activeElement;return t===document.body?!0:Ht(t,e)}doCloseInactiveEditor(e,t){this.model.closeEditor(e,t==null?void 0:t.context)}async handleCloseConfirmation(e){if(!e.length)return!1;const t=e.shift();let i=this.mapEditorToPendingConfirmation.get(t);i||(i=this.doHandleCloseConfirmation(t),this.mapEditorToPendingConfirmation.set(t,i));let o;try{o=await i}finally{this.mapEditorToPendingConfirmation.delete(t)}return o||this.handleCloseConfirmation(e)}async doHandleCloseConfirmation(e,t){var n;if(!this.shouldConfirmClose(e)||e instanceof Pt&&this.model.contains(e.primary)||this.accessor.groups.some(r=>{if(r===this)return!1;const a=r;return!!(a.contains(e,{supportSideBySide:$.BOTH})||e instanceof Pt&&a.contains(e.primary))}))return!1;let i=2,o=1,s=!1;if(!e.hasCapability(4)&&!(t!=null&&t.skipAutoSave)&&!e.closeHandler&&(this.filesConfigurationService.getAutoSaveMode()===3?(s=!0,i=0,o=3):ya&&(wn||Kg)&&this.filesConfigurationService.getAutoSaveMode()===4&&(s=!0,i=0,o=4)),!s)if((!this.activeEditor||!this.activeEditor.matches(e))&&await this.doOpenEditor(e),typeof((n=e.closeHandler)==null?void 0:n.confirm)=="function")i=await e.closeHandler.confirm([{editor:e,groupId:this.id}]);else{let r;e instanceof Pt?r=e.primary.getName():r=e.getName(),i=await this.fileDialogService.showSaveConfirm([r])}if(!e.closeHandler&&!this.shouldConfirmClose(e))return i===2;switch(i){case 0:return!await e.save(this.id,{reason:o})&&s?this.doHandleCloseConfirmation(e,{skipAutoSave:!0}):e.isDirty();case 1:try{return await e.revert(this.id),e.isDirty()}catch(r){return this.logService.error(r),await e.revert(this.id,{soft:!0}),e.isDirty()}case 2:return!0}}shouldConfirmClose(e){return e.closeHandler?e.closeHandler.showConfirm():e.isDirty()&&!e.isSaving()}async closeEditors(e,t){if(this.isEmpty)return!0;const i=this.doGetEditorsToClose(e);return await this.handleCloseConfirmation(i.slice(0))?!1:(this.doCloseEditors(i,t),!0)}doGetEditorsToClose(e){if(Array.isArray(e))return e;const t=e,i=typeof t.direction=="number";let o=this.model.getEditors(i?1:0,t);return t.savedOnly?o=o.filter(s=>!s.isDirty()||s.isSaving()):i&&t.except?o=t.direction===0?o.slice(0,this.model.indexOf(t.except,o)):o.slice(this.model.indexOf(t.except,o)+1):t.except&&(o=o.filter(s=>t.except&&!s.matches(t.except))),o}doCloseEditors(e,t){let i=!1;for(const o of e)this.isActive(o)?i=!0:this.doCloseInactiveEditor(o);i&&this.doCloseActiveEditor(t!=null&&t.preserveFocus?!1:void 0),e.length&&this.titleAreaControl.closeEditors(e)}async closeAllEditors(e){return this.isEmpty?(this.accessor.partOptions.closeEmptyGroups&&this.accessor.removeGroup(this),!0):await this.handleCloseConfirmation(this.model.getEditors(0,e))?!1:(this.doCloseAllEditors(e),!0)}doCloseAllEditors(e){const t=[];for(const i of this.model.getEditors(1,e))this.isActive(i)||this.doCloseInactiveEditor(i),t.push(i);this.activeEditor&&t.includes(this.activeEditor)&&this.doCloseActiveEditor(),t.length&&this.titleAreaControl.closeEditors(t)}async replaceEditors(e){let t;const i=[];for(let{editor:o,replacement:s,forceReplaceDirty:n,options:r}of e){const a=this.getIndexOfEditor(o);if(a>=0){const d=this.isActive(o);r?r.index=a:r={index:a},r.inactive=!d,r.pinned=r.pinned??!0;const l={editor:o,replacement:s,forceReplaceDirty:n,options:r};d?t=l:i.push(l)}}for(const{editor:o,replacement:s,forceReplaceDirty:n,options:r}of i)if(await this.doOpenEditor(s,r),!o.matches(s)){let a=!1;if(n?(this.doCloseEditor(o,!1,{context:Ti.REPLACE}),a=!0):a=await this.doCloseEditorWithConfirmationHandling(o,{preserveFocus:!0},{context:Ti.REPLACE}),!a)return}if(t){const o=this.doOpenEditor(t.replacement,t.options);t.editor.matches(t.replacement)||(t.forceReplaceDirty?this.doCloseEditor(t.editor,!1,{context:Ti.REPLACE}):await this.doCloseEditorWithConfirmationHandling(t.editor,{preserveFocus:!0},{context:Ti.REPLACE})),await o}}get isLocked(){return this.accessor.groups.length===1?!1:this.model.isLocked}lock(e){this.accessor.groups.length===1&&(e=!1),this.model.lock(e)}updateStyles(){const e=this.isEmpty;e?this.element.style.backgroundColor=this.getColor($g)||"":this.element.style.backgroundColor="";const t=this.getColor(jg)||this.getColor(ot);!e&&t?(this.titleContainer.classList.add("title-border-bottom"),this.titleContainer.style.setProperty("--title-border-bottom-color",t)):(this.titleContainer.classList.remove("title-border-bottom"),this.titleContainer.style.removeProperty("--title-border-bottom-color"));const{showTabs:i}=this.accessor.partOptions;this.titleContainer.style.backgroundColor=this.getColor(i?Jd:qg)||"",this.editorContainer.style.backgroundColor=this.getColor(Ia)||""}get minimumWidth(){return this.editorPane.minimumWidth}get minimumHeight(){return this.editorPane.minimumHeight}get maximumWidth(){return this.editorPane.maximumWidth}get maximumHeight(){return this.editorPane.maximumHeight}get proportionalLayout(){return this.lastLayout?!(this.lastLayout.width===this.minimumWidth||this.lastLayout.height===this.minimumHeight):!0}layout(e,t,i,o){this.lastLayout={width:e,height:t,top:i,left:o},this.element.classList.toggle("max-height-478px",t<=478);const s=this.titleAreaControl.layout({container:new G(e,t),available:new G(e,t-this.editorPane.minimumHeight)}),n=Math.max(0,t-s.height);this.editorContainer.style.height=`${n}px`,this.editorPane.layout({width:e,height:n,top:i+s.height,left:o})}relayout(){if(this.lastLayout){const{width:e,height:t,top:i,left:o}=this.lastLayout;this.layout(e,t,i,o)}}setBoundarySashes(e){this.editorPane.setBoundarySashes(e)}toJSON(){return this.model.serialize()}dispose(){this._disposed=!0,this._onWillDispose.fire(),this.titleAreaControl.dispose(),super.dispose()}};Qi=x([h(3,D),h(4,H),h(5,X),h(6,Ye),h(7,we),h(8,Xe),h(9,xe),h(10,dl),h(11,U),h(12,Ng),h(13,cs),h(14,rt)],Qi);var Lv="#monaco-workbench-editor-drop-overlay{height:100%;left:0;position:absolute;width:100%;z-index:10000}#monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator{align-items:center;display:flex;height:100%;justify-content:center;left:0;opacity:0;pointer-events:none;position:absolute;top:0;width:100%}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator{transition:opacity .15s ease-out}#monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt{line-height:normal;margin:.2em;opacity:0;padding:.6em;text-align:center}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt{transition:opacity .15s ease-out}#monaco-workbench-editor-drop-overlay .editor-group-overlay-drop-into-prompt i{background-color:hsla(0,0%,100%,.05);border:1px solid hsla(0,0%,80%,.4);border-radius:5px;font-style:normal;margin:0 1px;padding:0 8px}.monaco-workbench:not(.reduce-motion) #monaco-workbench-editor-drop-overlay>.editor-group-overlay-indicator.overlay-move-transition{transition:top 70ms ease-out,left 70ms ease-out,width 70ms ease-out,height 70ms ease-out,opacity .15s ease-out}";be(Lv,{});function Nh(c){return c.getValue("editor.dropIntoEditor.enabled")}function Fh(c){return c.shiftKey}let an=class Bh extends vn{get disposed(){return!!this._disposed}constructor(e,t,i,o,s,n,r,a,d){super(i),this.accessor=e,this.groupView=t,this.configurationService=o,this.instantiationService=s,this.editorService=n,this.editorGroupService=r,this.treeViewsDragAndDropService=a,this.contextService=d,this.editorTransfer=ti.getInstance(),this.groupTransfer=ti.getInstance(),this.treeItemsTransfer=ti.getInstance(),this.cleanupOverlayScheduler=this._register(new pn(()=>this.dispose(),300)),this.enableDropIntoEditor=Nh(this.configurationService)&&this.isDropIntoActiveEditorEnabled(),this.create()}create(){const e=this.getOverlayOffsetHeight(),t=this.container=document.createElement("div");t.id=Bh.OVERLAY_ID,t.style.top=`${e}px`,this.groupView.element.appendChild(t),this.groupView.element.classList.add("dragged-over"),this._register(ie(()=>{this.groupView.element.removeChild(t),this.groupView.element.classList.remove("dragged-over")})),this.overlay=document.createElement("div"),this.overlay.classList.add("editor-group-overlay-indicator"),t.appendChild(this.overlay),this.enableDropIntoEditor&&(this.dropIntoPromptElement=Yg(p("dropIntoEditorPrompt","Hold __{0}__ to drop into editor",le?"":"Shift"),{}),this.dropIntoPromptElement.classList.add("editor-group-overlay-drop-into-prompt"),this.overlay.appendChild(this.dropIntoPromptElement)),this.registerListeners(t),this.updateStyles()}updateStyles(){const e=j(this.overlay);e.style.backgroundColor=this.getColor(fn)||"";const t=this.getColor(ro);if(e.style.outlineColor=t||"",e.style.outlineOffset=t?"-2px":"",e.style.outlineStyle=t?"dashed":"",e.style.outlineWidth=t?"2px":"",this.dropIntoPromptElement){this.dropIntoPromptElement.style.backgroundColor=this.getColor(Xg)??"",this.dropIntoPromptElement.style.color=this.getColor(Jg)??"";const i=this.getColor(Zg);i?(this.dropIntoPromptElement.style.borderWidth="1px",this.dropIntoPromptElement.style.borderStyle="solid",this.dropIntoPromptElement.style.borderColor=i):this.dropIntoPromptElement.style.borderWidth="0"}}registerListeners(e){this._register(new fr(e,{onDragEnter:t=>{},onDragOver:t=>{if(this.enableDropIntoEditor&&Fh(t)){this.dispose();return}const i=this.groupTransfer.hasData(Ge.prototype),o=this.editorTransfer.hasData(Ce.prototype);!o&&!i&&t.dataTransfer&&(t.dataTransfer.dropEffect="copy");let s=!0;if(i)s=this.isCopyOperation(t);else if(o){const r=this.editorTransfer.getData(Ce.prototype);Array.isArray(r)&&(s=this.isCopyOperation(t,r[0].identifier))}if(!s){const r=this.findSourceGroupView();if(r===this.groupView&&(i||o&&r.count<2)){this.hideOverlay();return}}let n=!!this.editorGroupService.partOptions.splitOnDragAndDrop;this.isToggleSplitOperation(t)&&(n=!n),this.positionOverlay(t.offsetX,t.offsetY,i,n),this.cleanupOverlayScheduler.isScheduled()&&this.cleanupOverlayScheduler.cancel()},onDragLeave:t=>this.dispose(),onDragEnd:t=>this.dispose(),onDrop:t=>{K.stop(t,!0),this.dispose(),this.currentDropOperation&&this.handleDrop(t,this.currentDropOperation.splitDirection)}})),this._register(w(e,S.MOUSE_OVER,()=>{this.cleanupOverlayScheduler.isScheduled()||this.cleanupOverlayScheduler.schedule()}))}isDropIntoActiveEditorEnabled(){var e;return!!((e=this.groupView.activeEditor)!=null&&e.hasCapability(128))}findSourceGroupView(){if(this.groupTransfer.hasData(Ge.prototype)){const e=this.groupTransfer.getData(Ge.prototype);if(Array.isArray(e))return this.accessor.getGroup(e[0].identifier)}else if(this.editorTransfer.hasData(Ce.prototype)){const e=this.editorTransfer.getData(Ce.prototype);if(Array.isArray(e))return this.accessor.getGroup(e[0].identifier.groupId)}}async handleDrop(e,t){const i=()=>{let o;return typeof t=="number"?o=this.accessor.addGroup(this.groupView,t):o=this.groupView,o};if(this.groupTransfer.hasData(Ge.prototype)){const o=this.groupTransfer.getData(Ge.prototype);if(Array.isArray(o)){const s=this.accessor.getGroup(o[0].identifier);if(s){if(typeof t!="number"&&s===this.groupView)return;let n;if(typeof t=="number")this.isCopyOperation(e)?n=this.accessor.copyGroup(s,this.groupView,t):n=this.accessor.moveGroup(s,this.groupView,t);else{let r;this.isCopyOperation(e)&&(r={mode:0}),this.accessor.mergeGroup(s,this.groupView,r)}n&&this.accessor.activateGroup(n)}this.groupTransfer.clearData(Ge.prototype)}}else if(this.editorTransfer.hasData(Ce.prototype)){const o=this.editorTransfer.getData(Ce.prototype);if(Array.isArray(o)){const s=o[0].identifier,n=i(),r=this.accessor.getGroup(s.groupId);if(r){if(r===n)return;const a=vr(r,s.editor,{pinned:!0,sticky:r.isSticky(s.editor)});this.isCopyOperation(e,s)?r.copyEditor(s.editor,n,a):r.moveEditor(s.editor,n,a),n.focus()}this.editorTransfer.clearData(Ce.prototype)}}else if(this.treeItemsTransfer.hasData(Lt.prototype)){const o=this.treeItemsTransfer.getData(Lt.prototype);if(Array.isArray(o)){const s=[];for(const n of o){const r=await this.treeViewsDragAndDropService.removeDragOperationTransfer(n.identifier);if(r){const a=await sl(r);s.push(...a.map(d=>({...d,options:{...d.options,pinned:!0}})))}}s.length&&this.editorService.openEditors(s,i(),{validateTrust:!0})}this.treeItemsTransfer.clearData(Lt.prototype)}else this.instantiationService.createInstance(nl,{allowWorkspaceOpen:!Qe||Qg(this.contextService.getWorkspace())}).handleDrop(e,()=>i(),s=>s==null?void 0:s.focus())}isCopyOperation(e,t){return t!=null&&t.editor.hasCapability(8)?!1:e.ctrlKey&&!le||e.altKey&&le}isToggleSplitOperation(e){return e.altKey&&!le||e.shiftKey&&le}positionOverlay(e,t,i,o){const s=this.accessor.partOptions.openSideBySideDirection==="right",n=this.groupView.element.clientWidth,r=this.groupView.element.clientHeight-this.getOverlayOffsetHeight();let a,d;o?(i?a=s?.3:.1:a=.1,i?d=s?.1:.3:d=.1):(a=0,d=0);const l=n*a,u=r*d,g=n/3,m=r/3;let f;switch(e>l&&e<n-l&&t>u&&t<r-u?f=void 0:s?e<g?f=2:e>g*2?f=3:t<r/2?f=0:f=1:t<m?f=0:t>m*2?f=1:e<n/2?f=2:f=3,f){case 0:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case 1:this.doPositionOverlay({top:"50%",left:"0",width:"100%",height:"50%"}),this.toggleDropIntoPrompt(!1);break;case 2:this.doPositionOverlay({top:"0",left:"0",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;case 3:this.doPositionOverlay({top:"0",left:"50%",width:"50%",height:"100%"}),this.toggleDropIntoPrompt(!1);break;default:this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),this.toggleDropIntoPrompt(!0)}const C=j(this.overlay);C.style.opacity="1",setTimeout(()=>C.classList.add("overlay-move-transition"),0),this.currentDropOperation={splitDirection:f}}doPositionOverlay(e){const[t,i]=Zi(this.container,this.overlay),o=this.getOverlayOffsetHeight();o?t.style.height=`calc(100% - ${o}px)`:t.style.height="100%",i.style.top=e.top,i.style.left=e.left,i.style.width=e.width,i.style.height=e.height}getOverlayOffsetHeight(){return!this.groupView.isEmpty&&this.accessor.partOptions.showTabs?this.groupView.titleHeight.offset:0}hideOverlay(){const e=j(this.overlay);this.doPositionOverlay({top:"0",left:"0",width:"100%",height:"100%"}),e.style.opacity="0",e.classList.remove("overlay-move-transition"),this.currentDropOperation=void 0}toggleDropIntoPrompt(e){this.dropIntoPromptElement&&(this.dropIntoPromptElement.style.opacity=e?"1":"0")}contains(e){return e===this.container||e===this.overlay}dispose(){super.dispose(),this._disposed=!0}};an.OVERLAY_ID="monaco-workbench-editor-drop-overlay";an=x([h(2,X),h(3,L),h(4,D),h(5,U),h(6,oe),h(7,xa),h(8,at)],an);let Yr=class extends vn{constructor(e,t,i,o,s,n){super(o),this.accessor=e,this.container=t,this.delegate=i,this.configurationService=s,this.instantiationService=n,this.counter=0,this.editorTransfer=ti.getInstance(),this.groupTransfer=ti.getInstance(),this.registerListeners()}get overlay(){if(this._overlay&&!this._overlay.disposed)return this._overlay}registerListeners(){this._register(w(this.container,S.DRAG_ENTER,e=>this.onDragEnter(e))),this._register(w(this.container,S.DRAG_LEAVE,()=>this.onDragLeave())),[this.container,window].forEach(e=>this._register(w(e,S.DRAG_END,()=>this.onDragEnd())))}onDragEnter(e){if(Nh(this.configurationService)&&Fh(e))return;if(this.counter++,!this.editorTransfer.hasData(Ce.prototype)&&!this.groupTransfer.hasData(Ge.prototype)&&e.dataTransfer){const i=de.as(em.DragAndDropContribution).getAll(),o=Array.from(i).map(s=>s.dataFormatKey);if(!tm(e,to.FILES,wr.FILES,to.RESOURCES,wr.EDITORS,...o)){e.dataTransfer.dropEffect="none";return}}this.updateContainer(!0);const t=e.target;if(t&&(this.overlay&&!this.overlay.contains(t)&&this.disposeOverlay(),!this.overlay)){const i=this.findTargetGroupView(t);i&&(this._overlay=this.instantiationService.createInstance(an,this.accessor,i))}}onDragLeave(){this.counter--,this.counter===0&&this.updateContainer(!1)}onDragEnd(){this.counter=0,this.updateContainer(!1),this.disposeOverlay()}findTargetGroupView(e){return this.accessor.groups.find(i=>{var o,s;return Ht(e,i.element)||((s=(o=this.delegate).containsGroup)==null?void 0:s.call(o,i))})}updateContainer(e){this.container.classList.toggle("dragged-over",e)}dispose(){super.dispose(),this.disposeOverlay()}disposeOverlay(){this.overlay&&(this.overlay.dispose(),this._overlay=void 0)}};Yr=x([h(3,X),h(4,L),h(5,D)],Yr);const Eo={targetWidth:900,leftMarginRatio:.1909,rightMarginRatio:.1909},Xn={type:"distribute"};function hd(c){const e=z(".centered-layout-margin");return e.style.height="100%",c&&(e.style.backgroundColor=c.toString()),{element:e,layout:()=>{},minimumSize:60,maximumSize:Number.POSITIVE_INFINITY,onDidChange:I.None}}function Ov(c,e){return{element:c.element,get maximumSize(){return c.maximumWidth},get minimumSize(){return c.minimumWidth},onDidChange:I.map(c.onDidChange,t=>t&&t.width),layout:(t,i,o)=>c.layout(t,e(),(o==null?void 0:o.top)??0,((o==null?void 0:o.left)??0)+i)}}class Mv{constructor(e,t,i={...Eo}){this.container=e,this.view=t,this.state=i,this.lastLayoutPosition={width:0,height:0,left:0,top:0},this.didLayout=!1,this.splitViewDisposables=new A,this.centeredLayoutFixedWidth=!0,this._boundarySashes={},this.container.appendChild(this.view.element),this.container.style.overflow="hidden"}get minimumWidth(){return this.splitView?this.splitView.minimumSize:this.view.minimumWidth}get maximumWidth(){return this.splitView?this.splitView.maximumSize:this.view.maximumWidth}get minimumHeight(){return this.view.minimumHeight}get maximumHeight(){return this.view.maximumHeight}get onDidChange(){return this.view.onDidChange}get boundarySashes(){return this._boundarySashes}set boundarySashes(e){this._boundarySashes=e,this.splitView&&(this.splitView.orthogonalStartSash=e.top,this.splitView.orthogonalEndSash=e.bottom)}layout(e,t,i,o){this.lastLayoutPosition={width:e,height:t,top:i,left:o},this.splitView?(this.splitView.layout(e,this.lastLayoutPosition),(!this.didLayout||this.centeredLayoutFixedWidth)&&this.resizeSplitViews()):this.view.layout(e,t,i,o),this.didLayout=!0}resizeSplitViews(){if(this.splitView)if(this.centeredLayoutFixedWidth){const e=Math.min(this.lastLayoutPosition.width,this.state.targetWidth),t=(this.lastLayoutPosition.width-e)/2;this.splitView.resizeView(0,Math.floor(t)),this.splitView.resizeView(1,e),this.splitView.resizeView(2,Math.ceil(t))}else{const e=this.state.leftMarginRatio*this.lastLayoutPosition.width,t=this.state.rightMarginRatio*this.lastLayoutPosition.width,i=this.lastLayoutPosition.width-e-t;this.splitView.resizeView(0,e),this.splitView.resizeView(1,i),this.splitView.resizeView(2,t)}}setFixedWidth(e){this.centeredLayoutFixedWidth=e,this.splitView&&(this.updateState(),this.resizeSplitViews())}updateState(){this.splitView&&(this.state.targetWidth=this.splitView.getViewSize(1),this.state.leftMarginRatio=this.splitView.getViewSize(0)/this.lastLayoutPosition.width,this.state.rightMarginRatio=this.splitView.getViewSize(2)/this.lastLayoutPosition.width)}isActive(){return!!this.splitView}styles(e){this.style=e,this.splitView&&this.emptyViews&&(this.splitView.style(this.style),this.emptyViews[0].element.style.backgroundColor=this.style.background.toString(),this.emptyViews[1].element.style.backgroundColor=this.style.background.toString())}activate(e){var t;if(e!==this.isActive())if(e){this.container.removeChild(this.view.element),this.splitView=new Bo(this.container,{inverseAltBehavior:!0,orientation:1,styles:this.style}),this.splitView.orthogonalStartSash=this.boundarySashes.top,this.splitView.orthogonalEndSash=this.boundarySashes.bottom,this.splitViewDisposables.add(this.splitView.onDidSashChange(()=>{this.splitView&&this.updateState()})),this.splitViewDisposables.add(this.splitView.onDidSashReset(()=>{this.state={...Eo},this.resizeSplitViews()})),this.splitView.layout(this.lastLayoutPosition.width,this.lastLayoutPosition);const i=this.style?this.style.background:void 0;this.emptyViews=[hd(i),hd(i)],this.splitView.addView(this.emptyViews[0],Xn,0),this.splitView.addView(Ov(this.view,()=>this.lastLayoutPosition.height),Xn,1),this.splitView.addView(this.emptyViews[1],Xn,2),this.resizeSplitViews()}else this.splitView&&this.container.removeChild(this.splitView.el),this.splitViewDisposables.clear(),(t=this.splitView)==null||t.dispose(),this.splitView=void 0,this.emptyViews=void 0,this.container.appendChild(this.view.element),this.view.layout(this.lastLayoutPosition.width,this.lastLayoutPosition.height,this.lastLayoutPosition.top,this.lastLayoutPosition.left)}isDefault(e){return this.centeredLayoutFixedWidth?e.targetWidth===Eo.targetWidth:e.leftMarginRatio===Eo.leftMarginRatio&&e.rightMarginRatio===Eo.rightMarginRatio}dispose(){this.splitViewDisposables.dispose(),this.splitView&&(this.splitView.dispose(),this.splitView=void 0)}}function cn(c,e,t){const i=c.get(oe),o=c.get(L),s=Nv(e,t,i,o);let n;return i.activeGroup!==s&&e.options&&!e.options.inactive&&e.options.preserveFocus&&typeof e.options.activation!="number"&&t!==vi&&(n=Ri.ACTIVATE),[s,n]}function Nv(c,e,t,i){let o;const s=Vo(c)?c.editor:c,n=c.options;if(e&&typeof e!="number")o=e;else if(typeof e=="number"&&e>=0)o=t.getGroup(e);else if(e===vi){const r=Pc(i);let a=t.findGroup({direction:r});(!a||Ts(a,s))&&(a=t.addGroup(t.activeGroup,r)),o=a}else if(!n||typeof n.index!="number"){const r=t.getGroups(1);if(n!=null&&n.revealIfVisible){for(const a of r)if(Fv(a,s)){o=a;break}}if(!o&&(n!=null&&n.revealIfOpened||i.getValue("workbench.editor.revealIfOpen")||ae(s)&&s.hasCapability(8))){let a,d;for(const l of r)if(Hh(l,s)&&(d||(d=l),!a&&l.isActive(s)&&(a=l)),d&&a)break;o=a||d}}if(!o){let r=t.activeGroup;if(Ts(r,s)){for(const a of t.getGroups(1))if(!Ts(a,s)){r=a;break}Ts(r,s)?o=t.addGroup(r,Pc(i)):o=r}else o=r}return o}function Ts(c,e){return!(!c.isLocked||Hh(c,e))}function Fv(c,e){return c.activeEditor?c.activeEditor.matches(e):!1}function Hh(c,e){for(const t of c.editors)if(t.matches(e))return!0;return!1}class Bv{constructor(){this.element=z(".grid-view-container"),this._onDidChange=new ei,this.onDidChange=this._onDidChange.event}get minimumWidth(){return this.gridWidget?this.gridWidget.minimumWidth:0}get maximumWidth(){return this.gridWidget?this.gridWidget.maximumWidth:Number.POSITIVE_INFINITY}get minimumHeight(){return this.gridWidget?this.gridWidget.minimumHeight:0}get maximumHeight(){return this.gridWidget?this.gridWidget.maximumHeight:Number.POSITIVE_INFINITY}get gridWidget(){return this._gridWidget}set gridWidget(e){this.element.innerText="",e?(this.element.appendChild(e.element),this._onDidChange.input=e.onDidChange):this._onDidChange.input=I.None,this._gridWidget=e}layout(e,t,i,o){var s;(s=this.gridWidget)==null||s.layout(e,t,i,o)}dispose(){this._onDidChange.dispose()}}let Zo=class gi extends xn{constructor(e,t,i,o,s){super("workbench.parts.editor",{hasTitle:!1},t,o,s),this.instantiationService=e,this.configurationService=i,this._onDidLayout=this._register(new y),this.onDidLayout=this._onDidLayout.event,this._onDidChangeActiveGroup=this._register(new y),this.onDidChangeActiveGroup=this._onDidChangeActiveGroup.event,this._onDidChangeGroupIndex=this._register(new y),this.onDidChangeGroupIndex=this._onDidChangeGroupIndex.event,this._onDidChangeGroupLocked=this._register(new y),this.onDidChangeGroupLocked=this._onDidChangeGroupLocked.event,this._onDidActivateGroup=this._register(new y),this.onDidActivateGroup=this._onDidActivateGroup.event,this._onDidAddGroup=this._register(new y),this.onDidAddGroup=this._onDidAddGroup.event,this._onDidRemoveGroup=this._register(new y),this.onDidRemoveGroup=this._onDidRemoveGroup.event,this._onDidMoveGroup=this._register(new y),this.onDidMoveGroup=this._onDidMoveGroup.event,this.onDidSetGridWidget=this._register(new y),this._onDidChangeSizeConstraints=this._register(new ei),this.onDidChangeSizeConstraints=I.any(this.onDidSetGridWidget.event,this._onDidChangeSizeConstraints.event),this._onDidScroll=this._register(new ei),this.onDidScroll=I.any(this.onDidSetGridWidget.event,this._onDidScroll.event),this._onDidChangeEditorPartOptions=this._register(new y),this.onDidChangeEditorPartOptions=this._onDidChangeEditorPartOptions.event,this.workspaceMemento=this.getMemento(1,1),this.profileMemento=this.getMemento(0,1),this.groupViews=new Map,this.mostRecentActiveGroups=[],this.gridWidgetView=this._register(new Bv),this.enforcedPartOptions=[],this._partOptions=Lc(this.configurationService,this.themeService),this._top=0,this._left=0,this.sideGroup={openEditor:(n,r)=>{const[a]=this.instantiationService.invokeFunction(d=>cn(d,{editor:n,options:r},vi));return a.openEditor(n,r)}},this._isReady=!1,this.whenReadyPromise=new br,this.whenReady=this.whenReadyPromise.p,this.whenRestoredPromise=new br,this.whenRestored=this.whenRestoredPromise.p,this.priority=2,this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e))),this._register(this.themeService.onDidFileIconThemeChange(()=>this.handleChangedPartOptions()))}onConfigurationUpdated(e){im(e)&&this.handleChangedPartOptions()}handleChangedPartOptions(){const e=this._partOptions,t=Lc(this.configurationService,this.themeService);for(const i of this.enforcedPartOptions)Object.assign(t,i);this._partOptions=t,this._onDidChangeEditorPartOptions.fire({oldPartOptions:e,newPartOptions:t})}get partOptions(){return this._partOptions}enforcePartOptions(e){return this.enforcedPartOptions.push(e),this.handleChangedPartOptions(),ie(()=>{this.enforcedPartOptions.splice(this.enforcedPartOptions.indexOf(e),1),this.handleChangedPartOptions()})}get contentDimension(){return this._contentDimension}get activeGroup(){return this._activeGroup}get groups(){return Array.from(this.groupViews.values())}get count(){return this.groupViews.size}get orientation(){return this.gridWidget&&this.gridWidget.orientation===0?1:0}get isReady(){return this._isReady}get hasRestorableState(){return!!this.workspaceMemento[gi.EDITOR_PART_UI_STATE_STORAGE_KEY]}getGroups(e=0){switch(e){case 0:return this.groups;case 1:{const t=et(this.mostRecentActiveGroups.map(i=>this.getGroup(i)));return Ro([...t,...this.groups])}case 2:{const t=[];return this.gridWidget&&this.fillGridNodes(t,this.gridWidget.getViews()),t}}}fillGridNodes(e,t){Ni(t)?t.children.forEach(i=>this.fillGridNodes(e,i)):e.push(t.view)}getGroup(e){return this.groupViews.get(e)}findGroup(e,t=this.activeGroup,i){if(typeof e.direction=="number")return this.doFindGroupByDirection(e.direction,t,i);if(typeof e.location=="number")return this.doFindGroupByLocation(e.location,t,i);throw new Error("invalid arguments")}doFindGroupByDirection(e,t,i){const o=this.assertGroupView(t),s=this.gridWidget.getNeighborViews(o,this.toGridViewDirection(e),i);return s.sort((n,r)=>this.mostRecentActiveGroups.indexOf(n.id)-this.mostRecentActiveGroups.indexOf(r.id)),s[0]}doFindGroupByLocation(e,t,i){const o=this.assertGroupView(t),s=this.getGroups(2),n=s.indexOf(o);switch(e){case 0:return s[0];case 1:return s[s.length-1];case 2:{let r=s[n+1];return!r&&i&&(r=this.doFindGroupByLocation(0,t)),r}case 3:{let r=s[n-1];return!r&&i&&(r=this.doFindGroupByLocation(1,t)),r}}}activateGroup(e){const t=this.assertGroupView(e);return this.doSetGroupActive(t),this._onDidActivateGroup.fire(t),t}restoreGroup(e){const t=this.assertGroupView(e);return this.doRestoreGroup(t),t}getSize(e){const t=this.assertGroupView(e);return this.gridWidget.getViewSize(t)}setSize(e,t){const i=this.assertGroupView(e);this.gridWidget.resizeView(i,t)}arrangeGroups(e,t=this.activeGroup){if(!(this.count<2)&&this.gridWidget)switch(e){case 1:this.gridWidget.distributeViewSizes();break;case 0:this.gridWidget.maximizeViewSize(t);break;case 2:this.isGroupMaximized(t)?this.arrangeGroups(1):this.arrangeGroups(0);break}}isGroupMaximized(e){return this.gridWidget.isViewSizeMaximized(e)}setGroupOrientation(e){if(!this.gridWidget)return;const t=e===0?1:0;this.gridWidget.orientation!==t&&(this.gridWidget.orientation=t)}applyLayout(e){const t=this.shouldRestoreFocus(this.container);let i=0;function o(a){for(const d of a)Array.isArray(d.groups)?o(d.groups):i++}o(e.groups);let s=this.getGroups(2);if(i<s.length){const a=s[i-1];s.forEach((d,l)=>{l>=i&&this.mergeGroup(d,a)}),s=this.getGroups(2)}const n=this.activeGroup,r=Lh({orientation:this.toGridViewOrientation(e.orientation,this.isTwoDimensionalGrid()?this.gridWidget.orientation:Mt(this.gridWidget.orientation)),groups:e.groups});this.doCreateGridControlWithState(r,n.id,s),this.doLayout(this._contentDimension),this.updateContainer();for(const a of this.getGroups(2))s.includes(a)||this._onDidAddGroup.fire(a);this.notifyGroupIndexChange(),t&&this._activeGroup.focus()}getLayout(){const e=this.gridWidget.serialize(),t=e.orientation===1?0:1,i=this.serializedNodeToGroupLayoutArgument(e.root);return{orientation:t,groups:i.groups}}serializedNodeToGroupLayoutArgument(e){return e.type==="branch"?{size:e.size,groups:e.data.map(t=>this.serializedNodeToGroupLayoutArgument(t))}:{size:e.size}}shouldRestoreFocus(e){if(!e)return!1;const t=document.activeElement;return t===document.body?!0:Ht(t,e)}isTwoDimensionalGrid(){const e=this.gridWidget.getViews();return Ni(e)?e.children.some(t=>Ni(t)):!1}addGroup(e,t,i){const o=this.assertGroupView(e),s=this.doAddGroup(o,t);return i!=null&&i.activate&&this.doSetGroupActive(s),s}doAddGroup(e,t,i){const o=this.groupViews.size>1&&this.isGroupMaximized(e),s=this.doCreateGroupView(i);return this.gridWidget.addView(s,this.getSplitSizingStyle(),e,this.toGridViewDirection(t)),this.updateContainer(),this._onDidAddGroup.fire(s),this.notifyGroupIndexChange(),o&&this.arrangeGroups(0,s),s}getSplitSizingStyle(){return this._partOptions.splitSizing==="split"?Jo.Split:Jo.Distribute}doCreateGroupView(e){let t;e instanceof Qi?t=Qi.createCopy(e,this,this.count,this.instantiationService):ll(e)?t=Qi.createFromSerialized(e,this,this.count,this.instantiationService):t=Qi.createNew(this,this.count,this.instantiationService),this.groupViews.set(t.id,t);const i=new A;return i.add(t.onDidFocus(()=>{this.doSetGroupActive(t)})),i.add(t.onDidModelChange(o=>{switch(o.kind){case 2:this._onDidChangeGroupLocked.fire(t);break;case 1:this._onDidChangeGroupIndex.fire(t);break}})),i.add(t.onDidActiveEditorChange(()=>{this.updateContainer()})),I.once(t.onWillDispose)(()=>{ue(i),this.groupViews.delete(t.id),this.doUpdateMostRecentActive(t)}),t}doSetGroupActive(e){if(this._activeGroup===e)return;const t=this._activeGroup;this._activeGroup=e,this.doUpdateMostRecentActive(e,!0),t==null||t.setActive(!1),e.setActive(!0),this.doRestoreGroup(e),this._onDidChangeActiveGroup.fire(e)}doRestoreGroup(e){if(this.gridWidget){const t=this.gridWidget.getViewSize(e);(t.width===e.minimumWidth||t.height===e.minimumHeight)&&this.arrangeGroups(0,e)}}doUpdateMostRecentActive(e,t){const i=this.mostRecentActiveGroups.indexOf(e.id);i!==-1&&this.mostRecentActiveGroups.splice(i,1),t&&this.mostRecentActiveGroups.unshift(e.id)}toGridViewDirection(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3}}toGridViewOrientation(e,t){return typeof e=="number"?e===0?1:0:t}removeGroup(e){const t=this.assertGroupView(e);if(this.count!==1){if(t.isEmpty)return this.doRemoveEmptyGroup(t);this.doRemoveGroupWithEditors(t)}}doRemoveGroupWithEditors(e){const t=this.getGroups(1);let i;this._activeGroup===e?i=t[1]:i=t[0],this.mergeGroup(e,i)}doRemoveEmptyGroup(e){var i;const t=this.shouldRestoreFocus(this.container);if(this._activeGroup===e){const s=this.getGroups(1)[1];this.activateGroup(s)}this.gridWidget.removeView(e,this.getSplitSizingStyle()),e.dispose(),t&&this._activeGroup.focus(),this.notifyGroupIndexChange(),this.updateContainer(),this.count===1&&((i=Ta(this.groups))==null||i.lock(!1)),this._onDidRemoveGroup.fire(e)}moveGroup(e,t,i){const o=this.assertGroupView(e),s=this.assertGroupView(t);if(o.id===s.id)throw new Error("Cannot move group into its own");const n=this.shouldRestoreFocus(o.element);return this.gridWidget.moveView(o,this.getSplitSizingStyle(),s,this.toGridViewDirection(i)),n&&o.focus(),this._onDidMoveGroup.fire(o),this.notifyGroupIndexChange(),o}copyGroup(e,t,i){const o=this.assertGroupView(e),s=this.assertGroupView(t),n=this.shouldRestoreFocus(o.element),r=this.doAddGroup(s,i,o);return n&&r.focus(),r}mergeGroup(e,t,i){const o=this.assertGroupView(e),s=this.assertGroupView(t),n=[];let r=i&&typeof i.index=="number"?i.index:s.count;for(const a of o.editors){const d=!o.isActive(a)||this._activeGroup!==o,u={index:o.isSticky(a)?void 0:r,inactive:d,preserveFocus:d};n.push({editor:a,options:u}),r++}return(i==null?void 0:i.mode)===0?o.copyEditors(n,s):o.moveEditors(n,s),o.isEmpty&&!o.disposed&&this.removeGroup(o),s}mergeAllGroups(e=this.activeGroup){for(const t of this.getGroups(1))t!==e&&this.mergeGroup(t,e);return e}assertGroupView(e){let t;if(typeof e=="number"?t=this.getGroup(e):t=e,!t)throw new Error("Invalid editor group provided!");return t}createEditorDropTarget(e,t){return this.instantiationService.createInstance(Yr,this,e,t)}get minimumWidth(){return Math.min(this.centeredLayoutWidget.minimumWidth,this.layoutService.getMaximumEditorDimensions().width)}get maximumWidth(){return this.centeredLayoutWidget.maximumWidth}get minimumHeight(){return Math.min(this.centeredLayoutWidget.minimumHeight,this.layoutService.getMaximumEditorDimensions().height)}get maximumHeight(){return this.centeredLayoutWidget.maximumHeight}get snap(){return this.layoutService.getPanelAlignment()==="center"}get onDidChange(){return I.any(this.centeredLayoutWidget.onDidChange,this.onDidSetGridWidget.event)}get gridSeparatorBorder(){return this.theme.getColor(om)||this.theme.getColor(ot)||bi.transparent}updateStyles(){const e=j(this.container);e.style.backgroundColor=this.getColor(Ia)||"";const t={separatorBorder:this.gridSeparatorBorder,background:this.theme.getColor(sm)||bi.transparent};this.gridWidget.style(t),this.centeredLayoutWidget.styles(t)}createContentArea(e,t){return this.element=e,this.container=document.createElement("div"),this.container.classList.add("content"),e.appendChild(this.container),this.doCreateGridControl(t),this.centeredLayoutWidget=this._register(new Mv(this.container,this.gridWidgetView,this.profileMemento[gi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY])),this._register(this.onDidChangeEditorPartOptions(i=>this.centeredLayoutWidget.setFixedWidth(i.newPartOptions.centeredLayoutFixedWidth??!1))),this.setupDragAndDropSupport(e,this.container),this.whenReadyPromise.complete(),this._isReady=!0,To.settled(this.groups.map(i=>i.whenRestored)).finally(()=>{this.whenRestoredPromise.complete()}),this.container}setupDragAndDropSupport(e,t){this._register(this.createEditorDropTarget(t,Object.create(null)));const i=document.createElement("div");i.classList.add("drop-block-overlay"),e.appendChild(i),this._register(nm(i,()=>i.classList.remove("visible"))),this._register(Mo.INSTANCE.registerTarget(this.element,{onDragStart:l=>i.classList.add("visible"),onDragEnd:l=>i.classList.remove("visible")}));let o,s,n,r;const a=l=>{!this.layoutService.isVisible("workbench.parts.panel")&&l===this.layoutService.getPanelPosition()?this.layoutService.setPartHidden(!1,"workbench.parts.panel"):!this.layoutService.isVisible("workbench.parts.auxiliarybar")&&l===(this.layoutService.getSideBarPosition()===1?0:1)&&this.layoutService.setPartHidden(!1,"workbench.parts.auxiliarybar")},d=()=>{o&&(clearTimeout(o),o=void 0),s&&(clearTimeout(s),s=void 0)};this._register(Mo.INSTANCE.registerTarget(i,{onDragOver:l=>{K.stop(l.eventData,!0),l.eventData.dataTransfer&&(l.eventData.dataTransfer.dropEffect="none");const u=i.getBoundingClientRect();let g,m;const f=100;l.eventData.clientX<u.left+f&&(g=0),l.eventData.clientX>u.right-f&&(g=1),l.eventData.clientY>u.bottom-f&&(m=2),o&&g!==n&&(clearTimeout(o),o=void 0),s&&m!==r&&(clearTimeout(s),s=void 0),!o&&g!==void 0&&(n=g,o=setTimeout(()=>a(g),200)),!s&&m!==void 0&&(r=m,s=setTimeout(()=>a(m),200))},onDragLeave:()=>d(),onDragEnd:()=>d(),onDrop:()=>d()}))}centerLayout(e){this.centeredLayoutWidget.activate(e),this._activeGroup.focus()}isLayoutCentered(){return this.centeredLayoutWidget?this.centeredLayoutWidget.isActive():!1}doCreateGridControl(e){let t=!1;if((!e||e.restorePreviousState)&&(t=!this.doCreateGridControlWithPreviousState()),!this.gridWidget||t){const i=this.doCreateGroupView();this.doSetGridWidget(new Li(i)),this.doSetGroupActive(i)}this.updateContainer(),this.notifyGroupIndexChange()}doCreateGridControlWithPreviousState(){const e=this.workspaceMemento[gi.EDITOR_PART_UI_STATE_STORAGE_KEY];if(e!=null&&e.serializedGrid)try{this.mostRecentActiveGroups=e.mostRecentActiveGroups,this.doCreateGridControlWithState(e.serializedGrid,e.activeGroup),this._activeGroup.focus()}catch(t){return Ho(new Error(`Error restoring editor grid widget: ${t} (with state: ${JSON.stringify(e)})`)),this.groupViews.forEach(i=>i.dispose()),this.groupViews.clear(),this.mostRecentActiveGroups=[],!1}return!0}doCreateGridControlWithState(e,t,i){let o;i?o=i.slice(0):o=[];const s=[],n=Li.deserialize(e,{fromJSON:r=>{let a;return o.length>0?a=o.shift():a=this.doCreateGroupView(r),s.push(a),a.id===t&&this.doSetGroupActive(a),a}},{styles:{separatorBorder:this.gridSeparatorBorder}});this._activeGroup||this.doSetGroupActive(s[0]),this.mostRecentActiveGroups.some(r=>!this.getGroup(r))&&(this.mostRecentActiveGroups=s.map(r=>r.id)),this.doSetGridWidget(n)}doSetGridWidget(e){let t={};this.gridWidget&&(t=this.gridWidget.boundarySashes,this.gridWidget.dispose()),this.gridWidget=e,this.gridWidget.boundarySashes=t,this.gridWidgetView.gridWidget=e,this._onDidChangeSizeConstraints.input=e.onDidChange,this._onDidScroll.input=e.onDidScroll,this.onDidSetGridWidget.fire(void 0)}updateContainer(){j(this.container).classList.toggle("empty",this.isEmpty)}notifyGroupIndexChange(){this.getGroups(2).forEach((e,t)=>e.notifyIndexChanged(t))}get isEmpty(){return this.count===1&&this._activeGroup.isEmpty}setBoundarySashes(e){this.gridWidget.boundarySashes=e,this.centeredLayoutWidget.boundarySashes=e}layout(e,t,i,o){this._top=i,this._left=o;const s=super.layoutContents(e,t).contentSize;this.doLayout(G.lift(s),i,o)}doLayout(e,t=this._top,i=this._left){this._contentDimension=e,this.centeredLayoutWidget.layout(this._contentDimension.width,this._contentDimension.height,t,i),this._onDidLayout.fire(e)}saveState(){if(this.gridWidget){const e={serializedGrid:this.gridWidget.serialize(),activeGroup:this._activeGroup.id,mostRecentActiveGroups:this.mostRecentActiveGroups};this.isEmpty?delete this.workspaceMemento[gi.EDITOR_PART_UI_STATE_STORAGE_KEY]:this.workspaceMemento[gi.EDITOR_PART_UI_STATE_STORAGE_KEY]=e}if(this.centeredLayoutWidget){const e=this.centeredLayoutWidget.state;this.centeredLayoutWidget.isDefault(e)?delete this.profileMemento[gi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]:this.profileMemento[gi.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY]=e}super.saveState()}toJSON(){return{type:"workbench.parts.editor"}}dispose(){var e;this.groupViews.forEach(t=>t.dispose()),this.groupViews.clear(),(e=this.gridWidget)==null||e.dispose(),super.dispose()}};Zo.EDITOR_PART_UI_STATE_STORAGE_KEY="editorpart.state";Zo.EDITOR_PART_CENTERED_VIEW_STORAGE_KEY="editorpart.centeredview";Zo=x([h(0,D),h(1,X),h(2,L),h(3,Se),h(4,pt)],Zo);k.registerCommandAndKeybindingRule({weight:200,when:rm,primary:2051,mac:{primary:259},id:ul,handler:async(c,e)=>{const t=c.get(U),i=c.get(O),o=c.get(Ue),s=c.get(ci),n=ds(e,i,t,s);if(n.length){const r=n.filter(g=>g.scheme===Re.untitled),a=n.filter(g=>g.scheme!==Re.untitled),u=(await Promise.all(a.map(async g=>{const m=s.findClosest(g);return m||await o.stat(g)}))).filter(g=>!g.isDirectory).map(g=>({resource:g.resource,options:{pinned:!0}})).concat(...r.map(g=>({resource:g,options:{pinned:!0}})));await t.openEditors(u,vi)}}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(Je,ct.toNegated()),primary:3,mac:{primary:2066},id:"explorer.openAndPassFocus",handler:async(c,e)=>{const t=c.get(U),o=c.get(ci).getContext(!0);o.length&&await t.openEditors(o.map(s=>({resource:s.resource,options:{preserveFocus:!1,pinned:!0}})))}});const Jn="showModifications";let pi=[];k.registerCommandAndKeybindingRule({id:Va,when:void 0,weight:200,primary:kt(2089,34),handler:async(c,e)=>{const t=c.get(D),i=c.get(ns),o=c.get(U),s=c.get(Ue);let n=!1;if(pi.length===0){n=!0;const a=t.createInstance(Oc);pi.push(a),pi.push(i.registerTextModelContentProvider(Jn,a))}const r=ls(e,c.get(O),o);if(r&&s.hasProvider(r)){const a=rs(r),d=p("modifiedLabel","{0} (in file)  {1}",a,a);try{await Oc.open(r,Jn,d,o,{pinned:!0}),n&&pi.push(o.onDidVisibleEditorsChange(()=>{o.editors.some(l=>!!ee.getCanonicalUri(l,{supportSideBySide:$.SECONDARY,filterByScheme:Jn}))||(pi=ue(pi))}))}catch{pi=ue(pi)}}}});let Xr,Zn;q.registerCommand({id:pl,handler:(c,e)=>{const t=c.get(O);Xr=ls(e,t,c.get(U)),Zn||(Zn=Ra.bindTo(c.get(H))),Zn.set(!0)}});q.registerCommand({id:gl,handler:async(c,e)=>{const t=c.get(U),i=c.get(ci),o=ds(e,c.get(O),t,i);return o.length===2?t.openEditor({original:{resource:o[0]},modified:{resource:o[1]},options:{pinned:!0}}):!0}});q.registerCommand({id:ml,handler:(c,e)=>{const t=c.get(U),i=c.get(O),o=ls(e,i,t);Xr&&o&&t.openEditor({original:{resource:Xr},modified:{resource:o},options:{pinned:!0}})}});async function oc(c,e,t,i,o){if(c.length){const s=wn?`\r
`:`
`;let n;if(e){const a=o.getValue("explorer.copyRelativePathSeparator");(a==="/"||a==="\\")&&(n=a)}const r=c.map(a=>i.getUriLabel(a,{relative:e,noPrefix:!0,separator:n})).join(s);await t.writeText(r)}}const Wh=async(c,e)=>{const t=ds(e,c.get(O),c.get(U),c.get(ci));await oc(t,!1,c.get(Uo),c.get(Ci),c.get(L))};k.registerCommandAndKeybindingRule({weight:200,when:hs.focus.toNegated(),primary:2593,win:{primary:1569},id:us,handler:Wh});k.registerCommandAndKeybindingRule({weight:200,when:hs.focus,primary:kt(2089,2593),win:{primary:1569},id:us,handler:Wh});const Gh=async(c,e)=>{const t=ds(e,c.get(O),c.get(U),c.get(ci));await oc(t,!0,c.get(Uo),c.get(Ci),c.get(L))};k.registerCommandAndKeybindingRule({weight:200,when:hs.focus.toNegated(),primary:3617,win:{primary:kt(2089,3105)},id:ps,handler:Gh});k.registerCommandAndKeybindingRule({weight:200,when:hs.focus,primary:kt(2089,3617),win:{primary:kt(2089,3105)},id:ps,handler:Gh});k.registerCommandAndKeybindingRule({weight:200,when:void 0,primary:kt(2089,46),id:"workbench.action.files.copyPathOfActiveFile",handler:async c=>{const t=c.get(U).activeEditor,i=ee.getOriginalUri(t,{supportSideBySide:$.PRIMARY});await oc(i?[i]:[],!1,c.get(Uo),c.get(Ci),c.get(L))}});q.registerCommand({id:fl,handler:async(c,e)=>{const t=c.get(yn),i=c.get(at),o=c.get(ci),s=ls(e,c.get(O),c.get(U));if(s&&i.isInsideWorkspace(s)){const n=await t.openView(am,!1);n&&(n.setExpanded(!0),await o.select(s,"force"),n.focus())}else{const n=await t.openView(cm.ID,!1);n&&(n.setExpanded(!0),n.focus())}}});q.registerCommand({id:bl,handler:async(c,e)=>{const t=c.get(U),i=ls(e,c.get(O),c.get(U));if(i)return t.openEditor({resource:i,options:{override:Ps.PICK,source:al.USER}})}});async function sc(c,e){var a;const t=c.get(O),i=c.get(oe),o=c.get(gs),s=c.get(Ld);let n=Cl(t);if(!n){const d=i.activeGroup;d.activeEditor&&(n=[],d.activeEditor instanceof Pt&&!(e!=null&&e.saveAs)&&!(d.activeEditor.primary.hasCapability(4)||d.activeEditor.secondary.hasCapability(4))?(n.push({groupId:d.id,editor:d.activeEditor.primary}),n.push({groupId:d.id,editor:d.activeEditor.secondary})):n.push({groupId:d.id,editor:d.activeEditor}))}if(!n||n.length===0)return;await nc(c,n,e);const r=o.getFocusedCodeEditor();if(r instanceof Na){const d=(a=r.getModel())==null?void 0:a.uri;if(d&&!n.some(({editor:l})=>Qt(ee.getCanonicalUri(l,{supportSideBySide:$.PRIMARY}),d))){const l=s.files.get(d);l!=null&&l.isReadonly()||await s.save(d,e)}}}function zh(c,e,t){const i=[];for(const o of e)for(const s of o.getEditors(0))s.isDirty()&&i.push({groupId:o.id,editor:s});return nc(c,i,t)}async function nc(c,e,t){const i=c.get(U),o=c.get(Be),s=c.get(D);try{await i.save(e,t)}catch(n){Gi(n)||o.notify({id:e.map(({editor:r})=>{var a;return zo((a=r.resource)==null?void 0:a.toString())}).join(),severity:wt.Error,message:p({key:"genericSaveError",comment:["{0} is the resource that failed to save and {1} the error message"]},"Failed to save '{0}': {1}",e.map(({editor:r})=>r.getName()).join(", "),Go(n,!1)),actions:{primary:[Ne({id:"workbench.action.files.saveEditors",label:p("retry","Retry"),run:()=>s.invokeFunction(r=>nc(r,e,t))}),Ne({id:"workbench.action.files.revertEditors",label:p("discard","Discard"),run:()=>i.revert(e)})]}})}}k.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:2097,id:Pa,handler:c=>sc(c,{reason:1,force:!0})});k.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:kt(2089,49),win:{primary:kt(2089,3121)},id:vl,handler:c=>sc(c,{reason:1,force:!0,skipSaveParticipants:!0})});k.registerCommandAndKeybindingRule({id:wl,weight:200,when:void 0,primary:3121,handler:c=>sc(c,{reason:1,saveAs:!0})});k.registerCommandAndKeybindingRule({when:void 0,weight:200,primary:void 0,mac:{primary:2609},win:{primary:kt(2089,49)},id:dm,handler:c=>zh(c,c.get(oe).getGroups(1),{reason:1})});q.registerCommand({id:La,handler:(c,e,t)=>{const i=c.get(oe),o=lm(t,c.get(O),c.get(oe));let s;return o.length?s=et(o.map(n=>i.getGroup(n.groupId))):s=i.getGroups(1),zh(c,s,{reason:1})}});q.registerCommand({id:yl,handler:async c=>(await c.get(U).saveAll({includeUntitled:!1,reason:1})).success});q.registerCommand({id:Oa,handler:async c=>{const e=c.get(Be),t=c.get(O),i=c.get(oe),o=c.get(U);let s=Cl(t);if(!s){const n=i.activeGroup;n.activeEditor&&(s=[{groupId:n.id,editor:n.activeEditor}])}if(!(!s||s.length===0))try{await o.revert(s.filter(({editor:n})=>!n.hasCapability(4)),{force:!0})}catch(n){e.error(p("genericRevertError","Failed to revert '{0}': {1}",s.map(({editor:r})=>r.getName()).join(", "),Go(n,!1)))}}});q.registerCommand({id:Sl,handler:(c,e)=>{const t=c.get(hm),i=c.get(at),o=c.get(cs),s=i.getWorkspace(),n=ds(e,c.get(O),c.get(U),c.get(ci)).filter(r=>s.folders.some(a=>o.extUri.isEqual(a.uri,r)));return n.length===0?c.get(It).executeCommand(um.ID):t.removeFolders(n)}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(Je,Cn,El.negate()),primary:15,id:pm,handler:c=>{const t=c.get(zi).getActivePaneComposite(0);if((t==null?void 0:t.getId())!==Mi)return;t.getViewPaneContainer().getExplorerView().previousCompressedStat()}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(Je,Cn,_l.negate()),primary:17,id:gm,handler:c=>{const t=c.get(zi).getActivePaneComposite(0);if((t==null?void 0:t.getId())!==Mi)return;t.getViewPaneContainer().getExplorerView().nextCompressedStat()}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(Je,Cn,El.negate()),primary:14,id:mm,handler:c=>{const t=c.get(zi).getActivePaneComposite(0);if((t==null?void 0:t.getId())!==Mi)return;t.getViewPaneContainer().getExplorerView().firstCompressedStat()}});k.registerCommandAndKeybindingRule({weight:200+10,when:v.and(Je,Cn,_l.negate()),primary:13,id:fm,handler:c=>{const t=c.get(zi).getActivePaneComposite(0);if((t==null?void 0:t.getId())!==Mi)return;t.getViewPaneContainer().getExplorerView().lastCompressedStat()}});k.registerCommandAndKeybindingRule({weight:200,when:null,primary:Qe?wn?kt(2089,44):2604:2092,secondary:Qe?[2092]:void 0,id:Ma,description:{description:kl,args:[{isOptional:!0,name:"New Untitled Text File arguments",description:"The editor view type or language ID if known",schema:{type:"object",properties:{viewType:{type:"string"},languageId:{type:"string"}}}}]},handler:async(c,e)=>{await c.get(U).openEditor({resource:void 0,options:{override:e==null?void 0:e.viewType,pinned:!0},languageId:e==null?void 0:e.languageId})}});q.registerCommand({id:bm,handler:async(c,e)=>{const t=c.get(U),i=c.get(dl),o=c.get(Ue),s=p("newFileCommand.saveLabel","Create File"),n=No(await i.defaultFilePath(),(e==null?void 0:e.fileName)??"Untitled.txt"),r=await i.showSaveDialog({saveLabel:s,title:s,defaultUri:n});r&&(await o.createFile(r,void 0,{overwrite:!0}),await t.openEditor({resource:r,options:{override:e==null?void 0:e.viewType,pinned:!0},languageId:e==null?void 0:e.languageId}))}});const Hv="saveConflictResolutionContext",di=10,Uh="renameFile";k.registerCommandAndKeybindingRule({id:Uh,weight:200+di,when:v.and(Je,At.toNegated(),ze),primary:60,mac:{primary:3},handler:vm});const Kh="moveFileToTrash";k.registerCommandAndKeybindingRule({id:Kh,weight:200+di,when:v.and(Je,ze,Sn),primary:20,mac:{primary:2049,secondary:[20]},handler:wm});const Tn="deleteFile";k.registerCommandAndKeybindingRule({id:Tn,weight:200+di,when:v.and(Je,ze),primary:1044,mac:{primary:2561},handler:xl});k.registerCommandAndKeybindingRule({id:Tn,weight:200+di,when:v.and(Je,ze,Sn.toNegated()),primary:20,mac:{primary:2049},handler:xl});const $h="filesExplorer.cut";k.registerCommandAndKeybindingRule({id:$h,weight:200+di,when:v.and(Je,At.toNegated(),ze),primary:2102,handler:ym});const jh="filesExplorer.copy";k.registerCommandAndKeybindingRule({id:jh,weight:200+di,when:v.and(Je,At.toNegated()),primary:2081,handler:Cm});const qh="filesExplorer.paste";k.registerCommandAndKeybindingRule({id:qh,weight:200+di,when:v.and(Je,ze),primary:2100,handler:Sm});k.registerCommandAndKeybindingRule({id:"filesExplorer.cancelCut",weight:200+di,when:v.and(Je,Em),primary:9,handler:async c=>{await c.get(ci).setToCopy([],!0)}});k.registerCommandAndKeybindingRule({id:"filesExplorer.openFilePreserveFocus",weight:200+di,when:v.and(Je,ct.toNegated()),primary:10,handler:_m});const rc={id:us,title:p("copyPath","Copy Path")},ac={id:ps,title:p("copyRelativePath","Copy Relative Path")};cc(us,rc.title,fe.IsFileSystemResource,"1_cutcopypaste");cc(ps,ac.title,fe.IsFileSystemResource,"1_cutcopypaste");cc(fl,p("revealInSideBar","Reveal in Explorer View"),fe.IsFileSystemResource,"2_files",1);function cc(c,e,t,i,o){_.appendMenuItem(b.EditorTitleContext,{command:{id:c,title:e},when:t,group:i,order:o})}Yh("workbench.files.action.acceptLocalChanges",p("acceptLocalChanges","Use your changes and overwrite file contents"),M.check,-10);Yh("workbench.files.action.revertLocalChanges",p("revertLocalChanges","Discard your changes and revert to file contents"),M.discard,-9);function Yh(c,e,t,i,o){_.appendMenuItem(b.EditorTitle,{command:{id:c,title:e,icon:t},when:v.equals(Hv,!0),group:"navigation",order:i})}function ft(c,e,t,i){_.appendMenuItem(b.CommandPalette,{command:{id:c,title:e,category:t},when:i})}ft(us,{value:p("copyPathOfActive","Copy Path of Active File"),original:"Copy Path of Active File"},ve.File);ft(ps,{value:p("copyRelativePathOfActive","Copy Relative Path of Active File"),original:"Copy Relative Path of Active File"},ve.File);ft(Pa,{value:Dl,original:"Save"},ve.File);ft(vl,{value:km,original:"Save without Formatting"},ve.File);ft(La,{value:p("saveAllInGroup","Save All in Group"),original:"Save All in Group"},ve.File);ft(yl,{value:p("saveFiles","Save All Files"),original:"Save All Files"},ve.File);ft(Oa,{value:p("revert","Revert File"),original:"Revert File"},ve.File);ft(Va,{value:p("compareActiveWithSaved","Compare Active File with Saved"),original:"Compare Active File with Saved"},ve.File);ft(wl,{value:xm,original:"Save As..."},ve.File);ft(Al,{value:Il,original:"New File"},ve.File,Fa.notEqualsTo("0"));ft(Vl,{value:Tl,original:"New Folder"},ve.File,Fa.notEqualsTo("0"));ft(Ma,{value:kl,original:"New Untitled Text File"},ve.File);const Vn=v.or(fe.IsFileSystemResource,fe.Scheme.isEqualTo(Re.untitled)),Xh={id:ul,title:p("openToSide","Open to the Side")};_.appendMenuItem(b.OpenEditorsContext,{group:"navigation",order:10,command:Xh,when:Vn});_.appendMenuItem(b.OpenEditorsContext,{group:"1_open",order:10,command:{id:Dm,title:p("reopenWith","Reopen Editor With...")},when:Im});_.appendMenuItem(b.OpenEditorsContext,{group:"1_cutcopypaste",order:10,command:rc,when:fe.IsFileSystemResource});_.appendMenuItem(b.OpenEditorsContext,{group:"1_cutcopypaste",order:20,command:ac,when:fe.IsFileSystemResource});_.appendMenuItem(b.OpenEditorsContext,{group:"2_save",order:10,command:{id:Pa,title:Dl,precondition:Ba},when:v.or(fe.Scheme.isEqualTo(Re.untitled),v.and(ms.toNegated(),Rl.toNegated(),Ha.toNegated()))});_.appendMenuItem(b.OpenEditorsContext,{group:"2_save",order:20,command:{id:Oa,title:p("revert","Revert File"),precondition:Ba},when:v.and(ms.toNegated(),Rl.toNegated(),fe.Scheme.notEqualsTo(Re.untitled),Ha.toNegated())});_.appendMenuItem(b.OpenEditorsContext,{group:"2_save",order:30,command:{id:La,title:p("saveAll","Save All"),precondition:Am},when:ms});_.appendMenuItem(b.OpenEditorsContext,{group:"3_compare",order:10,command:{id:Va,title:p("compareWithSaved","Compare with Saved"),precondition:Ba},when:v.and(fe.IsFileSystemResource,Ha.toNegated(),$i.toNegated())});const Jh={id:ml,title:p("compareWithSelected","Compare with Selected")};_.appendMenuItem(b.OpenEditorsContext,{group:"3_compare",order:20,command:Jh,when:v.and(fe.HasResource,Ra,Vn,$i.toNegated())});const Zh={id:pl,title:p("compareSource","Select for Compare")};_.appendMenuItem(b.OpenEditorsContext,{group:"3_compare",order:30,command:Zh,when:v.and(fe.HasResource,Vn,$i.toNegated())});const Qh={id:gl,title:p("compareSelected","Compare Selected")};_.appendMenuItem(b.OpenEditorsContext,{group:"3_compare",order:30,command:Qh,when:v.and(fe.HasResource,$i,Vn)});_.appendMenuItem(b.OpenEditorsContext,{group:"4_close",order:10,command:{id:cl,title:p("close","Close")},when:ms.toNegated()});_.appendMenuItem(b.OpenEditorsContext,{group:"4_close",order:20,command:{id:Tm,title:p("closeOthers","Close Others")},when:ms.toNegated()});_.appendMenuItem(b.OpenEditorsContext,{group:"4_close",order:30,command:{id:Vm,title:p("closeSaved","Close Saved")}});_.appendMenuItem(b.OpenEditorsContext,{group:"4_close",order:40,command:{id:Rm,title:p("closeAll","Close All")}});_.appendMenuItem(b.ExplorerContext,{group:"navigation",order:4,command:{id:Al,title:Il,precondition:ze},when:ct});_.appendMenuItem(b.ExplorerContext,{group:"navigation",order:6,command:{id:Vl,title:Tl,precondition:ze},when:ct});_.appendMenuItem(b.ExplorerContext,{group:"navigation",order:10,command:Xh,when:v.and(ct.toNegated(),fe.HasResource)});_.appendMenuItem(b.ExplorerContext,{group:"navigation",order:20,command:{id:bl,title:p("explorerOpenWith","Open With...")},when:v.and(ct.toNegated(),Pm)});_.appendMenuItem(b.ExplorerContext,{group:"3_compare",order:20,command:Jh,when:v.and(ct.toNegated(),fe.HasResource,Ra,$i.toNegated())});_.appendMenuItem(b.ExplorerContext,{group:"3_compare",order:30,command:Zh,when:v.and(ct.toNegated(),fe.HasResource,$i.toNegated())});_.appendMenuItem(b.ExplorerContext,{group:"3_compare",order:30,command:Qh,when:v.and(ct.toNegated(),fe.HasResource,$i)});_.appendMenuItem(b.ExplorerContext,{group:"5_cutcopypaste",order:8,command:{id:$h,title:p("cut","Cut")},when:v.and(At.toNegated(),ze)});_.appendMenuItem(b.ExplorerContext,{group:"5_cutcopypaste",order:10,command:{id:jh,title:Lm},when:At.toNegated()});_.appendMenuItem(b.ExplorerContext,{group:"5_cutcopypaste",order:20,command:{id:qh,title:Om,precondition:v.and(ze,Mm)},when:ct});_.appendMenuItem(b.ExplorerContext,{group:"5b_importexport",order:10,command:{id:Nm,title:Fm},when:v.or(v.and(Do.toNegated(),fe.Scheme.notEqualsTo(Re.file)),v.and(Do,ct.toNegated(),At.toNegated()),v.and(Do,Bm))});_.appendMenuItem(b.ExplorerContext,{group:"5b_importexport",order:20,command:{id:Hm,title:Wm},when:v.and(Do,ct,ze)});_.appendMenuItem(b.ExplorerContext,{group:"6_copypath",order:10,command:rc,when:fe.IsFileSystemResource});_.appendMenuItem(b.ExplorerContext,{group:"6_copypath",order:20,command:ac,when:fe.IsFileSystemResource});_.appendMenuItem(b.ExplorerContext,{group:"2_workspace",order:10,command:{id:Gm,title:zm},when:v.and(At,v.or(Pl,Ll.isEqualTo("workspace")))});_.appendMenuItem(b.ExplorerContext,{group:"2_workspace",order:30,command:{id:Sl,title:Um},when:v.and(At,ct,v.and(Fa.notEqualsTo("0"),v.or(Pl,Ll.isEqualTo("workspace"))))});_.appendMenuItem(b.ExplorerContext,{group:"7_modification",order:10,command:{id:Uh,title:Km,precondition:ze},when:At.toNegated()});_.appendMenuItem(b.ExplorerContext,{group:"7_modification",order:20,command:{id:Kh,title:$m,precondition:ze},alt:{id:Tn,title:p("deleteFile","Delete Permanently"),precondition:ze},when:v.and(At.toNegated(),Sn)});_.appendMenuItem(b.ExplorerContext,{group:"7_modification",order:20,command:{id:Tn,title:p("deleteFile","Delete Permanently"),precondition:ze},when:v.and(At.toNegated(),Sn.toNegated())});for(const c of[b.EmptyEditorGroupContext,b.EditorTabsBarContext])_.appendMenuItem(c,{command:{id:Ma,title:p("newFile","New Text File")},group:"1_file",order:10}),_.appendMenuItem(c,{command:{id:"workbench.action.quickOpen",title:p("openFile","Open File...")},group:"1_file",order:20});_.appendMenuItem(b.MenubarGoMenu,{group:"3_global_nav",command:{id:"workbench.action.quickOpen",title:p({key:"miGotoFile",comment:["&& denotes a mnemonic"]},"Go to &&File...")},order:1});var Wv=".monaco-workbench .call-hierarchy .message,.monaco-workbench .call-hierarchy .results{display:none}.monaco-workbench .call-hierarchy[data-state=data] .results{display:inherit;height:100%}.monaco-workbench .call-hierarchy[data-state=message] .message{align-items:center;display:flex;height:100%;justify-content:center}.monaco-workbench .call-hierarchy .editor,.monaco-workbench .call-hierarchy .tree{height:100%}.monaco-editor .call-hierarchy .tree{background-color:var(--vscode-peekViewResult-background);color:var(--vscode-peekViewResult-fileForeground)}.monaco-workbench .call-hierarchy .tree .callhierarchy-element{align-items:center;display:flex;flex:1;flex-flow:row nowrap}.monaco-workbench .call-hierarchy .tree .callhierarchy-element .monaco-icon-label{padding-left:4px}.monaco-editor .call-hierarchy .tree .monaco-list:focus .monaco-list-rows>.monaco-list-row.selected:not(.highlighted){background-color:var(--vscode-peekViewResult-selectionBackground);color:var(--vscode-peekViewResult-selectionForeground)!important}.monaco-editor .call-hierarchy .call-decoration{background-color:var(--vscode-peekViewEditor-matchHighlightBackground);border:2px solid var(--vscode-peekViewEditor-matchHighlightBorder);box-sizing:border-box}.monaco-editor .call-hierarchy .editor .monaco-editor .inputarea.ime-input,.monaco-editor .call-hierarchy .editor .monaco-editor .monaco-editor-background{background-color:var(--vscode-peekViewEditor-background)}.monaco-editor .call-hierarchy .editor .monaco-editor .margin{background-color:var(--vscode-peekViewEditorGutter-background)}";be(Wv,{});class Fs{constructor(e,t,i,o){this.item=e,this.locations=t,this.model=i,this.parent=o}static compare(e,t){let i=Nl(e.item.uri.toString(),t.item.uri.toString());return i===0&&(i=tt.compareRangesUsingStarts(e.item.range,t.item.range)),i}}let Gv=class{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof Ol)return e.roots.map(o=>new Fs(o,void 0,e,void 0));const{model:t,item:i}=e;return this.getDirection()==="outgoingCalls"?(await t.resolveOutgoingCalls(i,Fi.None)).map(o=>new Fs(o.to,o.fromRanges.map(s=>({range:s,uri:i.uri})),t,e)):(await t.resolveIncomingCalls(i,Fi.None)).map(o=>new Fs(o.from,o.fromRanges.map(s=>({range:s,uri:o.from.uri})),t,e))}},zv=class{compare(e,t){return Fs.compare(e,t)}},Uv=class{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}};class Kv{constructor(e,t){this.icon=e,this.label=t}}class ws{constructor(){this.templateId=ws.id}renderTemplate(e){e.classList.add("callhierarchy-element");const t=document.createElement("div");e.appendChild(t);const i=new Wa(e,{supportHighlights:!0});return new Kv(t,i)}renderElement(e,t,i){var r;const{element:o,filterData:s}=e,n=(r=o.item.tags)==null?void 0:r.includes(1);i.icon.className="",i.icon.classList.add("inline",...me.asClassNameArray(Ml.toIcon(o.item.kind))),i.label.setLabel(o.item.name,o.item.detail,{labelEscapeNewLines:!0,matches:Wo(s),strikethrough:n})}disposeTemplate(e){e.label.dispose()}}ws.id="CallRenderer";let $v=class{getHeight(e){return 22}getTemplateId(e){return ws.id}},jv=class{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return p("tree.aria","Call Hierarchy")}getAriaLabel(e){return this.getDirection()==="outgoingCalls"?p("from","calls from {0}",e.item.name):p("to","callers of {0}",e.item.name)}},ud=class{static store(e,t){t.store("callHierarchyPeekLayout",JSON.stringify(e),0,1)}static retrieve(e){const t=e.get("callHierarchyPeekLayout",0,"{}"),i={ratio:.7,height:17};try{return{...i,...JSON.parse(t)}}catch{return i}}constructor(e,t){this.ratio=e,this.height=t}};class qv extends as{}let Bi=class eu extends Bl{constructor(e,t,i,o,s,n,r,a,d,l,u){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},u),this._where=t,this._direction=i,this._peekViewService=s,this._editorService=n,this._textModelService=r,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=u,this._treeViewStates=new Map,this._previewDisposable=new A,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){ud.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){const t=e.getColor(Hl)||bi.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(Wl)||bi.transparent,primaryHeadingColor:e.getColor(Gl),secondaryHeadingColor:e.getColor(zl)})}_fillHead(e){super._fillHead(e,!0);const t=this._menuService.createMenu(eu.TitleMenu,this._contextKeyService),i=()=>{const o=[];Ui(t,void 0,o),this._actionbarWidget.clear(),this._actionbarWidget.push(o,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=ud.retrieve(this._storageService),this._dim=new G(0,0),this._parent=e,e.classList.add("call-hierarchy");const t=document.createElement("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;const i=document.createElement("div");i.classList.add("results"),e.appendChild(i),this._splitView=new Bo(i,{orientation:1});const o=document.createElement("div");o.classList.add("editor"),i.appendChild(o);const s={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._editor=this._instantiationService.createInstance(Na,o,s,{},this.editor);const n=document.createElement("div");n.classList.add("tree"),i.appendChild(n);const r={sorter:new zv,accessibilityProvider:new jv(()=>this._direction),identityProvider:new Uv(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:ql}};this._tree=this._instantiationService.createInstance(qv,"CallHierarchyPeek",n,new $v,[this._instantiationService.createInstance(ws)],this._instantiationService.createInstance(Gv,()=>this._direction),r),this._splitView.addView({onDidChange:I.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:a})}},yt.Distribute),this._splitView.addView({onDidChange:I.None,element:n,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._tree.layout(this._dim.height,a)}},yt.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(a=>{const{event:d,target:l}=a;if(d.detail!==2)return;const[u]=this._tree.getFocus();u&&(this.dispose(),this._editorService.openEditor({resource:u.item.uri,options:{selection:l.range}}))})),this._disposables.add(this._tree.onMouseDblClick(a=>{a.target!==Ul.Twistie&&a.element&&(this.dispose(),this._editorService.openEditor({resource:a.element.item.uri,options:{selection:a.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(a=>{const[d]=a.elements;d&&a.browserEvent instanceof KeyboardEvent&&(this.dispose(),this._editorService.openEditor({resource:d.item.uri,options:{selection:d.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){const[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();const t={description:"call-hierarchy-decoration",stickiness:1,className:"call-decoration",overviewRuler:{color:Kl($l),position:jl.Center}};let i;this._direction==="outgoingCalls"?i=e.parent?e.parent.item.uri:e.model.root.uri:i=e.item.uri;const o=await this._textModelService.createModelReference(i);this._editor.setModel(o.object.textEditorModel);const s=[];let n,r=e.locations;r||(r=[{uri:e.item.uri,range:e.item.selectionRange}]);for(const d of r)d.uri.toString()===i.toString()&&(s.push({range:d.range,options:t}),n=n?tt.plusRange(d.range,n):d.range);if(n){this._editor.revealRangeInCenter(n,1);const d=this._editor.createDecorationsCollection(s);this._previewDisposable.add(ie(()=>d.clear()))}this._previewDisposable.add(o);const a=this._direction==="outgoingCalls"?p("callFrom","Calls from '{0}'",e.model.root.name):p("callsTo","Callers of '{0}'",e.model.root.name);this.setTitle(a)}showLoading(){this._parent.dataset.state="loading",this.setTitle(p("title.loading","Loading...")),this._show()}showMessage(e){this._parent.dataset.state="message",this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();const t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);const i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),i.children.length===0?this.showMessage(this._direction==="outgoingCalls"?p("empt.callsFrom","No calls from '{0}'",e.root.name):p("empt.callsTo","No callers of '{0}'",e.root.name)):(this._parent.dataset.state="data",(!t||this._tree.getFocus().length===0)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){const t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,0),super.show(tt.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new G(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}};Bi.TitleMenu=new b("callhierarchy/title");Bi=x([h(3,X),h(4,Fl),h(5,U),h(6,ns),h(7,Se),h(8,Xe),h(9,H),h(10,D)],Bi);const Jr=new N("editorHasCallHierarchyProvider",!1,p("editorHasCallHierarchyProvider","Whether a call hierarchy provider is available")),ys=new N("callHierarchyVisible",!1,p("callHierarchyVisible","Whether call hierarchy peek is currently showing")),Qo=new N("callHierarchyDirection",void 0,{type:"string",description:p("callHierarchyDirection","Whether call hierarchy shows incoming or outgoing calls")});function Yv(c){return c==="outgoingCalls"||c==="incomingCalls"?c:"incomingCalls"}let xt=class ko{static get(e){return e.getContribution(ko.Id)}constructor(e,t,i,o,s){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=s,this._dispoables=new A,this._sessionDisposables=new A,this._ctxIsVisible=ys.bindTo(this._contextKeyService),this._ctxHasProvider=Jr.bindTo(this._contextKeyService),this._ctxDirection=Qo.bindTo(this._contextKeyService),this._dispoables.add(I.any(e.onDidChangeModel,e.onDidChangeModelLanguage,Gn.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&Gn.has(e.getModel()))})),this._dispoables.add(this._sessionDisposables)}dispose(){this._ctxHasProvider.reset(),this._ctxIsVisible.reset(),this._dispoables.dispose()}async startCallHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition();if(!Gn.has(e))return;const i=new st,o=Ol.create(e,t,i.token),s=Yv(this._storageService.get(ko._StorageDirection,0,"incomingCalls"));this._showCallHierarchyWidget(t,s,o,i)}async startCallHierarchyFromCallHierarchy(){var s;if(!this._widget)return;const e=this._widget.getModel(),t=this._widget.getFocused();if(!t||!e)return;const i=await this._editorService.openCodeEditor({resource:t.item.uri},this._editor);if(!i)return;const o=e.fork(t.item);this._sessionDisposables.clear(),(s=ko.get(i))==null||s._showCallHierarchyWidget(tt.lift(o.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(o),new st)}_showCallHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),I.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endCallHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(Bi,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endCallHierarchy(),this._storageService.store(ko._StorageDirection,this._widget.direction,0,0)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(s=>{o.token.isCancellationRequested||(s?(this._sessionDisposables.add(s),this._widget.showModel(s)):this._widget.showMessage(p("no.item","No results")))}).catch(s=>{if(Gi(s)){this.endCallHierarchy();return}this._widget.showMessage(p("error","Failed to show call hierarchy"))})}showOutgoingCalls(){var e;(e=this._widget)==null||e.updateDirection("outgoingCalls"),this._ctxDirection.set("outgoingCalls")}showIncomingCalls(){var e;(e=this._widget)==null||e.updateDirection("incomingCalls"),this._ctxDirection.set("incomingCalls")}endCallHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}};xt.Id="callHierarchy";xt._StorageDirection="callHierarchy/defaultDirection";xt=x([h(1,H),h(2,Se),h(3,gs),h(4,D)],xt);Yl(xt.Id,xt,0);te(class extends jt{constructor(){super({id:"editor.showCallHierarchy",title:{value:p("title","Peek Call Hierarchy"),original:"Peek Call Hierarchy"},menu:{id:b.EditorContextPeek,group:"navigation",order:1e3,when:v.and(Jr,$s.notInPeekEditor)},keybinding:{when:hs.editorTextFocus,weight:200,primary:1024+512+38},precondition:v.and(Jr,$s.notInPeekEditor)})}async runEditorCommand(c,e){var t;return(t=xt.get(e))==null?void 0:t.startCallHierarchyFromEditor()}});te(class extends jt{constructor(){super({id:"editor.showIncomingCalls",title:{value:p("title.incoming","Show Incoming Calls"),original:"Show Incoming Calls"},icon:pe("callhierarchy-incoming",M.callIncoming,p("showIncomingCallsIcons","Icon for incoming calls in the call hierarchy view.")),precondition:v.and(ys,Qo.isEqualTo("outgoingCalls")),keybinding:{weight:200,primary:1024+512+38},menu:{id:Bi.TitleMenu,when:Qo.isEqualTo("outgoingCalls"),order:1}})}runEditorCommand(c,e){var t;return(t=xt.get(e))==null?void 0:t.showIncomingCalls()}});te(class extends jt{constructor(){super({id:"editor.showOutgoingCalls",title:{value:p("title.outgoing","Show Outgoing Calls"),original:"Show Outgoing Calls"},icon:pe("callhierarchy-outgoing",M.callOutgoing,p("showOutgoingCallsIcon","Icon for outgoing calls in the call hierarchy view.")),precondition:v.and(ys,Qo.isEqualTo("incomingCalls")),keybinding:{weight:200,primary:1024+512+38},menu:{id:Bi.TitleMenu,when:Qo.isEqualTo("incomingCalls"),order:1}})}runEditorCommand(c,e){var t;return(t=xt.get(e))==null?void 0:t.showOutgoingCalls()}});te(class extends jt{constructor(){super({id:"editor.refocusCallHierarchy",title:{value:p("title.refocus","Refocus Call Hierarchy"),original:"Refocus Call Hierarchy"},precondition:ys,keybinding:{weight:200,primary:1024+3}})}async runEditorCommand(c,e){var t;return(t=xt.get(e))==null?void 0:t.startCallHierarchyFromCallHierarchy()}});te(class extends jt{constructor(){super({id:"editor.closeCallHierarchy",title:p("close","Close"),icon:M.close,precondition:ys,keybinding:{weight:200+10,primary:9,when:v.not("config.editor.stablePeek")},menu:{id:Bi.TitleMenu,order:1e3}})}runEditorCommand(c,e){var t;return(t=xt.get(e))==null?void 0:t.endCallHierarchy()}});var Xv=".monaco-workbench .type-hierarchy .message,.monaco-workbench .type-hierarchy .results{display:none}.monaco-workbench .type-hierarchy[data-state=data] .results{display:inherit;height:100%}.monaco-workbench .type-hierarchy[data-state=message] .message{align-items:center;display:flex;height:100%;justify-content:center}.monaco-workbench .type-hierarchy .editor,.monaco-workbench .type-hierarchy .tree{height:100%}.monaco-editor .type-hierarchy .tree{background-color:var(--vscode-peekViewResult-background);color:var(--vscode-peekViewResult-fileForeground)}.monaco-editor .type-hierarchy .tree .monaco-list:focus .monaco-list-rows>.monaco-list-row.selected:not(.highlighted){background-color:var(--vscode-peekViewResult-selectionBackground);color:var(--vscode-peekViewResult-selectionForeground)!important}.monaco-workbench .type-hierarchy .tree .typehierarchy-element{align-items:center;display:flex;flex:1;flex-flow:row nowrap}.monaco-workbench .type-hierarchy .tree .typehierarchy-element .monaco-icon-label{padding-left:4px}.monaco-editor .type-hierarchy .type-decoration{background-color:var(--vscode-peekViewEditor-matchHighlightBackground);border:2px solid var(--vscode-peekViewEditor-matchHighlightBorder);box-sizing:border-box}.monaco-editor .type-hierarchy .editor .monaco-editor .inputarea.ime-input,.monaco-editor .type-hierarchy .editor .monaco-editor .monaco-editor-background{background-color:var(--vscode-peekViewEditor-background)}.monaco-editor .type-hierarchy .editor .monaco-editor .margin{background-color:var(--vscode-peekViewEditorGutter-background)}";be(Xv,{});class Bs{constructor(e,t,i){this.item=e,this.model=t,this.parent=i}static compare(e,t){let i=Nl(e.item.uri.toString(),t.item.uri.toString());return i===0&&(i=tt.compareRangesUsingStarts(e.item.range,t.item.range)),i}}class Jv{constructor(e){this.getDirection=e}hasChildren(){return!0}async getChildren(e){if(e instanceof Xl)return e.roots.map(o=>new Bs(o,e,void 0));const{model:t,item:i}=e;return this.getDirection()==="supertypes"?(await t.provideSupertypes(i,Fi.None)).map(o=>new Bs(o,t,e)):(await t.provideSubtypes(i,Fi.None)).map(o=>new Bs(o,t,e))}}class Zv{compare(e,t){return Bs.compare(e,t)}}class Qv{constructor(e){this.getDirection=e}getId(e){let t=this.getDirection()+JSON.stringify(e.item.uri)+JSON.stringify(e.item.range);return e.parent&&(t+=this.getId(e.parent)),t}}class ew{constructor(e,t){this.icon=e,this.label=t}}class Cs{constructor(){this.templateId=Cs.id}renderTemplate(e){e.classList.add("typehierarchy-element");const t=document.createElement("div");e.appendChild(t);const i=new Wa(e,{supportHighlights:!0});return new ew(t,i)}renderElement(e,t,i){var r;const{element:o,filterData:s}=e,n=(r=o.item.tags)==null?void 0:r.includes(1);i.icon.classList.add("inline",...me.asClassNameArray(Ml.toIcon(o.item.kind))),i.label.setLabel(o.item.name,o.item.detail,{labelEscapeNewLines:!0,matches:Wo(s),strikethrough:n})}disposeTemplate(e){e.label.dispose()}}Cs.id="TypeRenderer";class tw{getHeight(e){return 22}getTemplateId(e){return Cs.id}}class iw{constructor(e){this.getDirection=e}getWidgetAriaLabel(){return p("tree.aria","Type Hierarchy")}getAriaLabel(e){return this.getDirection()==="supertypes"?p("supertypes","supertypes of {0}",e.item.name):p("subtypes","subtypes of {0}",e.item.name)}}class pd{static store(e,t){t.store("typeHierarchyPeekLayout",JSON.stringify(e),0,1)}static retrieve(e){const t=e.get("typeHierarchyPeekLayout",0,"{}"),i={ratio:.7,height:17};try{return{...i,...JSON.parse(t)}}catch{return i}}constructor(e,t){this.ratio=e,this.height=t}}class ow extends as{}let Hi=class tu extends Bl{constructor(e,t,i,o,s,n,r,a,d,l,u){super(e,{showFrame:!0,showArrow:!0,isResizeable:!0,isAccessible:!0},u),this._where=t,this._direction=i,this._peekViewService=s,this._editorService=n,this._textModelService=r,this._storageService=a,this._menuService=d,this._contextKeyService=l,this._instantiationService=u,this._treeViewStates=new Map,this._previewDisposable=new A,this.create(),this._peekViewService.addExclusiveWidget(e,this),this._applyTheme(o.getColorTheme()),this._disposables.add(o.onDidColorThemeChange(this._applyTheme,this)),this._disposables.add(this._previewDisposable)}dispose(){pd.store(this._layoutInfo,this._storageService),this._splitView.dispose(),this._tree.dispose(),this._editor.dispose(),super.dispose()}get direction(){return this._direction}_applyTheme(e){const t=e.getColor(Hl)||bi.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(Wl)||bi.transparent,primaryHeadingColor:e.getColor(Gl),secondaryHeadingColor:e.getColor(zl)})}_fillHead(e){super._fillHead(e,!0);const t=this._menuService.createMenu(tu.TitleMenu,this._contextKeyService),i=()=>{const o=[];Ui(t,void 0,o),this._actionbarWidget.clear(),this._actionbarWidget.push(o,{label:!1,icon:!0})};this._disposables.add(t),this._disposables.add(t.onDidChange(i)),i()}_fillBody(e){this._layoutInfo=pd.retrieve(this._storageService),this._dim=new G(0,0),this._parent=e,e.classList.add("type-hierarchy");const t=document.createElement("div");t.classList.add("message"),e.appendChild(t),this._message=t,this._message.tabIndex=0;const i=document.createElement("div");i.classList.add("results"),e.appendChild(i),this._splitView=new Bo(i,{orientation:1});const o=document.createElement("div");o.classList.add("editor"),i.appendChild(o);const s={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._editor=this._instantiationService.createInstance(Na,o,s,{},this.editor);const n=document.createElement("div");n.classList.add("tree"),i.appendChild(n);const r={sorter:new Zv,accessibilityProvider:new iw(()=>this._direction),identityProvider:new Qv(()=>this._direction),expandOnlyOnTwistieClick:!0,overrideStyles:{listBackground:ql}};this._tree=this._instantiationService.createInstance(ow,"TypeHierarchyPeek",n,new tw,[this._instantiationService.createInstance(Cs)],this._instantiationService.createInstance(Jv,()=>this._direction),r),this._splitView.addView({onDidChange:I.None,element:o,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._editor.layout({height:this._dim.height,width:a})}},yt.Distribute),this._splitView.addView({onDidChange:I.None,element:n,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:a=>{this._dim.height&&this._tree.layout(this._dim.height,a)}},yt.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this._layoutInfo.ratio=this._splitView.getViewSize(0)/this._dim.width)})),this._disposables.add(this._tree.onDidChangeFocus(this._updatePreview,this)),this._disposables.add(this._editor.onMouseDown(a=>{const{event:d,target:l}=a;if(d.detail!==2)return;const[u]=this._tree.getFocus();u&&(this.dispose(),this._editorService.openEditor({resource:u.item.uri,options:{selection:l.range}}))})),this._disposables.add(this._tree.onMouseDblClick(a=>{a.target!==Ul.Twistie&&a.element&&(this.dispose(),this._editorService.openEditor({resource:a.element.item.uri,options:{selection:a.element.item.selectionRange,pinned:!0}}))})),this._disposables.add(this._tree.onDidChangeSelection(a=>{const[d]=a.elements;d&&a.browserEvent instanceof KeyboardEvent&&(this.dispose(),this._editorService.openEditor({resource:d.item.uri,options:{selection:d.item.selectionRange,pinned:!0}}))}))}async _updatePreview(){const[e]=this._tree.getFocus();if(!e)return;this._previewDisposable.clear();const t={description:"type-hierarchy-decoration",stickiness:1,className:"type-decoration",overviewRuler:{color:Kl($l),position:jl.Center}};let i;this._direction==="supertypes"?i=e.parent?e.parent.item.uri:e.model.root.uri:i=e.item.uri;const o=await this._textModelService.createModelReference(i);this._editor.setModel(o.object.textEditorModel);const s=[];let n;const r={uri:e.item.uri,range:e.item.selectionRange};if(r.uri.toString()===i.toString()&&(s.push({range:r.range,options:t}),n=n?tt.plusRange(r.range,n):r.range),n){this._editor.revealRangeInCenter(n,1);const d=this._editor.createDecorationsCollection(s);this._previewDisposable.add(ie(()=>d.clear()))}this._previewDisposable.add(o);const a=this._direction==="supertypes"?p("supertypes","Supertypes of '{0}'",e.model.root.name):p("subtypes","Subtypes of '{0}'",e.model.root.name);this.setTitle(a)}showLoading(){this._parent.dataset.state="loading",this.setTitle(p("title.loading","Loading...")),this._show()}showMessage(e){this._parent.dataset.state="message",this.setTitle(""),this.setMetaTitle(""),this._message.innerText=e,this._show(),this._message.focus()}async showModel(e){this._show();const t=this._treeViewStates.get(this._direction);await this._tree.setInput(e,t);const i=this._tree.getNode(e).children[0];await this._tree.expand(i.element),i.children.length===0?this.showMessage(this._direction==="supertypes"?p("empt.supertypes","No supertypes of '{0}'",e.root.name):p("empt.subtypes","No subtypes of '{0}'",e.root.name)):(this._parent.dataset.state="data",(!t||this._tree.getFocus().length===0)&&this._tree.setFocus([i.children[0].element]),this._tree.domFocus(),this._updatePreview())}getModel(){return this._tree.getInput()}getFocused(){return this._tree.getFocus()[0]}async updateDirection(e){const t=this._tree.getInput();t&&e!==this._direction&&(this._treeViewStates.set(this._direction,this._tree.getViewState()),this._direction=e,await this.showModel(t))}_show(){this._isShowing||(this.editor.revealLineInCenterIfOutsideViewport(this._where.lineNumber,0),super.show(tt.fromPositions(this._where),this._layoutInfo.height))}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){(this._dim.height!==e||this._dim.width!==t)&&(super._doLayoutBody(e,t),this._dim=new G(t,e),this._layoutInfo.height=this._viewZone?this._viewZone.heightInLines:this._layoutInfo.height,this._splitView.layout(t),this._splitView.resizeView(0,t*this._layoutInfo.ratio))}};Hi.TitleMenu=new b("typehierarchy/title");Hi=x([h(3,X),h(4,Fl),h(5,U),h(6,ns),h(7,Se),h(8,Xe),h(9,H),h(10,D)],Hi);const Zr=new N("editorHasTypeHierarchyProvider",!1,p("editorHasTypeHierarchyProvider","Whether a type hierarchy provider is available")),Ss=new N("typeHierarchyVisible",!1,p("typeHierarchyVisible","Whether type hierarchy peek is currently showing")),es=new N("typeHierarchyDirection",void 0,{type:"string",description:p("typeHierarchyDirection","whether type hierarchy shows super types or subtypes")});function sw(c){return c==="subtypes"||c==="supertypes"?c:"subtypes"}let Dt=class xo{static get(e){return e.getContribution(xo.Id)}constructor(e,t,i,o,s){this._editor=e,this._contextKeyService=t,this._storageService=i,this._editorService=o,this._instantiationService=s,this._disposables=new A,this._sessionDisposables=new A,this._ctxHasProvider=Zr.bindTo(this._contextKeyService),this._ctxIsVisible=Ss.bindTo(this._contextKeyService),this._ctxDirection=es.bindTo(this._contextKeyService),this._disposables.add(I.any(e.onDidChangeModel,e.onDidChangeModelLanguage,zn.onDidChange)(()=>{this._ctxHasProvider.set(e.hasModel()&&zn.has(e.getModel()))})),this._disposables.add(this._sessionDisposables)}dispose(){this._disposables.dispose()}async startTypeHierarchyFromEditor(){if(this._sessionDisposables.clear(),!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getPosition();if(!zn.has(e))return;const i=new st,o=Xl.create(e,t,i.token),s=sw(this._storageService.get(xo._storageDirectionKey,0,"subtypes"));this._showTypeHierarchyWidget(t,s,o,i)}_showTypeHierarchyWidget(e,t,i,o){this._ctxIsVisible.set(!0),this._ctxDirection.set(t),I.any(this._editor.onDidChangeModel,this._editor.onDidChangeModelLanguage)(this.endTypeHierarchy,this,this._sessionDisposables),this._widget=this._instantiationService.createInstance(Hi,this._editor,e,t),this._widget.showLoading(),this._sessionDisposables.add(this._widget.onDidClose(()=>{this.endTypeHierarchy(),this._storageService.store(xo._storageDirectionKey,this._widget.direction,0,0)})),this._sessionDisposables.add({dispose(){o.dispose(!0)}}),this._sessionDisposables.add(this._widget),i.then(s=>{o.token.isCancellationRequested||(s?(this._sessionDisposables.add(s),this._widget.showModel(s)):this._widget.showMessage(p("no.item","No results")))}).catch(s=>{if(Gi(s)){this.endTypeHierarchy();return}this._widget.showMessage(p("error","Failed to show type hierarchy"))})}async startTypeHierarchyFromTypeHierarchy(){var s;if(!this._widget)return;const e=this._widget.getModel(),t=this._widget.getFocused();if(!t||!e)return;const i=await this._editorService.openCodeEditor({resource:t.item.uri},this._editor);if(!i)return;const o=e.fork(t.item);this._sessionDisposables.clear(),(s=xo.get(i))==null||s._showTypeHierarchyWidget(tt.lift(o.root.selectionRange).getStartPosition(),this._widget.direction,Promise.resolve(o),new st)}showSupertypes(){var e;(e=this._widget)==null||e.updateDirection("supertypes"),this._ctxDirection.set("supertypes")}showSubtypes(){var e;(e=this._widget)==null||e.updateDirection("subtypes"),this._ctxDirection.set("subtypes")}endTypeHierarchy(){this._sessionDisposables.clear(),this._ctxIsVisible.set(!1),this._editor.focus()}};Dt.Id="typeHierarchy";Dt._storageDirectionKey="typeHierarchy/defaultDirection";Dt=x([h(1,H),h(2,Se),h(3,gs),h(4,D)],Dt);Yl(Dt.Id,Dt,0);te(class extends jt{constructor(){super({id:"editor.showTypeHierarchy",title:{value:p("title","Peek Type Hierarchy"),original:"Peek Type Hierarchy"},menu:{id:b.EditorContextPeek,group:"navigation",order:1e3,when:v.and(Zr,$s.notInPeekEditor)},precondition:v.and(Zr,$s.notInPeekEditor)})}async runEditorCommand(c,e){var t;return(t=Dt.get(e))==null?void 0:t.startTypeHierarchyFromEditor()}});te(class extends jt{constructor(){super({id:"editor.showSupertypes",title:{value:p("title.supertypes","Show Supertypes"),original:"Show Supertypes"},icon:M.typeHierarchySuper,precondition:v.and(Ss,es.isEqualTo("subtypes")),keybinding:{weight:200,primary:1024+512+38},menu:{id:Hi.TitleMenu,when:es.isEqualTo("subtypes"),order:1}})}runEditorCommand(c,e){var t;return(t=Dt.get(e))==null?void 0:t.showSupertypes()}});te(class extends jt{constructor(){super({id:"editor.showSubtypes",title:{value:p("title.subtypes","Show Subtypes"),original:"Show Subtypes"},icon:M.typeHierarchySub,precondition:v.and(Ss,es.isEqualTo("supertypes")),keybinding:{weight:200,primary:1024+512+38},menu:{id:Hi.TitleMenu,when:es.isEqualTo("supertypes"),order:1}})}runEditorCommand(c,e){var t;return(t=Dt.get(e))==null?void 0:t.showSubtypes()}});te(class extends jt{constructor(){super({id:"editor.refocusTypeHierarchy",title:{value:p("title.refocusTypeHierarchy","Refocus Type Hierarchy"),original:"Refocus Type Hierarchy"},precondition:Ss,keybinding:{weight:200,primary:1024+3}})}async runEditorCommand(c,e){var t;return(t=Dt.get(e))==null?void 0:t.startTypeHierarchyFromTypeHierarchy()}});te(class extends jt{constructor(){super({id:"editor.closeTypeHierarchy",title:p("close","Close"),icon:M.close,precondition:Ss,keybinding:{weight:200+10,primary:9,when:v.not("config.editor.stablePeek")},menu:{id:Hi.TitleMenu,order:1e3}})}runEditorCommand(c,e){var t;return(t=Dt.get(e))==null?void 0:t.endTypeHierarchy()}});function dc(c){c&&c.getHTMLElement()!==document.activeElement&&c.domFocus()}async function nw(c,e){if(!Zl.getValue(c.contextKeyService))return e(c);const t=c.getFocus(),i=c.getSelection();await e(c);const o=c.getFocus();if(i.length>1||!co(t,i)||co(t,o))return;const s=new KeyboardEvent("keydown");c.setSelection(o,s)}async function Gt(c,e){if(!c)return;await nw(c,e);const t=c.getFocus();t.length&&c.reveal(t[0]),c.setAnchor(t[0]),dc(c)}k.registerCommandAndKeybindingRule({id:"list.focusDown",weight:200,when:Y,primary:18,mac:{primary:18,secondary:[300]},handler:(c,e)=>{Gt(c.get(O).lastFocusedList,async t=>{const i=new KeyboardEvent("keydown");await t.focusNext(typeof e=="number"?e:1,!1,i)})}});k.registerCommandAndKeybindingRule({id:"list.focusUp",weight:200,when:Y,primary:16,mac:{primary:16,secondary:[302]},handler:(c,e)=>{Gt(c.get(O).lastFocusedList,async t=>{const i=new KeyboardEvent("keydown");await t.focusPrevious(typeof e=="number"?e:1,!1,i)})}});k.registerCommandAndKeybindingRule({id:"list.focusPageDown",weight:200,when:Y,primary:12,handler:c=>{Gt(c.get(O).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusNextPage(t)})}});k.registerCommandAndKeybindingRule({id:"list.focusPageUp",weight:200,when:Y,primary:11,handler:c=>{Gt(c.get(O).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusPreviousPage(t)})}});k.registerCommandAndKeybindingRule({id:"list.focusFirst",weight:200,when:Y,primary:14,handler:c=>{Gt(c.get(O).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusFirst(t)})}});k.registerCommandAndKeybindingRule({id:"list.focusLast",weight:200,when:Y,primary:13,handler:c=>{Gt(c.get(O).lastFocusedList,async e=>{const t=new KeyboardEvent("keydown");await e.focusLast(t)})}});function iu(c,e){if(c instanceof fs||c instanceof bs||c instanceof vs){const t=c,i=t.getFocus()?t.getFocus()[0]:void 0,o=t.getSelection();o&&typeof i=="number"&&o.indexOf(i)>=0?t.setSelection(o.filter(s=>s!==e)):typeof i=="number"&&t.setSelection(o.concat(i))}else if(c instanceof Si||c instanceof Ei||c instanceof mt){const t=c,i=t.getFocus()?t.getFocus()[0]:void 0;if(e===i)return;const o=t.getSelection(),s=new KeyboardEvent("keydown",{shiftKey:!0});o&&o.indexOf(i)>=0?t.setSelection(o.filter(n=>n!==e),s):t.setSelection(o.concat(i),s)}}k.registerCommandAndKeybindingRule({id:"list.expandSelectionDown",weight:200,when:v.and(Y,Ga),primary:1042,handler:(c,e)=>{const t=c.get(O).lastFocusedList;if(!t)return;const i=t.getFocus()?t.getFocus()[0]:void 0,o=new KeyboardEvent("keydown");t.focusNext(typeof e=="number"?e:1,!1,o),iu(t,i);const s=t.getFocus();s.length&&t.reveal(s[0]),dc(t)}});k.registerCommandAndKeybindingRule({id:"list.expandSelectionUp",weight:200,when:v.and(Y,Ga),primary:1040,handler:(c,e)=>{const t=c.get(O).lastFocusedList;if(!t)return;const i=t.getFocus()?t.getFocus()[0]:void 0,o=new KeyboardEvent("keydown");t.focusPrevious(typeof e=="number"?e:1,!1,o),iu(t,i);const s=t.getFocus();s.length&&t.reveal(s[0]),dc(t)}});k.registerCommandAndKeybindingRule({id:"list.collapse",weight:200,when:v.and(Y,v.or(jm,qm)),primary:15,mac:{primary:15,secondary:[2064]},handler:c=>{const e=c.get(O).lastFocusedList;if(!e||!(e instanceof Si||e instanceof Ei||e instanceof mt))return;const t=e,i=t.getFocus();if(i.length===0)return;const o=i[0];if(!t.collapse(o)){const s=t.getParentElement(o);s&&Gt(e,n=>{const r=new KeyboardEvent("keydown");n.setFocus([s],r)})}}});k.registerCommandAndKeybindingRule({id:"list.collapseAll",weight:200,when:Y,primary:2063,mac:{primary:2063,secondary:[3088]},handler:c=>{const e=c.get(O).lastFocusedList;e&&!(e instanceof fs||e instanceof bs||e instanceof vs)&&e.collapseAll()}});k.registerCommandAndKeybindingRule({id:"list.collapseAllToFocus",weight:200,when:Y,handler:c=>{const e=c.get(O).lastFocusedList,t=Jl("keydown",!0);if(e instanceof Si||e instanceof Ei||e instanceof mt){const i=e,o=i.getFocus();o.length>0&&i.collapse(o[0],!0),i.setSelection(o,t),i.setAnchor(o[0])}}});k.registerCommandAndKeybindingRule({id:"list.focusParent",weight:200,when:Y,handler:c=>{const e=c.get(O).lastFocusedList;if(!e||!(e instanceof Si||e instanceof Ei||e instanceof mt))return;const t=e,i=t.getFocus();if(i.length===0)return;const o=i[0],s=t.getParentElement(o);s&&Gt(e,n=>{const r=new KeyboardEvent("keydown");n.setFocus([s],r)})}});k.registerCommandAndKeybindingRule({id:"list.expand",weight:200,when:v.and(Y,v.or(Ym,Xm)),primary:17,handler:c=>{const e=c.get(O).lastFocusedList;if(e){if(e instanceof Si||e instanceof Ei){const t=e.getFocus();if(t.length===0)return;const i=t[0];if(!e.expand(i)){const o=e.getFirstElementChild(i);o&&e.getNode(o).visible&&Gt(e,n=>{const r=new KeyboardEvent("keydown");n.setFocus([o],r)})}}else if(e instanceof mt){const t=e.getFocus();if(t.length===0)return;const i=t[0];e.expand(i).then(o=>{if(i&&!o){const s=e.getFirstElementChild(i);s&&e.getNode(s).visible&&Gt(e,r=>{const a=new KeyboardEvent("keydown");r.setFocus([s],a)})}})}}}});function lc(c,e){const t=c.get(O).lastFocusedList,i=Jl("keydown",e);if(t instanceof fs||t instanceof bs||t instanceof vs){const o=t;o.setSelection(o.getFocus(),i),o.setAnchor(o.getFocus()[0])}else if(t instanceof Si||t instanceof Ei||t instanceof mt){const o=t,s=o.getFocus();if(s.length>0){let n=!0;(o.expandOnlyOnTwistieClick===!0||typeof o.expandOnlyOnTwistieClick!="boolean"&&o.expandOnlyOnTwistieClick(s[0]))&&(n=!1),n&&o.toggleCollapsed(s[0])}o.setSelection(s,i),o.setAnchor(s[0])}}k.registerCommandAndKeybindingRule({id:"list.select",weight:200,when:Y,primary:3,mac:{primary:3,secondary:[2066]},handler:c=>{lc(c,!1)}});k.registerCommandAndKeybindingRule({id:"list.selectAndPreserveFocus",weight:200,when:Y,handler:c=>{lc(c,!0)}});k.registerCommandAndKeybindingRule({id:"list.selectAll",weight:200,when:v.and(Y,Ga),primary:2079,handler:c=>{const e=c.get(O).lastFocusedList;if(e instanceof fs||e instanceof bs||e instanceof vs){const t=e,i=new KeyboardEvent("keydown");t.setSelection(Jm(t.length),i)}else if(e instanceof Si||e instanceof Ei||e instanceof mt){const t=e,i=t.getFocus(),o=t.getSelection();let s;i.length>0&&(o.length===0||!o.includes(i[0]))&&(s=i[0]),!s&&o.length>0&&(s=o[0]);let n;s?n=t.getParentElement(s):n=void 0;const r=[],a=l=>{for(const u of l.children)u.visible&&(r.push(u.element),u.collapsed||a(u))};a(t.getNode(n)),n&&o.length===r.length&&r.unshift(n);const d=new KeyboardEvent("keydown");t.setSelection(r,d)}}});k.registerCommandAndKeybindingRule({id:"list.toggleSelection",weight:200,when:Y,primary:3075,handler:c=>{const e=c.get(O).lastFocusedList;if(!e)return;const t=e.getFocus();if(t.length===0)return;const i=e.getSelection(),o=i.indexOf(t[0]);o>-1?e.setSelection([...i.slice(0,o),...i.slice(o+1)]):e.setSelection([...i,t[0]])}});k.registerCommandAndKeybindingRule({id:"list.toggleExpand",weight:200,when:Y,primary:10,handler:c=>{const e=c.get(O).lastFocusedList;if(e instanceof Si||e instanceof Ei||e instanceof mt){const t=e,i=t.getFocus();if(i.length>0&&t.isCollapsible(i[0])){t.toggleCollapsed(i[0]);return}}lc(c,!0)}});k.registerCommandAndKeybindingRule({id:"list.clear",weight:200,when:v.and(Y,Zm),primary:9,handler:c=>{const e=c.get(O).lastFocusedList;if(!e)return;const t=e.getSelection(),i=new KeyboardEvent("keydown");if(t.length>1)if(Zl.getValue(e.contextKeyService)){const s=e.getFocus();e.setSelection([s[0]],i)}else e.setSelection([],i);else e.setSelection([],i),e.setFocus([],i);e.setAnchor(void 0)}});q.registerCommand({id:"list.triggerTypeNavigation",handler:c=>{const e=c.get(O).lastFocusedList;e==null||e.triggerTypeNavigation()}});q.registerCommand({id:"list.toggleFindMode",handler:c=>{const e=c.get(O).lastFocusedList;if(e instanceof za||e instanceof mt){const t=e;t.findMode=t.findMode===Un.Filter?Un.Highlight:Un.Filter}}});q.registerCommandAlias("list.toggleKeyboardNavigation","list.triggerTypeNavigation");q.registerCommandAlias("list.toggleFilterOnType","list.toggleFindMode");k.registerCommandAndKeybindingRule({id:"list.find",weight:200,when:v.and(Ql,Qm),primary:2084,secondary:[61],handler:c=>{const e=c.get(O).lastFocusedList;e instanceof fs||e instanceof bs||e instanceof vs||(e instanceof za||e instanceof mt)&&e.openFind()}});k.registerCommandAndKeybindingRule({id:"list.closeFind",weight:200,when:v.and(Ql,ef),primary:9,handler:c=>{const e=c.get(O).lastFocusedList;(e instanceof za||e instanceof mt)&&e.closeFind()}});k.registerCommandAndKeybindingRule({id:"list.scrollUp",weight:200,when:Y,primary:2064,handler:c=>{const e=c.get(O).lastFocusedList;e&&(e.scrollTop-=10)}});k.registerCommandAndKeybindingRule({id:"list.scrollDown",weight:200,when:Y,primary:2066,handler:c=>{const e=c.get(O).lastFocusedList;e&&(e.scrollTop+=10)}});k.registerCommandAndKeybindingRule({id:"list.scrollLeft",weight:200,when:Y,handler:c=>{const e=c.get(O).lastFocusedList;e&&(e.scrollLeft-=10)}});k.registerCommandAndKeybindingRule({id:"list.scrollRight",weight:200,when:Y,handler:c=>{const e=c.get(O).lastFocusedList;e&&(e.scrollLeft+=10)}});var rw='.file-icon-themable-tree .align-icon-with-twisty .monaco-tl-twistie:not(.force-twistie):not(.collapsible),.file-icon-themable-tree .monaco-tl-twistie.force-no-twistie,.file-icon-themable-tree.align-icons-and-twisties .monaco-tl-twistie:not(.force-twistie):not(.collapsible),.file-icon-themable-tree.hide-arrows .monaco-tl-twistie:not(.force-twistie){background-image:none!important;padding-right:0!important;visibility:hidden;width:0!important}.file-icon-themable-tree .monaco-list-row .content .monaco-highlighted-label .highlight,.monaco-tl-contents .monaco-highlighted-label .highlight{background-color:var(--vscode-list-filterMatchBackground);color:unset!important;outline:1px dotted var(--vscode-list-filterMatchBorder);outline-offset:-1px}.monaco-workbench .tree-explorer-viewlet-tree-view{height:100%}.monaco-workbench .tree-explorer-viewlet-tree-view .message{display:flex;padding:4px 12px 4px 18px;user-select:text;-webkit-user-select:text}.monaco-workbench .tree-explorer-viewlet-tree-view .message p{margin-bottom:0;margin-top:0;padding-bottom:4px}.monaco-workbench .tree-explorer-viewlet-tree-view .message ul{padding-left:24px}.monaco-workbench .tree-explorer-viewlet-tree-view .message.hide{display:none}.monaco-workbench .tree-explorer-viewlet-tree-view .customview-tree{height:100%}.monaco-workbench .tree-explorer-viewlet-tree-view .customview-tree.hide{display:none}.monaco-workbench .pane>.pane-body>.welcome-view{box-sizing:border-box;display:flex;flex-direction:column;height:100%;width:100%}.monaco-workbench .pane>.pane-body.welcome>:not(.welcome-view),.monaco-workbench .pane>.pane-body:not(.welcome)>.welcome-view{display:none}.monaco-workbench .pane>.pane-body .welcome-view-content{align-items:center;box-sizing:border-box;display:flex;flex-direction:column;padding:0 20px 1em}.monaco-workbench .pane>.pane-body .welcome-view-content>.button-container{max-width:300px;width:100%}.monaco-workbench:not(.reduce-motion) .pane>.pane-body .welcome-view-content>.button-container{transition:max-width .2s ease-out}.monaco-workbench .pane>.pane-body .welcome-view-content.wide>.button-container{max-width:100%}.monaco-workbench .pane>.pane-body .welcome-view-content>.button-container>.monaco-button{max-width:300px}.monaco-workbench .pane>.pane-body .welcome-view-content>p{width:100%}.monaco-workbench .pane>.pane-body .welcome-view-content>*{margin-block-end:0;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.customview-tree .monaco-list-row .monaco-tl-contents.align-icon-with-twisty:before{display:none}.customview-tree .monaco-list-row .monaco-tl-contents:not(.align-icon-with-twisty):before{display:inline-block}.customview-tree .monaco-list .monaco-list-row{padding-left:0;padding-right:12px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item{display:flex;flex:1;flex-wrap:nowrap;height:22px;line-height:22px;overflow:hidden;padding-left:3px;text-overflow:ellipsis}.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item .custom-view-tree-node-item-checkbox{background-color:var(--vscode-checkbox-selectBackground);border:1px solid var(--vscode-checkbox-selectBorder)}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-checkbox{background-color:var(--vscode-checkbox-background);border:1px solid var(--vscode-checkbox-border);height:16px;margin:3px 6px 3px 0;opacity:1;padding:0;width:16px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-checkbox.codicon{font-size:13px;line-height:15px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .monaco-inputbox{flex:1;line-height:normal}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel{flex:1;overflow:hidden;text-overflow:ellipsis}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .monaco-icon-label-container:after{content:"";display:block}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon,.timeline-tree-view .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-icon{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;align-items:center;background-position:0;background-repeat:no-repeat;background-size:16px;display:flex;height:22px;justify-content:center;padding-right:6px;width:16px}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.disabled{opacity:.6}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.codicon.codicon-modifier-spin{margin-left:-6px;padding-left:6px}.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item>.custom-view-tree-node-item-resourceLabel>.custom-view-tree-node-item-icon.codicon{color:currentColor!important}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel .monaco-icon-label-container>.monaco-icon-name-container{flex:1}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .custom-view-tree-node-item-resourceLabel:after{margin-right:4px;padding-right:0}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .actions{display:none}.customview-tree .monaco-list .monaco-list-row .custom-view-tree-node-item .actions .action-label{padding:2px}.customview-tree .monaco-list .monaco-list-row.focused .custom-view-tree-node-item .actions,.customview-tree .monaco-list .monaco-list-row.selected .custom-view-tree-node-item .actions,.customview-tree .monaco-list .monaco-list-row:hover .custom-view-tree-node-item .actions{display:block}.viewpane-filter-container{cursor:default;display:flex}.viewpane-filter-container.grow{flex:1}.viewpane-filter-container>.viewpane-filter{align-items:center;display:flex;flex:1;position:relative}.viewpane-filter-container>.viewpane-filter .monaco-inputbox{flex:1;font-size:12px;height:24px}.pane-header .viewpane-filter-container>.viewpane-filter .monaco-inputbox .monaco-inputbox{height:20px;line-height:18px}.monaco-workbench.vs .viewpane-filter-container>.viewpane-filter .monaco-inputbox{height:25px}.viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls{align-items:center;bottom:0;display:flex;position:absolute;right:0;top:0}.viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls>.viewpane-filter-badge{border-radius:2px;margin:4px 0;padding:0 8px}.viewpane-filter.small>.viewpane-filter-controls>.viewpane-filter-badge,.viewpane-filter>.viewpane-filter-controls>.viewpane-filter-badge.hidden{display:none}.viewpane-filter>.viewpane-filter-controls>.monaco-action-bar .action-item .action-label.codicon.filter{padding:2px}.panel>.title .monaco-action-bar .action-item.viewpane-filter-container{margin-right:10px;max-width:400px;min-width:150px}.pane-body .viewpane-filter-container:not(:empty){flex:1;height:auto;margin:10px 20px}.pane-body .viewpane-filter-container>.viewpane-filter>.viewpane-filter-controls .monaco-action-bar .action-item{margin-right:4px}.viewpane-filter>.viewpane-filter-controls .monaco-action-bar .action-label.codicon.codicon-filter.checked{background-color:var(--vscode-inputOption-activeBackground);border-color:var(--vscode-inputOption-activeBorder);color:var(--vscode-inputOption-activeForeground)}';be(rw,{});class aw extends ke{constructor(e,t){super("vs.tree.collapse",p("collapse all","Collapse All"),"collapse-all",t),this.viewer=e}async run(){this.viewer.collapseAll(),this.viewer.setSelection([]),this.viewer.setFocus([])}}class cw extends R{constructor(){super(...arguments),this._onDidChangeCheckboxState=this._register(new y),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event}setCheckboxState(e){this._onDidChangeCheckboxState.fire([e])}}class Es extends R{constructor(e,t){super(),this.checkboxStateHandler=t,this.isDisposed=!1,this._onDidChangeState=new y,this.onDidChangeState=this._onDidChangeState.event,this.checkboxContainer=e}render(e){e.checkbox&&(this.toggle?(this.toggle.checked=e.checkbox.isChecked,this.toggle.setIcon(this.toggle.checked?M.check:void 0)):this.createCheckbox(e))}createCheckbox(e){e.checkbox&&(this.toggle=new tf({isChecked:e.checkbox.isChecked,title:this.createCheckboxTitle(e.checkbox),icon:e.checkbox.isChecked?M.check:void 0,...of}),this.setAccessibilityInformation(e.checkbox),this.toggle.domNode.classList.add(Es.checkboxClass),se(this.checkboxContainer,this.toggle.domNode),this.registerListener(e))}registerListener(e){this.toggle&&(this._register({dispose:()=>this.removeCheckbox()}),this._register(this.toggle),this._register(this.toggle.onChange(()=>{this.setCheckbox(e)})))}setCheckbox(e){this.toggle&&e.checkbox&&(e.checkbox.isChecked=this.toggle.checked,this.toggle.setIcon(this.toggle.checked?M.check:void 0),this.toggle.setTitle(this.createCheckboxTitle(e.checkbox)),this.setAccessibilityInformation(e.checkbox),this.checkboxStateHandler.setCheckboxState(e))}createCheckboxTitle(e){return e.tooltip?e.tooltip:e.isChecked?p("checked","Checked"):p("unchecked","Unchecked")}setAccessibilityInformation(e){this.toggle&&e.accessibilityInformation&&(this.toggle.domNode.ariaLabel=e.accessibilityInformation.label,e.accessibilityInformation.role&&(this.toggle.domNode.role=e.accessibilityInformation.role))}removeCheckbox(){const e=this.checkboxContainer.children;for(const t of e)this.checkboxContainer.removeChild(t)}}Es.checkboxClass="custom-view-tree-node-item-checkbox";let Qr=class extends En{constructor(e,t,i,o,s,n,r,a,d,l,u){super({...e,titleMenuId:b.ViewTitle,donotForwardArgs:!1},t,i,o,s,n,r,a,d,l);const{treeView:g}=de.as(lt.ViewsRegistry).getView(e.id);this.treeView=g,this._register(this.treeView.onDidChangeActions(()=>this.updateActions(),this)),this._register(this.treeView.onDidChangeTitle(m=>this.updateTitle(m))),this._register(this.treeView.onDidChangeDescription(m=>this.updateTitleDescription(m))),this._register(ie(()=>{this._container&&this.treeView.container&&this._container===this.treeView.container&&this.treeView.setVisibility(!1)})),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.treeView.onDidChangeWelcomeState(()=>this._onDidChangeViewWelcomeState.fire())),e.title!==this.treeView.title&&this.updateTitle(this.treeView.title),e.titleDescription!==this.treeView.description&&this.updateTitleDescription(this.treeView.description),this._actionRunner=new ru(u,()=>this.treeView.getSelection()),this.updateTreeVisibility()}focus(){super.focus(),this.treeView.focus()}renderBody(e){this._container=e,super.renderBody(e),this.renderTreeView(e)}shouldShowWelcome(){return(this.treeView.dataProvider===void 0||!!this.treeView.dataProvider.isTreeEmpty)&&this.treeView.message===void 0}layoutBody(e,t){super.layoutBody(e,t),this.layoutTreeView(e,t)}getOptimalWidth(){return this.treeView.getOptimalWidth()}renderTreeView(e){this.treeView.show(e)}layoutTreeView(e,t){this.treeView.layout(e,t)}updateTreeVisibility(){this.treeView.setVisibility(this.isBodyVisible())}getActionRunner(){return this._actionRunner}getActionsContext(){return{$treeViewId:this.id,$focusedTreeItem:!0,$selectedTreeItems:!0}}};Qr=x([h(1,we),h(2,xe),h(3,L),h(4,H),h(5,nt),h(6,D),h(7,Ki),h(8,X),h(9,Ye),h(10,Be)],Qr);class Qn{constructor(){this.label={label:"root"},this.handle="0",this.parentHandle=void 0,this.collapsibleState=Ot.Expanded,this.children=void 0}}function ou(c,e){const t=q.getCommand(c.originalId?c.originalId:c.id);if(t){const i=_.getCommand(t.id),o=i&&i.precondition;if(o)return e.contextMatchesRules(o)}return!0}const dw=p("no-dataprovider","There is no data provider registered that can provide view data."),su=new N("customTreeView",!1);class lw extends as{}let ea=class extends R{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C){super(),this.id=e,this._title=t,this.themeService=i,this.instantiationService=o,this.commandService=s,this.configurationService=n,this.progressService=r,this.contextMenuService=a,this.keybindingService=d,this.notificationService=l,this.viewDescriptorService=u,this.hoverService=g,this.contextKeyService=m,this.activityService=f,this.logService=C,this.isVisible=!1,this._hasIconForParentNode=!1,this._hasIconForLeafNode=!1,this.focused=!1,this._canSelectMany=!1,this._manuallyManageCheckboxes=!1,this.elementsToRefresh=[],this._onDidExpandItem=this._register(new y),this.onDidExpandItem=this._onDidExpandItem.event,this._onDidCollapseItem=this._register(new y),this.onDidCollapseItem=this._onDidCollapseItem.event,this._onDidChangeSelection=this._register(new y),this.onDidChangeSelection=this._onDidChangeSelection.event,this._onDidChangeFocus=this._register(new y),this.onDidChangeFocus=this._onDidChangeFocus.event,this._onDidChangeVisibility=this._register(new y),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDidChangeActions=this._register(new y),this.onDidChangeActions=this._onDidChangeActions.event,this._onDidChangeWelcomeState=this._register(new y),this.onDidChangeWelcomeState=this._onDidChangeWelcomeState.event,this._onDidChangeTitle=this._register(new y),this.onDidChangeTitle=this._onDidChangeTitle.event,this._onDidChangeDescription=this._register(new y),this.onDidChangeDescription=this._onDidChangeDescription.event,this._onDidChangeCheckboxState=this._register(new y),this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event,this._onDidCompleteRefresh=this._register(new y),this._isInitialized=!1,this._height=0,this._width=0,this.refreshing=!1,this.root=new Qn}initialize(){this._isInitialized||(this._isInitialized=!0,this.contextKeyService.bufferChangeEvents(()=>{this.initializeShowCollapseAllAction(),this.initializeCollapseAllToggle(),this.initializeShowRefreshAction()}),this.treeViewDnd=this.instantiationService.createInstance(oa,this.id),this._dragAndDropController&&(this.treeViewDnd.controller=this._dragAndDropController),this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration("explorer.decorations")&&this.doRefresh([this.root])})),this._register(this.viewDescriptorService.onDidChangeLocation(({views:e,from:t,to:i})=>{var o;e.some(s=>s.id===this.id)&&((o=this.tree)==null||o.updateOptions({overrideStyles:{listBackground:this.viewLocation===1?lr:sr}}))})),this.registerActions(),this.create())}get viewContainer(){return this.viewDescriptorService.getViewContainerByViewId(this.id)}get viewLocation(){return this.viewDescriptorService.getViewLocationById(this.id)}get dragAndDropController(){return this._dragAndDropController}set dragAndDropController(e){this._dragAndDropController=e,this.treeViewDnd&&(this.treeViewDnd.controller=e)}get dataProvider(){return this._dataProvider}set dataProvider(e){if(e){const t=this;this._dataProvider=new class{constructor(){this._isEmpty=!0,this._onDidChangeEmpty=new y,this.onDidChangeEmpty=this._onDidChangeEmpty.event}get isTreeEmpty(){return this._isEmpty}async getChildren(i){let o;if(i&&i.children?o=i.children:(i=i??t.root,i.children=await(i instanceof Qn?e.getChildren():e.getChildren(i)),o=i.children??[],o.forEach(s=>s.parent=i)),i instanceof Qn){const s=this._isEmpty;this._isEmpty=o.length===0,s!==this._isEmpty&&this._onDidChangeEmpty.fire()}return o}},this._dataProvider.onDidChangeEmpty&&this._register(this._dataProvider.onDidChangeEmpty(()=>{this.updateCollapseAllToggle(),this._onDidChangeWelcomeState.fire()})),this.updateMessage(),this.refresh()}else this._dataProvider=void 0,this.updateMessage();this._onDidChangeWelcomeState.fire()}get message(){return this._message}set message(e){this._message=e,this.updateMessage(),this._onDidChangeWelcomeState.fire()}get title(){return this._title}set title(e){this._title=e,this._onDidChangeTitle.fire(this._title)}get description(){return this._description}set description(e){this._description=e,this._onDidChangeDescription.fire(this._description)}get badge(){return this._badge}set badge(e){var t,i;if(!(((t=this._badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((i=this._badge)==null?void 0:i.tooltip)===(e==null?void 0:e.tooltip))&&(this._badgeActivity&&(this._badgeActivity.dispose(),this._badgeActivity=void 0),this._badge=e,e)){const o={badge:new Io(e.value,()=>e.tooltip),priority:50};this._badgeActivity=this.activityService.showViewActivity(this.id,o)}}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){var i;const t=this._canSelectMany;this._canSelectMany=e,this._canSelectMany!==t&&((i=this.tree)==null||i.updateOptions({multipleSelectionSupport:this.canSelectMany}))}get manuallyManageCheckboxes(){return this._manuallyManageCheckboxes}set manuallyManageCheckboxes(e){this._manuallyManageCheckboxes=e}get hasIconForParentNode(){return this._hasIconForParentNode}get hasIconForLeafNode(){return this._hasIconForLeafNode}get visible(){return this.isVisible}initializeShowCollapseAllAction(e=!1){return this.collapseAllContext||(this.collapseAllContextKey=new N(`treeView.${this.id}.enableCollapseAll`,e,p("treeView.enableCollapseAll","Whether the the tree view with id {0} enables collapse all.",this.id)),this.collapseAllContext=this.collapseAllContextKey.bindTo(this.contextKeyService)),!0}get showCollapseAllAction(){var e;return this.initializeShowCollapseAllAction(),!!((e=this.collapseAllContext)!=null&&e.get())}set showCollapseAllAction(e){var t;this.initializeShowCollapseAllAction(e),(t=this.collapseAllContext)==null||t.set(e)}initializeShowRefreshAction(e=!1){this.refreshContext||(this.refreshContextKey=new N(`treeView.${this.id}.enableRefresh`,e,p("treeView.enableRefresh","Whether the tree view with id {0} enables refresh.",this.id)),this.refreshContext=this.refreshContextKey.bindTo(this.contextKeyService))}get showRefreshAction(){var e;return this.initializeShowRefreshAction(),!!((e=this.refreshContext)!=null&&e.get())}set showRefreshAction(e){var t;this.initializeShowRefreshAction(e),(t=this.refreshContext)==null||t.set(e)}registerActions(){const e=this;this._register(te(class extends qe{constructor(){super({id:`workbench.actions.treeView.${e.id}.refresh`,title:p("refresh","Refresh"),menu:{id:b.ViewTitle,when:v.and(v.equals("view",e.id),e.refreshContextKey),group:"navigation",order:Number.MAX_SAFE_INTEGER-1},icon:M.refresh})}async run(){return e.refresh()}})),this._register(te(class extends qe{constructor(){super({id:`workbench.actions.treeView.${e.id}.collapseAll`,title:p("collapseAll","Collapse All"),menu:{id:b.ViewTitle,when:v.and(v.equals("view",e.id),e.collapseAllContextKey),group:"navigation",order:Number.MAX_SAFE_INTEGER},precondition:e.collapseAllToggleContextKey,icon:M.collapseAll})}async run(){if(e.tree)return new aw(e.tree,!0).run()}}))}setVisibility(e){this.initialize(),e=!!e,this.isVisible!==e&&(this.isVisible=e,this.tree&&(this.isVisible?go(this.tree.getHTMLElement()):mo(this.tree.getHTMLElement()),this.isVisible&&this.elementsToRefresh.length&&this.dataProvider&&(this.doRefresh(this.elementsToRefresh),this.elementsToRefresh=[])),sf(()=>{this.dataProvider&&this._onDidChangeVisibility.fire(this.isVisible)}),this.visible&&this.activate())}focus(e=!0,t){if(this.tree&&this.root.children&&this.root.children.length>0){const i=t??this.tree.getSelection()[0];i&&e&&this.tree.reveal(i,.5),this.tree.domFocus()}else this.tree?this.tree.domFocus():this.domNode.focus()}show(e){this._container=e,se(e,this.domNode)}create(){this.domNode=z(".tree-explorer-viewlet-tree-view"),this.messageElement=se(this.domNode,z(".message")),this.updateMessage(),this.treeContainer=se(this.domNode,z(".customview-tree")),this.treeContainer.classList.add("file-icon-themable-tree","show-file-icons");const e=this._register(fo(this.domNode));this._register(e.onDidFocus(()=>this.focused=!0)),this._register(e.onDidBlur(()=>this.focused=!1))}updateCheckboxes(e){const t=[];if(!this.manuallyManageCheckboxes){for(const i of e)if(i.checkbox!==void 0){let o=function(r){for(const a of r.children??[])a.checkbox!==void 0&&r.checkbox!==void 0&&(a.checkbox.isChecked=r.checkbox.isChecked,t.push(a),o(a))},n=function(r){if(r.parent&&r.parent.checkbox!==void 0&&r.parent.children){if(s.has(r.parent))return;s.add(r.parent);let a=!1,d=!1;for(const l of r.parent.children){if(a&&d)break;l.checkbox!==void 0&&(l.checkbox.isChecked?d=!0:a=!0)}d&&!a?(r.parent.checkbox.isChecked=!0,t.push(r.parent),n(r.parent)):a&&!d&&(r.parent.checkbox.isChecked=!1,t.push(r.parent),n(r.parent))}};o(i);const s=new Set;n(i)}}e=e.concat(t),e.forEach(i=>{var o;return(o=this.tree)==null?void 0:o.rerender(i)}),this._onDidChangeCheckboxState.fire(e)}createTree(){const e=un.bind(void 0,this.instantiationService),t=this._register(this.instantiationService.createInstance(ta,this.id));this.treeLabels=this._register(this.instantiationService.createInstance(bn,this));const i=this.instantiationService.createInstance(pw,this,l=>this.progressService.withProgress({location:this.id},()=>l)),o=new gw(this.themeService),s=this._register(new cw);this._register(s.onDidChangeCheckboxState(l=>{this.updateCheckboxes(l)}));const n=this.instantiationService.createInstance(Wi,this.id,t,this.treeLabels,e,o,s),r=this._title;this.tree=this._register(this.instantiationService.createInstance(lw,this.id,this.treeContainer,new uw,[n],i,{identityProvider:new hw,accessibilityProvider:{getAriaLabel(l){if(l.accessibilityInformation)return l.accessibilityInformation.label;if(Nt(l.tooltip))return l.tooltip;{if(l.resourceUri&&!l.label)return null;let u="";return l.label&&(u+=l.label.label+" "),l.description&&(u+=l.description),u}},getRole(l){var u;return((u=l.accessibilityInformation)==null?void 0:u.role)??"treeitem"},getWidgetAriaLabel(){return r}},keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:l=>l.label?l.label.label:l.resourceUri?rs(P.revive(l.resourceUri)):void 0},expandOnlyOnTwistieClick:l=>!!l.command||!!l.checkbox||this.configurationService.getValue("workbench.tree.expandMode")==="doubleClick",collapseByDefault:l=>l.collapsibleState!==Ot.Expanded,multipleSelectionSupport:this.canSelectMany,dnd:this.treeViewDnd,overrideStyles:{listBackground:this.viewLocation===1?lr:sr}})),t.setContextKeyService(this.tree.contextKeyService),o.tree=this.tree;const a=new ru(this.notificationService,()=>this.tree.getSelection());n.actionRunner=a,this.tree.contextKeyService.createKey(this.id,!0),su.bindTo(this.tree.contextKeyService).set(!0),this._register(this.tree.onContextMenu(l=>this.onContextMenu(t,l,a))),this._register(this.tree.onDidChangeSelection(l=>this._onDidChangeSelection.fire(l.elements))),this._register(this.tree.onDidChangeFocus(l=>{l.elements.length&&this._onDidChangeFocus.fire(l.elements[0])})),this._register(this.tree.onDidChangeCollapseState(l=>{if(!l.node.element)return;const u=Array.isArray(l.node.element.element)?l.node.element.element[0]:l.node.element.element;l.node.collapsed?this._onDidCollapseItem.fire(u):this._onDidExpandItem.fire(u)})),this.tree.setInput(this.root).then(()=>this.updateContentAreas()),this._register(this.tree.onDidOpen(async l=>{if(!l.browserEvent||l.browserEvent.target&&l.browserEvent.target.classList.contains(Es.checkboxClass))return;const u=this.tree.getSelection(),g=await this.resolveCommand(u.length===1?u[0]:void 0);if(g&&ou(g,this.contextKeyService)){let m=g.arguments||[];(g.id===nf||g.id===rf)&&(m=[...m,l]);try{await this.commandService.executeCommand(g.id,...m)}catch(f){this.notificationService.error(f)}}})),this._register(t.onDidChange(l=>{var u,g;(u=this.tree)!=null&&u.hasNode(l)&&((g=this.tree)==null||g.rerender(l))}))}async resolveCommand(e){let t=e==null?void 0:e.command;return e&&!t&&e instanceof Ka&&e.hasResolve&&(await e.resolve(new st().token),t=e.command),t}onContextMenu(e,t,i){this.hoverService.hideHover();const o=t.element;if(o===null)return;const s=t.browserEvent;s.preventDefault(),s.stopPropagation(),this.tree.setFocus([o]);const n=e.getResourceContextActions(o);n.length&&this.contextMenuService.showContextMenu({getAnchor:()=>t.anchor,getActions:()=>n,getActionViewItem:r=>{const a=this.keybindingService.lookupKeybinding(r.id);if(a)return new th(r,r,{label:!0,keybinding:a.getLabel()})},onHide:r=>{r&&this.tree.domFocus()},getActionsContext:()=>({$treeViewId:this.id,$treeItemHandle:o.handle}),actionRunner:i})}updateMessage(){this._message?this.showMessage(this._message):this.dataProvider?this.hideMessage():this.showMessage(dw),this.updateContentAreas()}showMessage(e){this._messageValue=e,this.messageElement&&(this.messageElement.classList.remove("hide"),this.resetMessageElement(),yr(this._message)||(this.messageElement.textContent=this._messageValue),this.layout(this._height,this._width))}hideMessage(){var e;this.resetMessageElement(),(e=this.messageElement)==null||e.classList.add("hide"),this.layout(this._height,this._width)}resetMessageElement(){this.messageElement&&oi(this.messageElement)}layout(e,t){var i;if(e&&t&&this.messageElement&&this.treeContainer){this._height=e,this._width=t;const o=e-af(this.messageElement);this.treeContainer.style.height=o+"px",(i=this.tree)==null||i.layout(o,t)}}getOptimalWidth(){if(this.tree){const e=this.tree.getHTMLElement(),t=[].slice.call(e.querySelectorAll(".outline-item-label > a"));return cf(e,t)}return 0}async refresh(e){if(this.dataProvider&&this.tree){this.refreshing&&await I.toPromise(this._onDidCompleteRefresh.event),e||(e=[this.root],this.elementsToRefresh=[]);for(const t of e)t.children=void 0;if(this.isVisible)return this.doRefresh(e);if(this.elementsToRefresh.length){const t=new Set;this.elementsToRefresh.forEach(i=>t.add(i.handle));for(const i of e)t.has(i.handle)||this.elementsToRefresh.push(i)}else this.elementsToRefresh.push(...e)}}async expand(e){const t=this.tree;if(t)try{e=Array.isArray(e)?e:[e];for(const i of e)await t.expand(i,!1)}catch{}}isCollapsed(e){var t;return!!((t=this.tree)!=null&&t.isCollapsed(e))}setSelection(e){var t;(t=this.tree)==null||t.setSelection(e)}getSelection(){var e;return((e=this.tree)==null?void 0:e.getSelection())??[]}setFocus(e){this.tree&&(e?(this.focus(!0,e),this.tree.setFocus([e])):this.tree.setFocus([]))}async reveal(e){if(this.tree)return this.tree.reveal(e)}async doRefresh(e){const t=this.tree;if(t&&this.visible){this.refreshing=!0;const i=t.getSelection();try{await Promise.all(e.map(s=>t.updateChildren(s,!0,!0)))}catch(s){this.logService.error(s)}const o=t.getSelection();(i.length!==o.length||i.some((s,n)=>s.handle!==o[n].handle))&&this._onDidChangeSelection.fire(o),this.refreshing=!1,this._onDidCompleteRefresh.fire(),this.updateContentAreas(),this.focused&&this.focus(!1),this.updateCollapseAllToggle()}}initializeCollapseAllToggle(){this.collapseAllToggleContext||(this.collapseAllToggleContextKey=new N(`treeView.${this.id}.toggleCollapseAll`,!1,p("treeView.toggleCollapseAll","Whether collapse all is toggled for the tree view with id {0}.",this.id)),this.collapseAllToggleContext=this.collapseAllToggleContextKey.bindTo(this.contextKeyService))}updateCollapseAllToggle(){var e;this.showCollapseAllAction&&(this.initializeCollapseAllToggle(),(e=this.collapseAllToggleContext)==null||e.set(!!this.root.children&&this.root.children.length>0&&this.root.children.some(t=>t.collapsibleState!==Ot.None)))}updateContentAreas(){const e=!this.root.children||this.root.children.length===0;this._messageValue&&e&&!this.refreshing&&this.treeContainer?(this.dragAndDropController||this.treeContainer.classList.add("hide"),this.domNode.setAttribute("tabindex","0")):this.treeContainer&&(this.treeContainer.classList.remove("hide"),this.domNode.removeAttribute("tabindex"))}get container(){return this._container}};ea=x([h(2,X),h(3,D),h(4,It),h(5,L),h(6,Ua),h(7,xe),h(8,we),h(9,Be),h(10,nt),h(11,gt),h(12,H),h(13,ts),h(14,rt)],ea);class hw{getId(e){return e.handle}}class uw{getHeight(e){return Wi.ITEM_HEIGHT}getTemplateId(e){return Wi.TREE_TEMPLATE_ID}}class pw{constructor(e,t){this.treeView=e,this.withProgress=t}hasChildren(e){return!!this.treeView.dataProvider&&e.collapsibleState!==Ot.None}async getChildren(e){let t=[];if(this.treeView.dataProvider)try{t=await this.withProgress(this.treeView.dataProvider.getChildren(e))??[]}catch(i){if(!i.message.startsWith("Bad progress location:"))throw i}return t}}let Wi=class nu extends R{constructor(e,t,i,o,s,n,r,a,d,l,u,g){super(),this.treeViewId=e,this.menus=t,this.labels=i,this.actionViewItemProvider=o,this.aligner=s,this.checkboxStateHandler=n,this.themeService=r,this.configurationService=a,this.labelService=d,this.hoverService=l,this.treeViewsService=u,this.contextKeyService=g,this._hasCheckbox=!1,this._renderedElements=new Map,this._hoverDelegate={showHover:m=>this.hoverService.showHover(m),delay:this.configurationService.getValue("workbench.hover.delay")},this._register(this.themeService.onDidFileIconThemeChange(()=>this.rerender())),this._register(this.themeService.onDidColorThemeChange(()=>this.rerender()))}get templateId(){return nu.TREE_TEMPLATE_ID}set actionRunner(e){this._actionRunner=e}renderTemplate(e){e.classList.add("custom-view-tree-node-item");const t=se(e,z("")),i=this.labels.create(e,{supportHighlights:!0,hoverDelegate:this._hoverDelegate}),o=Pd(i.element,z(".custom-view-tree-node-item-icon")),s=se(i.element,z(".actions")),n=new vo(s,{actionViewItemProvider:this.actionViewItemProvider});return{resourceLabel:i,icon:o,checkboxContainer:t,actionBar:n,container:e,elementDisposable:new A}}getHover(e,t,i){return!(i instanceof Ka)||!i.hasResolve?t&&!i.tooltip?void 0:i.tooltip===void 0?e:Nt(i.tooltip)?i.tooltip!==""?i.tooltip:void 0:{markdown:i.tooltip,markdownNotSupportedFallback:t?void 0:df(i.tooltip)}:{markdown:typeof i.tooltip=="string"?i.tooltip:o=>new Promise(s=>{i.resolve(o).then(()=>s(i.tooltip))}),markdownNotSupportedFallback:t?void 0:e??""}}renderElement(e,t,i){var C;const o=e.element,s=o.resourceUri?P.revive(o.resourceUri):null,n=o.label?o.label:s?{label:rs(s)}:void 0,r=Nt(o.description)?o.description:s&&o.description===!0?this.labelService.getUriLabel(Ea(s),{relative:!0}):void 0,a=n?n.label:void 0,d=n&&n.highlights&&a?n.highlights.map(([E,V])=>{if(E<0&&(E=a.length+E),V<0&&(V=a.length+V),E>=a.length||V>a.length)return{start:0,end:0};if(E>V){const B=E;E=V,V=B}return{start:E,end:V}}):void 0,l=this.themeService.getColorTheme().type===ih.LIGHT?o.icon:o.iconDark,u=l?P.revive(l):void 0,g=this.getHover(a,s,o);i.actionBar.clear(),i.icon.style.color="";let m=!0;if(o.command&&(m=ou(o.command,this.contextKeyService)),this.renderCheckbox(o,i),s){const E=this.configurationService.getValue("explorer.decorations"),V=s||P.parse("missing:_icon_resource");i.resourceLabel.setResource({name:a,description:r,resource:V},{fileKind:this.getFileKind(o),title:g,hideIcon:this.shouldHideResourceLabelIcon(u,o.themeIcon),fileDecorations:E,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:d||Wo(e.filterData),strikethrough:n==null?void 0:n.strikethrough,disabledCommand:!m,labelEscapeNewLines:!0})}else i.resourceLabel.setResource({name:a,description:r},{title:g,hideIcon:!0,extraClasses:["custom-view-tree-node-item-resourceLabel"],matches:d||Wo(e.filterData),strikethrough:n==null?void 0:n.strikethrough,disabledCommand:!m,labelEscapeNewLines:!0});if(u)i.icon.className="custom-view-tree-node-item-icon",i.icon.style.backgroundImage=Ca(u);else{let E;this.shouldShowThemeIcon(!!s,o.themeIcon)&&(E=me.asClassName(o.themeIcon),o.themeIcon.color&&(i.icon.style.color=((C=this.themeService.getColorTheme().getColor(o.themeIcon.color.id))==null?void 0:C.toString())??"")),i.icon.className=E?`custom-view-tree-node-item-icon ${E}`:"",i.icon.style.backgroundImage=""}m||(i.icon.className=i.icon.className+" disabled",i.container.parentElement&&(i.container.parentElement.className=i.container.parentElement.className+" disabled")),i.actionBar.context={$treeViewId:this.treeViewId,$treeItemHandle:o.handle};const f=this.menus.getResourceActions(o);f.menu&&i.elementDisposable.add(f.menu),i.actionBar.push(f.actions,{icon:!0,label:!1}),this._actionRunner&&(i.actionBar.actionRunner=this._actionRunner),this.setAlignment(i.container,o),this.treeViewsService.addRenderedTreeItemElement(o,i.container),this._renderedElements.set(e,i)}rerender(){const e=new Set(this._renderedElements.keys());for(const t of e){const i=this._renderedElements.get(t);i&&(this.disposeElement(t,0,i),this.renderElement(t,0,i))}}renderCheckbox(e,t){if(e.checkbox){if(this._hasCheckbox||(this._hasCheckbox=!0,this.rerender()),!t.checkbox){const i=new Es(t.checkboxContainer,this.checkboxStateHandler);t.checkbox=i}t.checkbox.render(e)}else t.checkbox&&(t.checkbox.dispose(),t.checkbox=void 0)}setAlignment(e,t){e.parentElement.classList.toggle("align-icon-with-twisty",!this._hasCheckbox&&this.aligner.alignIconWithTwisty(t))}shouldHideResourceLabelIcon(e,t){return!!e||!!t&&!this.isFileKindThemeIcon(t)}shouldShowThemeIcon(e,t){return t?!(e&&this.isFileKindThemeIcon(t)):!1}isFolderThemeIcon(e){return(e==null?void 0:e.id)===Cr.id}isFileKindThemeIcon(e){return e?e.id===Mc.id||this.isFolderThemeIcon(e):!1}getFileKind(e){if(e.themeIcon)switch(e.themeIcon.id){case Mc.id:return Ve.FILE;case Cr.id:return Ve.FOLDER}return e.collapsibleState===Ot.Collapsed||e.collapsibleState===Ot.Expanded?Ve.FOLDER:Ve.FILE}disposeElement(e,t,i){var o;i.elementDisposable.clear(),this._renderedElements.delete(e),this.treeViewsService.removeRenderedTreeItemElement(e.element),(o=i.checkbox)==null||o.dispose(),i.checkbox=void 0}disposeTemplate(e){e.resourceLabel.dispose(),e.actionBar.dispose(),e.elementDisposable.dispose()}};Wi.ITEM_HEIGHT=22;Wi.TREE_TEMPLATE_ID="treeExplorer";Wi=x([h(6,X),h(7,L),h(8,Ci),h(9,gt),h(10,eh),h(11,H)],Wi);class gw extends R{constructor(e){super(),this.themeService=e}set tree(e){this._tree=e}alignIconWithTwisty(e){if(e.collapsibleState!==Ot.None||!this.hasIcon(e))return!1;if(this._tree){const t=this._tree.getParentElement(e)||this._tree.getInput();return this.hasIcon(t)?!!t.children&&t.children.some(i=>i.collapsibleState!==Ot.None&&!this.hasIcon(i)):!!t.children&&t.children.every(i=>i.collapsibleState===Ot.None||!this.hasIcon(i))}else return!1}hasIcon(e){if(this.themeService.getColorTheme().type===ih.LIGHT?e.icon:e.iconDark)return!0;if(e.resourceUri||e.themeIcon){const i=this.themeService.getFileIconTheme();return(e.themeIcon?e.themeIcon.id===Cr.id:e.collapsibleState!==Ot.None)?i.hasFileIcons&&i.hasFolderIcons:i.hasFileIcons}return!1}}class ru extends is{constructor(e,t){super(),this.getSelectedResources=t,this._register(this.onDidRun(i=>{i.error&&!Gi(i.error)&&e.error(p("command-error","Error running command {1}: {0}. This is likely caused by the extension that contributes {1}.",i.error.message,i.action.id))}))}async runAction(e,t){const i=this.getSelectedResources();let o,s=!1;i.length>1&&(o=i.map(n=>((n.handle===t.$treeItemHandle||t.$selectedTreeItems)&&(s=!0),{$treeViewId:t.$treeViewId,$treeItemHandle:n.handle}))),s||(o=void 0),await e.run(t,o)}}let ta=class extends R{constructor(e,t){super(),this.id=e,this.menuService=t,this._onDidChange=new y,this.onDidChange=this._onDidChange.event}getResourceActions(e){const t=this.getActions(b.ViewItemContext,e,!0);return{menu:t.menu,actions:t.primary}}getResourceContextActions(e){return this.getActions(b.ViewItemContext,e).secondary}setContextKeyService(e){this.contextKeyService=e}getActions(e,t,i=!1){if(!this.contextKeyService)return{primary:[],secondary:[]};const o=this.contextKeyService.createOverlay([["view",this.id],["viewItem",t.contextValue]]),s=this.menuService.createMenu(e,o),a={primary:[],secondary:[],menu:s};return Gs(s,{shouldForwardArgs:!0},a,"inline"),i?this._register(s.onDidChange(()=>this._onDidChange.fire(t))):s.dispose(),a}dispose(){this.contextKeyService=void 0,super.dispose()}};ta=x([h(1,Xe)],ta);let ia=class extends ea{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E,V,B){super(e,t,o,s,n,r,a,d,l,u,g,f,m,E,B),this.extensionId=i,this.extensionService=C,this.telemetryService=V,this.activated=!1}activate(){this.activated||(this.telemetryService.publicLog2("Extension:ViewActivate",{extensionId:new hl(this.extensionId),id:this.id}),this.createTree(),this.progressService.withProgress({location:this.id},()=>this.extensionService.activateByEvent(`onView:${this.id}`)).then(()=>ka(2e3)).then(()=>{this.updateMessage()}),this.activated=!0)}};ia=x([h(3,X),h(4,D),h(5,It),h(6,L),h(7,Ua),h(8,xe),h(9,we),h(10,Be),h(11,nt),h(12,H),h(13,gt),h(14,yi),h(15,ts),h(16,Ye),h(17,rt)],ia);let oa=class{constructor(e,t,i,o,s){this.treeId=e,this.labelService=t,this.instantiationService=i,this.treeViewsDragAndDropService=o,this.logService=s,this.treeItemsTransfer=ti.getInstance(),this.treeMimeType=`application/vnd.code.tree.${e.toLowerCase()}`}set controller(e){this.dndController=e}handleDragAndLog(e,t,i,o){return e.handleDrag(t,i,o).then(s=>{if(s){const n=[];for(const r of s)r[0]!==this.treeMimeType&&e.dragMimeTypes.findIndex(a=>a===r[0])<0&&n.push(r[0]);n.length&&this.logService.warn(`Drag and drop controller for tree ${this.treeId} adds the following data transfer types but does not declare them in dragMimeTypes: ${n.join(", ")}`)}return s})}addExtensionProvidedTransferTypes(e,t){var o;if(!e.dataTransfer||!this.dndController)return;const i=Ed();this.dragCancellationToken=new st,this.treeViewsDragAndDropService.addDragOperationTransfer(i,this.handleDragAndLog(this.dndController,t,i,this.dragCancellationToken.token)),this.treeItemsTransfer.setData([new Lt(i)],Lt.prototype),e.dataTransfer.clearData(Kn.text),this.dndController.dragMimeTypes.find(s=>s===Kn.uriList)&&((o=e.dataTransfer)==null||o.setData(to.RESOURCES,"")),this.dndController.dragMimeTypes.forEach(s=>{var n;(n=e.dataTransfer)==null||n.setData(s,"")})}addResourceInfoToTransfer(e,t){if(t.length&&e.dataTransfer){this.instantiationService.invokeFunction(o=>Yd(o,t,e));const i=t.filter(o=>o.scheme===Re.file).map(o=>o.fsPath);i.length&&e.dataTransfer.setData(wr.FILES,JSON.stringify(i))}}onDragStart(e,t){if(t.dataTransfer){const i=e.getData(),o=[],s={id:this.treeId,itemHandles:[]};i.forEach(n=>{s.itemHandles.push(n.handle),n.resourceUri&&o.push(P.revive(n.resourceUri))}),this.addResourceInfoToTransfer(t,o),this.addExtensionProvidedTransferTypes(t,s.itemHandles),t.dataTransfer.setData(this.treeMimeType,JSON.stringify(s))}}debugLog(e){e.size?this.logService.debug(`TreeView dragged mime types: ${Array.from(e).join(", ")}`):this.logService.debug("TreeView dragged with no supported mime types.")}onDragOver(e,t,i,o){const s=Nc(o.dataTransfer),n=new Set(Array.from(s,d=>d[0]));if(o.dataTransfer){for(const d of o.dataTransfer.items)if(d.kind==="file"||d.type===to.RESOURCES.toLowerCase()){n.add(Kn.uriList);break}}this.debugLog(n);const r=this.dndController;return!r||!o.dataTransfer||r.dropMimeTypes.length===0?!1:Array.from(n).some((d,l)=>d===this.treeMimeType?!0:r.dropMimeTypes.indexOf(d)>=0)?{accept:!0,bubble:0,autoExpand:!0}:!1}getDragURI(e){return this.dndController?e.resourceUri?P.revive(e.resourceUri).toString():e.handle:null}getDragLabel(e){if(!this.dndController)return;if(e.length>1)return String(e.length);const t=e[0];return t.label?t.label.label:t.resourceUri?this.labelService.getUriLabel(P.revive(t.resourceUri)):void 0}async drop(e,t,i,o){const s=this.dndController;if(!o.dataTransfer||!s)return;let n,r;this.treeItemsTransfer.hasData(Lt.prototype)&&(r=this.treeItemsTransfer.getData(Lt.prototype)[0].identifier);const a=Nc(o.dataTransfer,!0),d=new lf;for(const[u,g]of a)if((u===this.treeMimeType||s.dropMimeTypes.includes(u)||g.asFile()&&s.dropMimeTypes.includes(to.FILES.toLowerCase()))&&(d.append(u,g),u===this.treeMimeType))try{n=JSON.parse(await g.asString())}catch{}const l=await this.treeViewsDragAndDropService.removeDragOperationTransfer(r);if(l)for(const[u,g]of l)d.append(u,g);return s.handleDrop(d,t,Fi.None,r,n==null?void 0:n.id,n==null?void 0:n.itemHandles)}onDragEnd(e){var t,i;((t=e.dataTransfer)==null?void 0:t.dropEffect)==="none"&&((i=this.dragCancellationToken)==null||i.cancel())}};oa=x([h(1,Ci),h(2,D),h(3,xa),h(4,rt)],oa);const He=bo("remoteExplorerService"),er="remote.tunnels.toRestore",hc="~remote.forwardedPorts";var he;(function(c){c.Candidate="Candidate",c.Detected="Detected",c.Forwarded="Forwarded",c.Add="Add"})(he||(he={}));var St;(function(c){c.Other="Other",c.User="User",c.AutoForwardEnd="AutoForwardEnd"})(St||(St={}));var Pe;(function(c){c[c.None=0]="None",c[c.New=1]="New",c[c.Label=2]="Label",c[c.LocalPort=3]="LocalPort"})(Pe||(Pe={}));var Jt;(function(c){c[c.User=0]="User",c[c.Auto=1]="Auto",c[c.Extension=2]="Extension"})(Jt||(Jt={}));const tr={source:Jt.User,description:p("tunnel.source.user","User Forwarded")},mw={source:Jt.Auto,description:p("tunnel.source.auto","Auto Forwarded")};function Q(c,e){return c+":"+e}function Hs(c){var t;const e=c.match(/^([a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*:)?([0-9]+)$/);if(e)return{host:((t=e[1])==null?void 0:t.substring(0,e[1].length-1))||"localhost",port:Number(e[2])}}function gd(c,e,t){const i=c.get(Q(e,t));if(i)return i;if(_n(e))for(const o of oh){const s=Q(o,t);if(c.has(s))return c.get(s)}else if(kn(e))for(const o of gf){const s=Q(o,t);if(c.has(s))return c.get(s)}}function Ie(c,e,t){const i=gd(c,e,t);if(i)return i;const o=kn(e)?"localhost":_n(e)?"0.0.0.0":void 0;if(o)return gd(c,o,t)}var dt;(function(c){c.Notify="notify",c.OpenBrowser="openBrowser",c.OpenBrowserOnce="openBrowserOnce",c.OpenPreview="openPreview",c.Silent="silent",c.Ignore="ignore"})(dt||(dt={}));class Ae extends R{constructor(e){super(),this.configurationService=e,this.portsAttributes=[],this._onDidChangeAttributes=new y,this.onDidChangeAttributes=this._onDidChangeAttributes.event,this._register(e.onDidChangeConfiguration(t=>{(t.affectsConfiguration(Ae.SETTING)||t.affectsConfiguration(Ae.DEFAULTS))&&this.updateAttributes()})),this.updateAttributes()}updateAttributes(){this.portsAttributes=this.readSetting(),this._onDidChangeAttributes.fire()}getAttributes(e,t,i){let o=this.findNextIndex(e,t,i,this.portsAttributes,0);const s={label:void 0,onAutoForward:void 0,elevateIfNeeded:void 0,requireLocalPort:void 0,protocol:void 0};for(;o>=0;){const n=this.portsAttributes[o];n.key===e?(s.onAutoForward=n.onAutoForward??s.onAutoForward,s.elevateIfNeeded=n.elevateIfNeeded!==void 0?n.elevateIfNeeded:s.elevateIfNeeded,s.label=n.label??s.label,s.requireLocalPort=n.requireLocalPort,s.protocol=n.protocol):(s.onAutoForward=s.onAutoForward??n.onAutoForward,s.elevateIfNeeded=s.elevateIfNeeded!==void 0?s.elevateIfNeeded:n.elevateIfNeeded,s.label=s.label??n.label,s.requireLocalPort=s.requireLocalPort!==void 0?s.requireLocalPort:void 0,s.protocol=s.protocol??n.protocol),o=this.findNextIndex(e,t,i,this.portsAttributes,o+1)}return s.onAutoForward!==void 0||s.elevateIfNeeded!==void 0||s.label!==void 0||s.requireLocalPort!==void 0||s.protocol!==void 0?s:this.getOtherAttributes()}hasStartEnd(e){return e.start!==void 0&&e.end!==void 0}hasHostAndPort(e){return e.host!==void 0&&e.port!==void 0&&Nt(e.host)&&$n(e.port)}findNextIndex(e,t,i,o,s){if(s>=o.length)return-1;const n=!_n(t)&&!kn(t),a=o.slice(s).findIndex(d=>$n(d.key)?n?!1:d.key===e:this.hasStartEnd(d.key)?n?!1:e>=d.key.start&&e<=d.key.end:this.hasHostAndPort(d.key)?e===d.key.port&&t===d.key.host:i?d.key.test(i):!1);return a>=0?a+s:-1}readSetting(){const e=this.configurationService.getValue(Ae.SETTING);if(!e||!Fc(e))return[];const t=[];for(const o in e){if(o===void 0)continue;const s=e[o];let n;if(Number(o))n=Number(o);else if(Nt(o))if(Ae.RANGE.test(o)){const r=o.match(Ae.RANGE);n={start:Number(r[1]),end:Number(r[2])}}else if(Ae.HOST_AND_PORT.test(o)){const r=o.match(Ae.HOST_AND_PORT);n={host:r[1],port:Number(r[2])}}else{let r;try{r=RegExp(o)}catch{}r&&(n=r)}n&&t.push({key:n,elevateIfNeeded:s.elevateIfNeeded,onAutoForward:s.onAutoForward,label:s.label,requireLocalPort:s.requireLocalPort,protocol:s.protocol})}const i=this.configurationService.getValue(Ae.DEFAULTS);return i&&(this.defaultPortAttributes={elevateIfNeeded:i.elevateIfNeeded,label:i.label,onAutoForward:i.onAutoForward,requireLocalPort:i.requireLocalPort,protocol:i.protocol}),this.sortAttributes(t)}sortAttributes(e){function t(i,o){return $n(i.key)?i.key:o.hasStartEnd(i.key)?i.key.start:o.hasHostAndPort(i.key)?i.key.port:Number.MAX_VALUE}return e.sort((i,o)=>t(i,this)-t(o,this))}getOtherAttributes(){return this.defaultPortAttributes}static providedActionToAction(e){switch(e){case Xi.Notify:return dt.Notify;case Xi.OpenBrowser:return dt.OpenBrowser;case Xi.OpenBrowserOnce:return dt.OpenBrowserOnce;case Xi.OpenPreview:return dt.OpenPreview;case Xi.Silent:return dt.Silent;case Xi.Ignore:return dt.Ignore;default:return}}async addAttributes(e,t,i){const s=this.configurationService.inspect(Ae.SETTING).userRemoteValue;let n;!s||!Fc(s)?n={}:n=pf(s),n[`${e}`]||(n[`${e}`]={});for(const r in t)n[`${e}`][r]=t[r];return this.configurationService.updateValue(Ae.SETTING,n,i)}}Ae.SETTING="remote.portsAttributes";Ae.DEFAULTS="remote.otherPortsAttributes";Ae.RANGE=/^(\d+)\-(\d+)$/;Ae.HOST_AND_PORT=/^([a-z0-9\-]+):(\d{1,5})$/;const fw=10*1e3;let dn=class extends R{constructor(e,t,i,o,s,n,r,a){super(),this.tunnelService=e,this.storageService=t,this.configurationService=i,this.environmentService=o,this.remoteAuthorityResolverService=s,this.workspaceContextService=n,this.logService=r,this.dialogService=a,this.inProgress=new Map,this._onForwardPort=new y,this.onForwardPort=this._onForwardPort.event,this._onClosePort=new y,this.onClosePort=this._onClosePort.event,this._onPortName=new y,this.onPortName=this._onPortName.event,this._onCandidatesChanged=new y,this.onCandidatesChanged=this._onCandidatesChanged.event,this._onEnvironmentTunnelsSet=new y,this.onEnvironmentTunnelsSet=this._onEnvironmentTunnelsSet.event,this._environmentTunnelsSet=!1,this.unrestoredExtensionTunnels=new Map,this.sessionCachedProperties=new Map,this.portAttributesProviders=[],this.mismatchCooldown=new Date,this.configPortsAttributes=new Ae(i),this.tunnelRestoreValue=this.getTunnelRestoreValue(),this._register(this.configPortsAttributes.onDidChangeAttributes(this.updateAttributes,this)),this.forwarded=new Map,this.remoteTunnels=new Map,this.tunnelService.tunnels.then(async d=>{var u;const l=await this.getAttributes(d.map(g=>({port:g.tunnelRemotePort,host:g.tunnelRemoteHost})));for(const g of d)if(g.localAddress){const m=Q(g.tunnelRemoteHost,g.tunnelRemotePort),f=Ie(this._candidates??new Map,g.tunnelRemoteHost,g.tunnelRemotePort);this.forwarded.set(m,{remotePort:g.tunnelRemotePort,remoteHost:g.tunnelRemoteHost,localAddress:g.localAddress,protocol:((u=l==null?void 0:l.get(g.tunnelRemotePort))==null?void 0:u.protocol)??_e.Http,localUri:await this.makeLocalUri(g.localAddress,l==null?void 0:l.get(g.tunnelRemotePort)),localPort:g.tunnelLocalPort,runningProcess:f==null?void 0:f.detail,hasRunningProcess:!!f,pid:f==null?void 0:f.pid,privacy:g.privacy,source:tr}),this.remoteTunnels.set(m,g)}}),this.detected=new Map,this._register(this.tunnelService.onTunnelOpened(async d=>{var u;const l=Q(d.tunnelRemoteHost,d.tunnelRemotePort);if(!Ie(this.forwarded,d.tunnelRemoteHost,d.tunnelRemotePort)&&!Ie(this.detected,d.tunnelRemoteHost,d.tunnelRemotePort)&&!Ie(this.inProgress,d.tunnelRemoteHost,d.tunnelRemotePort)&&d.localAddress){const g=Ie(this._candidates??new Map,d.tunnelRemoteHost,d.tunnelRemotePort),m=(u=await this.getAttributes([{port:d.tunnelRemotePort,host:d.tunnelRemoteHost}]))==null?void 0:u.get(d.tunnelRemotePort);this.forwarded.set(l,{remoteHost:d.tunnelRemoteHost,remotePort:d.tunnelRemotePort,localAddress:d.localAddress,protocol:(m==null?void 0:m.protocol)??_e.Http,localUri:await this.makeLocalUri(d.localAddress,m),localPort:d.tunnelLocalPort,closeable:!0,runningProcess:g==null?void 0:g.detail,hasRunningProcess:!!g,pid:g==null?void 0:g.pid,privacy:d.privacy,source:tr})}await this.storeForwarded(),this.remoteTunnels.set(l,d),this._onForwardPort.fire(this.forwarded.get(l))})),this._register(this.tunnelService.onTunnelClosed(d=>this.onTunnelClosed(d,St.Other)))}async onTunnelClosed(e,t){const i=Q(e.host,e.port);this.forwarded.has(i)&&(this.forwarded.delete(i),await this.storeForwarded(),this._onClosePort.fire(e))}makeLocalUri(e,t){if(e.startsWith("http"))return P.parse(e);const i=(t==null?void 0:t.protocol)??"http";return P.parse(`${i}://${e}`)}async getStorageKey(){const e=this.workspaceContextService.getWorkspace(),t=e.configuration?zo(e.configuration.path):e.folders.length>0?zo(e.folders[0].uri.path):void 0;if(t===void 0){this.logService.debug("Could not get workspace hash for forwarded ports storage key.");return}return`${er}.${this.environmentService.remoteAuthority}.${t}`}async getTunnelRestoreValue(){const e=this.storageService.get(er,1);if(e)return this.storageService.remove(er,1),await this.storeForwarded(),e;const t=await this.getStorageKey();if(t)return this.storageService.get(t,0)}async restoreForwarded(){if(this.configurationService.getValue("remote.restoreForwardedPorts")){const e=await this.tunnelRestoreValue;if(e&&e!==this.knownPortsRestoreValue){const t=JSON.parse(e)??[];this.logService.trace(`ForwardedPorts: (TunnelModel) restoring ports ${t.map(i=>i.remotePort).join(", ")}`);for(const i of t){const o=Ie(this.detected,i.remoteHost,i.remotePort);i.source.source===Jt.User&&!o||i.source.source===Jt.Extension&&o?await this.forward({remote:{host:i.remoteHost,port:i.remotePort},local:i.localPort,name:i.name,privacy:i.privacy,elevateIfNeeded:!0}):i.source.source===Jt.Extension&&!o&&this.unrestoredExtensionTunnels.set(Q(i.remoteHost,i.remotePort),i)}}}if(!this.restoreListener){const e=await this.getStorageKey();this.restoreListener=this._register(this.storageService.onDidChangeValue(async t=>{t.key===e&&(this.tunnelRestoreValue=Promise.resolve(this.storageService.get(e,0)),await this.restoreForwarded())}))}}async storeForwarded(){if(this.configurationService.getValue("remote.restoreForwardedPorts")){const e=JSON.stringify(Array.from(this.forwarded.values()).filter(t=>t.source.source!==Jt.Auto));if(e!==this.knownPortsRestoreValue){this.knownPortsRestoreValue=e;const t=await this.getStorageKey();t&&this.storageService.store(t,this.knownPortsRestoreValue,0,0)}}}async showPortMismatchModalIfNeeded(e,t,i){if(!e.tunnelLocalPort||!(i!=null&&i.requireLocalPort)||e.tunnelLocalPort===t)return;const o=new Date;if(this.mismatchCooldown.getTime()+fw>o.getTime())return;this.mismatchCooldown=o;const s=p("remote.localPortMismatch.single",`Local port {0} could not be used for forwarding to remote port {1}.

This usually happens when there is already another process using local port {0}.

Port number {2} has been used instead.`,t,e.tunnelRemotePort,e.tunnelLocalPort);return this.dialogService.info(s)}async forward(e,t){var s;const i=Ie(this.forwarded,e.remote.host,e.remote.port);t=t??(t!==null?(s=await this.getAttributes([e.remote]))==null?void 0:s.get(e.remote.port):void 0);const o=e.local!==void 0?e.local:e.remote.port;if(i)return this.mergeAttributesIntoExistingTunnel(i,e,t);{const n=this.environmentService.remoteAuthority,r=n?{getAddress:async()=>(await this.remoteAuthorityResolverService.resolveAuthority(n)).authority}:void 0,a=Q(e.remote.host,e.remote.port);this.inProgress.set(a,!0),e=this.mergeCachedAndUnrestoredProperties(a,e);const d=await this.tunnelService.openTunnel(r,e.remote.host,e.remote.port,void 0,o,e.elevateIfNeeded?e.elevateIfNeeded:t==null?void 0:t.elevateIfNeeded,e.privacy,t==null?void 0:t.protocol);if(d&&d.localAddress){const l=Ie(this._candidates??new Map,e.remote.host,e.remote.port),u=d.protocol?d.protocol===_e.Https?_e.Https:_e.Http:(t==null?void 0:t.protocol)??_e.Http,g={remoteHost:d.tunnelRemoteHost,remotePort:d.tunnelRemotePort,localPort:d.tunnelLocalPort,name:(t==null?void 0:t.label)??e.name,closeable:!0,localAddress:d.localAddress,protocol:u,localUri:await this.makeLocalUri(d.localAddress,t),runningProcess:l==null?void 0:l.detail,hasRunningProcess:!!l,pid:l==null?void 0:l.pid,source:e.source??tr,privacy:d.privacy};return this.forwarded.set(a,g),this.remoteTunnels.set(a,d),this.inProgress.delete(a),await this.storeForwarded(),await this.showPortMismatchModalIfNeeded(d,o,t),this._onForwardPort.fire(g),d}this.inProgress.delete(a)}}mergeCachedAndUnrestoredProperties(e,t){const i=this.unrestoredExtensionTunnels.has(e)?this.unrestoredExtensionTunnels:this.sessionCachedProperties.has(e)?this.sessionCachedProperties:void 0;if(i){const o=i.get(e);i.delete(e),o&&(t.name=o.name??t.name,t.local=("local"in o?o.local:"localPort"in o?o.localPort:void 0)??t.local,t.privacy=o.privacy??t.privacy)}return t}async mergeAttributesIntoExistingTunnel(e,t,i){const o=(i==null?void 0:i.label)??t.name;let s;(function(r){r[r.None=0]="None",r[r.Fire=1]="Fire",r[r.Reopen=2]="Reopen"})(s||(s={}));let n=s.None;switch(o!==e.name&&(e.name=o,n=s.Fire),(i!=null&&i.protocol||e.protocol!==_e.Http)&&(i==null?void 0:i.protocol)!==e.protocol&&(t.source=e.source,n=s.Reopen),t.privacy&&e.privacy!==t.privacy&&(n=s.Reopen),n){case s.Fire:{this._onForwardPort.fire();break}case s.Reopen:await this.close(e.remoteHost,e.remotePort,St.User),await this.forward(t,i)}return Ie(this.remoteTunnels,t.remote.host,t.remote.port)}async name(e,t,i){const o=Ie(this.forwarded,e,t),s=Q(e,t);if(o){o.name=i,await this.storeForwarded(),this._onPortName.fire({host:e,port:t});return}else this.detected.has(s)&&(this.detected.get(s).name=i,this._onPortName.fire({host:e,port:t}))}async close(e,t,i){const o=Q(e,t),s=this.forwarded.get(o);return i===St.AutoForwardEnd&&this.sessionCachedProperties.set(o,{local:s.localPort,name:s.name,privacy:s.privacy}),await this.tunnelService.closeTunnel(e,t),this.onTunnelClosed({host:e,port:t},i)}address(e,t){var o;const i=Q(e,t);return(o=this.forwarded.get(i)||this.detected.get(i))==null?void 0:o.localAddress}get environmentTunnelsSet(){return this._environmentTunnelsSet}addEnvironmentTunnels(e){if(e)for(const t of e){const i=Ie(this._candidates??new Map,t.remoteAddress.host,t.remoteAddress.port),o=typeof t.localAddress=="string"?t.localAddress:Q(t.localAddress.host,t.localAddress.port);this.detected.set(Q(t.remoteAddress.host,t.remoteAddress.port),{remoteHost:t.remoteAddress.host,remotePort:t.remoteAddress.port,localAddress:o,protocol:_e.Http,localUri:this.makeLocalUri(o),closeable:!1,runningProcess:i==null?void 0:i.detail,hasRunningProcess:!!i,pid:i==null?void 0:i.pid,privacy:Ko.ConstantPrivate,source:{source:Jt.Extension,description:p("tunnel.staticallyForwarded","Statically Forwarded")}}),this.tunnelService.setEnvironmentTunnel(t.remoteAddress.host,t.remoteAddress.port,o,Ko.ConstantPrivate,_e.Http)}this._environmentTunnelsSet=!0,this._onEnvironmentTunnelsSet.fire(),this._onForwardPort.fire()}setCandidateFilter(e){this._candidateFilter=e}async setCandidates(e){let t=e;this._candidateFilter&&(t=await this._candidateFilter(e));const i=this.updateInResponseToCandidates(t);this.logService.trace(`ForwardedPorts: (TunnelModel) removed candidates ${Array.from(i.values()).map(o=>o.port).join(", ")}`),this._onCandidatesChanged.fire(i)}updateInResponseToCandidates(e){const t=this._candidates??new Map,i=new Map;return this._candidates=i,e.forEach(o=>{const s=Q(o.host,o.port);i.set(s,{host:o.host,port:o.port,detail:o.detail,pid:o.pid}),t.has(s)&&t.delete(s);const n=Ie(this.forwarded,o.host,o.port);n&&(n.runningProcess=o.detail,n.hasRunningProcess=!0,n.pid=o.pid)}),t.forEach((o,s)=>{const n=Hs(s);if(!n)return;const r=Ie(this.forwarded,n.host,n.port);r&&(r.runningProcess=void 0,r.hasRunningProcess=!1,r.pid=void 0);const a=Ie(this.detected,n.host,n.port);a&&(a.runningProcess=void 0,a.hasRunningProcess=!1,a.pid=void 0)}),t}get candidates(){return this._candidates?Array.from(this._candidates.values()):[]}get candidatesOrUndefined(){return this._candidates?this.candidates:void 0}async updateAttributes(){const e=Array.from(this.forwarded.values()),t=await this.getAttributes(e.map(i=>({port:i.remotePort,host:i.remoteHost})),!1);if(t)for(const i of e){const o=t.get(i.remotePort);(o!=null&&o.protocol||i.protocol!==_e.Http)&&(o==null?void 0:o.protocol)!==i.protocol&&await this.forward({remote:{host:i.remoteHost,port:i.remotePort},local:i.localPort,name:i.name,source:i.source},o),o&&o.label&&o.label!==i.name&&await this.name(i.remoteHost,i.remotePort,o.label)}}async getAttributes(e,t=!0){const i=new Map,o=new Map;e.forEach(d=>{var u;const l=Ie(this._candidates??new Map,oh[0],d.port);l&&(i.set(d.port,l),o.has(l.pid)||o.set(l.pid,[]),(u=o.get(l.pid))==null||u.push(d.port))});const s=new Map;if(e.forEach(d=>{var u;const l=this.configPortsAttributes.getAttributes(d.port,d.host,(u=i.get(d.port))==null?void 0:u.detail);l&&s.set(d.port,l)}),this.portAttributesProviders.length===0||!t)return s.size>0?s:void 0;const n=await Promise.all(sh(this.portAttributesProviders.map(d=>Array.from(o.entries()).map(l=>{const u=l[1],g=i.get(u[0]);return d.providePortAttributes(u,g==null?void 0:g.pid,g==null?void 0:g.detail,new st().token)})))),r=new Map;if(n.forEach(d=>d.forEach(l=>{l&&r.set(l.port,l)})),!s&&!r)return;const a=new Map;return e.forEach(d=>{const l=s.get(d.port),u=r.get(d.port);a.set(d.port,{elevateIfNeeded:l==null?void 0:l.elevateIfNeeded,label:l==null?void 0:l.label,onAutoForward:(l==null?void 0:l.onAutoForward)??Ae.providedActionToAction(u==null?void 0:u.autoForwardAction),requireLocalPort:l==null?void 0:l.requireLocalPort,protocol:l==null?void 0:l.protocol})}),a}addAttributesProvider(e){this.portAttributesProviders.push(e)}};dn.__decorator=x([hf(1e3)],dn.prototype,"storeForwarded",null);dn=x([h(0,Wt),h(1,Se),h(2,L),h(3,Ut),h(4,uf),h(5,at),h(6,rt),h(7,gn)],dn);var bw='.ports-view .monaco-icon-label,.ports-view .monaco-list .monaco-list-row.focused .monaco-icon-label,.ports-view .monaco-list .monaco-list-row:hover:not(.highlighted) .monaco-icon-label{flex:1}.ports-view .monaco-list .monaco-list-row .actionBarContainer{flex:1 0 auto;flex:0 0 auto;text-align:right}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell{display:flex;flex:1;flex-wrap:nowrap;height:22px;overflow:hidden;text-overflow:ellipsis}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .monaco-inputbox{flex:1;height:22px;line-height:19px}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .monaco-inputbox input{margin-top:-40px}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .ports-view-actionbar-cell-localaddress:hover{text-decoration:underline}.ports-view .monaco-table-td[data-col-index="0"],.ports-view .monaco-table-th,.ports-view .monaco-table-th[data-col-index="0"]{padding-left:10px}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .monaco-button{line-height:1.4em;margin-bottom:3px;margin-left:3px;margin-top:4px;padding:2px 14px;width:auto}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell>.ports-view-actionbar-cell-icon.codicon{margin-top:3px;padding-right:3px}.ports-view .monaco-list .monaco-list-row.selected .ports-view-actionbar-cell>.ports-view-actionbar-cell-icon.codicon{color:currentColor!important}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .ports-view-actionbar-cell-resourceLabel .monaco-icon-label-container>.monaco-icon-name-container{flex:1}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .ports-view-actionbar-cell-resourceLabel:after{padding-right:0}.ports-view .monaco-list .monaco-list-row .ports-view-actionbar-cell .actions{display:none}.ports-view .monaco-list .monaco-list-row.focused .ports-view-actionbar-cell .actions,.ports-view .monaco-list .monaco-list-row.selected .ports-view-actionbar-cell .actions,.ports-view .monaco-list .monaco-list-row:hover .ports-view-actionbar-cell .actions{display:block}.ports-view .monaco-list .ports-view-actionbar-cell .actions .action-label{background-position:50% 50%;background-repeat:no-repeat;background-size:16px;height:100%;padding:2px;width:16px}.monaco-workbench .codicon.codicon-ports-forwarded-with-process-icon{color:var(--vscode-ports-iconRunningProcessForeground)}';be(bw,{});pe("remote-explorer-get-started",M.star,p("getStartedIcon","Getting started icon in the remote explorer view."));pe("remote-explorer-documentation",M.book,p("documentationIcon","Documentation icon in the remote explorer view."));pe("remote-explorer-feedback",M.twitter,p("feedbackIcon","Feedback icon in the remote explorer view."));pe("remote-explorer-review-issues",M.issues,p("reviewIssuesIcon","Review issue icon in the remote explorer view."));pe("remote-explorer-report-issues",M.comment,p("reportIssuesIcon","Report issue icon in the remote explorer view."));pe("remote-explorer-view-icon",M.remoteExplorer,p("remoteExplorerViewIcon","View icon of the remote explorer view."));pe("ports-view-icon",M.plug,p("portsViewIcon","View icon of the remote ports view."));pe("ports-view-icon",M.plug,p("portIcon","Icon representing a remote port."));const vw=pe("private-ports-view-icon",M.lock,p("privatePortIcon","Icon representing a private remote port.")),ww=pe("ports-forward-icon",M.plus,p("forwardPortIcon","Icon for the forward action.")),yw=pe("ports-stop-forward-icon",M.x,p("stopForwardIcon","Icon for the stop forwarding action.")),Cw=pe("ports-open-browser-icon",M.globe,p("openBrowserIcon","Icon for the open browser action.")),Sw=pe("ports-open-preview-icon",M.openPreview,p("openPreviewIcon","Icon for the open preview action.")),Ew=pe("ports-copy-address-icon",M.clippy,p("copyAddressIcon","Icon for the copy local address action.")),au=pe("ports-label-icon",M.tag,p("labelPortIcon","Icon for the label port action.")),_w=pe("ports-forwarded-without-process-icon",M.circleOutline,p("forwardedPortWithoutProcessIcon","Icon for forwarded ports that don't have a running process.")),kw=pe("ports-forwarded-with-process-icon",M.circleFilled,p("forwardedPortWithProcessIcon","Icon for forwarded ports that do have a running process.")),xw=bo("externalUriOpenerService"),Rn=new N("forwardedPortsViewEnabled",!1,p("tunnel.forwardedPortsViewEnabled","Whether the Ports view is enabled.")),Dw=new N("openPreviewEnabled",!1);class Iw{constructor(e){this.remoteExplorerService=e,this.headerRowHeight=22}getHeight(e){return e.tunnelType===he.Add&&!this.remoteExplorerService.getEditableData(void 0)?30:22}}function _s(c){return{label:"",tunnel:c,editId:Pe.None,tooltip:""}}class Aw{constructor(){this.label="",this.tooltip="",this.weight=1,this.minimumWidth=40,this.maximumWidth=40,this.templateId="actionbar"}project(e){if(e.tunnelType===he.Add)return _s(e);const t=e.processDescription?kw:_w;let i="";return e instanceof Le&&(i=`${e.iconTooltip} ${e.tooltipPostfix}`),{label:"",icon:t,tunnel:e,editId:Pe.None,tooltip:i}}}class Tw{constructor(){this.label=p("tunnel.portColumn.label","Port"),this.tooltip=p("tunnel.portColumn.tooltip","The label and remote port number of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){const t=e.tunnelType===he.Add,i=e.label;let o="";return e instanceof Le&&!t?o=`${e.portTooltip} ${e.tooltipPostfix}`:o=i,{label:i,tunnel:e,menuId:b.TunnelPortInline,editId:e.tunnelType===he.Add?Pe.New:Pe.Label,tooltip:o}}}class uc{constructor(){this.label=p("tunnel.addressColumn.label","Local Address"),this.tooltip=p("tunnel.addressColumn.tooltip","The address that the forwarded port is available at locally."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===he.Add)return _s(e);const t=e.localAddress??"";let i=t;return e instanceof Le&&(i=e.tooltipPostfix),{label:t,menuId:b.TunnelLocalAddressInline,tunnel:e,editId:Pe.LocalPort,tooltip:i,markdownTooltip:t?uc.getHoverText(t):void 0}}static getHoverText(e){return function(t){const i=t.getValue("editor");let o="";i.multiCursorModifier==="ctrlCmd"?le?o=p("portsLink.followLinkAlt.mac","option + click"):o=p("portsLink.followLinkAlt","alt + click"):le?o=p("portsLink.followLinkCmd","cmd + click"):o=p("portsLink.followLinkCtrl","ctrl + click");const s=new Cf("",!0),n=e.startsWith("http")?e:`http://${e}`;return s.appendLink(n,"Follow link").appendMarkdown(` (${o})`)}}}class Vw{constructor(){this.label=p("tunnel.processColumn.label","Running Process"),this.tooltip=p("tunnel.processColumn.tooltip","The command line of the process that is using the port."),this.weight=2,this.templateId="actionbar"}project(e){return e.tunnelType===he.Add?_s(e):{label:e.processDescription??"",tunnel:e,editId:Pe.None,tooltip:e instanceof Le?e.processTooltip:""}}}class Rw{constructor(){this.label=p("tunnel.originColumn.label","Origin"),this.tooltip=p("tunnel.originColumn.tooltip","The source that a forwarded port originates from. Can be an extension, user forwarded, statically forwarded, or automatically forwarded."),this.weight=1,this.templateId="actionbar"}project(e){if(e.tunnelType===he.Add)return _s(e);const t=e.source.description,i=`${e instanceof Le?e.originTooltip:""}. ${e instanceof Le?e.tooltipPostfix:""}`;return{label:t,menuId:b.TunnelOriginInline,tunnel:e,editId:Pe.None,tooltip:i}}}class Pw{constructor(){this.label=p("tunnel.privacyColumn.label","Visibility"),this.tooltip=p("tunnel.privacyColumn.tooltip","The availability of the forwarded port."),this.weight=1,this.templateId="actionbar"}project(e){var o;if(e.tunnelType===he.Add)return _s(e);const t=(o=e.privacy)==null?void 0:o.label;let i="";return e instanceof Le&&(i=`${e.privacy.label} ${e.tooltipPostfix}`),{label:t,tunnel:e,icon:{id:e.privacy.themeIcon},editId:Pe.None,tooltip:i}}}let sa=class extends R{constructor(e,t,i,o,s,n,r,a){super(),this.instantiationService=e,this.contextKeyService=t,this.menuService=i,this.contextViewService=o,this.remoteExplorerService=s,this.commandService=n,this.configurationService=r,this.hoverService=a,this.templateId="actionbar"}set actionRunner(e){this._actionRunner=e}renderTemplate(e){const t=se(e,z(".ports-view-actionbar-cell")),i=se(t,z(".ports-view-actionbar-cell-icon")),o=new Wa(t,{supportHighlights:!0,hoverDelegate:{showHover:r=>this.hoverService.showHover(r),delay:this.configurationService.getValue("workbench.hover.delay")}}),s=se(t,z(".actions")),n=new vo(s,{actionViewItemProvider:un.bind(void 0,this.instantiationService)});return{label:o,icon:i,actionBar:n,container:t,elementDisposable:R.None}}renderElement(e,t,i){i.actionBar.clear(),i.icon.className="ports-view-actionbar-cell-icon",i.icon.style.display="none",i.label.setLabel(""),i.label.element.style.display="none",i.container.style.height="22px",i.button&&(i.button.element.style.display="none",i.button.dispose()),i.container.style.paddingLeft="0px",i.elementDisposable.dispose();let o;e.editId===Pe.New&&(o=this.remoteExplorerService.getEditableData(void 0))?this.renderInputBox(i.container,o):(o=this.remoteExplorerService.getEditableData(e.tunnel,e.editId),o?this.renderInputBox(i.container,o):e.tunnel.tunnelType===he.Add&&e.menuId===b.TunnelPortInline?this.renderButton(e,i):this.renderActionBarItem(e,i))}renderButton(e,t){t.container.style.paddingLeft="7px",t.container.style.height="28px",t.button=this._register(new ff(t.container,bf)),t.button.label=e.label,t.button.element.title=e.tooltip,this._register(t.button.onDidClick(()=>{this.commandService.executeCommand(Oe.INLINE_ID)}))}tunnelContext(e){let t;return e instanceof Le&&(t=e.strip()),t||(t={tunnelType:e.tunnelType,remoteHost:e.remoteHost,remotePort:e.remotePort,localAddress:e.localAddress,protocol:e.protocol,localUri:e.localUri,localPort:e.localPort,name:e.name,closeable:e.closeable,source:e.source,privacy:e.privacy,processDescription:e.processDescription,label:e.label}),t}renderActionBarItem(e,t){t.label.element.style.display="flex",t.label.setLabel(e.label,void 0,{title:e.markdownTooltip?{markdown:e.markdownTooltip(this.configurationService),markdownNotSupportedFallback:e.tooltip}:e.tooltip,extraClasses:e.menuId===b.TunnelLocalAddressInline?["ports-view-actionbar-cell-localaddress"]:void 0}),t.actionBar.context=this.tunnelContext(e.tunnel),t.container.style.paddingLeft="10px";const i=[["view",hc],[ks.key,e.tunnel.tunnelType],[xs.key,e.tunnel.closeable],[na.key,e.tunnel.privacy.id],[Pn.key,e.tunnel.protocol]],o=this.contextKeyService.createOverlay(i),s=new A;if(t.elementDisposable=s,e.menuId){const n=s.add(this.menuService.createMenu(e.menuId,o));let r=[];if(Ui(n,{shouldForwardArgs:!0},r),r){const a=r.filter(d=>d.id.toLowerCase().indexOf("label")>=0);a.length>1&&(a.sort((d,l)=>d.label.length-l.label.length),a.pop(),r=r.filter(d=>a.indexOf(d)<0)),t.actionBar.push(r,{icon:!0,label:!1}),this._actionRunner&&(t.actionBar.actionRunner=this._actionRunner)}}e.icon&&(t.icon.className=`ports-view-actionbar-cell-icon ${me.asClassName(e.icon)}`,t.icon.title=e.tooltip,t.icon.style.display="inline")}renderInputBox(e,t){this.inputDone&&(this.inputDone(!1,!1),this.inputDone=void 0),e.style.paddingLeft="5px";const i=t.startingValue||"",o=new vf(e,this.contextViewService,{ariaLabel:p("remote.tunnelsView.input","Press Enter to confirm or Escape to cancel."),validationOptions:{validation:r=>{const a=t.validationMessage(r);return a?{content:a.content,formatContent:!0,type:a.severity===wt.Error?3:1}:null}},placeholder:t.placeholder||"",inputBoxStyles:wf});o.value=i,o.focus(),o.select({start:0,end:t.startingValue?t.startingValue.length:0});const s=Sf(async(r,a)=>{ue(n),this.inputDone&&(this.inputDone=void 0),o.element.style.display="none";const d=o.value;if(a)return t.onFinish(d,r)});this.inputDone=s;const n=[o,Fd(o.inputElement,S.KEY_DOWN,async r=>{if(r.equals(3))return r.stopPropagation(),o.validate()!==3?s(!0,!0):s(!1,!0);if(r.equals(9))return r.preventDefault(),r.stopPropagation(),s(!1,!0)}),w(o.inputElement,S.BLUR,()=>s(o.validate()!==3,!0))];return ie(()=>{s(!1,!1)})}disposeElement(e,t,i,o){i.elementDisposable.dispose()}disposeTemplate(e){var t;e.label.dispose(),e.actionBar.dispose(),e.elementDisposable.dispose(),(t=e.button)==null||t.dispose()}};sa=x([h(0,D),h(1,H),h(2,Xe),h(3,ss),h(4,He),h(5,It),h(6,L),h(7,gt)],sa);class Le{static createFromTunnel(e,t,i,o=he.Forwarded,s){return new Le(o,i.remoteHost,i.remotePort,i.source,!!i.hasRunningProcess,i.protocol,i.localUri,i.localAddress,i.localPort,s===void 0?i.closeable:s,i.name,i.runningProcess,i.pid,i.privacy,e,t)}strip(){return new Le(this.tunnelType,this.remoteHost,this.remotePort,this.source,this.hasRunningProcess,this.protocol,this.localUri,this.localAddress,this.localPort,this.closeable,this.name,this.runningProcess,this.pid,this._privacy)}constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E){this.tunnelType=e,this.remoteHost=t,this.remotePort=i,this.source=o,this.hasRunningProcess=s,this.protocol=n,this.localUri=r,this.localAddress=a,this.localPort=d,this.closeable=l,this.name=u,this.runningProcess=g,this.pid=m,this._privacy=f,this.remoteExplorerService=C,this.tunnelService=E}get label(){if(this.tunnelType===he.Add&&this.name)return this.name;const e=_n(this.remoteHost)||kn(this.remoteHost)?`${this.remotePort}`:`${this.remoteHost}:${this.remotePort}`;return this.name?`${this.name} (${e})`:e}set processDescription(e){this.runningProcess=e}get processDescription(){var t;let e="";return this.runningProcess?(this.pid&&((t=this.remoteExplorerService)!=null&&t.namedProcesses.has(this.pid))?e=this.remoteExplorerService.namedProcesses.get(this.pid):e=this.runningProcess.replace(/\0/g," ").trim(),this.pid&&(e+=` (${this.pid})`)):this.hasRunningProcess&&(e=p("tunnelView.runningProcess.inacessable","Process information unavailable")),e}get tooltipPostfix(){let e;return this.localAddress?e=p("remote.tunnel.tooltipForwarded","Remote port {0}:{1} forwarded to local address {2}. ",this.remoteHost,this.remotePort,this.localAddress):e=p("remote.tunnel.tooltipCandidate","Remote port {0}:{1} not forwarded. ",this.remoteHost,this.remotePort),e}get iconTooltip(){return this.tunnelType===he.Add?this.label:`${this.processDescription?p("tunnel.iconColumn.running","Port has running process."):p("tunnel.iconColumn.notRunning","No running process.")}`}get portTooltip(){return this.tunnelType===he.Add?"":`${this.name?p("remote.tunnel.tooltipName","Port labeled {0}. ",this.name):""}`}get processTooltip(){return this.processDescription??""}get originTooltip(){return this.source.description}get privacy(){var e,t;return(e=this.tunnelService)!=null&&e.privacyOptions?((t=this.tunnelService)==null?void 0:t.privacyOptions.find(i=>i.id===this._privacy))??{id:"",themeIcon:M.question.id,label:p("tunnelPrivacy.unknown","Unknown")}:{id:Ko.Private,themeIcon:vw.id,label:p("tunnelPrivacy.private","Private")}}}const ks=new N("tunnelType",he.Add,!0),xs=new N("tunnelCloseable",!1,!0),na=new N("tunnelPrivacy",void 0,!0),cu=new N("tunnelPrivacyEnabled",!1,!0),Pn=new N("tunnelProtocol",_e.Http,!0),Ln=new N("tunnelViewFocus",!1,p("tunnel.focusContext","Whether the Ports view has focus.")),Ds="tunnelViewSelection",Lw=new N(Ds,void 0,!0),du="tunnelViewMultiSelection",lu=new N(du,void 0,!0),hu=new N("portChangable",!1,!0);let lo=class uu extends En{constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E,V,B){super(t,i,o,n,s,a,r,d,m,C),this.viewModel=e,this.quickInputService=l,this.commandService=u,this.menuService=g,this.remoteExplorerService=f,this.tunnelService=E,this.contextViewService=V,this.hoverService=B,this.isEditing=!1,this.titleActions=[],this.lastFocus=[],this.tunnelTypeContext=ks.bindTo(s),this.tunnelCloseableContext=xs.bindTo(s),this.tunnelPrivacyContext=na.bindTo(s),this.tunnelPrivacyEnabledContext=cu.bindTo(s),this.tunnelPrivacyEnabledContext.set(E.privacyOptions.length!==0),this.tunnelProtocolContext=Pn.bindTo(s),this.tunnelViewFocusContext=Ln.bindTo(s),this.tunnelViewSelectionContext=Lw.bindTo(s),this.tunnelViewMultiSelectionContext=lu.bindTo(s),this.portChangableContextKey=hu.bindTo(s);const De=this.contextKeyService.createOverlay([["view",uu.ID]]),Me=this._register(this.menuService.createMenu(b.TunnelTitle,De)),bt=()=>{this.titleActions=[],Ui(Me,void 0,this.titleActions),this.updateActions()};this._register(Me.onDidChange(bt)),bt(),this._register(ie(()=>{this.titleActions=[]})),this.registerPrivacyActions()}registerPrivacyActions(){for(const e of this.tunnelService.privacyOptions){const t=`remote.tunnel.privacy${e.id}`;q.registerCommand(t,ra.handler(e.id)),_.appendMenuItem(b.TunnelPrivacy,{order:0,command:{id:t,title:e.label,toggled:na.isEqualTo(e.id)}})}}get portCount(){return this.remoteExplorerService.tunnelModel.forwarded.size+this.remoteExplorerService.tunnelModel.detected.size}renderBody(e){super.renderBody(e);const t=se(e,z(".tree-explorer-viewlet-tree-view")),i=se(t,z(".customview-tree"));i.classList.add("ports-view"),i.classList.add("file-icon-themable-tree","show-file-icons");const o=new sa(this.instantiationService,this.contextKeyService,this.menuService,this.contextViewService,this.remoteExplorerService,this.commandService,this.configurationService,this.hoverService),s=[new Aw,new Tw,new uc,new Vw];this.tunnelService.canChangePrivacy&&s.push(new Pw),s.push(new Rw),this.table=this.instantiationService.createInstance(yf,"RemoteTunnels",i,new Iw(this.remoteExplorerService),s,[o],{keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:d=>d.label},multipleSelectionSupport:!0,accessibilityProvider:{getAriaLabel:d=>d instanceof Le?`${d.tooltipPostfix} ${d.portTooltip} ${d.iconTooltip} ${d.processTooltip} ${d.originTooltip} ${this.tunnelService.canChangePrivacy?d.privacy.label:""}`:d.label,getWidgetAriaLabel:()=>p("tunnelView","Tunnel View")},openOnSingleClick:!0});const n=new is;o.actionRunner=n,this._register(this.table.onContextMenu(d=>this.onContextMenu(d,n))),this._register(this.table.onMouseDblClick(d=>this.onMouseDblClick(d))),this._register(this.table.onDidChangeFocus(d=>this.onFocusChanged(d))),this._register(this.table.onDidChangeSelection(d=>this.onSelectionChanged(d))),this._register(this.table.onDidFocus(()=>this.tunnelViewFocusContext.set(!0))),this._register(this.table.onDidBlur(()=>this.tunnelViewFocusContext.set(!1)));const r=()=>this.table.splice(0,Number.POSITIVE_INFINITY,this.viewModel.all);r();let a=this.portCount;this._register(I.debounce(this.viewModel.onForwardedPortsChanged,(d,l)=>l,50)(()=>{const d=this.portCount;(a===0||d===0)&&a!==d&&this._onDidChangeViewWelcomeState.fire(),a=d,r()})),this._register(this.table.onMouseClick(d=>{if(this.hasOpenLinkModifier(d.browserEvent)){const l=this.table.getSelectedElements();(l.length===0||l.length===1&&l[0]===d.element)&&this.commandService.executeCommand(it.ID,d.element)}})),this._register(this.table.onDidOpen(d=>{var l;!d.element||d.element.tunnelType!==he.Forwarded||((l=d.browserEvent)==null?void 0:l.type)==="dblclick"&&this.commandService.executeCommand(ai.ID)})),this._register(this.remoteExplorerService.onDidChangeEditable(d=>{this.isEditing=!!this.remoteExplorerService.getEditableData(d==null?void 0:d.tunnel,d==null?void 0:d.editId),this._onDidChangeViewWelcomeState.fire(),this.isEditing||i.classList.remove("highlight"),r(),this.isEditing?(i.classList.add("highlight"),d||this.table.reveal(this.table.indexOf(this.viewModel.input))):(d&&d.tunnel.tunnelType!==he.Add&&this.table.setFocus(this.lastFocus),this.focus())}))}shouldShowWelcome(){return this.viewModel.isEmpty()&&!this.isEditing}focus(){super.focus(),this.table.domFocus()}onFocusChanged(e){e.indexes.length>0&&e.elements.length>0&&(this.lastFocus=[...e.indexes]);const t=e.elements,i=t&&t.length?t[0]:void 0;i?(this.tunnelViewSelectionContext.set(Q(i.remoteHost,i.remotePort)),this.tunnelTypeContext.set(i.tunnelType),this.tunnelCloseableContext.set(!!i.closeable),this.tunnelPrivacyContext.set(i.privacy.id),this.tunnelProtocolContext.set(i.protocol===_e.Https?_e.Https:_e.Https),this.portChangableContextKey.set(!!i.localPort)):(this.tunnelTypeContext.reset(),this.tunnelViewSelectionContext.reset(),this.tunnelCloseableContext.reset(),this.tunnelPrivacyContext.reset(),this.tunnelProtocolContext.reset(),this.portChangableContextKey.reset())}hasOpenLinkModifier(e){const t=this.configurationService.getValue("editor");let i=!1;return t.multiCursorModifier==="ctrlCmd"?i=e.altKey:le?i=e.metaKey:i=e.ctrlKey,i}onSelectionChanged(e){const t=e.elements;t.length>1?this.tunnelViewMultiSelectionContext.set(t.map(i=>Q(i.remoteHost,i.remotePort))):this.tunnelViewMultiSelectionContext.set(void 0)}onContextMenu(e,t){if(e.element!==void 0&&!(e.element instanceof Le))return;e.browserEvent.preventDefault(),e.browserEvent.stopPropagation();const i=e.element;i?(this.table.setFocus([this.table.indexOf(i)]),this.tunnelTypeContext.set(i.tunnelType),this.tunnelCloseableContext.set(!!i.closeable),this.tunnelPrivacyContext.set(i.privacy.id),this.tunnelProtocolContext.set(i.protocol),this.portChangableContextKey.set(!!i.localPort)):(this.tunnelTypeContext.set(he.Add),this.tunnelCloseableContext.set(!1),this.tunnelPrivacyContext.set(void 0),this.tunnelProtocolContext.set(void 0),this.portChangableContextKey.set(!1)),this.contextMenuService.showContextMenu({menuId:b.TunnelContext,menuActionOptions:{shouldForwardArgs:!0},contextKeyService:this.table.contextKeyService,getAnchor:()=>e.anchor,getActionViewItem:o=>{const s=this.keybindingService.lookupKeybinding(o.id);if(s)return new th(o,o,{label:!0,keybinding:s.getLabel()})},onHide:o=>{o&&this.table.domFocus()},getActionsContext:()=>i==null?void 0:i.strip(),actionRunner:t})}onMouseDblClick(e){e.element||this.commandService.executeCommand(Oe.INLINE_ID)}layoutBody(e,t){super.layoutBody(e,t),this.table.layout(e,t)}};lo.ID=hc;lo.TITLE=p("remote.tunnel","Ports");lo=x([h(2,we),h(3,xe),h(4,H),h(5,L),h(6,D),h(7,nt),h(8,Ki),h(9,Kt),h(10,It),h(11,Xe),h(12,X),h(13,He),h(14,Ye),h(15,Wt),h(16,ss),h(17,gt)],lo);function _i(c){return c&&c.tunnelType&&c.remoteHost&&c.source}var ai;(function(c){c.ID="remote.tunnel.label",c.LABEL=p("remote.tunnel.label","Set Port Label"),c.COMMAND_ID_KEYWORD="label";function e(){return async(t,i)=>{const o=t.get(He);let s;if(_i(i))s=i;else{const n=t.get(H).getContextKeyValue(Ds),r=n?o.tunnelModel.forwarded.get(n):void 0;if(r){const a=t.get(Wt);s=Le.createFromTunnel(o,a,r)}}if(s){const n=s;return new Promise(r=>{const a=n.name?n.name:`${n.remotePort}`;o.setEditable(n,Pe.Label,{onFinish:async(d,l)=>{d=d.trim(),o.setEditable(n,Pe.Label,null);const u=l&&d!==a;u&&await o.tunnelModel.name(n.remoteHost,n.remotePort,d),r(u?{port:n.remotePort,label:d}:void 0)},validationMessage:()=>null,placeholder:p("remote.tunnelsView.labelPlaceholder","Port label"),startingValue:a})})}}}c.handler=e})(ai||(ai={}));const pu=p("remote.tunnelsView.portNumberValid","Forwarded port should be a number or a host:port."),pc=65536,gu=p("remote.tunnelsView.portNumberToHigh","Port number must be  0 and < {0}.",pc),mu=p("remote.tunnelView.inlineElevationMessage","May Require Sudo"),Ow=p("remote.tunnelView.alreadyForwarded","Port is already forwarded");var Oe;(function(c){c.INLINE_ID="remote.tunnel.forwardInline",c.COMMANDPALETTE_ID="remote.tunnel.forwardCommandPalette",c.LABEL={value:p("remote.tunnel.forward","Forward a Port"),original:"Forward a Port"},c.TREEITEM_LABEL=p("remote.tunnel.forwardItem","Forward Port");const e=p("remote.tunnel.forwardPrompt","Port number or address (eg. 3000 or 10.10.10.10:2000).");function t(n,r,a,d){const l=Hs(a);if(l){if(l.port>=pc)return{content:gu,severity:wt.Error};if(d&&r.isPortPrivileged(l.port))return{content:mu,severity:wt.Info};if(Ie(n.tunnelModel.forwarded,l.host,l.port))return{content:Ow,severity:wt.Error}}else return{content:pu,severity:wt.Error};return null}function i(n,r,a,d){r||n.warn(p("remote.tunnel.forwardError","Unable to forward {0}:{1}. The host may not be available or that remote port may already be forwarded",a,d))}function o(){return async(n,r)=>{const a=n.get(He),d=n.get(Be),l=n.get(Wt);a.setEditable(void 0,Pe.New,{onFinish:async(u,g)=>{a.setEditable(void 0,Pe.New,null);let m;g&&(m=Hs(u))&&a.forward({remote:{host:m.host,port:m.port},elevateIfNeeded:!0}).then(f=>i(d,f,m.host,m.port))},validationMessage:u=>t(a,l,u,l.canElevate),placeholder:e})}}c.inlineHandler=o;function s(){return async(n,r)=>{const a=n.get(He),d=n.get(Be),l=n.get(yn),u=n.get(Kt),g=n.get(Wt);await l.openView(lo.ID,!0);const m=await u.input({prompt:e,validateInput:C=>Promise.resolve(t(a,g,C,g.canElevate))});let f;m&&(f=Hs(m))&&a.forward({remote:{host:f.host,port:f.port},elevateIfNeeded:!0}).then(C=>i(d,C,f.host,f.port))}}c.commandPaletteHandler=s})(Oe||(Oe={}));function fu(c,e,t){const i=c.map(o=>{const s=Le.createFromTunnel(e,t,o);return{label:s.label,description:s.processDescription,tunnel:s}});return i.length===0&&i.push({label:p("remote.tunnel.closeNoPorts","No ports currently forwarded. Try running the {0} command",Oe.LABEL.value)}),i}var ht;(function(c){c.INLINE_ID="remote.tunnel.closeInline",c.COMMANDPALETTE_ID="remote.tunnel.closeCommandPalette",c.LABEL={value:p("remote.tunnel.close","Stop Forwarding Port"),original:"Stop Forwarding Port"};function e(){return async(i,o)=>{const s=i.get(H),n=i.get(He);let r=[];const a=s.getContextKeyValue(du);if(a)a.forEach(d=>{const l=n.tunnelModel.forwarded.get(d);l&&(r==null||r.push(l))});else if(_i(o))r=[o];else{const d=s.getContextKeyValue(Ds),l=d?n.tunnelModel.forwarded.get(d):void 0;l&&(r=[l])}if(!(!r||r.length===0))return Promise.all(r.map(d=>n.close({host:d.remoteHost,port:d.remotePort},St.User)))}}c.inlineHandler=e;function t(){return async i=>{const o=i.get(Kt),s=i.get(He),n=i.get(Wt),r=i.get(It),a=fu(Array.from(s.tunnelModel.forwarded.values()).filter(l=>l.closeable),s,n),d=await o.pick(a,{placeHolder:p("remote.tunnel.closePlaceholder","Choose a port to stop forwarding")});d&&d.tunnel?await s.close({host:d.tunnel.remoteHost,port:d.tunnel.remotePort},St.User):d&&await r.executeCommand(Oe.COMMANDPALETTE_ID)}}c.commandPaletteHandler=t})(ht||(ht={}));var it;(function(c){c.ID="remote.tunnel.open",c.LABEL=p("remote.tunnel.open","Open in Browser");function e(){return async(i,o)=>{let s;if(_i(o)?s=Q(o.remoteHost,o.remotePort):o.tunnelRemoteHost&&o.tunnelRemotePort&&(s=Q(o.tunnelRemoteHost,o.tunnelRemotePort)),s){const n=i.get(He).tunnelModel,r=i.get(Ki);return t(n,r,s)}}}c.handler=e;function t(i,o,s){const n=i.forwarded.get(s)||i.detected.get(s);return n?o.open(n.localUri,{allowContributedOpeners:!1}):Promise.resolve()}c.run=t})(it||(it={}));var Et;(function(c){c.ID="remote.tunnel.openPreview",c.LABEL=p("remote.tunnel.openPreview","Preview in Editor");function e(){return async(i,o)=>{let s;if(_i(o)?s=Q(o.remoteHost,o.remotePort):o.tunnelRemoteHost&&o.tunnelRemotePort&&(s=Q(o.tunnelRemoteHost,o.tunnelRemotePort)),s){const n=i.get(He).tunnelModel,r=i.get(Ki),a=i.get(xw);return t(n,r,a,s)}}}c.handler=e;async function t(i,o,s,n){const r=i.forwarded.get(n)||i.detected.get(n);if(r){const a=r.remoteHost.includes(":")?`[${r.remoteHost}]`:r.remoteHost,d=P.parse(`http://${a}:${r.remotePort}`),l=await s.getOpener(r.localUri,{sourceUri:d},new st().token);return l?l.openExternalUri(r.localUri,{sourceUri:d},new st().token):o.open(r.localUri)}return Promise.resolve()}c.run=t})(Et||(Et={}));var ho;(function(c){c.ID="remote.tunnel.openCommandPalette",c.LABEL=p("remote.tunnel.openCommandPalette","Open Port in Browser");function e(){return async(t,i)=>{const o=t.get(He),s=t.get(Wt),n=o.tunnelModel,r=t.get(Kt),a=t.get(Ki),d=t.get(It),l=[...n.forwarded,...n.detected].map(g=>{const m=Le.createFromTunnel(o,s,g[1]);return{label:m.label,description:m.processDescription,tunnel:m}});l.length===0?l.push({label:p("remote.tunnel.openCommandPaletteNone","No ports currently forwarded. Open the Ports view to get started.")}):l.push({label:p("remote.tunnel.openCommandPaletteView","Open the Ports view...")});const u=await r.pick(l,{placeHolder:p("remote.tunnel.openCommandPalettePick","Choose the port to open")});if(u&&u.tunnel)return it.run(n,a,Q(u.tunnel.remoteHost,u.tunnel.remotePort));if(u)return d.executeCommand(`${hc}.focus`)}}c.handler=e})(ho||(ho={}));var ut;(function(c){c.INLINE_ID="remote.tunnel.copyAddressInline",c.COMMANDPALETTE_ID="remote.tunnel.copyAddressCommandPalette",c.INLINE_LABEL=p("remote.tunnel.copyAddressInline","Copy Local Address"),c.COMMANDPALETTE_LABEL=p("remote.tunnel.copyAddressCommandPalette","Copy Forwarded Port Address");async function e(o,s,n){const r=o.tunnelModel.address(n.remoteHost,n.remotePort);r&&await s.writeText(r.toString())}function t(){return async(o,s)=>{const n=o.get(He);let r;if(_i(s))r=s;else{const a=o.get(H).getContextKeyValue(Ds);r=a?n.tunnelModel.forwarded.get(a):void 0}if(r)return e(n,o.get(Uo),r)}}c.inlineHandler=t;function i(){return async(o,s)=>{const n=o.get(Kt),r=o.get(He),a=o.get(Wt),d=o.get(It),l=o.get(Uo),u=Array.from(r.tunnelModel.forwarded.values()).concat(Array.from(r.tunnelModel.detected.values())),g=await n.pick(fu(u,r,a),{placeHolder:p("remote.tunnel.copyAddressPlaceholdter","Choose a forwarded port")});g&&g.tunnel?await e(r,l,g.tunnel):g&&await d.executeCommand(Oe.COMMANDPALETTE_ID)}}c.commandPaletteHandler=i})(ut||(ut={}));var uo;(function(c){c.ID="remote.tunnel.changeLocalPort",c.LABEL=p("remote.tunnel.changeLocalPort","Change Local Address Port");function e(i,o,s){if(o.match(/^[0-9]+$/)){if(Number(o)>=pc)return{content:gu,severity:wt.Error};if(s&&i.isPortPrivileged(Number(o)))return{content:mu,severity:wt.Info}}else return{content:pu,severity:wt.Error};return null}function t(){return async(i,o)=>{const s=i.get(He),n=i.get(Be),r=i.get(Wt);let a;if(_i(o))a=o;else{const d=i.get(H).getContextKeyValue(Ds),l=d?s.tunnelModel.forwarded.get(d):void 0;if(l){const u=i.get(Wt);a=Le.createFromTunnel(s,u,l)}}if(a){const d=a;s.setEditable(d,Pe.LocalPort,{onFinish:async(l,u)=>{if(s.setEditable(d,Pe.LocalPort,null),u){await s.close({host:d.remoteHost,port:d.remotePort},St.Other);const g=Number(l),m=await s.forward({remote:{host:d.remoteHost,port:d.remotePort},local:g,name:d.name,elevateIfNeeded:!0,source:d.source});m&&m.tunnelLocalPort!==g&&n.warn(p("remote.tunnel.changeLocalPortNumber","The local port {0} is not available. Port number {1} has been used instead",l,m.tunnelLocalPort??m.localAddress))}},validationMessage:l=>e(r,l,r.canElevate),placeholder:p("remote.tunnelsView.changePort","New local port")})}}}c.handler=t})(uo||(uo={}));var ra;(function(c){function e(t){return async(i,o)=>{if(_i(o)){const s=i.get(He);return await s.close({host:o.remoteHost,port:o.remotePort},St.Other),s.forward({remote:{host:o.remoteHost,port:o.remotePort},local:o.localPort,name:o.name,elevateIfNeeded:!0,privacy:t,source:o.source})}}}c.handler=e})(ra||(ra={}));var zt;(function(c){c.ID_HTTP="remote.tunnel.setProtocolHttp",c.ID_HTTPS="remote.tunnel.setProtocolHttps",c.LABEL_HTTP=p("remote.tunnel.protocolHttp","HTTP"),c.LABEL_HTTPS=p("remote.tunnel.protocolHttps","HTTPS");async function e(o,s,n){if(_i(o)){const r={protocol:s};return n.tunnelModel.configPortsAttributes.addAttributes(o.remotePort,r,4)}}function t(){return async(o,s)=>e(s,_e.Http,o.get(He))}c.handlerHttp=t;function i(){return async(o,s)=>e(s,_e.Https,o.get(He))}c.handlerHttps=i})(zt||(zt={}));const gc=10,qi=ks.isEqualTo(he.Forwarded),Yi=v.or(qi,ks.isEqualTo(he.Detected)),ki=lu.isEqualTo(void 0);k.registerCommandAndKeybindingRule({id:ai.ID,weight:200+gc,when:v.and(Ln,qi,ki),primary:60,mac:{primary:3},handler:ai.handler()});q.registerCommand(Oe.INLINE_ID,Oe.inlineHandler());q.registerCommand(Oe.COMMANDPALETTE_ID,Oe.commandPaletteHandler());k.registerCommandAndKeybindingRule({id:ht.INLINE_ID,weight:200+gc,when:v.and(xs,Ln),primary:20,mac:{primary:2049,secondary:[20]},handler:ht.inlineHandler()});q.registerCommand(ht.COMMANDPALETTE_ID,ht.commandPaletteHandler());q.registerCommand(it.ID,it.handler());q.registerCommand(Et.ID,Et.handler());q.registerCommand(ho.ID,ho.handler());k.registerCommandAndKeybindingRule({id:ut.INLINE_ID,weight:200+gc,when:v.and(Ln,Yi,ki),primary:2081,handler:ut.inlineHandler()});q.registerCommand(ut.COMMANDPALETTE_ID,ut.commandPaletteHandler());q.registerCommand(uo.ID,uo.handler());q.registerCommand(zt.ID_HTTP,zt.handlerHttp());q.registerCommand(zt.ID_HTTPS,zt.handlerHttps());_.appendMenuItem(b.CommandPalette,{command:{id:ht.COMMANDPALETTE_ID,title:ht.LABEL},when:Rn});_.appendMenuItem(b.CommandPalette,{command:{id:Oe.COMMANDPALETTE_ID,title:Oe.LABEL},when:Rn});_.appendMenuItem(b.CommandPalette,{command:{id:ut.COMMANDPALETTE_ID,title:ut.COMMANDPALETTE_LABEL},when:Rn});_.appendMenuItem(b.CommandPalette,{command:{id:ho.ID,title:ho.LABEL},when:Rn});_.appendMenuItem(b.TunnelContext,{group:"._open",order:0,command:{id:it.ID,title:it.LABEL},when:v.and(Yi,ki)});_.appendMenuItem(b.TunnelContext,{group:"._open",order:1,command:{id:Et.ID,title:Et.LABEL},when:v.and(Yi,ki)});_.appendMenuItem(b.TunnelContext,{group:"0_manage",order:1,command:{id:ai.ID,title:ai.LABEL,icon:au},when:v.and(qi,ki)});_.appendMenuItem(b.TunnelContext,{group:"2_localaddress",order:0,command:{id:ut.INLINE_ID,title:ut.INLINE_LABEL},when:v.and(Yi,ki)});_.appendMenuItem(b.TunnelContext,{group:"2_localaddress",order:1,command:{id:uo.ID,title:uo.LABEL},when:v.and(qi,hu,ki)});_.appendMenuItem(b.TunnelContext,{group:"2_localaddress",order:2,submenu:b.TunnelPrivacy,title:p("tunnelContext.privacyMenu","Port Visibility"),when:v.and(qi,cu)});_.appendMenuItem(b.TunnelContext,{group:"2_localaddress",order:3,submenu:b.TunnelProtocol,title:p("tunnelContext.protocolMenu","Change Port Protocol"),when:v.and(qi,ki)});_.appendMenuItem(b.TunnelContext,{group:"3_forward",order:0,command:{id:ht.INLINE_ID,title:ht.LABEL},when:xs});_.appendMenuItem(b.TunnelContext,{group:"3_forward",order:1,command:{id:Oe.INLINE_ID,title:Oe.LABEL}});_.appendMenuItem(b.TunnelProtocol,{order:0,command:{id:zt.ID_HTTP,title:zt.LABEL_HTTP,toggled:Pn.isEqualTo(_e.Http)}});_.appendMenuItem(b.TunnelProtocol,{order:1,command:{id:zt.ID_HTTPS,title:zt.LABEL_HTTPS,toggled:Pn.isEqualTo(_e.Https)}});_.appendMenuItem(b.TunnelPortInline,{group:"0_manage",order:0,command:{id:Oe.INLINE_ID,title:Oe.TREEITEM_LABEL,icon:ww},when:ks.isEqualTo(he.Candidate)});_.appendMenuItem(b.TunnelPortInline,{group:"0_manage",order:4,command:{id:ai.ID,title:ai.LABEL,icon:au},when:qi});_.appendMenuItem(b.TunnelPortInline,{group:"0_manage",order:5,command:{id:ht.INLINE_ID,title:ht.LABEL,icon:yw},when:xs});_.appendMenuItem(b.TunnelLocalAddressInline,{order:-1,command:{id:ut.INLINE_ID,title:ut.INLINE_LABEL,icon:Ew},when:Yi});_.appendMenuItem(b.TunnelLocalAddressInline,{order:0,command:{id:it.ID,title:it.LABEL,icon:Cw},when:Yi});_.appendMenuItem(b.TunnelLocalAddressInline,{order:1,command:{id:Et.ID,title:Et.LABEL,icon:Sw},when:Yi});mf("ports.iconRunningProcessForeground",{light:As,dark:As,hcDark:As,hcLight:As},p("portWithRunningProcess.foreground","The color of the icon for a port that has an associated running process."));const ir="workbench.view.remote";class mc extends R{constructor(e,t,i,o,s,n,r,a){super(),this.notificationService=e,this.remoteExplorerService=t,this.openerService=i,this.externalOpenerService=o,this.tunnelService=s,this.hostService=n,this.logService=r,this.contextKeyService=a,this.alreadyOpenedOnce=new Set,this.lastNotifyTime=new Date,this.lastNotifyTime.setFullYear(this.lastNotifyTime.getFullYear()-1)}async doAction(e){var i,o;this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Starting action for ${(i=e[0])==null?void 0:i.tunnelRemotePort}`),this.doActionTunnels=e;const t=await this.portNumberHeuristicDelay();if(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Heuristic chose ${t==null?void 0:t.tunnelRemotePort}`),t){const s=await this.remoteExplorerService.tunnelModel.getAttributes([{port:t.tunnelRemotePort,host:t.tunnelRemoteHost}]),n=(o=s==null?void 0:s.get(t.tunnelRemotePort))==null?void 0:o.onAutoForward;switch(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) onAutoForward action is ${n}`),n){case dt.OpenBrowserOnce:{if(this.alreadyOpenedOnce.has(t.localAddress))break;this.alreadyOpenedOnce.add(t.localAddress)}case dt.OpenBrowser:{const r=Q(t.tunnelRemoteHost,t.tunnelRemotePort);await it.run(this.remoteExplorerService.tunnelModel,this.openerService,r);break}case dt.OpenPreview:{const r=Q(t.tunnelRemoteHost,t.tunnelRemotePort);await Et.run(this.remoteExplorerService.tunnelModel,this.openerService,this.externalOpenerService,r);break}case dt.Silent:break;default:{const r=new Date().getTime()-this.lastNotifyTime.getTime();this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) time elapsed since last notification ${r} ms`),r>mc.NOTIFY_COOL_DOWN&&await this.showNotification(t)}}}}hide(e){var t;this.doActionTunnels&&(this.doActionTunnels=this.doActionTunnels.filter(i=>!e.includes(i.tunnelRemotePort))),this.lastShownPort&&e.indexOf(this.lastShownPort)>=0&&((t=this.lastNotification)==null||t.close())}async portNumberHeuristicDelay(){if(this.logService.trace("ForwardedPorts: (OnAutoForwardedAction) Starting heuristic delay"),!this.doActionTunnels||this.doActionTunnels.length===0)return;this.doActionTunnels=this.doActionTunnels.sort((t,i)=>t.tunnelRemotePort-i.tunnelRemotePort);const e=this.doActionTunnels.shift();return e.tunnelRemotePort%1e3===0?(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Heuristic chose tunnel because % 1000: ${e.tunnelRemotePort}`),this.newerTunnel=e,e):e.tunnelRemotePort<1e4&&e.tunnelRemotePort!==9229?(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Heuristic chose tunnel because < 10000: ${e.tunnelRemotePort}`),this.newerTunnel=e,e):(this.logService.trace(`ForwardedPorts: (OnAutoForwardedAction) Waiting for "better" tunnel than ${e.tunnelRemotePort}`),this.newerTunnel=void 0,new Promise(t=>{setTimeout(()=>{var i;this.newerTunnel?t(void 0):(i=this.doActionTunnels)!=null&&i.includes(e)?t(e):t(void 0)},3e3)}))}basicMessage(e){return p("remote.tunnelsView.automaticForward","Your application running on port {0} is available.  ",e.tunnelRemotePort)}linkMessage(){return p({key:"remote.tunnelsView.notificationLink2",comment:["[See all forwarded ports]({0}) is a link. Only translate `See all forwarded ports`. Do not change brackets and parentheses or {0}"]},"[See all forwarded ports]({0})",`command:${lo.ID}.focus`)}async showNotification(e){var o;if(!await this.hostService.hadLastFocus())return;(o=this.lastNotification)==null||o.close();let t=this.basicMessage(e);const i=[this.openBrowserChoice(e)];(!Qe||Dw.getValue(this.contextKeyService))&&i.push(this.openPreviewChoice(e)),e.tunnelLocalPort!==e.tunnelRemotePort&&this.tunnelService.canElevate&&this.tunnelService.isPortPrivileged(e.tunnelRemotePort)&&(t+=p("remote.tunnelsView.elevationMessage","You'll need to run as superuser to use port {0} locally.  ",e.tunnelRemotePort),i.unshift(this.elevateChoice(e))),e.privacy===Ko.Private&&Qe&&this.tunnelService.canChangePrivacy&&i.push(this.makePublicChoice(e)),t+=this.linkMessage(),this.lastNotification=this.notificationService.prompt(Ks.Info,t,i,{neverShowAgain:{id:"remote.tunnelsView.autoForwardNeverShow",isSecondary:!0}}),this.lastShownPort=e.tunnelRemotePort,this.lastNotifyTime=new Date,this.lastNotification.onDidClose(()=>{this.lastNotification=void 0,this.lastShownPort=void 0})}makePublicChoice(e){return{label:p("remote.tunnelsView.makePublic","Make Public"),run:async()=>{const t=Ie(this.remoteExplorerService.tunnelModel.forwarded,e.tunnelRemoteHost,e.tunnelRemotePort);return await this.remoteExplorerService.close({host:e.tunnelRemoteHost,port:e.tunnelRemotePort},St.Other),this.remoteExplorerService.forward({remote:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},local:e.tunnelLocalPort,name:t==null?void 0:t.name,elevateIfNeeded:!0,privacy:Ko.Public,source:t==null?void 0:t.source})}}}openBrowserChoice(e){const t=Q(e.tunnelRemoteHost,e.tunnelRemotePort);return{label:it.LABEL,run:()=>it.run(this.remoteExplorerService.tunnelModel,this.openerService,t)}}openPreviewChoice(e){const t=Q(e.tunnelRemoteHost,e.tunnelRemotePort);return{label:Et.LABEL,run:()=>Et.run(this.remoteExplorerService.tunnelModel,this.openerService,this.externalOpenerService,t)}}elevateChoice(e){return{label:p("remote.tunnelsView.elevationButton","Use Port {0} as Sudo...",e.tunnelRemotePort),run:async()=>{var i;await this.remoteExplorerService.close({host:e.tunnelRemoteHost,port:e.tunnelRemotePort},St.Other);const t=await this.remoteExplorerService.forward({remote:{host:e.tunnelRemoteHost,port:e.tunnelRemotePort},local:e.tunnelRemotePort,elevateIfNeeded:!0,source:mw});t&&((i=this.lastNotification)==null||i.close(),this.lastShownPort=t.tunnelRemotePort,this.lastNotification=this.notificationService.prompt(Ks.Info,this.basicMessage(t)+this.linkMessage(),[this.openBrowserChoice(t),this.openPreviewChoice(e)],{neverShowAgain:{id:"remote.tunnelsView.autoForwardNeverShow",isSecondary:!0}}),this.lastNotification.onDidClose(()=>{this.lastNotification=void 0,this.lastShownPort=void 0}))}}}}mc.NOTIFY_COOL_DOWN=5e3;const md="workbench.view.scm";class Mw extends R{constructor(e){super(),this._register(w(window,S.DRAG_START,()=>{var i;(i=e())==null||i.windowDidDragStart()}));const t=()=>{var i;(i=e())==null||i.windowDidDragEnd()};this._register(w(window,S.DRAG_END,t)),this._register(w(window,S.MOUSE_MOVE,i=>{i.buttons===0&&t()}))}}const Nw=bo("webviewViewService"),or={webviewState:"webviewState"};let aa=class bu extends En{static getOriginStore(e){return this._originStore??(this._originStore=new _f("webviewViews.origins",e)),this._originStore}constructor(e,t,i,o,s,n,r,a,d,l,u,g,m,f,C,E,V){super({...e,titleMenuId:b.ViewTitle},n,o,t,i,l,s,r,d,a),this.activityService=u,this.extensionService=g,this.progressService=m,this.storageService=f,this.viewService=C,this.webviewService=E,this.webviewViewService=V,this._webview=this._register(new je),this._webviewDisposables=this._register(new A),this._activated=!1,this._onDidChangeVisibility=this._register(new y),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._onDispose=this._register(new y),this.onDispose=this._onDispose.event,this.extensionId=e.fromExtensionId,this.defaultTitle=this.title,this.memento=new kf(`webviewView.${this.id}`,f),this.viewState=this.memento.getMemento(1,1),this._register(this.onDidChangeBodyVisibility(()=>this.updateTreeVisibility())),this._register(this.webviewViewService.onNewResolverRegistered(B=>{B.viewType===this.id&&this.updateTreeVisibility()})),this.updateTreeVisibility()}dispose(){this._onDispose.fire(),clearTimeout(this._repositionTimeout),super.dispose()}focus(){var e;super.focus(),(e=this._webview.value)==null||e.focus()}renderBody(e){super.renderBody(e),this._container=e,this._rootContainer=void 0,this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>{setTimeout(()=>{this.layoutWebview()},0)}),this._register(ie(()=>{this._resizeObserver.disconnect()})),this._resizeObserver.observe(e))}saveState(){this._webview.value&&(this.viewState[or.webviewState]=this._webview.value.state),this.memento.saveMemento(),super.saveState()}layoutBody(e,t){super.layoutBody(e,t),this.layoutWebview(new G(t,e))}updateTreeVisibility(){var e,t;this.isBodyVisible()?(this.activate(),(e=this._webview.value)==null||e.claim(this,void 0)):(t=this._webview.value)==null||t.release(this)}activate(){if(this._activated)return;this._activated=!0;const e=this.extensionId?bu.getOriginStore(this.storageService).getOrigin(this.id,this.extensionId):void 0,t=this.webviewService.createWebviewOverlay({origin:e,providedViewType:this.id,title:this.title,options:{purpose:"webviewView"},contentOptions:{},extension:this.extensionId?{id:this.extensionId}:void 0});t.state=this.viewState[or.webviewState],this._webview.value=t,this._container&&this.layoutWebview(),this._webviewDisposables.add(ie(()=>{var o;(o=this._webview.value)==null||o.release(this)})),this._webviewDisposables.add(t.onDidUpdateState(()=>{this.viewState[or.webviewState]=t.state}));for(const o of[S.DRAG,S.DRAG_END,S.DRAG_ENTER,S.DRAG_LEAVE,S.DRAG_START])this._webviewDisposables.add(w(this._webview.value.container,o,s=>{s.preventDefault(),s.stopImmediatePropagation(),this.dropTargetElement.dispatchEvent(new DragEvent(s.type,s))}));this._webviewDisposables.add(new Mw(()=>this._webview.value));const i=this._webviewDisposables.add(new st);this.withProgress(async()=>{await this.extensionService.activateByEvent(`onView:${this.id}`);const o=this,s={webview:t,onDidChangeVisibility:this.onDidChangeBodyVisibility,onDispose:this.onDispose,get title(){return o.setTitle},set title(n){o.updateTitle(n)},get description(){return o.titleDescription},set description(n){o.updateTitleDescription(n)},get badge(){return o.badge},set badge(n){o.updateBadge(n)},dispose:()=>{this._activated=!1,this._webview.clear(),this._webviewDisposables.clear()},show:n=>{this.viewService.openView(this.id,!n)}};await this.webviewViewService.resolve(this.id,s,i.token)})}updateTitle(e){this.setTitle=e,super.updateTitle(typeof e=="string"?e:this.defaultTitle)}updateBadge(e){var t,i;if(!(((t=this.badge)==null?void 0:t.value)===(e==null?void 0:e.value)&&((i=this.badge)==null?void 0:i.tooltip)===(e==null?void 0:e.tooltip))&&(this.activity&&(this.activity.dispose(),this.activity=void 0),this.badge=e,e)){const o={badge:new Io(e.value,()=>e.tooltip),priority:150};this.activityService.showViewActivity(this.id,o)}}async withProgress(e){return this.progressService.withProgress({location:this.id,delay:500},e)}onDidScrollRoot(){this.layoutWebview()}doLayoutWebview(e){const t=this._webview.value;!this._container||!t||((!this._rootContainer||!this._rootContainer.isConnected)&&(this._rootContainer=this.findRootContainer(this._container)),t.layoutWebviewOverElement(this._container,e,this._rootContainer))}layoutWebview(e){this.doLayoutWebview(e),clearTimeout(this._repositionTimeout),this._repositionTimeout=setTimeout(()=>this.doLayoutWebview(e),200)}findRootContainer(e){return Bt(Us(e,"monaco-scrollable-element"))}};aa=x([h(1,L),h(2,H),h(3,xe),h(4,D),h(5,we),h(6,Ki),h(7,Ye),h(8,X),h(9,nt),h(10,ts),h(11,yi),h(12,Ua),h(13,Se),h(14,yn),h(15,Ef),h(16,Nw)],aa);const fd={type:"object",properties:{id:{description:p({key:"vscode.extension.contributes.views.containers.id",comment:["Contribution refers to those that an extension contributes to VS Code through an extension/contribution point. "]},"Unique id used to identify the container in which views can be contributed using 'views' contribution point"),type:"string",pattern:"^[a-zA-Z0-9_-]+$"},title:{description:p("vscode.extension.contributes.views.containers.title","Human readable string used to render the container"),type:"string"},icon:{description:p("vscode.extension.contributes.views.containers.icon","Path to the container icon. Icons are 24x24 centered on a 50x40 block and have a fill color of 'rgb(215, 218, 224)' or '#d7dae0'. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"}},required:["id","title","icon"]},Fw={description:p("vscode.extension.contributes.viewsContainers","Contributes views containers to the editor"),type:"object",properties:{activitybar:{description:p("views.container.activitybar","Contribute views containers to Activity Bar"),type:"array",items:fd},panel:{description:p("views.container.panel","Contribute views containers to Panel"),type:"array",items:fd}}};var fi;(function(c){c.Tree="tree",c.Webview="webview"})(fi||(fi={}));var eo;(function(c){c.Visible="visible",c.Hidden="hidden",c.Collapsed="collapsed"})(eo||(eo={}));const _o={type:"object",required:["id","name"],defaultSnippets:[{body:{id:"${1:id}",name:"${2:name}"}}],properties:{type:{markdownDescription:p("vscode.extension.contributes.view.type","Type of the view. This can either be `tree` for a tree view based view or `webview` for a webview based view. The default is `tree`."),type:"string",enum:["tree","webview"],markdownEnumDescriptions:[p("vscode.extension.contributes.view.tree","The view is backed by a `TreeView` created by `createTreeView`."),p("vscode.extension.contributes.view.webview","The view is backed by a `WebviewView` registered by `registerWebviewViewProvider`.")]},id:{markdownDescription:p("vscode.extension.contributes.view.id","Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:p("vscode.extension.contributes.view.name","The human-readable name of the view. Will be shown"),type:"string"},when:{description:p("vscode.extension.contributes.view.when","Condition which must be true to show this view"),type:"string"},icon:{description:p("vscode.extension.contributes.view.icon","Path to the view icon. View icons are displayed when the name of the view cannot be shown. It is recommended that icons be in SVG, though any image file type is accepted."),type:"string"},contextualTitle:{description:p("vscode.extension.contributes.view.contextualTitle","Human-readable context for when the view is moved out of its original location. By default, the view's container name will be used."),type:"string"},visibility:{description:p("vscode.extension.contributes.view.initialState","Initial state of the view when the extension is first installed. Once the user has changed the view state by collapsing, moving, or hiding the view, the initial state will not be used again."),type:"string",enum:["visible","hidden","collapsed"],default:"visible",enumDescriptions:[p("vscode.extension.contributes.view.initialState.visible","The default initial state for the view. In most containers the view will be expanded, however; some built-in containers (explorer, scm, and debug) show all contributed views collapsed regardless of the `visibility`."),p("vscode.extension.contributes.view.initialState.hidden","The view will not be shown in the view container, but will be discoverable through the views menu and other view entry points and can be un-hidden by the user."),p("vscode.extension.contributes.view.initialState.collapsed","The view will show in the view container, but will be collapsed.")]},initialSize:{type:"number",description:p("vscode.extension.contributs.view.size","The initial size of the view. The size will behave like the css 'flex' property, and will set the initial size when the view is first shown. In the side bar, this is the height of the view. This value is only respected when the same extension owns both the view and the view container.")}}},Bw={type:"object",required:["id","name"],properties:{id:{description:p("vscode.extension.contributes.view.id","Identifier of the view. This should be unique across all views. It is recommended to include your extension id as part of the view id. Use this to register a data provider through `vscode.window.registerTreeDataProviderForView` API. Also to trigger activating your extension by registering `onView:${id}` event to `activationEvents`."),type:"string"},name:{description:p("vscode.extension.contributes.view.name","The human-readable name of the view. Will be shown"),type:"string"},when:{description:p("vscode.extension.contributes.view.when","Condition which must be true to show this view"),type:"string"},group:{description:p("vscode.extension.contributes.view.group","Nested group in the viewlet"),type:"string"},remoteName:{description:p("vscode.extension.contributes.view.remoteName","The name of the remote type associated with this view"),type:["string","array"],items:{type:"string"}}}},Hw={description:p("vscode.extension.contributes.views","Contributes views to the editor"),type:"object",properties:{explorer:{description:p("views.explorer","Contributes views to Explorer container in the Activity bar"),type:"array",items:_o,default:[]},debug:{description:p("views.debug","Contributes views to Debug container in the Activity bar"),type:"array",items:_o,default:[]},scm:{description:p("views.scm","Contributes views to SCM container in the Activity bar"),type:"array",items:_o,default:[]},test:{description:p("views.test","Contributes views to Test container in the Activity bar"),type:"array",items:_o,default:[]},remote:{description:p("views.remote","Contributes views to Remote container in the Activity bar. To contribute to this container, enableProposedApi needs to be turned on"),type:"array",items:Bw,default:[]}},additionalProperties:{description:p("views.contributed","Contributes views to contributed views container"),type:"array",items:_o,default:[]}},vu=nh.registerExtensionPoint({extensionPoint:"viewsContainers",jsonSchema:Fw}),Ww=nh.registerExtensionPoint({extensionPoint:"views",deps:[vu],jsonSchema:Hw,activationEventsGenerator:(c,e)=>{for(const t of c)for(const i of Object.values(t))for(const o of i)o.id&&e.push(`onView:${o.id}`)}}),Gw=7;let ca=class{constructor(e,t){this.instantiationService=e,this.logService=t,this.viewContainersRegistry=de.as(lt.ViewContainersRegistry),this.viewsRegistry=de.as(lt.ViewsRegistry),this.handleAndRegisterCustomViewContainers(),this.handleAndRegisterCustomViews();let i=new st;k.registerCommandAndKeybindingRule({id:"workbench.action.showTreeHover",handler:async(o,...s)=>{i.cancel(),i=new st;const n=o.get(O),r=o.get(eh),a=o.get(gt),d=n.lastFocusedList;if(!(d instanceof mt))return;const l=d.getFocus();if(!l||l.length===0)return;const u=l[0];if(u instanceof Ka&&await u.resolve(i.token),!u.tooltip)return;const g=r.getRenderedTreeElement(u);g&&a.showHover({content:u.tooltip,target:g,hoverPosition:2,hideOnHover:!1},!0)},weight:200,primary:kt(2089,2087),when:v.and(su,Y)})}handleAndRegisterCustomViewContainers(){vu.setHandler((e,{added:t,removed:i})=>{i.length&&this.removeCustomViewContainers(i),t.length&&this.addCustomViewContainers(t,this.viewContainersRegistry.all)})}addCustomViewContainers(e,t){const i=de.as(lt.ViewContainersRegistry);let o=Gw+i.all.filter(n=>!!n.extensionId&&i.getViewContainerLocation(n)===0).length,s=5+i.all.filter(n=>!!n.extensionId&&i.getViewContainerLocation(n)===1).length+1;for(const{value:n,collector:r,description:a}of e)Object.entries(n).forEach(([d,l])=>{if(this.isValidViewsContainer(l,r))switch(d){case"activitybar":o=this.registerCustomViewContainers(l,a,o,t,0);break;case"panel":s=this.registerCustomViewContainers(l,a,s,t,1);break}})}removeCustomViewContainers(e){const t=de.as(lt.ViewContainersRegistry),i=e.reduce((o,s)=>(o.add(s.description.identifier),o),new Bc);for(const o of t.all)if(o.extensionId&&i.has(o.extensionId)){const s=this.viewsRegistry.getViews(o);s.length&&this.viewsRegistry.moveViews(s,this.getDefaultViewContainer()),this.deregisterCustomViewContainer(o)}}isValidViewsContainer(e,t){if(!Array.isArray(e))return t.error(p("viewcontainer requirearray","views containers must be an array")),!1;for(const i of e){if(typeof i.id!="string"&&yr(i.id))return t.error(p("requireidstring","property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if(!/^[a-z0-9_-]+$/i.test(i.id))return t.error(p("requireidstring","property `{0}` is mandatory and must be of type `string` with non-empty value. Only alphanumeric characters, '_', and '-' are allowed.","id")),!1;if(typeof i.title!="string")return t.error(p("requirestring","property `{0}` is mandatory and must be of type `string`","title")),!1;if(typeof i.icon!="string")return t.error(p("requirestring","property `{0}` is mandatory and must be of type `string`","icon")),!1;if(yr(i.title))return t.warn(p("requirenonemptystring","property `{0}` is mandatory and must be of type `string` with non-empty value","title")),!0}return!0}registerCustomViewContainers(e,t,i,o,s){return e.forEach(n=>{const a=me.fromString(n.icon)||No(t.extensionLocation,n.icon),d=`workbench.view.extension.${n.id}`,l=n.title||d,u=this.registerCustomViewContainer(d,l,a,i++,t.identifier,s);if(o.length){const g=[];for(const m of o)u!==m&&g.push(...this.viewsRegistry.getViews(m).filter(f=>f.originalContainerId===n.id));g.length&&this.viewsRegistry.moveViews(g,u)}}),i}registerCustomViewContainer(e,t,i,o,s,n){let r=this.viewContainersRegistry.get(e);return r||(r=this.viewContainersRegistry.registerViewContainer({id:e,title:t,extensionId:s,ctorDescriptor:new J(fa,[e,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,order:o,icon:i},n)),r}deregisterCustomViewContainer(e){this.viewContainersRegistry.deregisterViewContainer(e),de.as(qs.Viewlets).deregisterPaneComposite(e.id)}handleAndRegisterCustomViews(){Ww.setHandler((e,{added:t,removed:i})=>{i.length&&this.removeViews(i),t.length&&this.addViews(t)})}addViews(e){const t=new Set,i=[];for(const o of e){const{value:s,collector:n}=o;Object.entries(s).forEach(([r,a])=>{var g;if(!this.isValidViewDescriptors(a,n))return;if(r==="remote"&&!Df(o.description,"contribViewsRemote")){n.warn(p("ViewContainerRequiresProposedAPI",`View container '{0}' requires 'enabledApiProposals: ["contribViewsRemote"]' to be added to 'Remote'.`,r));return}const d=this.getViewContainer(r);d||n.warn(p("ViewContainerDoesnotExist","View container '{0}' does not exist and all views registered to it will be added to 'Explorer'.",r));const l=d||this.getDefaultViewContainer(),u=[];for(let m=0;m<a.length;m++){const f=a[m];if(t.has(f.id)){n.error(p("duplicateView1","Cannot register multiple views with same id `{0}`",f.id));continue}if(this.viewsRegistry.getView(f.id)!==null){n.error(p("duplicateView2","A view with id `{0}` is already registered.",f.id));continue}const C=If.equals(o.description.identifier,l.extensionId)?m+1:l.viewOrderDelegate?l.viewOrderDelegate.getOrder(f.group):void 0;let E;typeof f.icon=="string"&&(E=me.fromString(f.icon)||No(o.description.extensionLocation,f.icon));const V=this.convertInitialVisibility(f.visibility),B=this.getViewType(f.type);if(!B){n.error(p("unknownViewType","Unknown view type `{0}`.",f.type));continue}let De;typeof f.initialSize=="number"&&(((g=l.extensionId)==null?void 0:g.value)===o.description.identifier.value?De=f.initialSize:this.logService.warn(`${o.description.identifier.value} tried to set the view size of ${f.id} but it was ignored because the view container does not belong to it.`));const Me={type:B,ctorDescriptor:B===fi.Tree?new J(Qr):new J(aa),id:f.id,name:f.name,when:v.deserialize(f.when),containerIcon:E||(d==null?void 0:d.icon),containerTitle:f.contextualTitle||(d==null?void 0:d.title),canToggleVisibility:!0,canMoveView:(d==null?void 0:d.id)!==ir,treeView:B===fi.Tree?this.instantiationService.createInstance(ia,f.id,f.name,o.description.identifier.value):void 0,collapsed:this.showCollapsed(l)||V===eo.Collapsed,order:C,extensionId:o.description.identifier,originalContainerId:r,group:f.group,remoteAuthority:f.remoteName||f.remoteAuthority,virtualWorkspace:f.virtualWorkspace,hideByDefault:V===eo.Hidden,workspace:(d==null?void 0:d.id)===ir?!0:void 0,weight:De};t.add(Me.id),u.push(Me)}i.push({viewContainer:l,views:u})})}this.viewsRegistry.registerViews2(i)}getViewType(e){if(e===fi.Webview)return fi.Webview;if(!e||e===fi.Tree)return fi.Tree}getDefaultViewContainer(){return this.viewContainersRegistry.get(Mi)}removeViews(e){const t=e.reduce((i,o)=>(i.add(o.description.identifier),i),new Bc);for(const i of this.viewContainersRegistry.all){const o=this.viewsRegistry.getViews(i).filter(s=>s.extensionId&&t.has(s.extensionId));if(o.length){this.viewsRegistry.deregisterViews(o,i);for(const s of o){const n=s;n.treeView&&n.treeView.dispose()}}}}convertInitialVisibility(e){if(Object.values(eo).includes(e))return e}isValidViewDescriptors(e,t){if(!Array.isArray(e))return t.error(p("requirearray","views must be an array")),!1;for(const i of e){if(typeof i.id!="string")return t.error(p("requirestring","property `{0}` is mandatory and must be of type `string`","id")),!1;if(typeof i.name!="string")return t.error(p("requirestring","property `{0}` is mandatory and must be of type `string`","name")),!1;if(i.when&&typeof i.when!="string")return t.error(p("optstring","property `{0}` can be omitted or must be of type `string`","when")),!1;if(i.icon&&typeof i.icon!="string")return t.error(p("optstring","property `{0}` can be omitted or must be of type `string`","icon")),!1;if(i.contextualTitle&&typeof i.contextualTitle!="string")return t.error(p("optstring","property `{0}` can be omitted or must be of type `string`","contextualTitle")),!1;if(i.visibility&&!this.convertInitialVisibility(i.visibility))return t.error(p("optenum","property `{0}` can be omitted or must be one of {1}","visibility",Object.values(eo).join(", "))),!1}return!0}getViewContainer(e){switch(e){case"explorer":return this.viewContainersRegistry.get(Mi);case"debug":return this.viewContainersRegistry.get(Hc);case"scm":return this.viewContainersRegistry.get(md);case"remote":return this.viewContainersRegistry.get(ir);default:return this.viewContainersRegistry.get(`workbench.view.extension.${e}`)}}showCollapsed(e){switch(e.id){case Mi:case md:case Hc:return!0}return!1}};ca=x([h(0,D),h(1,rt)],ca);const zw=de.as(xf.Workbench);zw.registerWorkbenchContribution(ca,1);const Uw=bo("editorDropService");let ln=class Ws extends R{get count(){return this.mostRecentEditorsMap.size}get editors(){return[...this.mostRecentEditorsMap.values()]}hasEditor(e){const t=this.editorsPerResourceCounter.get(e.resource);return(t==null?void 0:t.has(this.toIdentifier(e)))??!1}hasEditors(e){return this.editorsPerResourceCounter.has(e)}toIdentifier(e,t){return typeof e!="string"?this.toIdentifier(e.typeId,e.editorId):t?`${e}/${t}`:e}constructor(e,t){super(),this.editorGroupsService=e,this.storageService=t,this.keyMap=new Map,this.mostRecentEditorsMap=new Af,this.editorsPerResourceCounter=new Zt,this._onDidMostRecentlyActiveEditorsChange=this._register(new y),this.onDidMostRecentlyActiveEditorsChange=this._onDidMostRecentlyActiveEditorsChange.event,this.registerListeners()}registerListeners(){this._register(this.storageService.onWillSaveState(()=>this.saveState())),this._register(this.editorGroupsService.onDidAddGroup(e=>this.onGroupAdded(e))),this._register(this.editorGroupsService.onDidChangeEditorPartOptions(e=>this.onDidChangeEditorPartOptions(e))),this.editorGroupsService.whenReady.then(()=>this.loadState())}onGroupAdded(e){const t=e.getEditors(0);for(let i=t.length-1;i>=0;i--)this.addMostRecentEditor(e,t[i],!1,!0);this.editorGroupsService.activeGroup===e&&e.activeEditor&&this.addMostRecentEditor(e,e.activeEditor,!0,!1),this.registerGroupListeners(e)}registerGroupListeners(e){const t=new A;t.add(e.onDidModelChange(i=>{switch(i.kind){case 0:{this.editorGroupsService.activeGroup===e&&e.activeEditor&&this.addMostRecentEditor(e,e.activeEditor,!0,!1);break}case 3:{i.editor&&(this.addMostRecentEditor(e,i.editor,!1,!0),this.ensureOpenedEditorsLimit({groupId:e.id,editor:i.editor},e.id));break}}})),t.add(e.onDidCloseEditor(i=>{this.removeMostRecentEditor(e,i.editor)})),t.add(e.onDidActiveEditorChange(i=>{i.editor&&this.addMostRecentEditor(e,i.editor,this.editorGroupsService.activeGroup===e,!1)})),I.once(e.onWillDispose)(()=>ue(t))}onDidChangeEditorPartOptions(e){if(!Aa(e.newPartOptions.limit,e.oldPartOptions.limit)){const t=this.editorGroupsService.activeGroup;let i;t.activeEditor&&(i={editor:t.activeEditor,groupId:t.id}),this.ensureOpenedEditorsLimit(i)}}addMostRecentEditor(e,t,i,o){const s=this.ensureKey(e,t),n=this.mostRecentEditorsMap.first;i||!n?this.mostRecentEditorsMap.set(s,s,n?1:void 0):(this.mostRecentEditorsMap.set(s,s,1),this.mostRecentEditorsMap.set(n,n,1)),o&&this.updateEditorResourcesMap(t,!0),this._onDidMostRecentlyActiveEditorsChange.fire()}updateEditorResourcesMap(e,t){let i,o,s;if(e instanceof Pt?(i=e.primary.resource,o=e.primary.typeId,s=e.primary.editorId):(i=e.resource,o=e.typeId,s=e.editorId),!i)return;const n=this.toIdentifier(o,s);if(t){let r=this.editorsPerResourceCounter.get(i);r||(r=new Map,this.editorsPerResourceCounter.set(i,r)),r.set(n,(r.get(n)??0)+1)}else{const r=this.editorsPerResourceCounter.get(i);if(r){const a=r.get(n)??0;a>1?r.set(n,a-1):(r.delete(n),r.size===0&&this.editorsPerResourceCounter.delete(i))}}}removeMostRecentEditor(e,t){this.updateEditorResourcesMap(t,!1);const i=this.findKey(e,t);if(i){this.mostRecentEditorsMap.delete(i);const o=this.keyMap.get(e.id);o&&o.delete(i.editor)&&o.size===0&&this.keyMap.delete(e.id),this._onDidMostRecentlyActiveEditorsChange.fire()}}findKey(e,t){const i=this.keyMap.get(e.id);if(i)return i.get(t)}ensureKey(e,t){let i=this.keyMap.get(e.id);i||(i=new Map,this.keyMap.set(e.id,i));let o=i.get(t);return o||(o={groupId:e.id,editor:t},i.set(t,o)),o}async ensureOpenedEditorsLimit(e,t){var o,s;if(!((o=this.editorGroupsService.partOptions.limit)!=null&&o.enabled)||typeof this.editorGroupsService.partOptions.limit.value!="number"||this.editorGroupsService.partOptions.limit.value<=0)return;const i=this.editorGroupsService.partOptions.limit.value;if((s=this.editorGroupsService.partOptions.limit)!=null&&s.perEditorGroup)if(typeof t=="number"){const n=this.editorGroupsService.getGroup(t);n&&await this.doEnsureOpenedEditorsLimit(i,n.getEditors(0).map(r=>({editor:r,groupId:t})),e)}else for(const n of this.editorGroupsService.groups)await this.ensureOpenedEditorsLimit(e,n.id);else await this.doEnsureOpenedEditorsLimit(i,[...this.mostRecentEditorsMap.values()],e)}async doEnsureOpenedEditorsLimit(e,t,i){var a;let o;if((a=this.editorGroupsService.partOptions.limit)!=null&&a.excludeDirty?o=t.filter(({editor:d})=>!(d.isDirty()&&!d.isSaving()||d.hasCapability(512))):o=t,e>=o.length)return;const s=o.reverse().filter(({editor:d,groupId:l})=>{var u;return!(d.isDirty()&&!d.isSaving()||d.hasCapability(512)||i&&d===i.editor&&l===i.groupId||(u=this.editorGroupsService.getGroup(l))!=null&&u.isSticky(d))});let n=o.length-e;const r=new Map;for(const{groupId:d,editor:l}of s){let u=r.get(d);if(u||(u=[],r.set(d,u)),u.push(l),n--,n===0)break}for(const[d,l]of r){const u=this.editorGroupsService.getGroup(d);u&&await u.closeEditors(l,{preserveFocus:!0})}}saveState(){this.mostRecentEditorsMap.isEmpty()?this.storageService.remove(Ws.STORAGE_KEY,1):this.storageService.store(Ws.STORAGE_KEY,JSON.stringify(this.serialize()),1,1)}serialize(){const e=de.as(rl.EditorFactory),t=[...this.mostRecentEditorsMap.values()],i=new Map;return{entries:et(t.map(({editor:o,groupId:s})=>{const n=this.editorGroupsService.getGroup(s);if(!n)return;let r=i.get(n);r||(r=n.getEditors(1).filter(d=>{const l=e.getEditorSerializer(d);return l==null?void 0:l.canSerialize(d)}),i.set(n,r));const a=r.indexOf(o);if(a!==-1)return{groupId:s,index:a}}))}}loadState(){const e=this.storageService.get(Ws.STORAGE_KEY,1);if(e)this.deserialize(JSON.parse(e));else{const t=this.editorGroupsService.getGroups(1);for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.getEditors(0);for(let n=s.length-1;n>=0;n--)this.addMostRecentEditor(o,s[n],!0,!0)}}for(const t of this.editorGroupsService.groups)this.registerGroupListeners(t)}deserialize(e){const t=[];for(const{groupId:i,index:o}of e.entries){const s=this.editorGroupsService.getGroup(i);if(!s)continue;const n=s.getEditorByIndex(o);if(!n)continue;const r=this.ensureKey(s,n);t.push([r,r]),this.updateEditorResourcesMap(n,!0)}this.mostRecentEditorsMap.fromJSON(t)}};ln.STORAGE_KEY="editors.mru";ln=x([h(0,oe),h(1,Se)],ln);let da=class extends R{constructor(e,t,i,o,s,n,r,a,d,l){super(),this.editorGroupService=e,this.instantiationService=t,this.fileService=i,this.configurationService=o,this.contextService=s,this.uriIdentityService=n,this.editorResolverService=r,this.workspaceTrustRequestService=a,this.hostService=d,this.textEditorService=l,this._onDidActiveEditorChange=this._register(new y),this.onDidActiveEditorChange=this._onDidActiveEditorChange.event,this._onDidVisibleEditorsChange=this._register(new y),this.onDidVisibleEditorsChange=this._onDidVisibleEditorsChange.event,this._onDidEditorsChange=this._register(new y),this.onDidEditorsChange=this._onDidEditorsChange.event,this._onDidCloseEditor=this._register(new y),this.onDidCloseEditor=this._onDidCloseEditor.event,this._onDidOpenEditorFail=this._register(new y),this.onDidOpenEditorFail=this._onDidOpenEditorFail.event,this._onDidMostRecentlyActiveEditorsChange=this._register(new y),this.onDidMostRecentlyActiveEditorsChange=this._onDidMostRecentlyActiveEditorsChange.event,this.lastActiveEditor=void 0,this.activeOutOfWorkspaceWatchers=new Zt,this.closeOnFileDelete=!1,this.editorsObserver=this._register(this.instantiationService.createInstance(ln)),this.onConfigurationUpdated(),this.registerListeners()}registerListeners(){this.editorGroupService.whenReady.then(()=>this.onEditorGroupsReady()),this.editorGroupService.onDidChangeActiveGroup(e=>this.handleActiveEditorChange(e)),this.editorGroupService.onDidAddGroup(e=>this.registerGroupListeners(e)),this.editorsObserver.onDidMostRecentlyActiveEditorsChange(()=>this._onDidMostRecentlyActiveEditorsChange.fire()),this._register(this.onDidVisibleEditorsChange(()=>this.handleVisibleEditorsChange())),this._register(this.fileService.onDidRunOperation(e=>this.onDidRunFileOperation(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.configurationService.onDidChangeConfiguration(e=>this.onConfigurationUpdated(e)))}onEditorGroupsReady(){for(const e of this.editorGroupService.groups)this.registerGroupListeners(e);this.activeEditor&&(this.doHandleActiveEditorChangeEvent(),this._onDidVisibleEditorsChange.fire())}handleActiveEditorChange(e){e===this.editorGroupService.activeGroup&&(!this.lastActiveEditor&&!e.activeEditor||this.doHandleActiveEditorChangeEvent())}doHandleActiveEditorChangeEvent(){const e=this.editorGroupService.activeGroup;this.lastActiveEditor=Bt(e.activeEditor),this._onDidActiveEditorChange.fire()}registerGroupListeners(e){const t=new A;t.add(e.onDidModelChange(i=>{this._onDidEditorsChange.fire({groupId:e.id,event:i})})),t.add(e.onDidActiveEditorChange(()=>{this.handleActiveEditorChange(e),this._onDidVisibleEditorsChange.fire()})),t.add(e.onDidCloseEditor(i=>{this._onDidCloseEditor.fire(i)})),t.add(e.onDidOpenEditorFail(i=>{this._onDidOpenEditorFail.fire({editor:i,groupId:e.id})})),I.once(e.onWillDispose)(()=>{ue(t)})}handleVisibleEditorsChange(){const e=new dr;for(const t of this.visibleEditors){const i=Ro(et([ee.getCanonicalUri(t,{supportSideBySide:$.PRIMARY}),ee.getCanonicalUri(t,{supportSideBySide:$.SECONDARY})]),o=>o.toString());for(const o of i)this.fileService.hasProvider(o)&&!this.contextService.isInsideWorkspace(o)&&e.add(o)}for(const t of this.activeOutOfWorkspaceWatchers.keys())e.has(t)||(ue(this.activeOutOfWorkspaceWatchers.get(t)),this.activeOutOfWorkspaceWatchers.delete(t));for(const t of e.keys())if(!this.activeOutOfWorkspaceWatchers.get(t)){const i=this.fileService.watch(t);this.activeOutOfWorkspaceWatchers.set(t,i)}}async onDidRunFileOperation(e){e.isOperation(2)&&this.handleMovedFile(e.resource,e.target.resource),(e.isOperation(1)||e.isOperation(2))&&this.handleDeletedFile(e.resource,!1,e.target?e.target.resource:void 0)}onDidFilesChange(e){e.gotDeleted()&&this.handleDeletedFile(e,!0)}async handleMovedFile(e,t){for(const i of this.editorGroupService.groups){const o=[];for(const s of i.editors){const n=s.resource;if(!n||!this.uriIdentityService.extUri.isEqualOrParent(n,e))continue;let r;if(this.uriIdentityService.extUri.isEqual(e,n))r=t;else{const l=Tf(n.path,e.path,this.uriIdentityService.extUri.ignorePathCasing(n));r=No(t,n.path.substr(l+e.path.length+1))}const a=await s.rename(i.id,r);if(!a)return;const d={preserveFocus:!0,pinned:i.isPinned(s),sticky:i.isSticky(s),index:i.getIndexOfEditor(s),inactive:!i.isActive(s)};ae(a.editor)?o.push({editor:s,replacement:a.editor,options:{...a.options,...d}}):o.push({editor:s,replacement:{...a.editor,options:{...a.editor.options,...d}}})}o.length&&this.replaceEditors(o,i)}}onConfigurationUpdated(e){var i,o;if(e&&!e.affectsConfiguration("workbench.editor.closeOnFileDelete"))return;const t=this.configurationService.getValue();typeof((o=(i=t.workbench)==null?void 0:i.editor)==null?void 0:o.closeOnFileDelete)=="boolean"?this.closeOnFileDelete=t.workbench.editor.closeOnFileDelete:this.closeOnFileDelete=!1}handleDeletedFile(e,t,i){for(const o of this.getAllNonDirtyEditors({includeUntitled:!1,supportSideBySide:!0}))(async()=>{const s=o.resource;if(s&&(this.closeOnFileDelete||!t)){if(i&&this.uriIdentityService.extUri.isEqualOrParent(s,i))return;let n=!1;if(e instanceof io?n=e.contains(s,2):n=this.uriIdentityService.extUri.isEqualOrParent(s,e),!n)return;let r=!1;t&&this.fileService.hasProvider(s)&&(await ka(100),r=await this.fileService.exists(s)),!r&&!o.isDisposed()&&o.dispose()}})()}getAllNonDirtyEditors(e){const t=[];function i(o){o.hasCapability(4)&&!e.includeUntitled||o.isDirty()||t.push(o)}for(const o of this.editors)e.supportSideBySide&&o instanceof Pt?(i(o.primary),i(o.secondary)):i(o);return t}get activeEditorPane(){var e;return(e=this.editorGroupService.activeGroup)==null?void 0:e.activeEditorPane}get activeTextEditorControl(){const e=this.activeEditorPane;if(e){const t=e.getControl();if(Rs(t)||jn(t))return t;if(Vf(t)&&Rs(t.activeCodeEditor))return t.activeCodeEditor}}get activeTextEditorLanguageId(){var i;let e;const t=this.activeTextEditorControl;return jn(t)?e=t.getModifiedEditor():e=t,(i=e==null?void 0:e.getModel())==null?void 0:i.getLanguageId()}get count(){return this.editorsObserver.count}get editors(){return this.getEditors(1).map(({editor:e})=>e)}getEditors(e,t){switch(e){case 0:return t!=null&&t.excludeSticky?this.editorsObserver.editors.filter(({groupId:i,editor:o})=>{var s;return!((s=this.editorGroupService.getGroup(i))!=null&&s.isSticky(o))}):this.editorsObserver.editors;case 1:{const i=[];for(const o of this.editorGroupService.getGroups(2))i.push(...o.getEditors(1,t).map(s=>({editor:s,groupId:o.id})));return i}}}get activeEditor(){const e=this.editorGroupService.activeGroup;return e?Bt(e.activeEditor):void 0}get visibleEditorPanes(){return et(this.editorGroupService.groups.map(e=>e.activeEditorPane))}get visibleTextEditorControls(){const e=[];for(const t of this.visibleEditorPanes){const i=t.getControl();(Rs(i)||jn(i))&&e.push(i)}return e}get visibleEditors(){return et(this.editorGroupService.groups.map(e=>e.activeEditor))}async openEditor(e,t,i){let o,s=ae(e)?t:e.options,n;if(Rf(t)&&(i=t),!ae(e)){const r=await this.editorResolverService.resolveEditor(e,i);if(r===1)return;Po(r)&&(o=r.editor,s=r.options,n=r.group)}if(o||(o=ae(e)?e:await this.textEditorService.resolveTextEditor(e)),!n){let r;[n,r]=this.instantiationService.invokeFunction(cn,{editor:o,options:s},i),r&&(s={...s,activation:r})}return n.openEditor(o,s)}async openEditors(e,t,i){if(i!=null&&i.validateTrust&&!await this.handleWorkspaceTrust(e))return[];const o=new Map;for(const n of e){let r,a;if(!Vo(n)){const l=await this.editorResolverService.resolveEditor(n,t);if(l===1)continue;Po(l)&&(r=l,a=l.group)}r||(r=Vo(n)?n:{editor:await this.textEditorService.resolveTextEditor(n),options:n.options}),a||([a]=this.instantiationService.invokeFunction(cn,r,t));let d=o.get(a);d||(d=[],o.set(a,d)),d.push(r)}const s=[];for(const[n,r]of o)s.push(n.openEditors(r));return et(await To.settled(s))}async handleWorkspaceTrust(e){const{resources:t,diffMode:i,mergeMode:o}=this.extractEditorResources(e);switch(await this.workspaceTrustRequestService.requestOpenFilesTrust(t)){case 1:return!0;case 2:return await this.hostService.openWindow(t.map(n=>({fileUri:n})),{forceNewWindow:!0,diffMode:i,mergeMode:o}),!1;case 3:return!1}}extractEditorResources(e){const t=new dr;let i=!1,o=!1;for(const s of e)if(Vo(s)){const n=ee.getOriginalUri(s.editor,{supportSideBySide:$.BOTH});P.isUri(n)?t.add(n):n&&(n.primary&&t.add(n.primary),n.secondary&&t.add(n.secondary),i=s.editor instanceof Pf)}else ah(s)&&(P.isUri(s.input1)&&t.add(s.input1.resource),P.isUri(s.input2)&&t.add(s.input2.resource),P.isUri(s.base)&&t.add(s.base.resource),P.isUri(s.result)&&t.add(s.result.resource),o=!0),Ls(s)?(P.isUri(s.original.resource)&&t.add(s.original.resource),P.isUri(s.modified.resource)&&t.add(s.modified.resource),i=!0):js(s)&&t.add(s.resource);return{resources:Array.from(t.keys()),diffMode:i,mergeMode:o}}isOpened(e){return this.editorsObserver.hasEditor({resource:this.uriIdentityService.asCanonicalUri(e.resource),typeId:e.typeId,editorId:e.editorId})}isVisible(e){var t;for(const i of this.editorGroupService.groups)if((t=i.activeEditor)!=null&&t.matches(e))return!0;return!1}async closeEditor({editor:e,groupId:t},i){const o=this.editorGroupService.getGroup(t);await(o==null?void 0:o.closeEditor(e,i))}async closeEditors(e,t){const i=new Map;for(const{editor:o,groupId:s}of e){const n=this.editorGroupService.getGroup(s);if(!n)continue;let r=i.get(n);r||(r=[],i.set(n,r)),r.push(o)}for(const[o,s]of i)await o.closeEditors(s,t)}findEditors(e,t,i){const o=P.isUri(e)?e:e.resource,s=P.isUri(e)?void 0:e.typeId;if((t==null?void 0:t.supportSideBySide)!==$.ANY&&(t==null?void 0:t.supportSideBySide)!==$.SECONDARY&&!this.editorsObserver.hasEditors(o))return P.isUri(e)||Vi(i)?[]:void 0;if(Vi(i)){const n=[];for(const r of this.editorGroupService.getGroups(1)){const a=[];if(P.isUri(e))a.push(...this.findEditors(e,t,r));else{const d=this.findEditors(e,t,r);d&&a.push(d)}n.push(...a.map(d=>({editor:d,groupId:r.id})))}return n}else{const n=typeof i=="number"?this.editorGroupService.getGroup(i):i;if(P.isUri(e))return n?n.findEditors(o,t):[];{if(!n)return;const r=n.findEditors(o,t);for(const a of r)if(a.typeId===s)return a;return}}}async replaceEditors(e,t){const i=typeof t=="number"?this.editorGroupService.getGroup(t):t,o=[];for(const s of e){let n;if(!ae(s.replacement)){const r=await this.editorResolverService.resolveEditor(s.replacement,i);if(r===1)continue;Po(r)&&(n={editor:s.editor,replacement:r.editor,options:r.options,forceReplaceDirty:s.forceReplaceDirty})}n||(n={editor:s.editor,replacement:Wc(s)?s.replacement:await this.textEditorService.resolveTextEditor(s.replacement),options:Wc(s)?s.options:s.replacement.options,forceReplaceDirty:s.forceReplaceDirty}),o.push(n)}return i==null?void 0:i.replaceEditors(o)}async save(e,t){Array.isArray(e)||(e=[e]);const i=this.getUniqueEditors(e),o=[],s=[];if(t!=null&&t.saveAs)s.push(...i);else for(const{groupId:r,editor:a}of i)a.hasCapability(4)?s.push({groupId:r,editor:a}):o.push({groupId:r,editor:a});const n=await To.settled(o.map(({groupId:r,editor:a})=>{var d;return(t==null?void 0:t.reason)===1&&((d=this.editorGroupService.getGroup(r))==null||d.pinEditor(a)),a.save(r,t)}));for(const{groupId:r,editor:a}of s){if(a.isDisposed())continue;const d=await this.openEditor(a,r),l={pinned:!0,viewState:d==null?void 0:d.getViewState()},u=t!=null&&t.saveAs?await a.saveAs(r,t):await a.save(r,t);if(n.push(u),!u)break;if(!a.matches(u)){const g=a.hasCapability(4)?this.editorGroupService.groups.map(m=>m.id):[r];for(const m of g)u instanceof Lf?await this.replaceEditors([{editor:a,replacement:u,options:l}],m):await this.replaceEditors([{editor:a,replacement:{...u,options:l}}],m)}}return{success:n.every(r=>!!r),editors:et(n)}}saveAll(e){return this.save(this.getAllDirtyEditors(e),e)}async revert(e,t){Array.isArray(e)||(e=[e]);const i=this.getUniqueEditors(e);return await To.settled(i.map(async({groupId:o,editor:s})=>{var n;return(n=this.editorGroupService.getGroup(o))==null||n.pinEditor(s),s.revert(o,t)})),!i.some(({editor:o})=>o.isDirty())}async revertAll(e){return this.revert(this.getAllDirtyEditors(e),e)}getAllDirtyEditors(e){const t=[];for(const i of this.editorGroupService.getGroups(1))for(const o of i.getEditors(0))o.isDirty()&&(!(e!=null&&e.includeUntitled)&&o.hasCapability(4)||e!=null&&e.excludeSticky&&i.isSticky(o)||t.push({groupId:i.id,editor:o}));return t}getUniqueEditors(e){const t=[];for(const{editor:i,groupId:o}of e)t.some(s=>s.editor.matches(i))||t.push({editor:i,groupId:o});return t}dispose(){super.dispose(),this.activeOutOfWorkspaceWatchers.forEach(e=>ue(e)),this.activeOutOfWorkspaceWatchers.clear()}};da=x([h(0,oe),h(1,D),h(2,Ue),h(3,L),h(4,at),h(5,cs),h(6,$a),h(7,rh),h(8,os),h(9,ja)],da);let po=class mi extends R{constructor(e,t,i,o,s,n,r,a,d){super(),this.editorGroupService=e,this.instantiationService=t,this.configurationService=i,this.quickInputService=o,this.notificationService=s,this.telemetryService=n,this.storageService=r,this.extensionService=a,this.logService=d,this._onDidChangeEditorRegistrations=this._register(new Of),this.onDidChangeEditorRegistrations=this._onDidChangeEditorRegistrations.event,this._editors=new Map,this._flattenedEditors=new Map,this._shouldReFlattenEditors=!0,this.cache=new Set(JSON.parse(this.storageService.get(mi.cacheStorageID,0,JSON.stringify([])))),this.storageService.remove(mi.cacheStorageID,0),this._register(this.storageService.onWillSaveState(()=>{this.cacheEditors()})),this.extensionService.onDidRegisterExtensions(()=>{this.cache=void 0})}resolveUntypedInputAndGroup(e,t){const i=e,[o,s]=this.instantiationService.invokeFunction(cn,i,t);return[i,o,s]}async resolveEditor(e,t){var u,g,m,f;if(this._flattenedEditors=this._flattenEditorsMap(),Gc(e))return this.doResolveSideBySideEditor(e,t);const i=this.resolveUntypedInputAndGroup(e,t);if(!i)return 2;const[o,s,n]=i;n&&(o.options={...o.options,activation:n});let r=ee.getCanonicalUri(o,{supportSideBySide:$.PRIMARY});if(this.cache&&r&&this.resourceMatchesCache(r)&&await this.extensionService.whenInstalledExtensionsRegistered(),r===void 0)r=P.from({scheme:Re.untitled});else if(r.scheme===void 0||r===null)return 2;if(((u=o.options)==null?void 0:u.override)===Ps.PICK){const C=await this.doPickEditor(o);if(!C)return 1;o.options=C}let{editor:a,conflictingDefault:d}=this.getEditor(r,(g=o.options)==null?void 0:g.override);if(!a&&((m=o.options)!=null&&m.override||Vo(e)))return 2;if(!a){const C=this.getEditor(r,Rt.id);if(a=C==null?void 0:C.editor,d=C==null?void 0:C.conflictingDefault,!a)return 2}if(Ls(o)&&((f=o.options)==null?void 0:f.override)===void 0){let C=ee.getCanonicalUri(o,{supportSideBySide:$.SECONDARY});C||(C=P.from({scheme:Re.untitled}));const{editor:E}=this.getEditor(C,void 0);if(!E||a.editorInfo.id!==E.editorInfo.id){const{editor:V,conflictingDefault:B}=this.getEditor(r,Rt.id);a=V,d=B}if(!a)return 2}if(o.options={override:a.editorInfo.id,...o.options},a.editorFactoryObject.createDiffEditorInput===void 0&&Ls(o))return 2;const l=await this.doResolveEditor(o,s,a);return d&&l&&await this.doHandleConflictingDefaults(r,a.editorInfo.label,o,l.editor,s),l?(this.sendEditorResolutionTelemetry(l.editor),l.editor.editorId!==a.editorInfo.id&&this.logService.warn(`Editor ID Mismatch: ${l.editor.editorId} !== ${a.editorInfo.id}. This will cause bugs. Please ensure editorInput.editorId matches the registered id`),{...l,group:s}):1}async doResolveSideBySideEditor(e,t){const i=await this.resolveEditor(e.primary,t);if(!Po(i))return 2;const o=await this.resolveEditor(e.secondary,i.group??t);return Po(o)?{group:i.group??o.group,editor:this.instantiationService.createInstance(Pt,e.label,e.description,o.editor,i.editor),options:e.options}:2}bufferChangeEvents(e){this._onDidChangeEditorRegistrations.pause();try{e()}finally{this._onDidChangeEditorRegistrations.resume()}}registerEditor(e,t,i,o){let s=this._editors.get(e);s===void 0&&(s=new Map,this._editors.set(e,s));let n=s.get(t.id);n===void 0&&(n=[]);const r=el(n,{globPattern:e,editorInfo:t,options:i,editorFactoryObject:o});return s.set(t.id,n),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire(),ie(()=>{r(),n&&n.length===0&&(s==null||s.delete(t.id)),this._shouldReFlattenEditors=!0,this._onDidChangeEditorRegistrations.fire()})}getAssociationsForResource(e){const i=this.getAllUserAssociations().filter(s=>s.filenamePattern&&qn(s.filenamePattern,e)),o=this._registeredEditors;return i.filter(s=>o.find(n=>n.editorInfo.id===s.viewType))}getAllUserAssociations(){const e=this.configurationService.inspect(zc)||{},t=e.workspaceValue??{},i=e.userValue??{},o={...t};for(const[n,r]of Object.entries(i))o[n]===void 0&&(o[n]=r);const s=[];for(const[n,r]of Object.entries(o)){const a={filenamePattern:n,viewType:r};s.push(a)}return s}_flattenEditorsMap(){if(!this._shouldReFlattenEditors)return this._flattenedEditors;this._shouldReFlattenEditors=!1;const e=new Map;for(const[t,i]of this._editors){const o=[];for(const s of i.values()){let n;for(const r of s)n||(n={editorInfo:r.editorInfo,globPattern:r.globPattern,options:{},editorFactoryObject:{}}),n.options={...n.options,...r.options},n.editorFactoryObject={...n.editorFactoryObject,...r.editorFactoryObject};n&&o.push(n)}e.set(t,o)}return e}get _registeredEditors(){return sh(Array.from(this._flattenedEditors.values()))}updateUserAssociations(e,t){const i={viewType:t,filenamePattern:e},o=this.getAllUserAssociations(),s=Object.create(null);for(const n of[...o,i])n.filenamePattern&&(s[n.filenamePattern]=n.viewType);this.configurationService.updateValue(zc,s)}findMatchingEditors(e){const t=this.getAssociationsForResource(e),i=[];for(const[o,s]of this._flattenedEditors)for(const n of s)(t.find(a=>a.viewType===n.editorInfo.id)&&n.editorInfo.priority!==Tt.exclusive||qn(o,e))&&i.push(n);return i.sort((o,s)=>ui(s.editorInfo.priority)===ui(o.editorInfo.priority)&&typeof s.globPattern=="string"&&typeof o.globPattern=="string"?s.globPattern.length-o.globPattern.length:ui(s.editorInfo.priority)-ui(o.editorInfo.priority))}getEditors(e){if(this._flattenedEditors=this._flattenEditorsMap(),P.isUri(e)){const t=this.findMatchingEditors(e);return t.find(i=>i.editorInfo.priority===Tt.exclusive)?[]:t.map(i=>i.editorInfo)}return Ro(this._registeredEditors.map(t=>t.editorInfo),t=>t.id)}getEditor(e,t){var l;const i=(u,g)=>u.find(m=>m.options&&m.options.canSupportResource!==void 0?m.editorInfo.id===g&&m.options.canSupportResource(e):m.editorInfo.id===g);if(t&&t!==Ps.EXCLUSIVE_ONLY){const u=this._registeredEditors;return{editor:i(u,t),conflictingDefault:!1}}const o=this.findMatchingEditors(e),s=this.getAssociationsForResource(e),n=t===Ps.EXCLUSIVE_ONLY?Tt.exclusive:Tt.builtin;let r=o.filter(u=>ui(u.editorInfo.priority)>=ui(n)&&u.editorInfo.id!==Rt.id);if(r.length===0)return{editor:s[0]&&n!==Tt.exclusive?i(o,s[0].viewType):void 0,conflictingDefault:!1};const a=r[0].editorInfo.priority===Tt.exclusive?r[0].editorInfo.id:((l=s[0])==null?void 0:l.viewType)||r[0].editorInfo.id;let d=!1;return r=r.filter(u=>u.editorInfo.priority!==Tt.exclusive),s.length===0&&r.length>1&&(d=!0),{editor:i(o,a),conflictingDefault:d}}async doResolveEditor(e,t,i){var d,l;let o=e.options;const s=ee.getCanonicalUri(e,{supportSideBySide:$.PRIMARY});if(o&&typeof o.activation>"u"&&(o={...o,activation:o.preserveFocus?Ri.RESTORE:void 0}),ah(e)){if(!i.editorFactoryObject.createMergeEditorInput)return;const u=await i.editorFactoryObject.createMergeEditorInput(e,t);return{editor:u.editor,options:u.options??o}}if(Ls(e)){if(!i.editorFactoryObject.createDiffEditorInput)return;const u=await i.editorFactoryObject.createDiffEditorInput(e,t);return{editor:u.editor,options:u.options??o}}if(Gc(e))throw new Error("Untyped side by side editor input not supported here.");if(Mf(e)){if(!i.editorFactoryObject.createUntitledEditorInput)return;const u=await i.editorFactoryObject.createUntitledEditorInput(e,t);return{editor:u.editor,options:u.options??o}}if(s===void 0)throw new Error("Undefined resource on non untitled editor input.");if(typeof((d=i.options)==null?void 0:d.singlePerResource)=="function"?i.options.singlePerResource():(l=i.options)==null?void 0:l.singlePerResource){const u=await this.moveExistingEditorForResource(s,i.editorInfo.id,t);if(u)return{editor:u,options:o}}if(!i.editorFactoryObject.createEditorInput)return;const r=await i.editorFactoryObject.createEditorInput(e,t);return o=r.options??o,{editor:r.editor,options:o}}async moveExistingEditorForResource(e,t,i){const o=this.findExistingEditorsForResource(e,t);if(!o.length)return;const s=o[0];for(const{editor:n,group:r}of o)if(n!==s.editor&&!await r.closeEditor(n))return;if(i.id!==s.group.id)return s.group.moveEditor(s.editor,i),s.editor}findExistingEditorsForResource(e,t){const i=[],o=Ro([...this.editorGroupService.groups]);for(const s of o)for(const n of s.editors)Qt(n.resource,e)&&n.editorId===t&&i.push({editor:n,group:s});return i}async doHandleConflictingDefaults(e,t,i,o,s){const n=this.findMatchingEditors(e),r=JSON.parse(this.storageService.get(mi.conflictingDefaultsStorageID,0,"{}")),a=`*${xi(e)}`,d=()=>{r[a]=[],n.forEach(g=>r[a].push(g.editorInfo.id)),this.storageService.store(mi.conflictingDefaultsStorageID,JSON.stringify(r),0,1)};if(r[a]&&r[a].find(g=>g===o.editorId))return;const u=this.notificationService.prompt(wt.Warning,p("editorResolver.conflictingDefaults","There are multiple default editors available for the resource."),[{label:p("editorResolver.configureDefault","Configure Default"),run:async()=>{const g=await this.doPickEditor(i,!0);if(!g)return;i.options=g;const m=await this.resolveEditor(i,s);m===1||m===2||s.replaceEditors([{editor:o,replacement:m.editor,options:m.options??g}])}},{label:p("editorResolver.keepDefault","Keep {0}",t),run:d}]).onDidClose(()=>{d(),u.dispose()})}mapEditorsToQuickPickEntry(e,t){var u,g,m;const i=Ta(this.editorGroupService.activeGroup.findEditors(e));let o=e.scheme===Re.untitled?this._registeredEditors.filter(f=>f.editorInfo.priority!==Tt.exclusive):this.findMatchingEditors(e);o=Ro(o,f=>f.editorInfo.id);const s=(u=this.getAssociationsForResource(e)[0])==null?void 0:u.viewType;o=o.sort((f,C)=>f.editorInfo.id===Rt.id?-1:C.editorInfo.id===Rt.id?1:ui(C.editorInfo.priority)-ui(f.editorInfo.priority));const n=[],r=p("promptOpenWith.currentlyActive","Active"),a=p("promptOpenWith.currentDefault","Default"),d=p("promptOpenWith.currentDefaultAndActive","Active and Default");let l=s;if(!l&&o.length>2&&((g=o[1])==null?void 0:g.editorInfo.priority)!==Tt.option&&(l=(m=o[1])==null?void 0:m.editorInfo.id),l||(l=Rt.id),o.forEach(f=>{const C=(i==null?void 0:i.editorId)??Rt.id,E=i?f.editorInfo.id===C:!1,V=f.editorInfo.id===l,B={id:f.editorInfo.id,label:f.editorInfo.label,description:E&&V?d:E?r:V?a:void 0,detail:f.editorInfo.detail??f.editorInfo.priority};n.push(B)}),!t&&xi(e)!==""){const f={type:"separator"};n.push(f);const C={id:mi.configureDefaultID,label:p("promptOpenWith.configureDefault","Configure default editor for '{0}'...",`*${xi(e)}`)};n.push(C)}return n}async doPickEditor(e,t){var d;let i=ee.getOriginalUri(e,{supportSideBySide:$.PRIMARY});i===void 0&&(i=P.from({scheme:Re.untitled}));const o=this.mapEditorsToQuickPickEntry(i,t),s=this.quickInputService.createQuickPick(),n=t?p("promptOpenWith.updateDefaultPlaceHolder","Select new default editor for '{0}'",`*${xi(i)}`):p("promptOpenWith.placeHolder","Select editor for '{0}'",rs(i));s.placeholder=n,s.canAcceptInBackground=!0,s.items=o;const r=s.items.find(l=>l.type==="item");r&&(s.selectedItems=[r]);const a=await new Promise(l=>{s.onDidAccept(u=>{let g;s.selectedItems.length===1&&(g={item:s.selectedItems[0],keyMods:s.keyMods,openInBackground:u.inBackground}),i&&t&&(g!=null&&g.item.id)&&this.updateUserAssociations(`*${xi(i)}`,g.item.id),l(g)}),s.onDidHide(()=>l(void 0)),s.onDidTriggerItemButton(u=>{l({item:u.item,openInBackground:!1}),i&&u.item&&u.item.id&&this.updateUserAssociations(`*${xi(i)}`,u.item.id)}),s.show()});if(s.dispose(),a)return a.item.id===mi.configureDefaultID?this.doPickEditor(e,!0):{...e.options,override:a.item.id,preserveFocus:a.openInBackground||((d=e.options)==null?void 0:d.preserveFocus)}}sendEditorResolutionTelemetry(e){e.editorId&&this.telemetryService.publicLog2("override.viewType",{viewType:e.editorId})}cacheEditors(){const e=new Set;for(const[i,o]of this._flattenedEditors)o.find(n=>n.editorInfo.priority!==Tt.option&&n.editorInfo.id!==Rt.id)&&(Nf(i)?e.add(`${i.pattern}`):e.add(i));const t=this.getAllUserAssociations();for(const i of t)i.filenamePattern&&e.add(i.filenamePattern);this.storageService.store(mi.cacheStorageID,JSON.stringify(Array.from(e)),0,1)}resourceMatchesCache(e){if(!this.cache)return!1;for(const t of this.cache)if(qn(t,e))return!0;return!1}};po.configureDefaultID="promptOpenWith.configureDefault";po.cacheStorageID="editorOverrideService.cache";po.conflictingDefaultsStorageID="editorOverrideService.conflictingDefaults";po=x([h(0,oe),h(1,D),h(2,L),h(3,Kt),h(4,Be),h(5,Ye),h(6,Se),h(7,yi),h(8,rt)],po);var Kw='.monaco-workbench .part.statusbar{box-sizing:border-box;cursor:default;display:flex;font-size:12px;height:22px;overflow:hidden;width:100%}.monaco-workbench:not(.reduce-motion) .part.statusbar{transition:background-color .15s ease-out}.monaco-workbench .part.statusbar.status-border-top:after{background-color:var(--status-border-top-color);content:"";height:1px;left:0;pointer-events:none;position:absolute;top:0;width:100%;z-index:5}.monaco-workbench .part.statusbar>.left-items,.monaco-workbench .part.statusbar>.right-items{display:flex}.monaco-workbench .part.statusbar>.right-items{flex-direction:row-reverse;flex-wrap:wrap}.monaco-workbench .part.statusbar>.left-items{flex-grow:1}.monaco-workbench .part.statusbar>.items-container>.statusbar-item{display:inline-block;font-variant-numeric:tabular-nums;height:100%;line-height:22px;max-width:40vw;vertical-align:top}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak{position:relative}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak>.status-bar-item-beak-container{height:5px;left:calc(50% - 5px);position:absolute;top:-5px;width:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-beak>.status-bar-item-beak-container:before{border-bottom-style:solid;border-bottom-width:5px;border-left:5px solid transparent;border-right:5px solid transparent;content:"";position:fixed}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>.statusbar-item-label{margin-left:3px;margin-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left>.statusbar-item-label{margin-left:0;margin-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right>.statusbar-item-label{margin-left:3px;margin-right:0}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.left.first-visible-item{padding-left:7px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.right.last-visible-item{margin-right:7px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color.left.first-visible-item,.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color.right.last-visible-item{padding-left:0;padding-right:0}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.has-background-color>.statusbar-item-label{margin-left:0;margin-right:0;padding-left:10px;padding-right:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left.has-background-color>.statusbar-item-label{padding-left:3px;padding-right:10px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right.has-background-color>.statusbar-item-label{padding-left:10px;padding-right:3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>.statusbar-item-label{align-items:center;cursor:pointer;display:flex;height:100%;outline-width:0;overflow:hidden;padding:0 5px;text-overflow:ellipsis;white-space:pre}.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-left>.statusbar-item-label,.monaco-workbench .part.statusbar>.items-container>.statusbar-item.compact-right>.statusbar-item-label{padding:0 3px}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>a:hover:not(.disabled){text-decoration:none}.monaco-workbench .part.statusbar>.items-container>.statusbar-item>a.disabled{cursor:default}.monaco-workbench .part.statusbar>.items-container>.statusbar-item span.codicon{color:inherit;font-size:14px;text-align:center}.monaco-workbench .part.statusbar>.items-container>.statusbar-item .status-bar-info{background-color:var(--vscode-statusBarItem-prominentBackground);color:var(--vscode-statusBarItem-prominentForeground)}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a.status-bar-info:hover:not(.disabled){background-color:var(--vscode-statusBarItem-prominentHoverBackground)}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a:active:not(.disabled){outline:1px solid var(--vscode-contrastActiveBorder)!important;outline-offset:-1px}.monaco-workbench:not(.hc-light):not(.hc-black) .part.statusbar>.items-container>.statusbar-item a:active:not(.disabled){background-color:var(--vscode-statusBarItem-activeBackground)!important}.monaco-workbench .part.statusbar>.items-container>.statusbar-item a:hover:not(.disabled){outline:1px dashed var(--vscode-contrastActiveBorder);outline-offset:-1px}.monaco-workbench:not(.hc-light):not(.hc-black) .part.statusbar>.items-container>.statusbar-item a:hover:not(.disabled){background-color:var(--vscode-statusBarItem-hoverBackground)}';be(Kw,{});class $w extends ke{constructor(e,t,i){super(e,t,void 0,!0),this.model=i,this.checked=!i.isHidden(e)}async run(){this.model.isHidden(this.id)?this.model.show(this.id):this.model.hide(this.id)}}class jw extends ke{constructor(e,t,i){super(e,p("hide","Hide '{0}'",t),void 0,!0),this.model=i}async run(){this.model.hide(this.id)}}k.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusPrevious",weight:200,primary:15,secondary:[16],when:wo,handler:c=>{c.get(ji).focusPreviousEntry()}});k.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusNext",weight:200,primary:17,secondary:[18],when:wo,handler:c=>{c.get(ji).focusNextEntry()}});k.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusFirst",weight:200,primary:14,when:wo,handler:c=>{const e=c.get(ji);e.focus(!1),e.focusNextEntry()}});k.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusLast",weight:200,primary:13,when:wo,handler:c=>{const e=c.get(ji);e.focus(!1),e.focusPreviousEntry()}});k.registerCommandAndKeybindingRule({id:"workbench.statusBar.clearFocus",weight:200,primary:9,when:wo,handler:c=>{const e=c.get(ji),t=c.get(U);e.isEntryFocused()?e.focus(!1):t.activeEditorPane&&t.activeEditorPane.focus()}});class qw extends qe{constructor(){super({id:"workbench.action.focusStatusBar",title:{value:p("focusStatusBar","Focus Status Bar"),original:"Focus Status Bar"},category:ve.View,f1:!0})}async run(e){e.get(pt).focusPart("workbench.parts.statusbar")}}te(qw);class Oi extends R{get entries(){return this._entries.slice(0)}get lastFocusedEntry(){return this._lastFocusedEntry&&!this.isHidden(this._lastFocusedEntry.id)?this._lastFocusedEntry:void 0}constructor(e){super(),this.storageService=e,this._onDidChangeEntryVisibility=this._register(new y),this.onDidChangeEntryVisibility=this._onDidChangeEntryVisibility.event,this._entries=[],this.hidden=new Set,this.restoreState(),this.registerListeners()}restoreState(){const e=this.storageService.get(Oi.HIDDEN_ENTRIES_KEY,0);if(e)try{const t=JSON.parse(e);this.hidden=new Set(t)}catch{}}registerListeners(){this._register(this.storageService.onDidChangeValue(e=>this.onDidStorageValueChange(e)))}onDidStorageValueChange(e){if(e.key===Oi.HIDDEN_ENTRIES_KEY&&e.scope===0){const t=new Set(this.hidden);this.hidden.clear(),this.restoreState();const i=new Set;for(const o of t)this.hidden.has(o)||i.add(o);for(const o of this.hidden)t.has(o)||i.add(o);if(i.size>0)for(const o of this._entries)i.has(o.id)&&(this.updateVisibility(o.id,!0),i.delete(o.id))}}add(e){this._entries.push(e),this.updateVisibility(e,!1),this.sort(),this.markFirstLastVisibleEntry()}remove(e){const t=this._entries.indexOf(e);t>=0&&(this._entries.splice(t,1),this._entries.some(i=>Os(i.priority.primary)&&i.priority.primary.id===e.id)&&this.sort(),this.markFirstLastVisibleEntry())}isHidden(e){return this.hidden.has(e)}hide(e){this.hidden.has(e)||(this.hidden.add(e),this.updateVisibility(e,!0),this.saveState())}show(e){this.hidden.has(e)&&(this.hidden.delete(e),this.updateVisibility(e,!0),this.saveState())}findEntry(e){return this._entries.find(t=>t.container===e)}getEntries(e){return this._entries.filter(t=>t.alignment===e)}focusNextEntry(){this.focusEntry(1,0)}focusPreviousEntry(){this.focusEntry(-1,this.entries.length-1)}isEntryFocused(){return!!this.getFocusedEntry()}getFocusedEntry(){return this._entries.find(e=>Ht(document.activeElement,e.container))}focusEntry(e,t){const i=n=>{let r=n,a=r>=0&&r<this._entries.length?this._entries[r]:void 0;for(;a&&this.isHidden(a.id);)r+=e,a=r>=0&&r<this._entries.length?this._entries[r]:void 0;return a},o=this.getFocusedEntry();if(o){const n=i(this._entries.indexOf(o)+e);if(n){this._lastFocusedEntry=n,n.labelContainer.focus();return}}const s=i(t);s&&(this._lastFocusedEntry=s,s.labelContainer.focus())}updateVisibility(e,t){if(typeof e=="string"){const i=e;for(const o of this._entries)o.id===i&&this.updateVisibility(o,t)}else{const i=e,o=this.isHidden(i.id);o?mo(i.container):go(i.container),t&&this._onDidChangeEntryVisibility.fire({id:i.id,visible:!o}),this.markFirstLastVisibleEntry()}}saveState(){this.hidden.size>0?this.storageService.store(Oi.HIDDEN_ENTRIES_KEY,JSON.stringify(Array.from(this.hidden.values())),0,0):this.storageService.remove(Oi.HIDDEN_ENTRIES_KEY,0)}sort(){const e=new Map,t=new Map;for(let s=0;s<this._entries.length;s++){const n=this._entries[s];if(typeof n.priority.primary=="number")e.set(n,s);else{let r=t.get(n.priority.primary.id);r||(r=[],t.set(n.priority.primary.id,r)),r.push(n)}}const i=Array.from(e.keys());i.sort((s,n)=>s.alignment===n.alignment?s.priority.primary!==n.priority.primary?Number(n.priority.primary)-Number(s.priority.primary):s.priority.secondary!==n.priority.secondary?n.priority.secondary-s.priority.secondary:e.get(s)-e.get(n):s.alignment===0?-1:n.alignment===0?1:0);let o;if(t.size>0){o=[];for(const s of i){const n=t.get(s.id);n&&o.push(...n.filter(r=>Os(r.priority.primary)&&r.priority.primary.alignment===0)),o.push(s),n&&o.push(...n.filter(r=>Os(r.priority.primary)&&r.priority.primary.alignment===1)),t.delete(s.id)}for(const[,s]of t)o.push(...s)}else o=i;this._entries=o}markFirstLastVisibleEntry(){this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(0)),this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(1))}doMarkFirstLastVisibleStatusbarItem(e){let t,i;for(const o of e)o.container.classList.remove("first-visible-item","last-visible-item"),!this.isHidden(o.id)&&(t||(t=o),i=o);t==null||t.container.classList.add("first-visible-item"),i==null||i.container.classList.add("last-visible-item")}}Oi.HIDDEN_ENTRIES_KEY="workbench.statusbar.hidden";let la=class extends R{get name(){return j(this.entry).name}get hasCommand(){var e;return typeof((e=this.entry)==null?void 0:e.command)<"u"}constructor(e,t,i,o,s,n,r){super(),this.container=e,this.hoverDelegate=i,this.commandService=o,this.notificationService=s,this.telemetryService=n,this.themeService=r,this.entry=void 0,this.foregroundListener=this._register(new je),this.backgroundListener=this._register(new je),this.commandMouseListener=this._register(new je),this.commandTouchListener=this._register(new je),this.commandKeyboardListener=this._register(new je),this.hover=void 0,this.labelContainer=document.createElement("a"),this.labelContainer.tabIndex=-1,this.labelContainer.setAttribute("role","button"),this.labelContainer.className="statusbar-item-label",this._register(ii.addTarget(this.labelContainer)),this.label=new Yw(this.labelContainer),this.container.appendChild(this.labelContainer),this.beakContainer=document.createElement("div"),this.beakContainer.className="status-bar-item-beak-container",this.container.appendChild(this.beakContainer),this.update(t)}update(e){if(this.label.showProgress=e.showProgress??!1,(!this.entry||e.text!==this.entry.text)&&(this.label.text=e.text,e.text?go(this.labelContainer):mo(this.labelContainer)),(!this.entry||e.ariaLabel!==this.entry.ariaLabel)&&(this.container.setAttribute("aria-label",e.ariaLabel),this.labelContainer.setAttribute("aria-label",e.ariaLabel)),(!this.entry||e.role!==this.entry.role)&&this.labelContainer.setAttribute("role",e.role||"button"),!this.entry||!this.isEqualTooltip(this.entry,e)){const t=Ao(e.tooltip)?{markdown:e.tooltip,markdownNotSupportedFallback:void 0}:e.tooltip;this.hover?this.hover.update(t):this.hover=this._register(Ff(this.hoverDelegate,this.container,t))}if(!this.entry||e.command!==this.entry.command){this.commandMouseListener.clear(),this.commandTouchListener.clear(),this.commandKeyboardListener.clear();const t=e.command;t&&(t!==Uc||this.hover)?(this.commandMouseListener.value=w(this.labelContainer,S.CLICK,()=>this.executeCommand(t)),this.commandTouchListener.value=w(this.labelContainer,Te.Tap,()=>this.executeCommand(t)),this.commandKeyboardListener.value=w(this.labelContainer,S.KEY_DOWN,i=>{const o=new Ct(i);(o.equals(10)||o.equals(3))&&(K.stop(i),this.executeCommand(t))}),this.labelContainer.classList.remove("disabled")):this.labelContainer.classList.add("disabled")}(!this.entry||e.showBeak!==this.entry.showBeak)&&(e.showBeak?this.container.classList.add("has-beak"):this.container.classList.remove("has-beak")),(!this.entry||e.color!==this.entry.color)&&this.applyColor(this.labelContainer,e.color),(!this.entry||e.backgroundColor!==this.entry.backgroundColor)&&(this.container.classList.toggle("has-background-color",!!e.backgroundColor),this.applyColor(this.container,e.backgroundColor,!0)),this.entry=e}isEqualTooltip({tooltip:e},{tooltip:t}){return e===void 0?t===void 0:Ao(e)?Ao(t)&&Bf(e,t):e===t}async executeCommand(e){var t;if(e===Uc)(t=this.hover)==null||t.show(!0);else{const i=typeof e=="string"?e:e.id,o=typeof e=="string"?[]:e.arguments??[];this.telemetryService.publicLog2("workbenchActionExecuted",{id:i,from:"status bar"});try{await this.commandService.executeCommand(i,...o)}catch(s){this.notificationService.error(Go(s))}}}applyColor(e,t,i){var s;let o;if(i?this.backgroundListener.clear():this.foregroundListener.clear(),t)if(Hf(t)){o=(s=this.themeService.getColorTheme().getColor(t.id))==null?void 0:s.toString();const n=this.themeService.onDidColorThemeChange(r=>{var d;const a=(d=r.getColor(t.id))==null?void 0:d.toString();i?e.style.backgroundColor=a??"":e.style.color=a??""});i?this.backgroundListener.value=n:this.foregroundListener.value=n}else o=t;i?e.style.backgroundColor=o??"":e.style.color=o??""}};la=x([h(3,It),h(4,Be),h(5,Ye),h(6,X)],la);class Yw extends Wf{constructor(e){super(e),this.container=e,this.progressCodicon=Kc($c),this.currentText="",this.currentShowProgress=!1}set showProgress(e){this.currentShowProgress!==e&&(this.currentShowProgress=e,this.progressCodicon=Kc(e==="loading"?Gf:$c),this.text=this.currentText)}set text(e){if(this.currentShowProgress){this.container.firstChild!==this.progressCodicon&&this.container.appendChild(this.progressCodicon);for(const i of Array.from(this.container.childNodes))i!==this.progressCodicon&&i.remove();let t=e??"";t&&(t=` ${t}`),se(this.container,...zf(t))}else super.text=e}}let ha=class extends xn{constructor(e,t,i,o,s,n,r,a,d){super("workbench.parts.statusbar",{hasTitle:!1},t,o,s),this.instantiationService=e,this.contextService=i,this.storageService=o,this.contextMenuService=n,this.contextKeyService=r,this.hoverService=a,this.configurationService=d,this.minimumWidth=0,this.maximumWidth=Number.POSITIVE_INFINITY,this.minimumHeight=22,this.maximumHeight=22,this.pendingEntries=[],this.viewModel=this._register(new Oi(this.storageService)),this.onDidChangeEntryVisibility=this.viewModel.onDidChangeEntryVisibility,this.hoverDelegate=new class{get delay(){return Date.now()-this.lastHoverHideTime<200?0:this.configurationService.getValue("workbench.hover.delay")}constructor(l,u){this.configurationService=l,this.hoverService=u,this.lastHoverHideTime=0,this.placement="element"}showHover(l,u){return this.hoverService.showHover({...l,hideOnKeyDown:!0},u)}onDidHideHover(){this.lastHoverHideTime=Date.now()}}(this.configurationService,this.hoverService),this.compactEntriesDisposable=this._register(new je),this.styleOverrides=new Set,this.registerListeners()}registerListeners(){this._register(this.onDidChangeEntryVisibility(()=>this.updateCompactEntries())),this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateStyles()))}addEntry(e,t,i,o=0){let s;return Uf(o)?s=o:s={primary:o,secondary:zo(t)},this.element?this.doAddEntry(e,t,i,s):this.doAddPendingEntry(e,t,i,s)}doAddPendingEntry(e,t,i,o){const s={entry:e,id:t,alignment:i,priority:o};return this.pendingEntries.push(s),{update:r=>{s.accessor?s.accessor.update(r):s.entry=r},dispose:()=>{s.accessor?s.accessor.dispose():this.pendingEntries=this.pendingEntries.filter(r=>r!==s)}}}doAddEntry(e,t,i,o){const s=this.doCreateStatusItem(t,i,...et([e.showBeak?"has-beak":void 0])),n=this.instantiationService.createInstance(la,s,e,this.hoverDelegate),r=new class{constructor(){this.id=t,this.alignment=i,this.priority=o,this.container=s,this.labelContainer=n.labelContainer}get name(){return n.name}get hasCommand(){return n.hasCommand}},{needsFullRefresh:a}=this.doAddOrRemoveModelEntry(r,!0);return a?this.appendStatusbarEntries():this.appendStatusbarEntry(r),{update:d=>{n.update(d)},dispose:()=>{const{needsFullRefresh:d}=this.doAddOrRemoveModelEntry(r,!1);d?this.appendStatusbarEntries():s.remove(),ue(n)}}}doCreateStatusItem(e,t,...i){const o=document.createElement("div");return o.id=e,o.classList.add("statusbar-item"),i&&o.classList.add(...i),t===1?o.classList.add("right"):o.classList.add("left"),o}doAddOrRemoveModelEntry(e,t){const i=this.viewModel.entries;t?this.viewModel.add(e):this.viewModel.remove(e);const o=this.viewModel.entries;return t?i.splice(o.indexOf(e),0,e):i.splice(i.indexOf(e),1),{needsFullRefresh:!co(i,o)}}isEntryVisible(e){return!this.viewModel.isHidden(e)}updateEntryVisibility(e,t){t?this.viewModel.show(e):this.viewModel.hide(e)}focusNextEntry(){this.viewModel.focusNextEntry()}focusPreviousEntry(){this.viewModel.focusPreviousEntry()}isEntryFocused(){return this.viewModel.isEntryFocused()}focus(e=!0){var i;(i=this.getContainer())==null||i.focus();const t=this.viewModel.lastFocusedEntry;e&&t&&setTimeout(()=>t.labelContainer.focus(),0)}createContentArea(e){this.element=e;const t=this.contextKeyService.createScoped(this.element);return wo.bindTo(t).set(!0),this.leftItemsContainer=document.createElement("div"),this.leftItemsContainer.classList.add("left-items","items-container"),this.element.appendChild(this.leftItemsContainer),this.element.tabIndex=0,this.rightItemsContainer=document.createElement("div"),this.rightItemsContainer.classList.add("right-items","items-container"),this.element.appendChild(this.rightItemsContainer),this._register(w(e,S.CONTEXT_MENU,i=>this.showContextMenu(i))),this._register(ii.addTarget(e)),this._register(w(e,Te.Contextmenu,i=>this.showContextMenu(i))),this.createInitialStatusbarEntries(),this.element}createInitialStatusbarEntries(){for(this.appendStatusbarEntries();this.pendingEntries.length;){const e=this.pendingEntries.shift();e&&(e.accessor=this.addEntry(e.entry,e.id,e.alignment,e.priority.primary))}}appendStatusbarEntries(){const e=j(this.leftItemsContainer),t=j(this.rightItemsContainer);oi(e),oi(t);for(const i of[...this.viewModel.getEntries(0),...this.viewModel.getEntries(1).reverse()])(i.alignment===0?e:t).appendChild(i.container);this.updateCompactEntries()}appendStatusbarEntry(e){const t=this.viewModel.getEntries(e.alignment);e.alignment===1&&t.reverse();const i=j(e.alignment===0?this.leftItemsContainer:this.rightItemsContainer),o=t.indexOf(e);o+1===t.length?i.appendChild(e.container):i.insertBefore(e.container,t[o+1].container),this.updateCompactEntries()}updateCompactEntries(){const e=this.viewModel.entries,t=new Map;for(const n of e)this.viewModel.isHidden(n.id)||t.set(n.id,n),n.container.classList.remove("compact-left","compact-right");const i=new Map;for(const n of t.values())if(Os(n.priority.primary)&&n.priority.primary.compact){const r=n.priority.primary.id,a=t.get(r);if(!a)continue;let d=i.get(r);d?d.add(n):(d=new Set([n,a]),i.set(r,d)),n.priority.primary.alignment===0?(a.container.classList.add("compact-left"),n.container.classList.add("compact-right")):(a.container.classList.add("compact-right"),n.container.classList.add("compact-left"))}const o=this.getColor(Kf),s=this.getColor($f);if(this.compactEntriesDisposable.value=new A,o&&s&&!Da(this.theme.type))for(const[,n]of i)for(const r of n)r.hasCommand&&(this.compactEntriesDisposable.value.add(w(r.labelContainer,S.MOUSE_OVER,()=>{n.forEach(a=>a.labelContainer.style.backgroundColor=o),r.labelContainer.style.backgroundColor=s})),this.compactEntriesDisposable.value.add(w(r.labelContainer,S.MOUSE_OUT,()=>{n.forEach(a=>a.labelContainer.style.backgroundColor="")})))}showContextMenu(e){K.stop(e,!0);const t=new _t(e);let i;this.contextMenuService.showContextMenu({getAnchor:()=>({x:t.posx,y:t.posy}),getActions:()=>(i=this.getContextMenuActions(t),i),onHide:()=>{i&&jf(i)}})}getContextMenuActions(e){const t=[];t.push(Ne({id:ed.ID,label:p("hideStatusBar","Hide Status Bar"),run:()=>this.instantiationService.invokeFunction(s=>new ed().run(s))})),t.push(new Fe);const i=new Set;for(const s of this.viewModel.entries)i.has(s.id)||(t.push(new $w(s.id,s.name,this.viewModel)),i.add(s.id));let o;for(let s=e.target;s;s=s.parentElement){const n=this.viewModel.findEntry(s);if(n){o=n;break}}return o&&(t.push(new Fe),t.push(new jw(o.id,o.name,this.viewModel))),t}updateStyles(){super.updateStyles();const e=j(this.getContainer()),t=[...this.styleOverrides].sort((a,d)=>a.priority-d.priority)[0],i=this.getColor((t==null?void 0:t.background)??(this.contextService.getWorkbenchState()!==1?qf:Yf))||"";e.style.backgroundColor=i;const o=this.getColor((t==null?void 0:t.foreground)??(this.contextService.getWorkbenchState()!==1?Xf:Jf))||"";e.style.color=o;const s=this.getColor(Zf),n=this.getColor((t==null?void 0:t.border)??(this.contextService.getWorkbenchState()!==1?Qf:eb))||this.getColor(ot);n?(e.classList.add("status-border-top"),e.style.setProperty("--status-border-top-color",n)):(e.classList.remove("status-border-top"),e.style.removeProperty("--status-border-top-color"));const r=this.getColor(tb);this.styleElement||(this.styleElement=Bd(e)),this.styleElement.textContent=`

				/* Status bar focus outline */
				.monaco-workbench .part.statusbar:focus {
					outline-color: ${r};
				}

				/* Status bar item focus outline */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item a:focus-visible:not(.disabled) {
					outline: 1px solid ${this.getColor(ro)??s};
					outline-offset: ${n?"-2px":"-1px"};
				}

				/* Notification Beak */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item.has-beak > .status-bar-item-beak-container:before {
					border-bottom-color: ${i};
				}
			`}layout(e,t,i,o){super.layout(e,t,i,o),super.layoutContents(e,t)}overrideStyle(e){return this.styleOverrides.add(e),this.updateStyles(),ie(()=>{this.styleOverrides.delete(e),this.updateStyles()})}toJSON(){return{type:"workbench.parts.statusbar"}}};ha=x([h(0,D),h(1,X),h(2,at),h(3,Se),h(4,pt),h(5,xe),h(6,H),h(7,gt),h(8,L)],ha);let wi=class Xt extends R{constructor(e,t,i,o,s,n,r,a,d,l){super(),this.editorService=e,this.editorGroupService=t,this.contextService=i,this.storageService=o,this.configurationService=s,this.fileService=n,this.workspacesService=r,this.instantiationService=a,this.layoutService=d,this.contextKeyService=l,this.activeEditorListeners=this._register(new A),this.lastActiveEditor=void 0,this.editorHelper=this.instantiationService.createInstance(hn),this.canNavigateBackContextKey=new N("canNavigateBack",!1,p("canNavigateBack","Whether it is possible to navigate back in editor history")).bindTo(this.contextKeyService),this.canNavigateForwardContextKey=new N("canNavigateForward",!1,p("canNavigateForward","Whether it is possible to navigate forward in editor history")).bindTo(this.contextKeyService),this.canNavigateBackInNavigationsContextKey=new N("canNavigateBackInNavigationLocations",!1,p("canNavigateBackInNavigationLocations","Whether it is possible to navigate back in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInNavigationsContextKey=new N("canNavigateForwardInNavigationLocations",!1,p("canNavigateForwardInNavigationLocations","Whether it is possible to navigate forward in editor navigation locations history")).bindTo(this.contextKeyService),this.canNavigateToLastNavigationLocationContextKey=new N("canNavigateToLastNavigationLocation",!1,p("canNavigateToLastNavigationLocation","Whether it is possible to navigate to the last editor navigation location")).bindTo(this.contextKeyService),this.canNavigateBackInEditsContextKey=new N("canNavigateBackInEditLocations",!1,p("canNavigateBackInEditLocations","Whether it is possible to navigate back in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateForwardInEditsContextKey=new N("canNavigateForwardInEditLocations",!1,p("canNavigateForwardInEditLocations","Whether it is possible to navigate forward in editor edit locations history")).bindTo(this.contextKeyService),this.canNavigateToLastEditLocationContextKey=new N("canNavigateToLastEditLocation",!1,p("canNavigateToLastEditLocation","Whether it is possible to navigate to the last editor edit location")).bindTo(this.contextKeyService),this.canReopenClosedEditorContextKey=new N("canReopenClosedEditor",!1,p("canReopenClosedEditor","Whether it is possible to reopen the last closed editor")).bindTo(this.contextKeyService),this._onDidChangeEditorNavigationStack=this._register(new y),this.onDidChangeEditorNavigationStack=this._onDidChangeEditorNavigationStack.event,this.defaultScopedEditorNavigationStack=void 0,this.editorGroupScopedNavigationStacks=new Map,this.editorScopedNavigationStacks=new Map,this.editorNavigationScope=0,this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0,this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0,this.navigatingInRecentlyUsedEditorsStack=!1,this.navigatingInRecentlyUsedEditorsInGroupStack=!1,this.recentlyClosedEditors=[],this.ignoreEditorCloseEvent=!1,this.history=void 0,this.editorHistoryListeners=new Map,this.resourceExcludeMatcher=this._register(new ib(()=>{const u=this._register(this.instantiationService.createInstance(ob,g=>sb(g?this.configurationService.getValue({resource:g}):this.configurationService.getValue())||Object.create(null),g=>g.affectsConfiguration(nb)||g.affectsConfiguration(rb)));return this._register(u.onExpressionChange(()=>this.removeExcludedFromHistory())),u})),this.registerListeners(),this.editorService.activeEditorPane&&this.onDidActiveEditorChange()}registerListeners(){this.registerMouseNavigationListener(),this._register(this.editorService.onDidActiveEditorChange(()=>this.onDidActiveEditorChange())),this._register(this.editorService.onDidOpenEditorFail(e=>this.remove(e.editor))),this._register(this.editorService.onDidCloseEditor(e=>this.onDidCloseEditor(e))),this._register(this.editorService.onDidMostRecentlyActiveEditorsChange(()=>this.handleEditorEventInRecentEditorsStack())),this._register(this.editorGroupService.onDidRemoveGroup(e=>this.onDidRemoveGroup(e))),this._register(this.fileService.onDidFilesChange(e=>this.onDidFilesChange(e))),this._register(this.fileService.onDidRunOperation(e=>this.onDidFilesChange(e))),this._register(this.storageService.onWillSaveState(()=>this.saveState())),this.registerEditorNavigationScopeChangeListener(),this._register(this.onDidChangeEditorNavigationStack(()=>this.updateContextKeys())),this._register(this.editorGroupService.onDidChangeActiveGroup(()=>this.updateContextKeys()))}onDidCloseEditor(e){this.handleEditorCloseEventInHistory(e),this.handleEditorCloseEventInReopen(e)}registerMouseNavigationListener(){const e=this._register(new A),t=()=>{e.clear(),this.configurationService.getValue(Xt.MOUSE_NAVIGATION_SETTING)&&(e.add(w(this.layoutService.container,S.MOUSE_DOWN,i=>this.onMouseDownOrUp(i,!0))),e.add(w(this.layoutService.container,S.MOUSE_UP,i=>this.onMouseDownOrUp(i,!1))))};this._register(this.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(Xt.MOUSE_NAVIGATION_SETTING)&&t()})),t()}onMouseDownOrUp(e,t){switch(e.button){case 3:K.stop(e),t&&this.goBack();break;case 4:K.stop(e),t&&this.goForward();break}}onDidRemoveGroup(e){this.handleEditorGroupRemoveInNavigationStacks(e)}onDidActiveEditorChange(){const e=this.editorGroupService.activeGroup,t=e.activeEditorPane;this.lastActiveEditor&&this.editorHelper.matchesEditorIdentifier(this.lastActiveEditor,t)||(this.lastActiveEditor=t!=null&&t.input&&t.group?{editor:t.input,groupId:t.group.id}:void 0,this.activeEditorListeners.clear(),this.handleActiveEditorChange(e,t),Sr(t)&&this.activeEditorListeners.add(t.onDidChangeSelection(i=>this.handleActiveEditorSelectionChangeEvent(e,t,i))),this.updateContextKeys())}onDidFilesChange(e){e instanceof io?e.gotDeleted()&&this.remove(e):e.isOperation(1)?this.remove(e):e.isOperation(2)&&e.target.isFile&&this.move(e)}handleActiveEditorChange(e,t){this.handleActiveEditorChangeInHistory(t),this.handleActiveEditorChangeInNavigationStacks(e,t)}handleActiveEditorSelectionChangeEvent(e,t,i){this.handleActiveEditorSelectionChangeInNavigationStacks(e,t,i)}move(e){this.moveInHistory(e),this.moveInEditorNavigationStacks(e)}remove(e){this.removeFromHistory(e),this.removeFromEditorNavigationStacks(e),this.removeFromRecentlyClosedEditors(e),this.removeFromRecentlyOpened(e)}removeFromRecentlyOpened(e){let t;ae(e)?t=ee.getOriginalUri(e):e instanceof io||(t=e.resource),t&&this.workspacesService.removeRecentlyOpened([t])}clear(){this.clearRecentlyOpened(),this.clearEditorNavigationStacks(),this.recentlyClosedEditors=[],this.updateContextKeys()}updateContextKeys(){this.contextKeyService.bufferChangeEvents(()=>{const e=this.getStack();this.canNavigateBackContextKey.set(e.canGoBack(0)),this.canNavigateForwardContextKey.set(e.canGoForward(0)),this.canNavigateBackInNavigationsContextKey.set(e.canGoBack(2)),this.canNavigateForwardInNavigationsContextKey.set(e.canGoForward(2)),this.canNavigateToLastNavigationLocationContextKey.set(e.canGoLast(2)),this.canNavigateBackInEditsContextKey.set(e.canGoBack(1)),this.canNavigateForwardInEditsContextKey.set(e.canGoForward(1)),this.canNavigateToLastEditLocationContextKey.set(e.canGoLast(1)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)})}registerEditorNavigationScopeChangeListener(){const e=()=>{this.disposeEditorNavigationStacks();const t=this.configurationService.getValue(Xt.NAVIGATION_SCOPE_SETTING);t==="editorGroup"?this.editorNavigationScope=1:t==="editor"?this.editorNavigationScope=2:this.editorNavigationScope=0};this._register(this.configurationService.onDidChangeConfiguration(t=>{t.affectsConfiguration(Xt.NAVIGATION_SCOPE_SETTING)&&e()})),e()}getStack(e=this.editorGroupService.activeGroup,t=e.activeEditor){var i,o;switch(this.editorNavigationScope){case 2:{if(!t)return new Xw;let s=this.editorScopedNavigationStacks.get(e.id);s||(s=new Map,this.editorScopedNavigationStacks.set(e.id,s));let n=(i=s.get(t))==null?void 0:i.stack;if(!n){const r=new A;n=r.add(this.instantiationService.createInstance(Oo,2)),r.add(n.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),s.set(t,{stack:n,disposable:r})}return n}case 1:{let s=(o=this.editorGroupScopedNavigationStacks.get(e.id))==null?void 0:o.stack;if(!s){const n=new A;s=n.add(this.instantiationService.createInstance(Oo,1)),n.add(s.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire())),this.editorGroupScopedNavigationStacks.set(e.id,{stack:s,disposable:n})}return s}case 0:return this.defaultScopedEditorNavigationStack||(this.defaultScopedEditorNavigationStack=this._register(this.instantiationService.createInstance(Oo,0)),this._register(this.defaultScopedEditorNavigationStack.onDidChange(()=>this._onDidChangeEditorNavigationStack.fire()))),this.defaultScopedEditorNavigationStack}}goForward(e){return this.getStack().goForward(e)}goBack(e){return this.getStack().goBack(e)}goPrevious(e){return this.getStack().goPrevious(e)}goLast(e){return this.getStack().goLast(e)}handleActiveEditorChangeInNavigationStacks(e,t){this.getStack(e,t==null?void 0:t.input).handleActiveEditorChange(t)}handleActiveEditorSelectionChangeInNavigationStacks(e,t,i){this.getStack(e,t.input).handleActiveEditorSelectionChange(t,i)}handleEditorCloseEventInHistory(e){const t=this.editorScopedNavigationStacks.get(e.groupId);if(t){const i=t.get(e.editor);i&&(i.disposable.dispose(),t.delete(e.editor)),t.size===0&&this.editorScopedNavigationStacks.delete(e.groupId)}}handleEditorGroupRemoveInNavigationStacks(e){var i;(i=this.defaultScopedEditorNavigationStack)==null||i.remove(e.id);const t=this.editorGroupScopedNavigationStacks.get(e.id);t&&(t.disposable.dispose(),this.editorGroupScopedNavigationStacks.delete(e.id))}clearEditorNavigationStacks(){this.withEachEditorNavigationStack(e=>e.clear())}removeFromEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.remove(e))}moveInEditorNavigationStacks(e){this.withEachEditorNavigationStack(t=>t.move(e))}withEachEditorNavigationStack(e){this.defaultScopedEditorNavigationStack&&e(this.defaultScopedEditorNavigationStack);for(const[,t]of this.editorGroupScopedNavigationStacks)e(t.stack);for(const[,t]of this.editorScopedNavigationStacks)for(const[,i]of t)e(i.stack)}disposeEditorNavigationStacks(){var e;(e=this.defaultScopedEditorNavigationStack)==null||e.dispose(),this.defaultScopedEditorNavigationStack=void 0;for(const[,t]of this.editorGroupScopedNavigationStacks)t.disposable.dispose();this.editorGroupScopedNavigationStacks.clear();for(const[,t]of this.editorScopedNavigationStacks)for(const[,i]of t)i.disposable.dispose();this.editorScopedNavigationStacks.clear()}openNextRecentlyUsedEditor(e){const[t,i]=this.ensureRecentlyUsedStack(o=>o-1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}openPreviouslyUsedEditor(e){const[t,i]=this.ensureRecentlyUsedStack(o=>o+1,e);return this.doNavigateInRecentlyUsedEditorsStack(t[i],e)}async doNavigateInRecentlyUsedEditorsStack(e,t){if(e){const i=typeof t!="number"||!this.editorGroupService.getGroup(t);i?this.navigatingInRecentlyUsedEditorsStack=!0:this.navigatingInRecentlyUsedEditorsInGroupStack=!0;const o=this.editorGroupService.getGroup(e.groupId)??this.editorGroupService.activeGroup;try{await o.openEditor(e.editor)}finally{i?this.navigatingInRecentlyUsedEditorsStack=!1:this.navigatingInRecentlyUsedEditorsInGroupStack=!1}}}ensureRecentlyUsedStack(e,t){let i,o;const s=typeof t=="number"?this.editorGroupService.getGroup(t):void 0;s?(i=this.recentlyUsedEditorsInGroupStack||s.getEditors(0).map(r=>({groupId:s.id,editor:r})),o=this.recentlyUsedEditorsInGroupStackIndex):(i=this.recentlyUsedEditorsStack||this.editorService.getEditors(0),o=this.recentlyUsedEditorsStackIndex);let n=e(o);return n<0?n=0:n>i.length-1&&(n=i.length-1),s?(this.recentlyUsedEditorsInGroupStack=i,this.recentlyUsedEditorsInGroupStackIndex=n):(this.recentlyUsedEditorsStack=i,this.recentlyUsedEditorsStackIndex=n),[i,n]}handleEditorEventInRecentEditorsStack(){this.navigatingInRecentlyUsedEditorsStack||(this.recentlyUsedEditorsStack=void 0,this.recentlyUsedEditorsStackIndex=0),this.navigatingInRecentlyUsedEditorsInGroupStack||(this.recentlyUsedEditorsInGroupStack=void 0,this.recentlyUsedEditorsInGroupStackIndex=0)}handleEditorCloseEventInReopen(e){if(this.ignoreEditorCloseEvent)return;const{editor:t,context:i}=e;if(i===Ti.REPLACE||i===Ti.MOVE)return;const o=t.toUntyped();if(!o)return;const s=[],n=ee.getOriginalUri(t,{supportSideBySide:$.BOTH});P.isUri(n)?s.push(n):n&&s.push(...et([n.primary,n.secondary])),this.removeFromRecentlyClosedEditors(t),this.recentlyClosedEditors.push({editorId:t.editorId,editor:o,resource:ee.getOriginalUri(t),associatedResources:s,index:e.index,sticky:e.sticky}),this.recentlyClosedEditors.length>Xt.MAX_RECENTLY_CLOSED_EDITORS&&this.recentlyClosedEditors.shift(),this.canReopenClosedEditorContextKey.set(!0)}async reopenLastClosedEditor(){const e=this.recentlyClosedEditors.pop();let t;return e&&(t=this.doReopenLastClosedEditor(e)),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0),t}async doReopenLastClosedEditor(e){const t={pinned:!0,sticky:e.sticky,index:e.index,ignoreError:!0};(e.sticky&&!this.editorGroupService.activeGroup.isSticky(e.index)||!e.sticky&&this.editorGroupService.activeGroup.isSticky(e.index))&&(t.index=void 0);let i;if(!this.editorGroupService.activeGroup.contains(e.editor)){this.ignoreEditorCloseEvent=!0;try{i=await this.editorService.openEditor({...e.editor,options:{...e.editor.options,...t}})}finally{this.ignoreEditorCloseEvent=!1}}i||(ab(this.recentlyClosedEditors,e),this.reopenLastClosedEditor())}removeFromRecentlyClosedEditors(e){this.recentlyClosedEditors=this.recentlyClosedEditors.filter(t=>ae(e)&&t.editorId!==e.editorId?!0:!(t.resource&&this.editorHelper.matchesFile(t.resource,e)||t.associatedResources.some(i=>this.editorHelper.matchesFile(i,e)))),this.canReopenClosedEditorContextKey.set(this.recentlyClosedEditors.length>0)}handleActiveEditorChangeInHistory(e){const t=e==null?void 0:e.input;!t||t.isDisposed()||!this.includeInHistory(t)||(this.removeFromHistory(t),this.addToHistory(t))}addToHistory(e,t=!0){this.ensureHistoryLoaded(this.history);const i=this.editorHelper.preferResourceEditorInput(e);i&&(t?this.history.unshift(i):this.history.push(i),this.history.length>Xt.MAX_HISTORY_ITEMS&&this.editorHelper.clearOnEditorDispose(this.history.pop(),this.editorHistoryListeners),ae(i)&&this.editorHelper.onEditorDispose(i,()=>this.updateHistoryOnEditorDispose(i),this.editorHistoryListeners))}updateHistoryOnEditorDispose(e){if(!cb(e))this.removeFromHistory(e);else{const t=[],i=e.primary.matches(e.secondary)?[e.primary]:[e.primary,e.secondary];for(const o of i){const s=this.editorHelper.preferResourceEditorInput(o);js(s)&&t.push(s)}this.replaceInHistory(e,...t)}}includeInHistory(e){return ae(e)?!0:!this.resourceExcludeMatcher.value.matches(e.resource)}removeExcludedFromHistory(){this.ensureHistoryLoaded(this.history),this.history=this.history.filter(e=>{const t=this.includeInHistory(e);return t||this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t})}moveInHistory(e){e.isOperation(2)&&this.removeFromHistory(e)&&this.addToHistory({resource:e.target.resource})}removeFromHistory(e){let t=!1;return this.ensureHistoryLoaded(this.history),this.history=this.history.filter(i=>{const o=this.editorHelper.matchesEditor(e,i);return o&&(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),t=!0),!o}),t}replaceInHistory(e,...t){this.ensureHistoryLoaded(this.history);let i=!1;const o=[];for(const s of this.history)this.editorHelper.matchesEditor(e,s)?(this.editorHelper.clearOnEditorDispose(e,this.editorHistoryListeners),i||(o.push(...t),i=!0)):t.some(n=>this.editorHelper.matchesEditor(n,s))||o.push(s);i||o.push(...t),this.history=o}clearRecentlyOpened(){this.history=[];for(const[,e]of this.editorHistoryListeners)ue(e);this.editorHistoryListeners.clear()}getHistory(){return this.ensureHistoryLoaded(this.history),this.history}ensureHistoryLoaded(e){this.history||(this.history=[],this.editorGroupService.isReady?this.loadHistory():(async()=>(await this.editorGroupService.whenReady,this.loadHistory()))())}loadHistory(){var o;this.history=[];const e=this.loadHistoryFromStorage(),t=[...this.editorService.getEditors(0)].reverse(),i=new Set;for(const{editor:s}of t)this.includeInHistory(s)&&(this.addToHistory(s),s.resource&&i.add(`${s.resource.toString()}/${s.editorId}`));for(const s of e)i.has(`${s.resource.toString()}/${(o=s.options)==null?void 0:o.override}`)||this.addToHistory(s,!1)}loadHistoryFromStorage(){const e=[],t=this.storageService.get(Xt.HISTORY_STORAGE_KEY,1);if(t)try{const i=JSON.parse(t);for(const o of i)if(!(!o.editor||!o.editor.resource))try{e.push({...o.editor,resource:typeof o.editor.resource=="string"?P.parse(o.editor.resource):P.from(o.editor.resource)})}catch(s){Ho(s)}}catch(i){Ho(i)}return e}saveState(){if(!this.history)return;const e=[];for(const t of this.history)ae(t)||!js(t)||e.push({editor:{...t,resource:t.resource.toString()}});this.storageService.store(Xt.HISTORY_STORAGE_KEY,JSON.stringify(e),1,1)}getLastActiveWorkspaceRoot(e){const t=this.contextService.getWorkspace().folders;if(t.length!==0){if(t.length===1){const i=t[0].uri;return!e||i.scheme===e?i:void 0}for(const i of this.getHistory()){if(ae(i)||e&&i.resource.scheme!==e)continue;const o=this.contextService.getWorkspaceFolder(i.resource);if(o)return o.uri}for(const i of t){const o=i.uri;if(!e||o.scheme===e)return o}}}getLastActiveFile(e){for(const t of this.getHistory()){let i;if(ae(t)?i=ee.getOriginalUri(t,{filterByScheme:e}):i=t.resource,(i==null?void 0:i.scheme)===e)return i}}};wi.MOUSE_NAVIGATION_SETTING="workbench.editor.mouseBackForwardToNavigate";wi.NAVIGATION_SCOPE_SETTING="workbench.editor.navigationScope";wi.MAX_RECENTLY_CLOSED_EDITORS=20;wi.MAX_HISTORY_ITEMS=200;wi.HISTORY_STORAGE_KEY="history.entries";wi=x([h(0,U),h(1,oe),h(2,at),h(3,Se),h(4,L),h(5,Ue),h(6,wa),h(7,D),h(8,pt),h(9,H)],wi);class bd{constructor(e,t,i){this.editorIdentifier=e,this.selection=t,this.reason=i}justifiesNewNavigationEntry(e){if(this.editorIdentifier.groupId!==e.editorIdentifier.groupId||!this.editorIdentifier.editor.matches(e.editorIdentifier.editor)||!this.selection||!e.selection)return!0;const t=this.selection.compare(e.selection);return t===2&&(e.reason===4||e.reason===5)?!0:t===3}}let Oo=class extends R{constructor(e,t){super(),this.scope=e,this.instantiationService=t,this.selectionsStack=this._register(this.instantiationService.createInstance(so,0,this.scope)),this.editsStack=this._register(this.instantiationService.createInstance(so,1,this.scope)),this.navigationsStack=this._register(this.instantiationService.createInstance(so,2,this.scope)),this.stacks=[this.selectionsStack,this.editsStack,this.navigationsStack],this.onDidChange=I.any(this.selectionsStack.onDidChange,this.editsStack.onDidChange,this.navigationsStack.onDidChange)}canGoForward(e){return this.getStack(e).canGoForward()}goForward(e){return this.getStack(e).goForward()}canGoBack(e){return this.getStack(e).canGoBack()}goBack(e){return this.getStack(e).goBack()}goPrevious(e){return this.getStack(e).goPrevious()}canGoLast(e){return this.getStack(e).canGoLast()}goLast(e){return this.getStack(e).goLast()}getStack(e=0){switch(e){case 0:return this.selectionsStack;case 1:return this.editsStack;case 2:return this.navigationsStack}}handleActiveEditorChange(e){this.selectionsStack.notifyNavigation(e)}handleActiveEditorSelectionChange(e,t){const i=this.selectionsStack.current;this.selectionsStack.notifyNavigation(e,t),t.reason===3?this.editsStack.notifyNavigation(e,t):(t.reason===4||t.reason===5)&&!this.selectionsStack.isNavigating()&&(t.reason===5&&!this.navigationsStack.isNavigating()&&i&&this.navigationsStack.addOrReplace(i.groupId,i.editor,i.selection),this.navigationsStack.notifyNavigation(e,t))}clear(){for(const e of this.stacks)e.clear()}remove(e){for(const t of this.stacks)t.remove(e)}move(e){for(const t of this.stacks)t.move(e)}};Oo=x([h(1,D)],Oo);class Xw{constructor(){this.onDidChange=I.None}canGoForward(){return!1}async goForward(){}canGoBack(){return!1}async goBack(){}async goPrevious(){}canGoLast(){return!1}async goLast(){}handleActiveEditorChange(){}handleActiveEditorSelectionChange(){}clear(){}remove(){}move(){}dispose(){}}let so=class wu extends R{get current(){return this.stack[this.index]}set current(e){e&&(this.stack[this.index]=e)}constructor(e,t,i,o,s,n){super(),this.filter=e,this.scope=t,this.instantiationService=i,this.editorService=o,this.editorGroupService=s,this.logService=n,this._onDidChange=this._register(new y),this.onDidChange=this._onDidChange.event,this.mapEditorToDisposable=new Map,this.mapGroupToDisposable=new Map,this.editorHelper=this.instantiationService.createInstance(hn),this.stack=[],this.index=-1,this.previousIndex=-1,this.navigating=!1,this.currentSelectionState=void 0,this.registerListeners()}registerListeners(){this._register(this.onDidChange(()=>this.traceStack())),this._register(this.logService.onDidChangeLogLevel(()=>this.traceStack()))}traceStack(){var t,i,o;if(this.logService.getLevel()!==jc.Trace)return;const e=[];for(const s of this.stack)typeof((t=s.selection)==null?void 0:t.log)=="function"?e.push(`- group: ${s.groupId}, editor: ${(i=s.editor.resource)==null?void 0:i.toString()}, selection: ${s.selection.log()}`):e.push(`- group: ${s.groupId}, editor: ${(o=s.editor.resource)==null?void 0:o.toString()}, selection: <none>`);e.length===0?this.trace(`index: ${this.index}, navigating: ${this.isNavigating()}: <empty>`):this.trace(`index: ${this.index}, navigating: ${this.isNavigating()}
${e.join(`
`)}
			`)}trace(e,t=null,i){var n;if(this.logService.getLevel()!==jc.Trace)return;let o;switch(this.filter){case 0:o="global";break;case 1:o="edits";break;case 2:o="navigation";break}let s;switch(this.scope){case 0:s="default";break;case 1:s="editorGroup";break;case 2:s="editor";break}t!==null?this.logService.trace(`[History stack ${o}-${s}]: ${e} (editor: ${(n=t==null?void 0:t.resource)==null?void 0:n.toString()}, event: ${this.traceEvent(i)})`):this.logService.trace(`[History stack ${o}-${s}]: ${e}`)}traceEvent(e){if(!e)return"<none>";switch(e.reason){case 3:return"edit";case 4:return"navigation";case 5:return"jump";case 1:return"programmatic";case 2:return"user"}}registerGroupListeners(e){if(!this.mapGroupToDisposable.has(e)){const t=this.editorGroupService.getGroup(e);t&&this.mapGroupToDisposable.set(e,t.onWillMoveEditor(i=>this.onWillMoveEditor(i)))}}onWillMoveEditor(e){if(this.trace("onWillMoveEditor()",e.editor),this.scope!==1)for(const t of this.stack)t.groupId===e.groupId&&this.editorHelper.matchesEditor(e.editor,t.editor)&&(t.groupId=e.target)}notifyNavigation(e,t){this.trace("notifyNavigation()",e==null?void 0:e.input,t);const i=Sr(e),o=(e==null?void 0:e.group)&&e.input&&!e.input.isDisposed();this.navigating?(this.trace("notifyNavigation() ignoring (navigating)",e==null?void 0:e.input,t),i&&o?(this.trace("notifyNavigation() updating current selection state",e==null?void 0:e.input,t),this.currentSelectionState=new bd({groupId:e.group.id,editor:e.input},e.getSelection(),t==null?void 0:t.reason)):(this.trace("notifyNavigation() dropping current selection state",e==null?void 0:e.input,t),this.currentSelectionState=void 0)):(this.trace("notifyNavigation() not ignoring",e==null?void 0:e.input,t),i&&o?this.onSelectionAwareEditorNavigation(e.group.id,e.input,e.getSelection(),t):(this.currentSelectionState=void 0,o&&this.onNonSelectionAwareEditorNavigation(e.group.id,e.input)))}onSelectionAwareEditorNavigation(e,t,i,o){var n;if(((n=this.current)==null?void 0:n.groupId)===e&&!i&&this.editorHelper.matchesEditor(this.current.editor,t))return;this.trace("onSelectionAwareEditorNavigation()",t,o);const s=new bd({groupId:e,editor:t},i,o==null?void 0:o.reason);!this.currentSelectionState||this.currentSelectionState.justifiesNewNavigationEntry(s)?this.doAdd(e,t,s.selection):this.doReplace(e,t,s.selection),this.currentSelectionState=s}onNonSelectionAwareEditorNavigation(e,t){var i;((i=this.current)==null?void 0:i.groupId)===e&&this.editorHelper.matchesEditor(this.current.editor,t)||(this.trace("onNonSelectionAwareEditorNavigation()",t),this.doAdd(e,t))}doAdd(e,t,i){this.navigating||this.addOrReplace(e,t,i)}doReplace(e,t,i){this.navigating||this.addOrReplace(e,t,i,!0)}addOrReplace(e,t,i,o){this.registerGroupListeners(e);let s=!1;this.current&&(o||this.shouldReplaceStackEntry(this.current,{groupId:e,editor:t,selection:i}))&&(s=!0);const n=this.editorHelper.preferResourceEditorInput(t);if(!n)return;s?this.trace("replace()",n):this.trace("add()",n);const r={groupId:e,editor:n,selection:i},a=[];if(s)this.current&&a.push(this.current),this.current=r;else{if(this.stack.length>this.index+1){for(let d=this.index+1;d<this.stack.length;d++)a.push(this.stack[d]);this.stack=this.stack.slice(0,this.index+1)}this.stack.splice(this.index+1,0,r),this.stack.length>wu.MAX_STACK_SIZE?(a.push(this.stack.shift()),this.previousIndex>=0&&this.previousIndex--):this.setIndex(this.index+1,!0)}for(const d of a)this.editorHelper.clearOnEditorDispose(d.editor,this.mapEditorToDisposable);ae(n)&&this.editorHelper.onEditorDispose(n,()=>this.remove(n),this.mapEditorToDisposable),this._onDidChange.fire()}shouldReplaceStackEntry(e,t){return e.groupId!==t.groupId||!this.editorHelper.matchesEditor(e.editor,t.editor)?!1:e.selection?t.selection?e.selection.compare(t.selection)===1:!1:!0}move(e){if(e.isOperation(2))for(const t of this.stack)this.editorHelper.matchesEditor(e,t.editor)&&(t.editor={resource:e.target.resource})}remove(e){var t;this.stack=this.stack.filter(i=>{const o=typeof e=="number"?i.groupId===e:this.editorHelper.matchesEditor(e,i.editor);return o&&this.editorHelper.clearOnEditorDispose(i.editor,this.mapEditorToDisposable),!o}),this.flatten(),this.index=this.stack.length-1,this.previousIndex=-1,typeof e=="number"&&((t=this.mapGroupToDisposable.get(e))==null||t.dispose(),this.mapGroupToDisposable.delete(e)),this._onDidChange.fire()}flatten(){const e=[];let t;for(const i of this.stack)t&&this.shouldReplaceStackEntry(i,t)||(t=i,e.push(i));this.stack=e}clear(){this.index=-1,this.previousIndex=-1,this.stack.splice(0);for(const[,e]of this.mapEditorToDisposable)ue(e);this.mapEditorToDisposable.clear();for(const[,e]of this.mapGroupToDisposable)ue(e);this.mapGroupToDisposable.clear()}dispose(){super.dispose(),this.clear()}canGoForward(){return this.stack.length>this.index+1}async goForward(){if(!await this.maybeGoCurrent()&&this.canGoForward())return this.setIndex(this.index+1),this.navigate()}canGoBack(){return this.index>0}async goBack(){if(!await this.maybeGoCurrent()&&this.canGoBack())return this.setIndex(this.index-1),this.navigate()}async goPrevious(){if(!await this.maybeGoCurrent())return this.previousIndex===-1?this.goBack():(this.setIndex(this.previousIndex),this.navigate())}canGoLast(){return this.stack.length>0}async goLast(){if(this.canGoLast())return this.setIndex(this.stack.length-1),this.navigate()}async maybeGoCurrent(){return this.filter===0||this.isCurrentSelectionActive()?!1:(await this.navigate(),!0)}isCurrentSelectionActive(){var i,o;if(!((i=this.current)!=null&&i.selection))return!1;const e=this.editorService.activeEditorPane;if(!Sr(e)||((o=e.group)==null?void 0:o.id)!==this.current.groupId||!e.input||!this.editorHelper.matchesEditor(e.input,this.current.editor))return!1;const t=e.getSelection();return t?t.compare(this.current.selection)===1:!1}setIndex(e,t){this.previousIndex=this.index,this.index=e,t||this._onDidChange.fire()}async navigate(){this.navigating=!0;try{this.current&&await this.doNavigate(this.current)}finally{this.navigating=!1}}doNavigate(e){let t=Object.create(null);return e.selection&&(t=e.selection.restore(t)),ae(e.editor)?this.editorService.openEditor(e.editor,t,e.groupId):this.editorService.openEditor({...e.editor,options:{...e.editor.options,...t}},e.groupId)}isNavigating(){return this.navigating}};so.MAX_STACK_SIZE=50;so=x([h(2,D),h(3,U),h(4,oe),h(5,rt)],so);let hn=class{constructor(e,t,i,o){this.uriIdentityService=e,this.lifecycleService=t,this.fileService=i,this.pathService=o}preferResourceEditorInput(e){const t=ee.getOriginalUri(e);if((t==null?void 0:t.scheme)===Re.file||(t==null?void 0:t.scheme)===Re.vscodeRemote||(t==null?void 0:t.scheme)===Re.vscodeUserData||(t==null?void 0:t.scheme)===this.pathService.defaultUriScheme){if(ae(e)){const o=e.toUntyped();if(js(o))return o}return e}else return ae(e)?e:void 0}matchesEditor(e,t){return e instanceof io||e instanceof qc?ae(t)?!1:e instanceof io?e.contains(t.resource,2):this.matchesFile(t.resource,e):ae(e)?ae(t)?e.matches(t):this.matchesFile(t.resource,e):ae(t)?this.matchesFile(e.resource,t):e&&t&&this.uriIdentityService.extUri.isEqual(e.resource,t.resource)}matchesFile(e,t){if(t instanceof io)return t.contains(e,2);if(t instanceof qc)return this.uriIdentityService.extUri.isEqualOrParent(e,t.resource);if(ae(t)){const i=t.resource;return!i||this.lifecycleService.phase>=3&&!this.fileService.hasProvider(i)?!1:this.uriIdentityService.extUri.isEqual(i,e)}return this.uriIdentityService.extUri.isEqual(t==null?void 0:t.resource,e)}matchesEditorIdentifier(e,t){return!(t!=null&&t.group)||e.groupId!==t.group.id?!1:t.input?e.editor.matches(t.input):!1}onEditorDispose(e,t,i){const o=I.once(e.onWillDispose)(()=>t());let s=i.get(e);s||(s=new A,i.set(e,s)),s.add(o)}clearOnEditorDispose(e,t){if(!ae(e))return;const i=t.get(e);i&&(ue(i),t.delete(e))}};hn=x([h(0,cs),h(1,Sa),h(2,Ue),h(3,Xd)],hn);const On=new Map,fc=new Map;class Jw{constructor(){this.onDidPaneCompositeOpen=I.None,this.onDidPaneCompositeClose=I.None}async openPaneComposite(e,t,i){var o;return(o=this.getPartByLocation(t))==null?void 0:o.openPaneComposite(e,i)}getActivePaneComposite(e){var t;return(t=this.getPartByLocation(e))==null?void 0:t.getActivePaneComposite()}getPaneComposite(e,t){var i;return(i=this.getPartByLocation(t))==null?void 0:i.getPaneComposite(e)}getPaneComposites(e){var t;return((t=this.getPartByLocation(e))==null?void 0:t.getPaneComposites())??[]}getPinnedPaneCompositeIds(e){var t;return((t=this.getSelectorPartByLocation(e))==null?void 0:t.getPinnedPaneCompositeIds())??[]}getVisiblePaneCompositeIds(e){var t;return((t=this.getSelectorPartByLocation(e))==null?void 0:t.getVisiblePaneCompositeIds())??[]}getProgressIndicator(e,t){var i;return(i=this.getPartByLocation(t))==null?void 0:i.getProgressIndicator(e)}hideActivePaneComposite(e){var t;(t=this.getPartByLocation(e))==null||t.hideActivePaneComposite()}getLastActivePaneCompositeId(e){return this.getPartByLocation(e).getLastActivePaneCompositeId()}showActivity(e,t,i,o,s){return this.getSelectorPartByLocation(t).showActivity(e,i,o,s)}getPartByLocation(e){return On.get(e)}getSelectorPartByLocation(e){return fc.get(e)}}function Is(c,e,t){const i=document.createElement("div");e.append(i),i.classList.add(...t),i.oncontextmenu=()=>!1,c.create(i);function o(){c.layout(Math.max(c.minimumWidth,Math.min(c.maximumWidth,e.offsetWidth)),Math.max(c.minimumHeight,Math.min(c.maximumHeight,e.offsetHeight)),0,0)}c.onDidVisibilityChange(n=>{n&&o()}),o();const s=new ResizeObserver(o);return s.observe(e),{dispose(){return s.disconnect()}}}function aC(c){const e=yo.get(D).createInstance(ni,On.get(0));return fc.set(0,e),e._register(Is(e,c,["part","activitybar","left"])),e}function cC(c){const e=yo.get(D).createInstance(Ys);return On.set(0,e),e._register(Is(e,c,["part","sidebar","left"])),e.getPaneComposites().length>0&&e.openPaneComposite(e.getPaneComposites()[0].id),e}function dC(c){const e=yo.get(D).createInstance(en);return fc.set(1,e),On.set(1,e),e._register(Is(e,c,["part","panel","basepanel"])),e.getPaneComposites().length>0&&e.openPaneComposite(e.getPaneComposites()[0].id),e}function lC(c){const e=yo.get(oe);return Is(e,c,["part","editor"])}function hC(c){const e=yo.get(ji);return Is(e,c,["part","statusbar"])}function uC(c){const e=c.icon!=null?P.parse(c.icon):void 0,t=de.as(lt.ViewContainersRegistry).registerViewContainer({id:c.id,title:c.name,order:c.order,ctorDescriptor:new J(fa,[c.id,{mergeViewWithContainerWhenSingleView:!0}]),hideIfEmpty:!0,icon:e},c.location),i=[{id:c.id,name:c.name,canToggleVisibility:!1,ctorDescriptor:new J(class extends En{renderBody(s){super.renderBody(s),this.content=z(".view-pane-content"),this.content.style.display="flex",this.content.style.alignItems="stretch",se(s,this.content),this._register(c.renderBody(this.content))}getActionViewItem(s,n){const r=(c.actions??[]).find(a=>a.id===s.id);return(r==null?void 0:r.render)!=null?new class extends db{constructor(){super(null,s),this.render=r.render}}:super.getActionViewItem(s,n)}layoutBody(s,n){this.content.style.height=`${s}px`,this.content.style.width=`${n}px`}}),canMoveView:c.canMoveView??!0,containerIcon:e}];de.as(lt.ViewsRegistry).registerViews(i,t);const o=new A;o.add({dispose(){de.as(lt.ViewsRegistry).deregisterViews(i,t),de.as(lt.ViewContainersRegistry).deregisterViewContainer(t)}});for(const s of c.actions??[])o.add(te(class extends qe{constructor(){super({id:s.id,title:{value:s.title,original:s.title},category:ve.View,menu:[{id:b.ViewTitle,when:v.equals("view",c.id),group:"navigation",order:s.order},{id:b.CommandPalette}],tooltip:s.tooltip,icon:s.icon!=null?M[s.icon]:void 0}),this.run=s.run??(async()=>{})}}));return o}let ua=class{constructor(e){this.editorPart=e}createEditorDropTarget(e,t){return this.editorPart.createEditorDropTarget(e,t)}};ua=x([h(0,oe)],ua);let pa=class extends da{constructor(e,t,i,o,s,n,r,a,d,l,u,g){super(t,i,o,s,n,r,a,d,l,u),this._editorGroupService=t,this.openEditor=Db(g,this.openEditor.bind(this),e)}get activeTextEditorControl(){return super.activeTextEditorControl??yo.get(gs).getFocusedCodeEditor()??void 0}async openEditor(e,t,i){var s;if(((s=this._editorGroupService.getContainer())==null?void 0:s.isConnected)??!1)return super.openEditor(e,t,i)}};pa=x([h(1,oe),h(2,D),h(3,Ue),h(4,L),h(5,at),h(6,cs),h(7,$a),h(8,rh),h(9,os),h(10,ja),h(11,ns)],pa);function mC(c){return{...lb(),[yn.toString()]:new J(Cb),[nt.toString()]:new J($o),[ts.toString()]:new J(xr),[zi.toString()]:new J(Jw),[gt.toString()]:new J(Vr),[ci.toString()]:new J(hb),[ub.toString()]:new J(Nr),[gs.toString()]:new J(xb),[ja.toString()]:new J(pb),[oe.toString()]:new J(Zo),[ji.toString()]:new J(ha),[Uw.toString()]:new J(ua),[U.toString()]:new J(pa,[c]),[$a.toString()]:new J(po),[$t.toString()]:new J(gb),[ss.toString()]:new J(mb),[fb.toString()]:new J(bb),[vb.toString()]:new J(wb),[yb.toString()]:new J(wi)}}export{vC as ViewContainerLocation,mC as default,uC as registerCustomView,aC as renderActivitybarPar,lC as renderEditorPart,dC as renderPanelPart,cC as renderSidebarPart,hC as renderStatusBarPart};
